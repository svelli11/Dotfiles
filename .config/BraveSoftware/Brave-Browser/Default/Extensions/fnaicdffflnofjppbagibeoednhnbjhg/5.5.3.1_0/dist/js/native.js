!function(){try{var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},e=(new t.Error).stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="556571db-e07d-4e3d-98d2-617b15fdcca7",t._sentryDebugIdIdentifier="sentry-dbid-556571db-e07d-4e3d-98d2-617b15fdcca7")}catch(t){}}();var _global="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{};_global.SENTRY_RELEASE={id:"5.4.5"},(()=>{var t,e,a,o,n,i={6062:(t,e,a)=>{a.p="/js/"},19851:(t,e,a)=>{"use strict";a(6062);var o=a(85471),n=a(41146),i=a(67856),r=a(52941),s=function(){var t=this._self._c;return t(r.A,{style:{background:this.background},attrs:{id:"app"}},[t("router-view")],1)};s._withStripped=!0,a(3362);var c=a(8330),l=a(95099),d=a(7486),u=a.n(d);const p={name:"NativeApp",data:()=>({VERSION:c.rE,key:"",unlockError:null}),computed:{locked:()=>!1,background(){return this.$vuetify.theme.dark?"#000000":"#ffffff"}},async created(){const t=await u().getSingleton();await t.onLoad(),setInterval((()=>{this.$store.dispatch(l.o.LOAD_ACCOUNTS)}),5e3),t.onStatusChange((()=>{this.$store.dispatch(l.o.LOAD_ACCOUNTS)}))}},A=()=>{(0,o.$9)(((t,e)=>({"7e609dbe":t.background})))},m=p.setup;p.setup=m?(t,e)=>(A(),m(t,e)):A;const g=p;a(51975);const w=(0,a(14486).A)(g,s,[],!1,null,null,null).exports;var O=a(95353);const f={[l.z.SET_LOCKED](t,e){t.locked=e},[l.z.LOAD_ACCOUNTS](t,e){t.accounts=e},[l.z.STORE_ACCOUNT_DATA](t,e){let{id:a,data:n}=e;o.Ay.set(t.accounts[a],"data",n)},[l.z.REMOVE_ACCOUNT](t,e){o.Ay.delete(t.accounts,e)},[l.z.LOAD_TREE](t,e){t.tree=e},[l.z.SET_LOGIN_FLOW_STATE](t,e){o.Ay.set(t.loginFlow,"isRunning",e)},[l.z.LOADING_START](t,e){o.Ay.set(t.loading,e,!0)},[l.z.LOADING_END](t,e){o.Ay.set(t.loading,e,!1)},[l.z.SET_LAST_FOLDER](t,e){let{accountId:a,folderId:n}=e;o.Ay.set(t.lastFolders,a,n)}};a(23792),a(33110),a(98992),a(81454),a(62953),a(48408);var E=a(15879),T=a.n(E),h=a(29242),y=a(10341),_=a.n(y),C=a(5e3),b=a(16546),k=a(40962),v=a(91557),S=a.n(v),R=a(2142),N=a(48292);const L={async[l.o.LOAD_ACCOUNTS](t){let{commit:e,dispatch:a,state:o}=t;e(l.z.LOADING_START,"accounts");const n=await T().getAllAccounts(),i={};await Promise.all(n.map((async t=>{i[t.id]={data:t.getData(),id:t.id,label:t.getLabel()}}))),await e(l.z.LOAD_ACCOUNTS,i),e(l.z.LOADING_END,"accounts")},async[l.o.LOAD_TREE](t,e){let{commit:a,dispatch:o,state:n}=t;const i=await T().get(e),r=await i.getResource(),s=await r.getBookmarksTree(!0);await a(l.z.LOAD_TREE,s)},async[l.o.LOAD_TREE_FROM_DISK](t,e){let{commit:a,dispatch:o,state:n}=t;const i=await T().get(e);if(i.syncing)return;const r=await i.getResource(),s=await r.load(),c=await r.getBookmarksTree(!0);await a(l.z.LOAD_TREE,c),s&&await o(l.o.TRIGGER_SYNC,e)},async[l.o.CREATE_BOOKMARK](t,e){let{commit:a}=t,{accountId:o,bookmark:n}=e;const i=await T().get(o),r=await i.getResource();await r.createBookmark(n),await r.save(),await a(l.z.LOAD_TREE,await r.getBookmarksTree(!0)),(await u().getSingleton()).scheduleSync(o,!0)},async[l.o.EDIT_BOOKMARK](t,e){let{commit:a}=t,{accountId:o,bookmark:n}=e;const i=await T().get(o),r=await i.getResource();await r.updateBookmark(n),await r.save(),await a(l.z.LOAD_TREE,await r.getBookmarksTree(!0))},async[l.o.COUNT_BOOKMARK_CLICK](t,e){let{state:a}=t,{accountId:o,bookmark:n}=e;if(!a.accounts[o].data.clickCountEnabled)return;const i=await T().get(o),r=await i.getServer();r.countClick&&await r.countClick(n.url)},async[l.o.DELETE_BOOKMARK](t,e){let{commit:a}=t,{accountId:o,bookmark:n}=e;const i=await T().get(o),r=await i.getResource();await r.removeBookmark(n),await r.save(),await a(l.z.LOAD_TREE,await r.getBookmarksTree(!0)),(await u().getSingleton()).scheduleSync(o,!0)},async[l.o.SHARE_BOOKMARK](t,e){let{commit:a}=t;await k.S.share({title:e.title,url:e.url})},async[l.o.CREATE_FOLDER](t,e){let{commit:a}=t,{accountId:o,folder:n}=e;const i=await T().get(o),r=await i.getResource();await r.createFolder(n),await r.save(),await a(l.z.LOAD_TREE,await r.getBookmarksTree(!0)),(await u().getSingleton()).scheduleSync(o,!0)},async[l.o.EDIT_FOLDER](t,e){let{commit:a}=t,{accountId:o,folder:n}=e;const i=await T().get(o),r=await i.getResource();await r.updateFolder(n),await r.save(),await a(l.z.LOAD_TREE,await r.getBookmarksTree(!0)),(await u().getSingleton()).scheduleSync(o,!0)},async[l.o.DELETE_FOLDER](t,e){let{commit:a}=t,{accountId:o,folder:n}=e;const i=await T().get(o),r=await i.getResource();await r.removeFolder(n),await r.save(),await a(l.z.LOAD_TREE,await r.getBookmarksTree(!0)),(await u().getSingleton()).scheduleSync(o,!0)},async[l.o.IMPORT_BOOKMARKS](t,e){let{commit:a}=t,{accountId:o,parentFolder:n,html:i}=e;const r=S().deserialize(i),s=await T().get(o),c=await s.getResource();await Promise.all(r.children.map((async t=>{if(t.parentId=n,t instanceof R.Bookmark&&await c.createBookmark(t),t instanceof R.Folder){const e=await c.createFolder(t);await c.bulkImportFolder(e,t)}}))),await c.save(),await a(l.z.LOAD_TREE,await c.getBookmarksTree(!0))},async[l.o.CREATE_ACCOUNT](t,e){let{commit:a,dispatch:o,state:n}=t;const i=await _().getDefaultValues(e.type),r=await T().create({...i,...e});return await o(l.o.LOAD_ACCOUNTS),r.id},async[l.o.IMPORT_ACCOUNTS](t,e){let{commit:a,dispatch:o,state:n}=t;await T().import(e),await o(l.o.LOAD_ACCOUNTS)},async[l.o.EXPORT_ACCOUNTS](t,e){let{commit:a,dispatch:o,state:n}=t;const i=await T().export(e),r=new Blob([JSON.stringify(i,null,"  ")],{type:"text/plain",endings:"native"});h.default.download("floccus.export.json",r)},async[l.o.DELETE_ACCOUNT](t,e){let{commit:a,dispatch:o,state:n}=t;const i=await T().get(e);await i.delete(),a(l.z.REMOVE_ACCOUNT,e)},async[l.o.RESET_ACCOUNT](t,e){let{commit:a,dispatch:o,state:n}=t;const i=await T().get(e);await i.storage.initCache(),await i.storage.initMappings()},async[l.o.STORE_ACCOUNT](t,e){let{commit:a,dispatch:o,state:n}=t,{id:i,data:r}=e;const s=await T().get(i),c=s.getData();await s.setData(r),c.localRoot!==r.localRoot&&await s.init(),c.bookmark_file!==r.bookmark_file&&await s.init(),c.bookmark_file_type!==r.bookmark_file_type&&await s.init(),a(l.z.STORE_ACCOUNT_DATA,{id:i,data:r})},async[l.o.TRIGGER_SYNC](t,e){let{commit:a,dispatch:o,state:n}=t;(await u().getSingleton()).syncAccount(e)},async[l.o.FORCE_SYNC](t,e){let{commit:a,dispatch:o,state:n}=t;(await u().getSingleton()).syncAccount(e,null,!0)},async[l.o.TRIGGER_SYNC_DOWN](t,e){let{commit:a,dispatch:o,state:n}=t;const i=await u().getSingleton();await i.syncAccount(e,"slave")},async[l.o.TRIGGER_SYNC_UP](t,e){let{commit:a,dispatch:o,state:n}=t;const i=await u().getSingleton();await i.syncAccount(e,"overwrite")},async[l.o.CANCEL_SYNC](t,e){let{commit:a,dispatch:o,state:n}=t;const i=await u().getSingleton();await i.cancelSync(e,!0)},async[l.o.DOWNLOAD_LOGS](t,e){let{commit:a,dispatch:o,state:n}=t;await h.default.downloadLogs(e)},async[l.o.EXPORT_BOOKMARKS](t,e){let{commit:a,dispatch:o,state:n}=t;const i=await T().get(e),r=await i.localTree.getBookmarksTree(),s=S().serialize(r),c=new Blob([s],{type:"text/html",endings:"native"});h.default.download("floccus-"+(new Date).toISOString().slice(0,10)+".export.html",c)},async[l.o.TEST_WEBDAV_SERVER](t,e){let{commit:a,dispatch:o,state:n}=t,{rootUrl:i,username:r,password:s}=e;return!0},async[l.o.TEST_LINKWARDEN_SERVER](t,e){let{commit:a,dispatch:o,state:n}=t,{rootUrl:i,token:r}=e;if(200!==(await b.CapacitorHttp.request({url:`${i}/api/v1/collections`,method:"GET",headers:{"User-Agent":"Floccus bookmarks sync",Authorization:"Bearer "+r}})).status)throw new Error(C.i18n.getMessage("LabelLinkwardenconnectionerror"));return!0},async[l.o.TEST_NEXTCLOUD_SERVER](t,e){let{commit:a,dispatch:o,state:n}=t;if(200!==(await b.CapacitorHttp.request({url:`${e}/index.php/login/v2`,method:"POST",headers:{"User-Agent":"Floccus bookmarks sync"}})).status)throw new Error(C.i18n.getMessage("LabelLoginFlowError"));return!0},async[l.o.START_LOGIN_FLOW](t,e){let{commit:a,dispatch:o,state:n}=t;a(l.z.SET_LOGIN_FLOW_STATE,!0);let i=await b.CapacitorHttp.request({url:`${e}/index.php/login/v2`,method:"POST",headers:{"User-Agent":"Floccus bookmarks sync"}});if(200!==i.status||!n.loginFlow.isRunning)throw a(l.z.SET_LOGIN_FLOW_STATE,!1),new Error(C.i18n.getMessage("LabelLoginFlowError"));let r=i.data;await N.P.open({url:r.login,presentationStyle:"popover"});do{await new Promise((t=>setTimeout(t,1e3)));try{const t=new URLSearchParams;t.set("token",r.poll.token),i=await b.CapacitorHttp.request({url:r.poll.endpoint,method:"POST",data:t.toString(),headers:{"Content-type":"application/x-www-form-urlencoded"}})}catch(t){i={status:404}}}while((404===i.status||!i.data.appPassword)&&n.loginFlow.isRunning);if(a(l.z.SET_LOGIN_FLOW_STATE,!1),await N.P.close(),200!==i.status)throw new Error(C.i18n.getMessage("LabelLoginFlowError"));return r=i.data,{username:r.loginName,password:r.appPassword}},async[l.o.STOP_LOGIN_FLOW](t){let{commit:e}=t;e(l.z.SET_LOGIN_FLOW_STATE,!1)},async[l.o.SET_SORTBY](t,e){let{state:a}=t,{accountId:o,sortBy:n}=e;const i=await T().get(o);await i.setData({sortBy:n})}};o.Ay.use(O.Ay);const D=new O.il({mutations:f,actions:L,state:{locked:!1,accounts:{},tree:null,loginFlow:{isRunning:!1},loading:{accounts:!0},lastFolders:{}},getters:{}});var I=a(78742),U=a(91149);a(33692),o.Ay.mixin(I.A),o.Ay.mixin(i.A),C.i18n.setLocales(navigator.languages),C.i18n.load().then((()=>{window.floccus=a.g.Floccus=new o.Ay({el:"#app",router:U.Q,store:D,vuetify:n.A,render:t=>t(w)})}))},51975:(t,e,a)=>{var o=a(78732);o.__esModule&&(o=o.default),"string"==typeof o&&(o=[[t.id,o,""]]),o.locals&&(t.exports=o.locals),(0,a(70534).A)("dc6d5744",o,!1,{})},78732:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>s});var o=a(71354),n=a.n(o),i=a(76314),r=a.n(i)()(n());r.push([t.id,"\nbody {\n  padding-top: env(safe-area-inset-top);\n  padding-bottom: env(safe-area-inset-bottom);\n  padding-left: env(safe-area-inset-left);\n  padding-right: env(sage-area-inset-right);\n  background: var(--7e609dbe);\n  font-size: 0.45cm !important;\n}\n@media (prefers-color-scheme: dark) {\nhtml {\n    background-color: #000000;\n}\n}\nhtml {\n  font-size: 0.45cm !important;\n}\n.v-navigation-drawer {\n  top: env(safe-area-inset-top) !important;\n  bottom: 0;\n}\n","",{version:3,sources:["webpack://./src/ui/NativeApp.vue"],names:[],mappings:";AA0CA;EACA,qCAAA;EACA,2CAAA;EACA,uCAAA;EACA,yCAAA;EACA,2BAAA;EACA,4BAAA;AACA;AACA;AACA;IACA,yBAAA;AACA;AACA;AACA;EACA,4BAAA;AACA;AACA;EACA,wCAAA;EACA,SAAA;AACA",sourcesContent:["<template>\n  <v-app\n    id=\"app\"\n    :style=\"{ background }\">\n    <router-view />\n  </v-app>\n</template>\n\n<script>\nimport { version as VERSION } from '../../package.json'\nimport { actions } from './store/definitions'\nimport Controller from '../lib/Controller'\nexport default {\n  name: 'NativeApp',\n  data() {\n    return {\n      VERSION,\n      key: '',\n      unlockError: null,\n    }\n  },\n  computed: {\n    locked() {\n      return false\n    },\n    background() {\n      return this.$vuetify.theme.dark ? '#000000' : '#ffffff'\n    }\n  },\n  async created() {\n    const controller = await Controller.getSingleton()\n    await controller.onLoad()\n    setInterval(() => {\n      this.$store.dispatch(actions.LOAD_ACCOUNTS)\n    }, 5000)\n    controller.onStatusChange(() => {\n      this.$store.dispatch(actions.LOAD_ACCOUNTS)\n    })\n  }\n}\n<\/script>\n<style>\nbody {\n  padding-top: env(safe-area-inset-top);\n  padding-bottom: env(safe-area-inset-bottom);\n  padding-left: env(safe-area-inset-left);\n  padding-right: env(sage-area-inset-right);\n  background: v-bind(background);\n  font-size: 0.45cm !important;\n}\n@media (prefers-color-scheme: dark) {\n  html {\n    background-color: #000000;\n  }\n}\nhtml {\n  font-size: 0.45cm !important;\n}\n.v-navigation-drawer {\n  top: env(safe-area-inset-top) !important;\n  bottom: 0;\n}\n</style>\n"],sourceRoot:""}]);const s=r},91149:(t,e,a)=>{"use strict";a.d(e,{J:()=>u,Q:()=>p}),a(23792),a(3362),a(62953);var o=a(85471),n=a(40173),i=a(93538),r=a(67377),s=a(84559),c=a(51410),l=a(63262),d=a(71050);o.Ay.use(n.Ay);const u={HOME:"HOME",TREE:"TREE",ACCOUNT_OPTIONS:"ACCOUNT_OPTIONS",NEW_ACCOUNT:"NEW_ACCOUNT",ADD_BOOKMARK:"ADD_BOOKMARK",FUNDING:"FUNDING",UPDATE:"UPDATE",IMPORTEXPORT:"IMPORTEXPORT",DONATE:"DONATE",ABOUT:"ABOUT"},p=new n.Ay({linkActiveClass:"active",routes:[{path:"/",name:u.HOME,component:r.A},{path:"/tree/:accountId",name:u.TREE,component:i.A},{path:"/options/:accountId",name:u.ACCOUNT_OPTIONS,component:()=>Promise.all([a.e(36),a.e(628)]).then(a.bind(a,55046))},{path:"/new",name:u.NEW_ACCOUNT,component:s.A},{path:"/update",name:u.UPDATE,component:()=>a.e(828).then(a.bind(a,98828))},{path:"/newBookmark/:accountId/:url/:text?",name:u.ADD_BOOKMARK,component:c.A},{path:"/importexport",name:u.IMPORTEXPORT,component:l.A},{path:"/about",name:u.ABOUT,component:d.A}]})}},r={};function s(t){var e=r[t];if(void 0!==e)return e.exports;var a=r[t]={id:t,loaded:!1,exports:{}};return i[t].call(a.exports,a,a.exports,s),a.loaded=!0,a.exports}s.m=i,s.amdD=function(){throw new Error("define cannot be used indirect")},s.amdO={},t=[],s.O=(e,a,o,n)=>{if(!a){var i=1/0;for(d=0;d<t.length;d++){for(var[a,o,n]=t[d],r=!0,c=0;c<a.length;c++)(!1&n||i>=n)&&Object.keys(s.O).every((t=>s.O[t](a[c])))?a.splice(c--,1):(r=!1,n<i&&(i=n));if(r){t.splice(d--,1);var l=o();void 0!==l&&(e=l)}}return e}n=n||0;for(var d=t.length;d>0&&t[d-1][2]>n;d--)t[d]=t[d-1];t[d]=[a,o,n]},s.F={},s.E=t=>{Object.keys(s.F).map((e=>{s.F[e](t)}))},s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},a=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,s.t=function(t,o){if(1&o&&(t=this(t)),8&o)return t;if("object"==typeof t&&t){if(4&o&&t.__esModule)return t;if(16&o&&"function"==typeof t.then)return t}var n=Object.create(null);s.r(n);var i={};e=e||[null,a({}),a([]),a(a)];for(var r=2&o&&t;"object"==typeof r&&!~e.indexOf(r);r=a(r))Object.getOwnPropertyNames(r).forEach((e=>i[e]=()=>t[e]));return i.default=()=>t,s.d(n,i),n},s.d=(t,e)=>{for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},s.f={},s.e=t=>Promise.all(Object.keys(s.f).reduce(((e,a)=>(s.f[a](t,e),e)),[])),s.u=t=>t+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o={},n="floccus:",s.l=(t,e,a,i)=>{if(o[t])o[t].push(e);else{var r,c;if(void 0!==a)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==t||u.getAttribute("data-webpack")==n+a){r=u;break}}r||(c=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,s.nc&&r.setAttribute("nonce",s.nc),r.setAttribute("data-webpack",n+a),r.src=t),o[t]=[e];var p=(e,a)=>{r.onerror=r.onload=null,clearTimeout(A);var n=o[t];if(delete o[t],r.parentNode&&r.parentNode.removeChild(r),n&&n.forEach((t=>t(a))),e)return e(a)},A=setTimeout(p.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=p.bind(null,r.onerror),r.onload=p.bind(null,r.onload),c&&document.head.appendChild(r)}},s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),s.p="/dist/js/",(()=>{s.b=document.baseURI||self.location.href;var t={262:0};s.f.j=(e,a)=>{var o=s.o(t,e)?t[e]:void 0;if(0!==o)if(o)a.push(o[2]);else{var n=new Promise(((a,n)=>o=t[e]=[a,n]));a.push(o[2]=n);var i=s.p+s.u(e),r=new Error;s.l(i,(a=>{if(s.o(t,e)&&(0!==(o=t[e])&&(t[e]=void 0),o)){var n=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;r.message="Loading chunk "+e+" failed.\n("+n+": "+i+")",r.name="ChunkLoadError",r.type=n,r.request=i,o[1](r)}}),"chunk-"+e,e)}},s.F.j=e=>{if(!s.o(t,e)||void 0===t[e]){t[e]=null;var a=document.createElement("link");a.charset="utf-8",s.nc&&a.setAttribute("nonce",s.nc),a.rel="prefetch",a.as="script",a.href=s.p+s.u(e),document.head.appendChild(a)}},s.O.j=e=>0===t[e];var e=(e,a)=>{var o,n,[i,r,c]=a,l=0;if(i.some((e=>0!==t[e]))){for(o in r)s.o(r,o)&&(s.m[o]=r[o]);if(c)var d=c(s)}for(e&&e(a);l<i.length;l++)n=i[l],s.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return s.O(d)},a=globalThis.webpackChunkfloccus=globalThis.webpackChunkfloccus||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))})(),s.O(0,[262],(()=>{[36,628,828].map(s.E)}),5);var c=s.O(void 0,[754,890,389,346,133,991,510],(()=>s(19851)));c=s.O(c)})();
//# sourceMappingURL=native.js.map