(()=>{var dt=Object.defineProperty;var N=(G,J)=>dt(G,"name",{value:J,configurable:!0});(()=>{var G={1839:f=>{"use strict";f.exports=function(){function y(p,_,U,v,b){return p<_||U<_?p>U?U+1:p+1:v===b?_:_+1}return N(y,"_min"),function(p,_){if(p===_)return 0;if(p.length>_.length){var U=p;p=_,_=U}for(var v=p.length,b=_.length;v>0&&p.charCodeAt(v-1)===_.charCodeAt(b-1);)v--,b--;for(var E=0;E<v&&p.charCodeAt(E)===_.charCodeAt(E);)E++;if(v-=E,b-=E,v===0||b<3)return b;var S=0,C,A,P,M,F,j,$,O,z,a,r,e,t=[];for(C=0;C<v;C++)t.push(C+1),t.push(p.charCodeAt(E+C));for(var i=t.length-1;S<b-3;)for(z=_.charCodeAt(E+(A=S)),a=_.charCodeAt(E+(P=S+1)),r=_.charCodeAt(E+(M=S+2)),e=_.charCodeAt(E+(F=S+3)),j=S+=4,C=0;C<i;C+=2)$=t[C],O=t[C+1],A=y($,A,P,z,O),P=y(A,P,M,a,O),M=y(P,M,F,r,O),j=y(M,F,j,e,O),t[C]=j,F=M,M=P,P=A,A=$;for(;S<b;)for(z=_.charCodeAt(E+(A=S)),j=++S,C=0;C<i;C+=2)$=t[C],t[C]=j=y($,A,j,z,t[C+1]),A=$;return j}}()},4847:f=>{(function(y){if(!0)f.exports=y();else var p})(function(y){"use strict";var p=N(function(a,r){return a+r&4294967295},"add32"),_=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function U(a,r,e,t,i,s){return r=p(p(r,a),p(t,s)),p(r<<i|r>>>32-i,e)}N(U,"cmn");function v(a,r){var e=a[0],t=a[1],i=a[2],s=a[3];e+=(t&i|~t&s)+r[0]-680876936|0,e=(e<<7|e>>>25)+t|0,s+=(e&t|~e&i)+r[1]-389564586|0,s=(s<<12|s>>>20)+e|0,i+=(s&e|~s&t)+r[2]+606105819|0,i=(i<<17|i>>>15)+s|0,t+=(i&s|~i&e)+r[3]-1044525330|0,t=(t<<22|t>>>10)+i|0,e+=(t&i|~t&s)+r[4]-176418897|0,e=(e<<7|e>>>25)+t|0,s+=(e&t|~e&i)+r[5]+1200080426|0,s=(s<<12|s>>>20)+e|0,i+=(s&e|~s&t)+r[6]-1473231341|0,i=(i<<17|i>>>15)+s|0,t+=(i&s|~i&e)+r[7]-45705983|0,t=(t<<22|t>>>10)+i|0,e+=(t&i|~t&s)+r[8]+1770035416|0,e=(e<<7|e>>>25)+t|0,s+=(e&t|~e&i)+r[9]-1958414417|0,s=(s<<12|s>>>20)+e|0,i+=(s&e|~s&t)+r[10]-42063|0,i=(i<<17|i>>>15)+s|0,t+=(i&s|~i&e)+r[11]-1990404162|0,t=(t<<22|t>>>10)+i|0,e+=(t&i|~t&s)+r[12]+1804603682|0,e=(e<<7|e>>>25)+t|0,s+=(e&t|~e&i)+r[13]-40341101|0,s=(s<<12|s>>>20)+e|0,i+=(s&e|~s&t)+r[14]-1502002290|0,i=(i<<17|i>>>15)+s|0,t+=(i&s|~i&e)+r[15]+1236535329|0,t=(t<<22|t>>>10)+i|0,e+=(t&s|i&~s)+r[1]-165796510|0,e=(e<<5|e>>>27)+t|0,s+=(e&i|t&~i)+r[6]-1069501632|0,s=(s<<9|s>>>23)+e|0,i+=(s&t|e&~t)+r[11]+643717713|0,i=(i<<14|i>>>18)+s|0,t+=(i&e|s&~e)+r[0]-373897302|0,t=(t<<20|t>>>12)+i|0,e+=(t&s|i&~s)+r[5]-701558691|0,e=(e<<5|e>>>27)+t|0,s+=(e&i|t&~i)+r[10]+38016083|0,s=(s<<9|s>>>23)+e|0,i+=(s&t|e&~t)+r[15]-660478335|0,i=(i<<14|i>>>18)+s|0,t+=(i&e|s&~e)+r[4]-405537848|0,t=(t<<20|t>>>12)+i|0,e+=(t&s|i&~s)+r[9]+568446438|0,e=(e<<5|e>>>27)+t|0,s+=(e&i|t&~i)+r[14]-1019803690|0,s=(s<<9|s>>>23)+e|0,i+=(s&t|e&~t)+r[3]-187363961|0,i=(i<<14|i>>>18)+s|0,t+=(i&e|s&~e)+r[8]+1163531501|0,t=(t<<20|t>>>12)+i|0,e+=(t&s|i&~s)+r[13]-1444681467|0,e=(e<<5|e>>>27)+t|0,s+=(e&i|t&~i)+r[2]-51403784|0,s=(s<<9|s>>>23)+e|0,i+=(s&t|e&~t)+r[7]+1735328473|0,i=(i<<14|i>>>18)+s|0,t+=(i&e|s&~e)+r[12]-1926607734|0,t=(t<<20|t>>>12)+i|0,e+=(t^i^s)+r[5]-378558|0,e=(e<<4|e>>>28)+t|0,s+=(e^t^i)+r[8]-2022574463|0,s=(s<<11|s>>>21)+e|0,i+=(s^e^t)+r[11]+1839030562|0,i=(i<<16|i>>>16)+s|0,t+=(i^s^e)+r[14]-35309556|0,t=(t<<23|t>>>9)+i|0,e+=(t^i^s)+r[1]-1530992060|0,e=(e<<4|e>>>28)+t|0,s+=(e^t^i)+r[4]+1272893353|0,s=(s<<11|s>>>21)+e|0,i+=(s^e^t)+r[7]-155497632|0,i=(i<<16|i>>>16)+s|0,t+=(i^s^e)+r[10]-1094730640|0,t=(t<<23|t>>>9)+i|0,e+=(t^i^s)+r[13]+681279174|0,e=(e<<4|e>>>28)+t|0,s+=(e^t^i)+r[0]-358537222|0,s=(s<<11|s>>>21)+e|0,i+=(s^e^t)+r[3]-722521979|0,i=(i<<16|i>>>16)+s|0,t+=(i^s^e)+r[6]+76029189|0,t=(t<<23|t>>>9)+i|0,e+=(t^i^s)+r[9]-640364487|0,e=(e<<4|e>>>28)+t|0,s+=(e^t^i)+r[12]-421815835|0,s=(s<<11|s>>>21)+e|0,i+=(s^e^t)+r[15]+530742520|0,i=(i<<16|i>>>16)+s|0,t+=(i^s^e)+r[2]-995338651|0,t=(t<<23|t>>>9)+i|0,e+=(i^(t|~s))+r[0]-198630844|0,e=(e<<6|e>>>26)+t|0,s+=(t^(e|~i))+r[7]+1126891415|0,s=(s<<10|s>>>22)+e|0,i+=(e^(s|~t))+r[14]-1416354905|0,i=(i<<15|i>>>17)+s|0,t+=(s^(i|~e))+r[5]-57434055|0,t=(t<<21|t>>>11)+i|0,e+=(i^(t|~s))+r[12]+1700485571|0,e=(e<<6|e>>>26)+t|0,s+=(t^(e|~i))+r[3]-1894986606|0,s=(s<<10|s>>>22)+e|0,i+=(e^(s|~t))+r[10]-1051523|0,i=(i<<15|i>>>17)+s|0,t+=(s^(i|~e))+r[1]-2054922799|0,t=(t<<21|t>>>11)+i|0,e+=(i^(t|~s))+r[8]+1873313359|0,e=(e<<6|e>>>26)+t|0,s+=(t^(e|~i))+r[15]-30611744|0,s=(s<<10|s>>>22)+e|0,i+=(e^(s|~t))+r[6]-1560198380|0,i=(i<<15|i>>>17)+s|0,t+=(s^(i|~e))+r[13]+1309151649|0,t=(t<<21|t>>>11)+i|0,e+=(i^(t|~s))+r[4]-145523070|0,e=(e<<6|e>>>26)+t|0,s+=(t^(e|~i))+r[11]-1120210379|0,s=(s<<10|s>>>22)+e|0,i+=(e^(s|~t))+r[2]+718787259|0,i=(i<<15|i>>>17)+s|0,t+=(s^(i|~e))+r[9]-343485551|0,t=(t<<21|t>>>11)+i|0,a[0]=e+a[0]|0,a[1]=t+a[1]|0,a[2]=i+a[2]|0,a[3]=s+a[3]|0}N(v,"md5cycle");function b(a){var r=[],e;for(e=0;e<64;e+=4)r[e>>2]=a.charCodeAt(e)+(a.charCodeAt(e+1)<<8)+(a.charCodeAt(e+2)<<16)+(a.charCodeAt(e+3)<<24);return r}N(b,"md5blk");function E(a){var r=[],e;for(e=0;e<64;e+=4)r[e>>2]=a[e]+(a[e+1]<<8)+(a[e+2]<<16)+(a[e+3]<<24);return r}N(E,"md5blk_array");function S(a){var r=a.length,e=[1732584193,-271733879,-1732584194,271733878],t,i,s,w,k,I;for(t=64;t<=r;t+=64)v(e,b(a.substring(t-64,t)));for(a=a.substring(t-64),i=a.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<i;t+=1)s[t>>2]|=a.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(v(e,s),t=0;t<16;t+=1)s[t]=0;return w=r*8,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),I=parseInt(w[1],16)||0,s[14]=k,s[15]=I,v(e,s),e}N(S,"md51");function C(a){var r=a.length,e=[1732584193,-271733879,-1732584194,271733878],t,i,s,w,k,I;for(t=64;t<=r;t+=64)v(e,E(a.subarray(t-64,t)));for(a=t-64<r?a.subarray(t-64):new Uint8Array(0),i=a.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<i;t+=1)s[t>>2]|=a[t]<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(v(e,s),t=0;t<16;t+=1)s[t]=0;return w=r*8,w=w.toString(16).match(/(.*?)(.{0,8})$/),k=parseInt(w[2],16),I=parseInt(w[1],16)||0,s[14]=k,s[15]=I,v(e,s),e}N(C,"md51_array");function A(a){var r="",e;for(e=0;e<4;e+=1)r+=_[a>>e*8+4&15]+_[a>>e*8&15];return r}N(A,"rhex");function P(a){var r;for(r=0;r<a.length;r+=1)a[r]=A(a[r]);return a.join("")}N(P,"hex"),P(S("hello"))!=="5d41402abc4b2a76b9719d911017c592"&&(p=N(function(a,r){var e=(a&65535)+(r&65535),t=(a>>16)+(r>>16)+(e>>16);return t<<16|e&65535},"add32")),typeof ArrayBuffer<"u"&&!ArrayBuffer.prototype.slice&&function(){function a(r,e){return r=r|0||0,r<0?Math.max(r+e,0):Math.min(r,e)}N(a,"clamp"),ArrayBuffer.prototype.slice=function(r,e){var t=this.byteLength,i=a(r,t),s=t,w,k,I,X;return e!==y&&(s=a(e,t)),i>s?new ArrayBuffer(0):(w=s-i,k=new ArrayBuffer(w),I=new Uint8Array(k),X=new Uint8Array(this,i,w),I.set(X),k)}}();function M(a){return/[\u0080-\uFFFF]/.test(a)&&(a=unescape(encodeURIComponent(a))),a}N(M,"toUtf8");function F(a,r){var e=a.length,t=new ArrayBuffer(e),i=new Uint8Array(t),s;for(s=0;s<e;s+=1)i[s]=a.charCodeAt(s);return r?i:t}N(F,"utf8Str2ArrayBuffer");function j(a){return String.fromCharCode.apply(null,new Uint8Array(a))}N(j,"arrayBuffer2Utf8Str");function $(a,r,e){var t=new Uint8Array(a.byteLength+r.byteLength);return t.set(new Uint8Array(a)),t.set(new Uint8Array(r),a.byteLength),e?t:t.buffer}N($,"concatenateArrayBuffers");function O(a){var r=[],e=a.length,t;for(t=0;t<e-1;t+=2)r.push(parseInt(a.substr(t,2),16));return String.fromCharCode.apply(String,r)}N(O,"hexToBinaryString");function z(){this.reset()}return N(z,"SparkMD5"),z.prototype.append=function(a){return this.appendBinary(M(a)),this},z.prototype.appendBinary=function(a){this._buff+=a,this._length+=a.length;var r=this._buff.length,e;for(e=64;e<=r;e+=64)v(this._hash,b(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},z.prototype.end=function(a){var r=this._buff,e=r.length,t,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s;for(t=0;t<e;t+=1)i[t>>2]|=r.charCodeAt(t)<<(t%4<<3);return this._finish(i,e),s=P(this._hash),a&&(s=O(s)),this.reset(),s},z.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},z.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},z.prototype.setState=function(a){return this._buff=a.buff,this._length=a.length,this._hash=a.hash,this},z.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},z.prototype._finish=function(a,r){var e=r,t,i,s;if(a[e>>2]|=128<<(e%4<<3),e>55)for(v(this._hash,a),e=0;e<16;e+=1)a[e]=0;t=this._length*8,t=t.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(t[2],16),s=parseInt(t[1],16)||0,a[14]=i,a[15]=s,v(this._hash,a)},z.hash=function(a,r){return z.hashBinary(M(a),r)},z.hashBinary=function(a,r){var e=S(a),t=P(e);return r?O(t):t},z.ArrayBuffer=function(){this.reset()},z.ArrayBuffer.prototype.append=function(a){var r=$(this._buff.buffer,a,!0),e=r.length,t;for(this._length+=a.byteLength,t=64;t<=e;t+=64)v(this._hash,E(r.subarray(t-64,t)));return this._buff=t-64<e?new Uint8Array(r.buffer.slice(t-64)):new Uint8Array(0),this},z.ArrayBuffer.prototype.end=function(a){var r=this._buff,e=r.length,t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],i,s;for(i=0;i<e;i+=1)t[i>>2]|=r[i]<<(i%4<<3);return this._finish(t,e),s=P(this._hash),a&&(s=O(s)),this.reset(),s},z.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},z.ArrayBuffer.prototype.getState=function(){var a=z.prototype.getState.call(this);return a.buff=j(a.buff),a},z.ArrayBuffer.prototype.setState=function(a){return a.buff=F(a.buff,!0),z.prototype.setState.call(this,a)},z.ArrayBuffer.prototype.destroy=z.prototype.destroy,z.ArrayBuffer.prototype._finish=z.prototype._finish,z.ArrayBuffer.hash=function(a,r){var e=C(new Uint8Array(a)),t=P(e);return r?O(t):t},z})}},J={};function c(f){var y=J[f];if(y!==void 0)return y.exports;var p=J[f]={exports:{}};return G[f](p,p.exports,c),p.exports}N(c,"__webpack_require__"),c.m=G,c.n=f=>{var y=f&&f.__esModule?()=>f.default:()=>f;return c.d(y,{a:y}),y},c.d=(f,y)=>{for(var p in y)c.o(y,p)&&!c.o(f,p)&&Object.defineProperty(f,p,{enumerable:!0,get:y[p]})},c.f={},c.e=f=>Promise.all(Object.keys(c.f).reduce((y,p)=>(c.f[p](f,y),y),[])),c.u=f=>"prattlenot/vue.js",c.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),c.o=(f,y)=>Object.prototype.hasOwnProperty.call(f,y),(()=>{var f={},y="ffz-addons:";c.l=(p,_,U,v)=>{if(f[p]){f[p].push(_);return}var b,E;if(U!==void 0)for(var S=document.getElementsByTagName("script"),C=0;C<S.length;C++){var A=S[C];if(A.getAttribute("src")==p||A.getAttribute("data-webpack")==y+U){b=A;break}}b||(E=!0,b=document.createElement("script"),b.charset="utf-8",b.timeout=120,c.nc&&b.setAttribute("nonce",c.nc),b.setAttribute("data-webpack",y+U),b.src=p,b.src.indexOf(window.location.origin+"/")!==0&&(b.crossOrigin="anonymous")),f[p]=[_];var P=N((F,j)=>{b.onerror=b.onload=null,clearTimeout(M);var $=f[p];if(delete f[p],b.parentNode&&b.parentNode.removeChild(b),$&&$.forEach(O=>O(j)),F)return F(j)},"onScriptComplete"),M=setTimeout(P.bind(null,void 0,{type:"timeout",target:b}),12e4);b.onerror=P.bind(null,b.onerror),b.onload=P.bind(null,b.onload),E&&document.head.appendChild(b)}})(),c.r=f=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})},(()=>{var f;c.g.importScripts&&(f=c.g.location+"");var y=c.g.document;if(!f&&y&&(y.currentScript&&(f=y.currentScript.src),!f)){var p=y.getElementsByTagName("script");if(p.length)for(var _=p.length-1;_>-1&&!f;)f=p[_--].src}if(!f)throw new Error("Automatic publicPath is not supported in this browser");f=f.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),c.p=f+"../"})(),(()=>{var f={80:0};c.f.j=(_,U)=>{var v=c.o(f,_)?f[_]:void 0;if(v!==0)if(v)U.push(v[2]);else{var b=new Promise((A,P)=>v=f[_]=[A,P]);U.push(v[2]=b);var E=c.p+c.u(_),S=new Error,C=N(A=>{if(c.o(f,_)&&(v=f[_],v!==0&&(f[_]=void 0),v)){var P=A&&(A.type==="load"?"missing":A.type),M=A&&A.target&&A.target.src;S.message="Loading chunk "+_+` failed.
(`+P+": "+M+")",S.name="ChunkLoadError",S.type=P,S.request=M,v[1](S)}},"loadingEnded");c.l(E,C,"chunk-"+_,_)}};var y=N((_,U)=>{var[v,b,E]=U,S,C,A=0;if(v.some(M=>f[M]!==0)){for(S in b)c.o(b,S)&&(c.m[S]=b[S]);if(E)var P=E(c)}for(_&&_(U);A<v.length;A++)C=v[A],c.o(f,C)&&f[C]&&f[C][0](),f[C]=0},"webpackJsonpCallback"),p=globalThis.ffzAddonsWebpackJsonp=globalThis.ffzAddonsWebpackJsonp||[];p.forEach(y.bind(null,0)),p.push=y.bind(null,p.push.bind(p))})();var ft={};(()=>{"use strict";var f={};c.r(f),c.d(f,{badges:()=>$,cheer:()=>F,emote_only:()=>e,repeated_message:()=>O,repeated_words:()=>r,spam:()=>i,splitting:()=>a,unicode:()=>s,uppercase:()=>t});const y=c.p+"prattlenot/styles.css";var p=c(1839),_=c.n(p),U=c(4847),v=c.n(U);const{has:b}=FrankerFaceZ.utilities.object,E=/^\s*$/;let S,C,A,P;try{S=/\p{Lu}/gu,C=/[^\p{Letter}\p{Number}]/gu,A=/([^\p{Number}])\1+/gui,P=/([^\p{Number}]{2,3})\1+/gui}catch{S=/[A-Z]/g,C=/[^0-9a-z ]/g,A=/([^0-9])\1+/gi,P=/([^0-9]{2,3})\1+/gi}function M(g){return g._sanitext?g._sanitext:g._sanitext=g.text.toLowerCase().replace(C,"").replace(A,"$1").replace(P,"$1")}N(M,"saniText");const F={title:"Cheering",i18n:"addon.prattlenot.filter.cheer",about:"This rule matches messages that contain a cheer with at least a minimum amount of bits.",default:()=>({score:-100,critical:!1,min_bits:1}),editor:()=>c.e(738).then(c.bind(c,2729)),createTest(g){const n=g.score??-100,l=g.critical??!1,h=g.min_bits??1;if(!(n==0&&!l))return o=>(o.source.bits??0)>=h&&(o.score+=n,o.reasons&&o.reasons.push("cheer"),l)?!1:o.score<o.threshold}};function j(g){let n=g.badges?Object.keys(g.badges):null;if(!g.ffz_badges)return n;n||(n=[]);for(const l of g.ffz_badges)l?.id&&n.push(l.id);return n}N(j,"getBadgeIDs");const $={title:"Badge",i18n:"addon.prattlenot.filter.badge",about:"This rule matches messages sent by a user with a specific badge.",default:()=>({score:-10,critical:!1,badges:[]}),editor:()=>c.e(738).then(c.bind(c,4592)),createTest(g){const n=g.score??-10,l=g.critical??!1,h=g.badges;if(!(!Array.isArray(h)||!h.length||n==0&&!l))return o=>{let u=!1;const d=j(o.source);if(d!==null){for(const m of h)if(d.includes(m)){u=!0;break}}return u&&(o.score+=n,o.reasons&&o.reasons.push("badge"),l)?!1:o.score<o.threshold}}},O={title:"Repeated Message",i18n:"addon.prattlenot.filter.repeated_message",about:`This rule matches messages that were already seen, using two methods.

First, the message text is sanitized. Then, the MD5 hash of the sanitized text is checked
against a list of existing message hashes. PrattleNot will remember the last "Hash Storage
Size" messages.

Second, assuming the hash doesn't match, the [levenshtein distance](https://en.wikipedia.org/wiki/Levenshtein_distance)
of the message is checked against the previous "Levenshtein Storage Size" messages. If the
distance is within the threshold, the message will be flagged.`,default:()=>({score:100,critical:!1,hash_count:50,leven_count:100,leven_score:.3}),editor:()=>c.e(738).then(c.bind(c,2790)),createTest(g){const n=g.score??100,l=g.critical??!1,h=g.hash_count??50,o=g.leven_count??100,u=g.leven_score??.3,d=h>0,m=o>0&&u<1;if(n==0&&!l||!d&&!m)return;const B=d?[]:null,T=m?[]:null;return L=>{const x=M(L),D=x.length;let Z=!1;if(d){const R=v().hashBinary(x,!0),H=B.indexOf(R);H!==-1?(B.splice(H,1),B.unshift(R),Z=!0):(B.unshift(R),B.length>h&&B.splice(-1,B.length-h))}if(!Z&&m&&D>=35){for(let R=0;R<T.length;R++){const H=T[R];if(_()(x,H)/D<u){Z=!0,T.splice(R,1),T.unshift(x);break}}Z||(T.unshift(x),T.length>o&&T.splice(-1,T.length-o))}return Z&&(L.score+=n,L.reasons&&L.reasons.push("repeated"),l)?!1:L.score<=L.threshold}}};function z(g){let n=-1,l,h=0;for(;(l=g.indexOf(" ",n+1))!==-1;)n+2===l&&h++,n=l;return n!==-1&&n+2===g.length&&h++,h}N(z,"findSingleChars");const a={title:"Too Many Single Characters",i18n:"addon.prattlenot.filter.splitting",about:"This rule matches messages that have too many single characters.",default:()=>({score:10,critical:!1,limit:5}),editor:()=>c.e(738).then(c.bind(c,7144)),createTest(g){const n=g.score??10,l=g.critical??!1,h=g.limit??5;if(!(n==0&&!l))return o=>{const u=o.text;if(!u)return!0;const d=z(Array.from(u));return d>h&&(o.score+=n,o.reasons&&o.reasons.push(`split:${d}`),l)?!1:o.score<=o.threshold}}},r={title:"Repeated Words",i18n:"addon.prattlenot.filter.repeated_words",about:"This rule matches messages that have too many repeated words. The score is adjusted based on the number of repeated words found in the message.",default:()=>({score:3,critical:!1}),editor:()=>c.e(738).then(c.bind(c,5461)),createTest(g){const n=g.score??3,l=g.critical??!1;if(!(n==0&&!l))return h=>{const o=h.text;if(!o)return!0;const u=o.toLowerCase().split(/ +/g),d={};for(let L=0;L<u.length;L++){const x=u[L];x&&(d[x]||(d[x]=[])).push(L)}let m=0;for(const[L,x]of Object.entries(d)){if(x.length>1)for(const D of x)u[D]="";x.length>2&&L.length>2&&(m+=x.length)}const B=u.join(" ").replace(/  +/g," ").trim();let T;return B?B.length>40&&m<10||B.length>100&&m<20||B.length>150&&m<30?T=0:T=n*Math.max(0,m-1):T=n*10,T&&(h.score+=n,h.reasons&&h.reasons.push("rep-words"),l)?!1:h.score<=h.threshold}}},e={title:"Emote Only / Too Many Emotes",i18n:"addon.prattlenot.filter.emote_only",about:"This rule matches messages that only contain emotes, or that contain too many emotes.",default:()=>({score:100,critical:!1,max_emotes:5}),editor:()=>c.e(738).then(c.bind(c,6720)),createTest(g){const n=g.max_emotes??5,l=g.score??100,h=g.critical??!1;if(!(l==0&&!h))return o=>{let u=0,d=0;for(const m of o.tokens)m.type==="emote"||m.type==="emoji"?u++:(!m.text||!E.test(m.text))&&d++;return(u>n||!d)&&(o.score+=l,o.reasons&&o.reasons.push(`emotes:${u}-${d}`),h)?!1:o.score<=o.threshold}}},t={title:"Too Much Uppercase",i18n:"addon.prattlenot.uppercase",about:"This rule matches messages that contain too many uppercase characters compared to other characters.",default:()=>({score:10,critical:!1,threshold:.3}),editor:()=>c.e(738).then(c.bind(c,836)),createTest(g){const n=g.threshold||.3,l=g.score??10,h=g.critical??!1;if(!(l==0&&!h||!n))return o=>{const u=o.text;if(u.length>3){const d=u.match(S),m=d?d.length/u.length:0;if(m>n&&(o.score+=l,o.reasons&&o.reasons.push(`uppercase:${Math.round(m*100)}`),h))return!1}return o.score<=o.threshold}}},i={title:"Spammy",i18n:"addon.prattlenot.filter.spam",about:"This filter matches short messages with few words.",default:()=>({score:20,critical:!1}),editor:()=>c.e(738).then(c.bind(c,5461)),createTest(g){const n=g.score??20,l=g.critical??!1;if(!(n==0&&!l))return h=>{const o=h.text;if(!o)return!0;let u=!1;if(o.length<3)u=!0;else{const d=o.replace(P,"$1");if(/([^ ]{3,} [^ ]{3,} [^ ]{3,})/i.test(d))return!0;const m=d.length<15?!1:d.match(/ /g);(!m||m.length<3)&&(u=!0)}return u&&(h.score+=n,h.reasons&&h.reasons.push("spam"),l)?!1:h.score<=h.threshold}}},s={title:"Too Much Unicode",i18n:"addon.prattlenot.filter.unicode",about:"This filter matches messages that contain too many non-matching unicode characters compared to matching characters.",default:()=>({score:3,critical:!1,threshold:.3,terms:[{t:"cat",v:"Letter"},{t:"cat",v:"Number"},{t:"cat",v:"Punctuation"},{t:"cat",v:"Separator"}]}),editor:()=>c.e(738).then(c.bind(c,7728)),default_terms:[{t:"cat",v:"Letter"},{t:"cat",v:"Number"},{t:"cat",v:"Punctuation"},{t:"cat",v:"Separator"}],createTest(g){const n=g.threshold||.3,l=g.score??3,h=g.terms??s.default_terms,o=g.critical??!1;if(l==0&&!o||!n||!Array.isArray(h)||!h.length)return;const u=[];for(const m of h)m.t==="cat"?u.push(`\\p{${m.v}}`):m.t==="script"?u.push(`\\p{Script=${m.v}}`):m.t==="scr-ext"?u.push(`\\p{Script_Extension=${m.v}}`):m.t==="raw"&&u.push(m.v);if(!u.length)return;let d;try{d=new RegExp(`[^${u.join("")}]`,"gu")}catch{return}return m=>{const B=m.text;if(!B)return!0;const T=(B.match(d)||[]).length,L=T/B.length;return L>n&&(m.score+=l*T,m.reasons&&m.reasons.push(`unicode:${Math.round(L*100)}`),o)?!1:m.score<=m.threshold}}},{createElement:w,on:k,off:I}=FrankerFaceZ.utilities.dom,{createTester:X}=FrankerFaceZ.utilities.filtering,{RERENDER_SETTINGS:nt}=FrankerFaceZ.utilities.constants,at=["cheer","emote","emoji"],ot=["resub","sub_gift","sub_mystery"],rt=["pn.show-reason","pn.show-badges","pn.timestamps"],Q=class Q extends FrankerFaceZ.utilities.addon.Addon{constructor(...n){super(...n),this.inject("chat"),this.inject("chat.overrides"),this.inject("settings"),this.inject("i18n"),this.injectAs("site_chat","site.chat"),this.inject("site.fine"),this.ChatScroller=this.fine.define("chat-scroller"),this.prattle=[],this.pending=[],this.scrollback_limit=20,this.updating=!0,this.onMouseMove=this.onMouseMove.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.performUpdate=this.performUpdate.bind(this),this.onClickUndelete=this.onClickUndelete.bind(this)}addNotice(n){this.addPrattle({type:this.site_chat?.chat_types?.Notice??31,message:n})}rebuildTester(){const n=this.chat.context.get("pn.rules");if(!n||!n.length){this.tester=null;return}this.tester=X(n,this.parent.rules)}onEnable(){this.on("chat:receive-message",this.handleMessage,this),this.on("chat:mod-user",this.handleMod,this),this.on("chat:clear-chat",this.handleClear,this),this.on("site.router:route",this.handleNavigate,this),this.on("i18n:update",this.updateTranslation,this),this.rebuildTester(),this.updateConstants(),this.chat.context.on("changed:pn.rules",this.rebuildTester,this),this.chat.context.on("changed:pn.scrollback",this.updateConstants,this),this.chat.context.on("changed:chat.scroller.hover-delay",this.updateConstants,this),this.chat.context.on("changed:pn.background",this.updateContainer,this),this.chat.context.on("changed:pn.active-position",this.updateContainer,this),this.chat.context.on("changed:pn.active-size",this.updateContainer,this),this.chat.context.on("changed:pn.shared-chat.style",this.rerenderLines,this);for(const n of rt)this.chat.context.on(`changed:${n}`,this.rerenderLines,this);for(const n of nt)this.chat.context.on(`changed:${n}`,this.rerenderLines,this);this.ChatScroller.ready((n,l)=>{for(const h of l)this.checkContainer(h)}),this.ChatScroller.on("mount",this.checkContainer,this),this.ChatScroller.on("update",this.checkContainer,this),this.handleNavigate()}updateConstants(){this.scrollback_limit=this.chat.context.get("pn.scrollback"),this.pause_delay=this.chat.context.get("chat.scroller.hover-delay")}onDisable(){for(const n of nt)this.chat.context.off(`changed:${n}`,this.rerenderLines,this);for(const n of rt)this.chat.context.off(`changed:${n}`,this.rerenderLines,this);this.chat.context.off("changed:pn.rules",this.rebuildTester,this),this.chat.context.off("changed:pn.scrollback",this.updateConstants,this),this.chat.context.off("changed:chat.scroller.hover-delay",this.updateConstants,this),this.chat.context.off("changed:pn.active-position",this.updateContainer,this),this.chat.context.off("changed:pn.active-size",this.updateContainer,this),this.chat.context.off("changed:pn.background",this.updateContainer,this),this.removeContainer(),this.clearUnpauseTimer(),this._outside_timer&&(clearTimeout(this._outside_timer),this._outside_timer=null),this.off("chat:receive-message",this.handleMessage,this),this.off("chat:mod-user",this.handleMod,this),this.off("chat:clear-chat",this.handleClear,this),this.off("site.router:route",this.handleNavigate,this),this.off("i18n:update",this.updateTranslation,this),this.ChatScroller.off("mount",this.checkContainer,this),this.ChatScroller.off("update",this.checkContainer,this)}rerenderLines(){if(this.cont)for(const n of this.prattle)n.prattle_line&&this.renderLine(n)}updateTranslation(){this.pause_cont!=null&&(this.pause_cont.textContent=this.i18n.t("addon.prattlenot.mouse-pause","Prattle Paused Due to Mouse"))}getContainer(){if(!this.container){this.container=w("div",{class:"ffz-pn--list chat-list--other font-scale--default","data-simplebar":!0},this.cont=w("div",{role:"log"}),w("div",{class:"ffz-pn--pause-notice"},this.pause_cont=w("div",null,this.i18n.t("addon.prattlenot.mouse-pause","Prattle Paused Due to Mouse")))),k(this.container,"mousemove",this.onMouseMove),k(this.container,"mouseleave",this.onMouseLeave);for(const n of this.prattle){const l=this.renderLine(n);l&&this.cont.appendChild(l)}}return this.container}removeContainer(){if(!this.container)return;const n=this.container.parentElement;n&&(n.classList.remove("ffz-pn--container"),n.classList.remove("ffz-pn--horizontal")),this.container.remove();for(const l of this.prattle)l.prattle_line=null;I(this.container,"mousemove",this.onMouseMove),I(this.container,"mouseleave",this.onMouseLeave),this.container=this.cont=this.pause_cont=null}updateContainer(){for(const n of this.ChatScroller.instances)this.checkContainer(n)}checkContainer(n){let l=this.fine.getChildNode(n);if(l.parentElement&&l.parentElement.matches('[class*="chat-list"]')&&(l=l.parentElement),!l)return;const h=this.chat.context.get("pn.active-size");if(h<=0){this.removeContainer();return}const o=this.getContainer();if(!o)return;const u=this.chat.context.get("pn.active-position"),d=this.chat.context.get("pn.background");l.classList.add("ffz-pn--container"),l.classList.toggle("ffz-pn--horizontal",u===2||u===3),l.classList.toggle("ffz-pn--exclusive",h>=100),h>=100?o.style="--ffz-pn-size: 100%;":o.style=`--ffz-pn-size: ${h}%;`,d&&(o.style.backgroundColor=d),o.classList.toggle("ffz-pn--top",u===0),o.classList.toggle("ffz-pn--bottom",u===1),o.classList.toggle("ffz-pn--left",u===2),o.classList.toggle("ffz-pn--right",u===3),l.contains(o)||l.insertBefore(o,l.firstElementChild),this.scroller=n}onMouseMove(){this._last_move=Date.now(),this._outside=!1,this._outside_timer&&(clearTimeout(this._outside_timer),this._outside_timer=null),this.updating&&this.shouldBePaused()&&(this.pauseScrolling(),this.setUnpauseTimer())}clearUnpauseTimer(){this._unpause_timer&&(clearInterval(this._unpause_timer),this._unpause_timer=null)}setUnpauseTimer(){this._unpause_timer||(this._unpause_timer=setInterval(()=>{!this.updating&&!this.shouldBePaused()&&this.unpauseScrolling()},50))}onMouseLeave(){this._outside=!0,this._outside_timer&&clearTimeout(this._outside_timer),this._outside_timer=setTimeout(()=>this.maybeUnpause(),64)}shouldBePaused(){return this._outside?!1:Date.now()-this._last_move<this.pause_delay}maybeUnpause(){this.shouldBePaused()||this.unpauseScrolling()}updatePauseEl(){this._pause_raf||(this._pause_raf=requestAnimationFrame(()=>{this._pause_raf=null,this.container.classList.toggle("ffz-pn--paused",!this.updating)}))}pauseScrolling(){this.updating&&(this.updating=!1,this.updatePauseEl())}unpauseScrolling(){this.updating||(this.updating=!0,this.updatePauseEl(),this.scheduleUpdate())}handleMod(n,l,h){const o=n===this.site_chat.mod_types.Delete&&h!=null;let u=this.prattle.length;for(;u--;){const d=this.prattle[u];if(!(!d.user||d.user.login!==l||d.deleted||o&&d.id!==h)&&(d.deleted=!0,d.prattle_line)){const m=d.prattle_line.querySelector(".message");m?m.textContent=this.i18n.t("chat.message-deleted","<message deleted>"):this.renderLine(d)}}for(u=this.pending.length;u--;){const d=this.pending[u];d.user.login!==l||d.deleted||o&&d.id!==h||(d.deleted=!0)}}handleNavigate(){this.pending=[],this.prattle=[],this.cont&&(this.cont.innerHTML=""),this.addNotice(this.i18n.t("addon.pn.welcome","Welcome to the field of prattle."))}handleClear(){this.pending=[],this.prattle=[],this.cont&&(this.cont.innerHTML=""),this.addNotice(this.i18n.t("addon.pn.cleared","Chat was cleared"))}addPrattle(n){this.pending.push(n),this.pending.length>this.scrollback_limit&&this.pending.splice(0,this.pending.length-this.scrollback_limit),this.scheduleUpdate()}renderSharedChatPill(n){let l=this.chat.context.get("pn.shared-chat.style")??0;if(!l)return null;const h=n.sourceRoomID,o=h&&this.site_chat.shared_room_data?.get?.(h);if(!o)return null;const u=h===n.roomId,d=this.i18n.t("chat.sent-from-source","Sent from {source}",{source:o.displayName??o.login});return l===1?w("span",{class:`ffz-pill ffz-tooltip tw-mg-r-05 ${u?"ffz-pill--brand":""}`,"data-title":d},o.displayName??o.login):l===2?w("figure",{class:`ffz-tooltip ffz-tooltip--no-mouse ffz-shared-chat-badge ffz-avatar tw-border-radius-rounded ${u?"ffz-shared-chat-badge--active":""} tw-mg-r-05`,"data-title":this.i18n.t("chat.sent-from-source","Sent from {source}",{source:o.displayName})},w("img",{class:"tw-block tw-border-radius-rounded tw-image",src:o.profileImageURL,alt:o.displayName})):null}renderLine(n){let l,h=n.roomLogin?n.roomLogin:n.channel?n.channel.slice(1):void 0,o=n.roomId;if(!h&&o){const T=this.chat.getRoom(o,null,!0);T&&T.login&&(h=n.roomLogin=T.login)}else if(!o&&h){const T=this.chat.getRoom(null,h,!0);T&&T.id&&(o=n.roomId=T.id)}const u=n.sourceRoomID,d=u&&this.site_chat.shared_room_data?.get?.(u),m=!d||u===o,B=m?{id:o,login:h}:{id:u,login:d?.login};if(n.type&&n.type===this.site_chat.chat_types?.Notice)l=w("div",{class:"chat-line__status","data-room":h,"data-room-id":o},n.message);else{const T=n.messageType===this.site_chat.message_types?.Action,L=T?this.chat.context.get("chat.me-style"):0,x=L>=2,D=L===1||L===3,Z=this.overrides.getColor(n.user.id)||n.user.color,R=this.site_chat.colors.process(Z),H=n.mentioned&&n.mention_color?this.site_chat.inverse_colors.process(n.mention_color):null,tt=this.chat.formatUser(n.user,w),et=this.overrides.getName(n.user.id),ct=this.chat.context.get("pn.show-reason");let st=null;ct&&n.prattle_reasons&&(st=`[${n.prattle_score}=${n.prattle_reasons.join(", ")}]`);const ut=st?w("span",{class:"pn--reasons tw-pd-l-05 tw-c-text-alt-2"},st):null;let W=n.ffz_user_class;W instanceof Set?W=[...W].join(" "):Array.isArray(W)&&(W=W.join(" "));const it={className:`chat-line__username notranslate${et?" ffz--name-override tw-relative ffz-il-tooltip__container":""} ${W??""}`,role:"button",style:{color:R}};n.ffz_user_props&&Object.assign(it,n.ffz_user_props),n.ffz_user_style&&Object.assign(it.style,n.ffz_user_style),l=w("div",{class:`chat-line__message${n.deleted?" ffz--deleted-message":""}${n.mentioned?" ffz-mentioned":""}${H?" ffz-custom-color":""}`,"data-room":B.login,"data-room-id":B.id,"data-user":n.user.login,"data-user-id":n.user.id,style:{backgroundColor:H}},d?this.renderSharedChatPill(n):null,this.chat.context.get("pn.timestamps")?w("span",{class:"chat-line__timestamp"},this.chat.formatTime(n.timestamp)):null,this.chat.context.get("pn.show-badges")?w("span",{class:"chat-line__message--badges"},this.chat.badges.render(n,w)):null,w("span",it,et?[w("span",{class:"chat-author__display_name"},et),w("div",{class:"ffz-il-tooltip ffz-il-tooldip--down ffz-il-tooltip--align-center"},tt)]:tt),w("span",{"aria-hidden":"true"},T&&!x?" ":": "),w("span",{class:`message ${x?"chat-line__message-body--italicized":""}`,style:D?{color:R}:null},n.deleted?w("a",{href:"",onClick:this.onClickUndelete},this.i18n.t("chat.message-deleted","<message deleted>")):this.chat.renderTokens(n.ffz_tokens,w)),ut)}return l&&(l.message=n,n.prattle_line&&n.prattle_line.replaceWith(l),n.prattle_line=l),l}onClickUndelete(n){n.preventDefault();const l=n.target.closest(".chat-line__message"),h=l?.message;return h&&(h.deleted=!1,this.renderLine(h)),!1}scheduleUpdate(){this.updating&&!this._update_raf&&(this._update_raf=requestAnimationFrame(this.performUpdate))}performUpdate(){if(this._update_raf=null,!this.updating)return;const n=this.pending;this.pending=[];const l=this.cont?.parentElement?.parentElement;for(const h of n)if(!(h.deleted||h.ffz_removed)){if(this.cont){const o=this.renderLine(h);o&&this.cont.appendChild(o)}this.prattle.push(h)}this.trimPrattle(),l&&(l.scrollTop=l.scrollHeight)}trimPrattle(){let n=Math.max(0,this.prattle.length-this.scrollback_limit);for(n%2&&n--;n;){const l=this.prattle.shift();l.prattle_line&&(l.prattle_line.remove(),l.prattle_line=null),n--}}handleMessage(n){if(!n.message||!this.tester||n.defaultPrevented)return;const l=n.message;if(l.ffz_removed||l.deleted||!l.ffz_tokens)return;const h=l.ffz_type;if(h&&ot.includes(h))return;const o=this.settings.get("pn.threshold")??0,u=this.settings.get("pn.show-reason"),d={source:l,msg:l.message,tokens:l.ffz_tokens,score:0,threshold:o};u&&(d.reasons=[]),Object.defineProperty(d,"text",{get(){if(d._text)return d._text;const B=[],T=d.tokens,L=T.length;for(let x=0;x<L;x++){const D=T[x];D.text&&!at.includes(D.type)&&B.push(D.text)}return d._text=B.join("").trim()}});const m=this.tester(d);d.score>o&&(l.prattle_reasons=d.reasons,l.prattle_score=d.score,this.addPrattle(l),n.preventDefault())}};N(Q,"Logic");let Y=Q;const{createElement:q,on:pt,off:gt}=FrankerFaceZ.utilities.dom,{has:lt,deep_copy:ht}=FrankerFaceZ.utilities.object,{Color:mt}=FrankerFaceZ.utilities.color,V=class V extends FrankerFaceZ.utilities.addon.Addon{constructor(...n){super(...n),this.toggleEnabled=this.toggleEnabled.bind(this),this.inject("chat"),this.inject("settings"),this.inject("i18n"),this.inject("site.fine"),this.register("logic",Y,!0);const l=[{value:0,i18n_key:"pn.position.top",title:"Top"},{value:1,i18n_key:"pn.position.bottom",title:"Bottom"},{value:2,i18n_key:"pn.position.left",title:"Left"},{value:3,i18n_key:"pn.position.right",title:"Right"}],h=[];for(let o=0;o<=100;o+=5)h.push({value:o,i18n_key:"pn.size.entry",title:"{value,number}%"});this.settings.add("pn.enabled",{default:!1,ui:{path:"Add-Ons > PrattleNot >> Behavior",title:"Enable by Default",description:"When this is enabled, PrattleNot will be enabled by default. Otherwise, you will need to manually enable it as desired.",component:"setting-check-box"}}),this.settings.add("pn.shared-chat.style",{default:-1,requires:["chat.shared-chat.style"],process(o,u){return u===-1?o.get("chat.shared-chat.style"):u},ui:{path:"Add-Ons > PrattleNot >> Appearance",title:"Shared Chat: Pill Style",component:"setting-select-box",description:"This controls the appearance of the pill at the left-side of chat messages when a message is part of a Shared Chat. By default, this is Avatar for moderators and broadcasters and Hidden for everyone else.",data:[{value:-1,title:"Same as Normal Chat"},{value:null,title:"Automatic"},{value:0,title:"Hidden"},{value:1,title:"Channel Name"},{value:2,title:"Avatar"}]}}),this.settings.add("pn.scrollback",{default:20,ui:{path:"Add-Ons > PrattleNot >> Behavior",title:"Scrollback Length",description:"Keep up to this many lines in Prattle. Setting this too high will create lag.",component:"setting-text-box",process:"to_int",bounds:[1]}}),this.settings.add("pn.position",{default:0,ui:{path:"Add-Ons > PrattleNot >> Position",title:"Position",component:"setting-select-box",data:l}}),this.settings.add("pn.size",{default:30,ui:{path:"Add-Ons > PrattleNot >> Position",title:"Size",component:"setting-select-box",data:h}}),this.settings.add("pn.portrait-position",{default:2,ui:{path:"Add-Ons > PrattleNot >> Position (Portrait Mode)",title:"Position",component:"setting-select-box",data:l}}),this.settings.add("pn.portrait-size",{default:30,ui:{path:"Add-Ons > PrattleNot >> Position (Portrait Mode)",title:"Size",component:"setting-select-box",data:h}}),this.settings.add("pn.active-size",{requires:["layout.use-portrait","pn.portrait-size","pn.size"],process(o){return o.get("layout.use-portrait")?o.get("pn.portrait-size"):o.get("pn.size")}}),this.settings.add("pn.active-position",{requires:["layout.use-portrait","pn.portrait-position","pn.position"],process(o){return o.get("layout.use-portrait")?o.get("pn.portrait-position"):o.get("pn.position")}}),this.settings.add("pn.background",{default:null,ui:{path:"Add-Ons > PrattleNot >> Appearance",title:"Background Color",description:"An optional, simple background color to use for the prattle log to better differentiate it from normal chat.",component:"setting-color-box"}}),this.settings.add("pn.show-reason",{default:!1,ui:{path:"Add-Ons > PrattleNot >> Appearance",title:"Show Matching Filters",description:"When this is enabled, the rules that match a given chat message are logged and displayed to help you tweak your rules.",component:"setting-check-box"}}),this.settings.add("pn.show-badges",{default:!0,ui:{path:"Add-Ons > PrattleNot >> Appearance",title:"Show Badges",component:"setting-check-box"}}),this.settings.add("pn.timestamps",{default:null,requires:["context.chat.showTimestamps"],process(o,u){return u===null?o.get("context.chat.showTimestamps"):u},ui:{path:"Add-Ons > PrattleNot >> Appearance",title:"Show Timestamps",component:"setting-check-box"}}),this.settings.add("pn.threshold",{default:1,ui:{path:"Add-Ons > PrattleNot >> Behavior",title:"Threshold",description:"A score higher than this value will cause a message to be flagged.",component:"setting-text-box",process:"to_int"}}),this.settings.add("pn.rules",{default:[{v:{type:"badges",data:{critical:!0,score:-100,badges:["broadcaster","moderator","admin","vip","extension","twitchbot","global_mod"]}}},{v:{type:"cheer",data:{critical:!1,score:-100,min_bits:1}}},{v:{type:"emote_only",data:{score:100,critical:!1,max_emotes:5}}},{v:{type:"uppercase",data:{score:10,critical:!1,threshold:.3}}},{v:{type:"spam",data:{score:20,critical:!1}}},{v:{type:"unicode",data:{score:3,critical:!1,threshold:.3,terms:[{t:"cat",v:"Letter"},{t:"cat",v:"Number"},{t:"cat",v:"Punctuation"},{t:"cat",v:"Separator"}]}}},{v:{type:"splitting",data:{score:10,critical:!1,limit:5}}},{v:{type:"repeated_message",data:{score:100,critical:!1,hash_count:50,leven_count:100,leven_score:.3}}},{v:{type:"repeated_words",data:{score:3,critical:!1}}}],type:"array_merge",inherit_default:!0,ui:{path:'Add-Ons > PrattleNot >> Rules @{"description": "Rules allow you to define a series of conditions under which PrattleNot will flag a message as prattle, or spam, and display it separately from more valuable chat messages."}',component:"setting-filter-editor",data:()=>ht(this.rules),test_context:()=>({source:{bits:0,badges:{},text:"This is a test."}})}}),this.rules={};for(const o in f)lt(f,o)&&(this.rules[o]=f[o]);this.set_enabled=null,this.ChatInput=this.fine.define("chat-input"),this.logic.on(":enabled",this.updateButtons,this),this.logic.on(":disabled",this.updateButtons,this)}onEnable(){this.style_link||document.head.appendChild(this.style_link=q("link",{href:y,rel:"stylesheet",type:"text/css",crossOrigin:"anonymous"})),this.chat.context.on("changed:pn.enabled",this.checkEnabled,this),this.checkEnabled(),this.ChatInput.on("mount",this.updateButton,this),this.ChatInput.on("update",this.updateButton,this),this.updateButtons()}async onDisable(){await this.logic.disable(),this.style_link&&(this.style_link.remove(),this.style_link=null);for(const n of this.ChatInput.instances)this.removeButton(n);this.ChatInput.off("mount",this.updateButton,this),this.ChatInput.off("update",this.updateButton,this)}checkEnabled(){const n=this.set_enabled??this.chat.context.get("pn.enabled");n&&!this.logic.enabled?this.logic.enable():!n&&this.logic.enabled&&this.logic.disable()}updateButtons(){if(this.ChatInput&&(this.enabling||this.enabled))for(const n of this.ChatInput.instances)this.updateButton(n)}toggleEnabled(){this.set_enabled=!this.logic.enabled,this.checkEnabled()}updateButton(n){const l=this.fine.getHostNode(n);if(l){if(n._ffz_pn_button||(n._ffz_pn_button=q("div",{class:"tw-relative ffz-il-tooltip__container"},q("button",{class:"tw-border-radius-medium tw-button-icon--primary ffz-core-button tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative tw-button-icon",onclick:this.toggleEnabled},q("span",{class:"tw-button-icon__icon"},n._ffz_pn_icon=q("figure",{class:"ffz-i-zreknarf"}))),q("div",{class:"ffz-il-tooltip ffz-il-tooltip--up ffz-il-tooltip--align-right"},this.i18n.t("addon.pn.button.title","Toggle PrattleNot"),n._ffz_pn_enabled_tip=q("div",null)))),!l.contains(n._ffz_pn_button)){const h=l.querySelector(".chat-input__buttons-container > div:last-child");h&&h.insertBefore(n._ffz_pn_button,h.firstChild)}n._ffz_pn_icon.className=this.logic.enabled?"ffz-i-chat":"ffz-i-chat-empty",n._ffz_pn_enabled_tip.classList.toggle("tw-mg-t-1",this.logic.enabled),n._ffz_pn_enabled_tip.textContent=this.logic.enabled?this.i18n.t("addon.pn.button.enabled","PrattleNot is currently enabled. Click to disable."):null}}removeButton(n){n._ffz_pn_button&&(n._ffz_pn_button.remove(),n._ffz_pn_button=null,n._ffz_pn_enabled_tip=null)}};N(V,"PrattleNot");let K=V;K.register("prattlenot",null,"0.10.0")})()})();})();

//# sourceMappingURL=script.js.map