(()=>{var L=Object.defineProperty;var f=(B,C)=>L(B,"name",{value:C,configurable:!0});(()=>{var B={2320:l=>{var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"MassTermBlockerTool_BlockTerms"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AddChannelBlockedTermInput"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addChannelBlockedTerm"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"phrases"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:121}};a.loc.source={body:"mutation MassTermBlockerTool_BlockTerms($input:AddChannelBlockedTermInput!){addChannelBlockedTerm(input:$input){phrases}}",name:"GraphQL request",locationOffset:{line:1,column:1}};var m={};function k(o){return o.filter(function(s){if(s.kind!=="FragmentDefinition")return!0;var e=s.name.value;return m[e]?!1:(m[e]=!0,!0)})}f(k,"unique");function p(o,s){if(o.kind==="FragmentSpread")s.add(o.name.value);else if(o.kind==="VariableDefinition"){var e=o.type;e.kind==="NamedType"&&s.add(e.name.value)}o.selectionSet&&o.selectionSet.selections.forEach(function(r){p(r,s)}),o.variableDefinitions&&o.variableDefinitions.forEach(function(r){p(r,s)}),o.definitions&&o.definitions.forEach(function(r){p(r,s)})}f(p,"collectFragmentReferences");var v={};f(function(){a.definitions.forEach(function(s){if(s.name){var e=new Set;p(s,e),v[s.name.value]=e}})},"extractReferences")();function y(o,s){for(var e=0;e<o.definitions.length;e++){var r=o.definitions[e];if(r.name&&r.name.value==s)return r}}f(y,"findOperation");function g(o,s){var e={kind:o.kind,definitions:[y(o,s)]};o.hasOwnProperty("loc")&&(e.loc=o.loc);var r=v[s]||new Set,n=new Set,b=new Set;for(r.forEach(function(h){b.add(h)});b.size>0;){var x=b;b=new Set,x.forEach(function(h){if(!n.has(h)){n.add(h);var i=v[h]||new Set;i.forEach(function(z){b.add(z)})}})}return n.forEach(function(h){var i=y(o,h);i&&e.definitions.push(i)}),e}f(g,"oneQuery"),l.exports=a,l.exports.MassTermBlockerTool_BlockTerms=g(a,"MassTermBlockerTool_BlockTerms")},6214:l=>{var a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"MassBanTool_GetRecentFollowers"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"login"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"first"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"login"},value:{kind:"Variable",name:{kind:"Name",value:"login"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"followers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"Variable",name:{kind:"Name",value:"first"}}},{kind:"Argument",name:{kind:"Name",value:"order"},value:{kind:"EnumValue",value:"DESC"}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]}]}}]}}]}}]}}]}}],loc:{start:0,end:145}};a.loc.source={body:"query MassBanTool_GetRecentFollowers($login:String!$first:Int!){user(login:$login){followers(first:$first order:DESC){edges{node{displayName}}}}}",name:"GraphQL request",locationOffset:{line:1,column:1}};var m={};function k(o){return o.filter(function(s){if(s.kind!=="FragmentDefinition")return!0;var e=s.name.value;return m[e]?!1:(m[e]=!0,!0)})}f(k,"unique");function p(o,s){if(o.kind==="FragmentSpread")s.add(o.name.value);else if(o.kind==="VariableDefinition"){var e=o.type;e.kind==="NamedType"&&s.add(e.name.value)}o.selectionSet&&o.selectionSet.selections.forEach(function(r){p(r,s)}),o.variableDefinitions&&o.variableDefinitions.forEach(function(r){p(r,s)}),o.definitions&&o.definitions.forEach(function(r){p(r,s)})}f(p,"collectFragmentReferences");var v={};f(function(){a.definitions.forEach(function(s){if(s.name){var e=new Set;p(s,e),v[s.name.value]=e}})},"extractReferences")();function y(o,s){for(var e=0;e<o.definitions.length;e++){var r=o.definitions[e];if(r.name&&r.name.value==s)return r}}f(y,"findOperation");function g(o,s){var e={kind:o.kind,definitions:[y(o,s)]};o.hasOwnProperty("loc")&&(e.loc=o.loc);var r=v[s]||new Set,n=new Set,b=new Set;for(r.forEach(function(h){b.add(h)});b.size>0;){var x=b;b=new Set,x.forEach(function(h){if(!n.has(h)){n.add(h);var i=v[h]||new Set;i.forEach(function(z){b.add(z)})}})}return n.forEach(function(h){var i=y(o,h);i&&e.definitions.push(i)}),e}f(g,"oneQuery"),l.exports=a,l.exports.MassBanTool_GetRecentFollowers=g(a,"MassBanTool_GetRecentFollowers")}},C={};function d(l){var a=C[l];if(a!==void 0)return a.exports;var m=C[l]={exports:{}};return B[l](m,m.exports,d),m.exports}f(d,"__webpack_require__"),d.n=l=>{var a=l&&l.__esModule?()=>l.default:()=>l;return d.d(a,{a}),a},d.d=(l,a)=>{for(var m in a)d.o(a,m)&&!d.o(l,m)&&Object.defineProperty(l,m,{enumerable:!0,get:a[m]})},d.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),d.o=(l,a)=>Object.prototype.hasOwnProperty.call(l,a),(()=>{var l;d.g.importScripts&&(l=d.g.location+"");var a=d.g.document;if(!l&&a&&(a.currentScript&&(l=a.currentScript.src),!l)){var m=a.getElementsByTagName("script");if(m.length)for(var k=m.length-1;k>-1&&!l;)l=m[k--].src}if(!l)throw new Error("Automatic publicPath is not supported in this browser");l=l.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),d.p=l+"../"})();var U={};(()=>{"use strict";const l=d.p+"mass-ban-tool/style.css",a="tw-pd-x-1 tw-pd-y-05 tw-mg-y-05 tw-mg-r-05 tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-button",{createElement:m}=FrankerFaceZ.utilities.dom,k=m("button",{type:"button",class:a+" ffz-mmu-file-upload"},m("span",{class:"tw-button__icon tw-button__icon--left ffz-i-upload"}),m("span",{class:"tw-button__text"},"Select File")),{openFile:p}=FrankerFaceZ.utilities.dom;async function v(S,t){const c=await p("text/plain",!1);c.type==="text/plain"&&c.text().then(u=>{const w=u.replace(/\r\n/gm,`
`).match(/^.*$/gm);for(const T of w)y(S,t,T)})}f(v,"openFileSelector");function y(S,t,c){t.entriesListTextArea.value[0]!==t.entriesListTextArea.value[t.entriesListTextArea.value.length-1]&&t.entriesListTextArea.value[t.entriesListTextArea.value.length-1]!==`
`&&(t.entriesListTextArea.value+=`
`),t.entriesListTextArea.value+=c.trim(),t.entriesListTextArea.value[t.entriesListTextArea.value.length-1]!==`
`&&(t.entriesListTextArea.value+=`
`),t.entriesListTextArea.scrollTop=t.entriesListTextArea.scrollHeight,g(S,t)}f(y,"addEntryToList");function g(S,t){S.modal.querySelector(`#ffz-mmu-mass-${t.toolName}-tool-entry-count`).textContent=t.entriesListTextArea.value.trim().split(/[\r\n|\r|\n]/).filter(Boolean).length}f(g,"updateEntryCount");var o=d(6214),s=d.n(o);const{createElement:e}=FrankerFaceZ.utilities.dom,F=class F{constructor(t){this.MMU=t,this.toolName="ban"}buildToolContent(){const t=k.cloneNode(!0),c={five:e("button",{type:"button",class:a+" ffz-mmu-mass-ban-tool-5-followers-import",onClick:()=>this.importRecentFollowers(5)},e("span",{class:"tw-button__text"},"5")),ten:e("button",{type:"button",class:a+" ffz-mmu-mass-ban-tool-10-followers-import",onClick:()=>this.importRecentFollowers(10)},e("span",{class:"tw-button__text"},"10")),twentyFive:e("button",{type:"button",class:a+" ffz-mmu-mass-ban-tool-25-followers-import",onClick:()=>this.importRecentFollowers(25)},e("span",{class:"tw-button__text"},"25")),oneHundred:e("button",{type:"button",class:a+" ffz-mmu-mass-ban-tool-100-followers-import",onClick:()=>this.importRecentFollowers(100)},e("span",{class:"tw-button__text"},"100")),custom:e("span",{class:"tw-border-l tw-mg-l-1 tw-pd-l-1"},e("input",{type:"number",id:"ffz-mmu-mass-ban-tool-followers-import-custom-amount",name:"ffz-mmu-mass-ban-tool-followers-import-custom-amount",class:"tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 tw-mg-05 ffz-input ffz-mmu-mass-ban-tool-followers-import-custom-amount",min:"1",max:"100",placeholder:"Custom",onKeyUp:u=>{if(u.key==="Enter"){const w=parseInt(document.getElementById("ffz-mmu-mass-ban-tool-followers-import-custom-amount").value);isNaN(w)||this.importCustomFollowersAmount(w)}}}),e("button",{type:"button",id:"ffz-mmu-mass-ban-tool-custom-followers-import",class:a+" ffz-mmu-mass-ban-tool-custom-followers-import",onClick:()=>this.importCustomFollowersAmount(parseInt(document.getElementById("ffz-mmu-mass-ban-tool-followers-import-custom-amount").value))},e("span",{class:"tw-button__text"},"Import")))};this.toolContent=e("div",{id:"ffz-mmu-mass-ban-tool",class:"ffz--menu-page","data-mmu-tool-name":"ban"},e("div",{class:"tw-mg-y-05"},e("div",{class:"ffz--widget ffz--text-box default"},e("div",{class:"tw-flex tw-align-items-center"},e("label",{for:"ffz-mmu-mass-ban-tool-entries-list"},"Users List",e("br",null),e("span",{class:"ffz-mmu-entry-count-label"},"(Current User Count: ",e("span",{id:"ffz-mmu-mass-ban-tool-entry-count",class:"ffz-mmu-mass-ban-tool-entry-count ffz-mmu-entry-count"},"0"),")")),e("textarea",{id:"ffz-mmu-mass-ban-tool-entries-list",class:"tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 tw-mg-05 ffz-input ffz-mmu-mass-ban-tool-entries-list ffz-mmu-entries-list",placeholder:`Username1
Username2
Username3
Etc.`,rows:"10",onKeyUp:()=>g(this.MMU,this)})),e("section",{class:"tw-c-text-alt-2"},e("div",null,e("p",null,"The list of users you wish to action. List one username per line."))))),e("div",{class:"tw-mg-y-05"},e("div",{class:"ffz--widget ffz--select-box"},e("div",{class:"tw-flex tw-align-items-start ffz-mmu-mass-ban-tool-upload-field"},e("label",{class:"tw-mg-y-05",for:"ffz-mmu-mass-ban-tool-upload-file"},"Upload Users List File")),e("section",{class:"tw-c-text-alt-2"},e("div",null,e("p",null,"Optionally you can upload a ",e("code",null,".txt")," file here to populate the Users List. Make sure your list consists of one username per line."))))),e("div",{class:"tw-mg-y-05"},e("div",{class:"ffz--widget ffz--select-box"},e("div",{id:"ffz-mmu-mass-ban-tool-recent-followers-field",class:"tw-flex tw-align-items-start ffz-mmu-mass-ban-tool-recent-followers-field"},e("label",{class:"tw-mg-y-05",for:"ffz-mmu-mass-ban-tool-recent-followers-import"},"Recent Followers"),e("div",{class:"tw-flex tw-align-items-start ffz-mmu-mass-ban-tool-recent-followers-inputs"}),e("div",{class:"tw-flex tw-align-items-start tw-pd-y-05 tw-mg-y-05 ffz-mmu-mass-ban-tool-recent-followers-loading"},e("figure",{class:"ffz-i-t-reset loading tw-mg-r-05"})," Retrieving recent followers\u2026")),e("section",{class:"tw-c-text-alt-2"},e("div",null,e("p",null,"Optionally you can automatically import a specific number of the most recent followers of the channel, up to 100."))))),e("div",{class:"tw-mg-y-05"},e("div",{class:"ffz--widget ffz--select-box default"},e("div",{class:"tw-flex tw-align-items-center"},e("label",{class:"tw-mg-y-05 action-label",for:"ffz-mmu-mass-ban-tool-unban-action"},"Action To Take"),e("select",{id:"ffz-mmu-mass-ban-tool-unban-action",class:"tw-border-radius-medium tw-font-size-6 ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-05 ffz-mmu-mass-ban-tool-action",onChange:u=>this.toggleBanReasonField(u)},e("option",{value:"ban"},"Ban"),e("option",{value:"unban"},"Unban"))),e("section",{class:"tw-c-text-alt-2"},e("div",null,e("p",null,"Select whether to ban or unban the listed users."))))),e("div",{class:"tw-mg-y-05"},e("div",{class:"ffz--widget ffz--text-box default"},e("div",{class:"tw-flex tw-align-items-center"},e("label",{for:"ffz-mmu-mass-ban-tool-ban-reason"},"Reason for Ban"),e("input",{id:"ffz-mmu-mass-ban-tool-ban-reason",class:"tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 tw-mg-05 ffz-input ffz-mmu-mass-ban-tool-ban-reason",type:"text",placeholder:"Being a troll"})),e("section",{class:"tw-c-text-alt-2"},e("div",null,e("p",null,"An optional reason for the ban which will be applied to every ban. Not applicable when unbanning.")))))),t.addEventListener("click",()=>{v(this.MMU,this)}),this.toolContent.querySelector(".ffz-mmu-mass-ban-tool-upload-field").append(t);for(const u in c)this.toolContent.querySelector(".ffz-mmu-mass-ban-tool-recent-followers-inputs").append(c[u]);return this.entriesListTextArea=this.toolContent.querySelector(".ffz-mmu-mass-ban-tool-entries-list"),this.toolContent}async importRecentFollowers(t){if(!(t!==0&&!t))if(t>=1&&t<=100){this.toggleLoadingFollowers();try{if(!this.MMU.apollo){this.toggleLoadingFollowers();return}const c=await this.MMU.apollo.client.query({query:s(),variables:{login:this.MMU.channelName,first:t}});for(const u of c?.data?.user?.followers?.edges)y(this.MMU,this,u.node.displayName)}catch{this.toggleLoadingFollowers();return}this.toggleLoadingFollowers()}else alert("Number of recent followers to import must be between 1 and 100.")}importCustomFollowersAmount(t){document.getElementById("ffz-mmu-mass-ban-tool-followers-import-custom-amount").value="",this.importRecentFollowers(t)}toggleLoadingFollowers(){document.getElementById("ffz-mmu-mass-ban-tool-recent-followers-field").classList.toggle("loading")}toggleBanReasonField(t){const c=this.toolContent.querySelector(".ffz-mmu-mass-ban-tool-ban-reason");t.target.value==="unban"?c.disabled=!0:c.disabled=!1}};f(F,"MassBanTool");let r=F;const{createElement:n}=FrankerFaceZ.utilities.dom,N=class N{constructor(t){this.MMU=t,this.toolName="term-blocker"}buildToolContent(){const t=k.cloneNode(!0);return this.toolContent=n("div",{id:"ffz-mmu-mass-term-blocker-tool",class:"ffz--menu-page","data-mmu-tool-name":"term-blocker"},n("div",{class:"tw-mg-y-05"},n("div",{class:"ffz--widget ffz--text-box default"},n("div",{class:"tw-flex tw-align-items-center"},n("label",{for:"ffz-mmu-mass-term-blocker-tool-entries-list"},"Terms List",n("br",null),n("span",{class:"ffz-mmu-entry-count-label"},"(Current Term Count: ",n("span",{id:"ffz-mmu-mass-term-blocker-tool-entry-count",class:"ffz-mmu-mass-term-blocker-tool-entry-count ffz-mmu-entry-count"},"0"),")")),n("textarea",{id:"ffz-mmu-mass-term-blocker-tool-entries-list",class:"tw-border-radius-medium tw-font-size-6 tw-pd-x-1 tw-pd-y-05 tw-mg-05 ffz-input ffz-mmu-mass-term-blocker-tool-entries-list ffz-mmu-entries-list",placeholder:`Term1
Term2
Term3
Etc.`,rows:"10",onKeyUp:()=>g(this.MMU,this)})),n("section",{class:"tw-c-text-alt-2"},n("div",null,n("p",null,"The list of terms/phrases you wish to block. List one term per line."))))),n("div",{class:"tw-mg-y-05"},n("div",{class:"ffz--widget ffz--select-box"},n("div",{class:"tw-flex tw-align-items-start ffz-mmu-mass-term-blocker-tool-upload-field"},n("label",{class:"tw-mg-y-05",for:"ffz-mmu-mass-term-blocker-tool-upload-file"},"Upload Terms List File")),n("section",{class:"tw-c-text-alt-2"},n("div",null,n("p",null,"Optionally you can upload a ",n("code",null,".txt")," file here to populate the Terms List. Make sure your list consists of one term/phrase per line."))))),n("div",{class:"tw-mg-y-05"},n("div",{class:"ffz--widget ffz--select-box default"},n("div",{class:"tw-flex tw-align-items-center"},n("label",{class:"tw-mg-y-05 action-label",for:"ffz-mmu-mass-term-blocker-tool-privacy"},"Privacy"),n("select",{id:"ffz-mmu-mass-term-blocker-tool-privacy",class:"tw-border-radius-medium tw-font-size-6 ffz-select tw-pd-l-1 tw-pd-r-3 tw-pd-y-05 tw-mg-05 ffz-mmu-mass-term-blocker-tool-privacy"},n("option",{value:"public"},"Public"),n("option",{value:"private"},"Private"))),n("section",{class:"tw-c-text-alt-2"},n("div",null,n("p",null,'Select the privacy of the blocked term(s). This setting only applies if you are the streamer/channel owner; moderators are only able to create public blocked terms and setting this to "Private" will cause the mass term blocking to fail.'),n("p",null,n("b",null,"NOTE:")," Due to the nature of private term/phrase blocking, privately-blocked terms/phrases will not display any kind of confirmation of successful blocking such as a toast notification on the page or and entry in the Mod Actions log. You will need to check your ",n("a",{href:"https://dashboard.twitch.tv/settings/moderation/blocked-terms"},"Blocked Terms And Phrases")," in your creator dashboard if you wish to confirm that they have been successfully blocked.")))))),t.addEventListener("click",()=>{v(this.MMU,this)}),this.toolContent.querySelector(".ffz-mmu-mass-term-blocker-tool-upload-field").append(t),this.entriesListTextArea=this.toolContent.querySelector(".ffz-mmu-mass-term-blocker-tool-entries-list"),this.toolContent}};f(N,"MassTermBlocker");let b=N;var x=d(2320),h=d.n(x);const{createElement:i}=FrankerFaceZ.utilities.dom,{sleep:z}=FrankerFaceZ.utilities.object,M=class M extends FrankerFaceZ.utilities.addon.Addon{constructor(...t){super(...t),this.BanTool=new r(this),this.TermBlocker=new b(this),this.massBanToolCSS=document.createElement("link"),this.massBanToolCSS.rel="stylesheet",this.massBanToolCSS.id="ffz-mmu-css",this.massBanToolCSS.href=l,this.toolIsRunning=!1,this.inject("site.apollo"),this.inject("site.chat"),this.inject("site.fine")}getChannelName(){this.channelName=this.chat.router.match[1]}getChannelID(){this.channelID=Object.keys(this.chat.chat.room_ids)[0]}buildModal(){this.modal=i("div",{id:"ffz-mmu-modal",class:"ffz-dialog tw-elevation-3 tw-c-background-alt tw-c-text-base tw-border tw-flex tw-flex-nowrap tw-flex-column ffz-mmu-modal"},i("header",{class:"tw-c-background-base tw-full-width tw-align-items-center tw-flex tw-flex-nowrap"},i("h3",{class:"ffz-i-mass-ban-tool ffz-i-pd-1"},i("i",{class:"ffz-i-block"})," Mass Moderation Utilities"),i("div",{class:"tw-flex-grow-1 tw-pd-x-2"}),i("button",{type:"button",class:"tw-button-icon tw-mg-x-05",onClick:()=>this.removeModal()},i("span",{class:"tw-button-icon__icon"},i("figure",{class:"ffz-i-window-close"})))),i("nav",{id:"ffz-mmu-nav",class:"tw-c-background-alt tw-full-width ffz-mmu-nav"},i("menu",{id:"ffz-mmu-nav-menu",class:"tw-align-items-center tw-flex tw-flex-norwap ffz-mmu-nav-menu"},i("li",{class:"ffz-mmu-nav-menu-item"},i("button",{id:"ffz-mmu-menu-mass-ban-tool",class:"ffz-mmu-nav-menu-btn ffz-mmu-nav-menu-mass-ban-tool",onClick:()=>this.toggleTool("ban")},"Ban/Unban")),i("li",{class:"tw-border-l ffz-mmu-nav-menu-item"},i("button",{id:"ffz-mmu-menu-mass-term-blocker-tool",class:"ffz-mmu-nav-menu-btn ffz-mmu-nav-menu-mass-term-blocker-tool",onClick:()=>this.toggleTool("term-blocker")},"Term Blocker")))),i("section",{class:"tw-border-t tw-full-height tw-full-width tw-flex tw-flex-nowrap tw-overflow-hidden"},i("div",{class:"scrollable-area tw-flex-grow-1","data-simplebar-auto-hide":"true","data-simplebar-scrollbar-min-size":"10","data-simplebar":"init"},i("form",{id:"ffz-mmu-tool-form",class:"ffz-mmu-tool-form"},i("div",{id:"ffz-mmu-tabs",class:"ffz-mmu-tabs"},this.BanTool.buildToolContent(),this.TermBlocker.buildToolContent())))),i("footer",{class:"tw-c-background-base tw-full-width tw-align-items-center tw-justify-content-end tw-flex tw-flex-nowrap"},i("div",{class:"tw-mg-y-05"},i("div",{class:"ffz--widget ffz-mmu-run-tool-btn default"},i("div",{class:"tw-flex-shrink-0"},i("button",{class:"tw-button",type:"button",onClick:()=>this.runToolConfirmation()},i("span",{class:"tw-button__text"},"Run Tool")))))))}toggleTool(t){this.removeActiveToolClassName(),this.addActiveToolClassName(t)}runToolConfirmation(){if(this.toolIsRunning)window.alert("The tool is currently running. Please wait until it is finished to run it again.");else if(window.confirm("Are you absolutely sure you want to run this tool? The process cannot be stopped once started.")){switch(this.modal.querySelector(".ffz--menu-page.active-tool").dataset.mmuToolName){case"ban":this.runBanTool(this.modal.querySelector(".ffz-mmu-mass-ban-tool-entries-list").value,this.modal.querySelector(".ffz-mmu-mass-ban-tool-action").value,this.modal.querySelector(".ffz-mmu-mass-ban-tool-ban-reason").value);break;case"term-blocker":this.runTermBlockerTool(this.modal.querySelector(".ffz-mmu-mass-term-blocker-tool-entries-list").value,this.modal.querySelector(".ffz-mmu-mass-term-blocker-tool-privacy").value);break}this.removeModal()}}entriesToArray(t){return t.trim().match(/^.*$/gm)}entriesProvided(t){return t.length>0&&t[0]!==""}async runBanTool(t,c,u){const w=this.entriesToArray(t);if(this.entriesProvided(w)){this.toolIsRunning=!0;for(const T of w)await this.actionUser(T,c,u);this.toolIsRunning=!1}else this.log.info("Aborting run: no usernames were provided.")}async runTermBlockerTool(t,c){const u=this.entriesToArray(t);if(this.entriesProvided(u)){let w=!0;this.channelID||this.getChannelID(),c==="private"&&(w=!1);for(const T of u){const A=await this.apollo.client.mutate({mutation:h(),variables:{input:{channelID:this.channelID,isModEditable:w,phrase:T}}}).catch(E=>this.log.info(E));A.data.addChannelBlockedTerm.length>0?(this.log.info(`Term/phrase "${A.data.addChannelBlockedTerm.phrases[0]}" successfully blocked.`),await z(350)):this.log.info(`Term/phrase ${T} failed to be blocked. Did you accidentally set the Privacy to "Private" in a channel that you don't own? If so, that's most likely the cause of this issue. Moderators are only able to block terms publicly.`)}}else this.log.info("Aborting run: no terms/phrases were provided.")}addActiveToolClassName(t){this.modal.querySelector(`#ffz-mmu-mass-${t}-tool`).classList.add("active-tool"),this.modal.querySelector(`.ffz-mmu-nav-menu-mass-${t}-tool`).classList.add("active-tool")}removeActiveToolClassName(){this.modal.querySelectorAll(".active-tool").forEach((t,c)=>{t.classList.remove("active-tool")})}insertModal(t){this.addActiveToolClassName(t),document.body.append(this.modal)}removeModal(){this.modal.querySelector(".ffz-mmu-tool-form").reset(),g(this,this.BanTool),g(this,this.TermBlocker),this.BanTool.toggleBanReasonField({target:{value:"ban"}}),document.body.contains(this.modal)&&(document.body.removeChild(this.modal),this.removeActiveToolClassName())}checkForModView(){if(this.chat.router.current_name==="mod-view"){if(this.modBar=this.fine.define("mod-view-bar"),this.modBar)return this.reactModBar(),!0}else return!1}insertCSS(){document.head.append(this.massBanToolCSS)}removeCSS(){document.head.contains(this.massBanToolCSS)&&document.head.removeChild(this.massBanToolCSS)}reactModBar(){this.modBar.ready(()=>{this.update()}),this.modBar.on("mount",this.insertModViewButton,this),this.modBar.on("update",this.insertModViewButton,this)}update(){requestAnimationFrame(()=>{for(const t of this.modBar.instances)this.insertModViewButton(t)})}insertModViewButton(t,c,u){const w=this.fine.getChildNode(t);t?.childContext&&!w.contains(this.modViewBtn)&&(this.modBarContainer=w&&w.querySelector(".modview-dock > div:last-child"),this.modViewBtn=i("div",{class:"tw-relative tw-mg-b-1",onClick:()=>this.insertModal("ban")},i("div",{id:"ffz-mmu-btn",class:"tw-inline-flex tw-relative ffz-il-tooltip__container"},i("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon ffz-core-button ffz-core-button--border tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative"},i("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},i("span",{class:"tw-button-icon__icon"},i("figure",{class:"ffz-i-block"})))),i("div",{class:"ffz-il-tooltip ffz-il-tooltip--up ffz-il-tooltip--align-left"},"Mass Moderation Utilities"))),this.modBarContainer.insertBefore(this.modViewBtn,this.modBarContainer.lastElementChild))}removeModViewButton(){this.modBarContainer.contains(this.modViewBtn)&&this.modBarContainer.removeChild(this.modViewBtn)}async actionUser(t,c,u){this.channelName||this.getChannelName();let w="/"+c+" "+t;c==="ban"&&u.trim()!==""&&(w+=" "+u),this.chat.sendMessage(this.channelName,w),await z(350)}onDisable(){this.removeCSS(),this.removeModal(),this.removeModViewButton(),this.log.info("Mass Moderation Utilities add-on successfully disabled.")}onEnable(){this.checkForModView()?(this.getChannelName(),this.insertCSS(),this.insertModViewButton(),this.buildModal(),this.log.info("Mass Moderation Utilies add-on successfully enabled.")):this.log.info("Mass Moderation Utilities not enabled: Not currently in mod view.")}};f(M,"MassModerationUtilities");let _=M;_.register("mass-ban-tool",null,"2.0.0")})()})();})();

//# sourceMappingURL=script.js.map