{"version":3,"file":"new-account-highlighter/script.js","mappings":"8SAAA,MAAM,GAAN,gBAAoC,kCAAM,CAIzC,eAAeA,EAAM,CACpB,MAAM,GAAGA,CAAI,EAHd,qBAAc,IAAI,EAKjB,KAAK,OAAO,MAAM,EAElB,KAAK,SAAS,IAAI,kBAAmB,CACpC,QAAS,KACT,GAAI,CACH,KAAM,+CACN,MAAO,sBACP,YAAa,sFACb,UAAW,qBACX,KAAM,IAAM,CACX,MAAMC,EAAM,OAAO,KAAK,EAAsB,QAAQ,EAAE,IAAIC,IAAQ,CAAC,MAAOA,EAAK,MAAOA,CAAG,EAAE,EAC7F,OAAAD,EAAI,KAAK,CAAC,MAAO,KAAM,MAAO,UAAU,CAAC,EAClCA,CACR,CACD,EACA,QAAS,IAAM,KAAK,KAAK,mBAAmB,CAC7C,CAAC,EAED,KAAK,SAAS,IAAI,oBAAqB,CACtC,QAAS,EACT,GAAI,CACH,KAAM,+CACN,MAAO,qBACP,UAAW,mBACX,KAAM,SACN,QAAS,QACV,EACA,QAAS,IAAM,KAAK,KAAK,mBAAmB,CAC7C,CAAC,EAED,KAAK,SAAS,IAAI,0BAA2B,CAC5C,QAAS,UACT,GAAI,CACH,KAAM,+CACN,MAAO,kBACP,YAAa,oCACb,UAAW,mBACZ,EACA,QAAS,IAAM,KAAK,KAAK,mBAAmB,CAC7C,CAAC,EAED,KAAK,KAAK,mBAAmB,WAAY,qBAAqB,EAC9D,MAAM,EAAI,KAEJE,EAAuB,CAC5B,KAAM,uBACN,SAAU,GAEV,QAAQC,EAAQC,EAAK,CACpB,MAAMC,EAAS,EAAE,SAAS,IAAI,iBAAiB,EACzCC,EAAgB,EAAsB,SAASD,CAAM,EACrDE,EAASD,EAAgBA,EAAc,IAAM,OAAO,UAC1D,OAAIF,EAAI,KAAK,OAASG,GACrB,KAAK,eACJH,EACA,EAAE,SAAS,IAAI,mBAAmB,EAClC,EAAE,SAAS,IAAI,yBAAyB,EACxC,UACD,EAEMD,CACR,CACD,EAEA,KAAK,KAAK,aAAaD,CAAoB,CAC5C,CAEA,MAAM,iBAAkB,CAGvB,MAAMM,EAAM,MAAM,MAFN,sCAEe,EAAE,KAAKC,GAAQA,EAAK,GAAKA,EAAK,KAAK,EAAI,IAAI,EACjED,IACJ,EAAsB,SAAWA,EACnC,CAEA,QAAS,CACR,OAAO,KAAK,gBAAgB,CAC7B,CAEA,UAAW,CACV,KAAK,YAAc,YAAY,IAAM,CACpC,KAAK,gBAAgB,CACtB,EAAI,IAAK,GAAG,GAAI,KAAK,MAAM,KAAK,OAAO,EAAI,KAAK,MAAM,IAAK,GAAG,EAAE,CAAC,CAAC,CACnE,CAEA,WAAY,CACX,cAAc,KAAK,WAAW,CAC/B,CAEA,MAAM,UAAW,CACjB,CACD,EAlG0C,+BAA1C,GACC,EADK,EACE,WAAW,CAAC,KAAM,CAAC,CAAC,EAD5B,EAoGsB,SAAS,uC","sources":["webpack://ffz-addons/./src/new-account-highlighter/index.js"],"sourcesContent":["class NewAccountHighlighter extends Addon {\n\tstatic Mappings = {'7d': 0};\n\tupdateTimer = null;\n\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t\tthis.inject('chat');\n\n\t\tthis.settings.add('newusers.minage', {\n\t\t\tdefault: '7d',\n\t\t\tui: {\n\t\t\t\tpath: 'Add-Ons > New User Highlighter >> Highlights',\n\t\t\t\ttitle: 'Minimum account age',\n\t\t\t\tdescription: 'Users whose account is younger than the specified time will be highlighted in chat.',\n\t\t\t\tcomponent: 'setting-select-box',\n\t\t\t\tdata: () => {\n\t\t\t\t\tconst arr = Object.keys(NewAccountHighlighter.Mappings).map(age => ({value: age, title: age}));\n\t\t\t\t\tarr.push({value: null, title: 'Disabled'});\n\t\t\t\t\treturn arr;\n\t\t\t\t}\n\t\t\t},\n\t\t\tchanged: () => this.emit('chat:update-lines')\n\t\t});\n\n\t\tthis.settings.add('newusers.priority', {\n\t\t\tdefault: 0,\n\t\t\tui: {\n\t\t\t\tpath: 'Add-Ons > New User Highlighter >> Highlights',\n\t\t\t\ttitle: 'Highlight Priority',\n\t\t\t\tcomponent: 'setting-text-box',\n\t\t\t\ttype: 'number',\n\t\t\t\tprocess: 'to_int'\n\t\t\t},\n\t\t\tchanged: () => this.emit('chat:update-lines')\n\t\t});\n\n\t\tthis.settings.add('newusers.highlightcolor', {\n\t\t\tdefault: '#FFFFFF',\n\t\t\tui: {\n\t\t\t\tpath: 'Add-Ons > New User Highlighter >> Highlights',\n\t\t\t\ttitle: 'Highlight Color',\n\t\t\t\tdescription: 'Set the color for your highlights',\n\t\t\t\tcomponent: 'setting-color-box'\n\t\t\t},\n\t\t\tchanged: () => this.emit('chat:update-lines')\n\t\t});\n\n\t\tthis.chat.addHighlightReason('user-age', 'Minimum Account Age');\n\t\tconst t = this;\n\n\t\tconst NewAccountHighlights = {\n\t\t\ttype: 'newaccount_highlight',\n\t\t\tpriority: 95,\n\n\t\t\tprocess(tokens, msg) {\n\t\t\t\tconst minage = t.settings.get('newusers.minage');\n\t\t\t\tconst minagemapping = NewAccountHighlighter.Mappings[minage];\n\t\t\t\tconst minuid = minagemapping ? minagemapping.uid : Number.MAX_VALUE;\n\t\t\t\tif( msg.user.userID > minuid )\n\t\t\t\t\tthis.applyHighlight(\n\t\t\t\t\t\tmsg,\n\t\t\t\t\t\tt.settings.get('newusers.priority'),\n\t\t\t\t\t\tt.settings.get('newusers.highlightcolor'),\n\t\t\t\t\t\t'user-age'\n\t\t\t\t\t);\n\n\t\t\t\treturn tokens;\n\t\t\t}\n\t\t}\n\n\t\tthis.chat.addTokenizer(NewAccountHighlights);\n\t}\n\n\tasync refreshMappings() {\n\t\tconst url = 'https://ffz.0x.bot/api/mappings.json';\n\n\t\tconst out = await fetch(url).then(resp => resp.ok ? resp.json() : null);\n\t\tif ( out )\n\t\t\tNewAccountHighlighter.Mappings = out;\n\t}\n\n\tonLoad() {\n\t\treturn this.refreshMappings();\n\t}\n\n\tonEnable() {\n\t\tthis.updateTimer = setInterval(() => {\n\t\t\tthis.refreshMappings();\n\t\t}, (1000*60*25)+Math.floor(Math.random() * Math.floor(1000*60*10)));\n\t}\n\n\tonDisable() {\n\t\tclearInterval(this.updateTimer);\n\t}\n\n\tasync onUnload() {\n\t}\n}\n\nNewAccountHighlighter.register();\n"],"names":["args","arr","age","NewAccountHighlights","tokens","msg","minage","minagemapping","minuid","out","resp"],"sourceRoot":""}