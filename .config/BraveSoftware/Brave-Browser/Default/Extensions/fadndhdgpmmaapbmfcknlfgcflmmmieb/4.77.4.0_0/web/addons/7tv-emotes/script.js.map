{"version":3,"file":"7tv-emotes/script.js","mappings":"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","sources":["webpack://ffz-addons/./src/7tv-emotes/modules/api.js","webpack://ffz-addons/./src/7tv-emotes/modules/avatars.js","webpack://ffz-addons/./src/7tv-emotes/modules/badges.js","webpack://ffz-addons/./src/7tv-emotes/modules/emotes.js","webpack://ffz-addons/./src/7tv-emotes/modules/nametag-paints.js","webpack://ffz-addons/./src/7tv-emotes/modules/personal-emotes.js","webpack://ffz-addons/./src/7tv-emotes/modules/socket.js","webpack://ffz-addons/./src/7tv-emotes/modules/ sync nonrecursive \\.js$","webpack://ffz-addons/webpack/bootstrap","webpack://ffz-addons/webpack/runtime/define property getters","webpack://ffz-addons/webpack/runtime/hasOwnProperty shorthand","webpack://ffz-addons/webpack/runtime/make namespace object","webpack://ffz-addons/./src/7tv-emotes/index.js"],"sourcesContent":["export default class API extends FrankerFaceZ.utilities.module.Module {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t\tthis.inject(User);\n\t\tthis.inject(Emotes);\n\t\tthis.inject(Cosmetics);\n\n\t\tthis.apiBaseURI = 'https://7tv.io/v3';\n\t\tthis.eventsBaseURI = 'https://events.7tv.io/v3';\n\t\tthis.appBaseURI = 'https://7tv.app';\n\n\t\tthis.clientPlatform = 'ffz';\n\t\tthis.clientVersion = this.parent.manifest.version;\n\t}\n\n\tmakeRequest(route, options = {}, skip_cache = false) {\n\t\tconst headers = new Headers(options && options.headers || {});\n\n\t\theaders.set('X-SevenTV-Platform', this.clientPlatform);\n\t\theaders.set('X-SevenTV-Version', this.clientVersion);\n\n\t\tconst request = fetch(`${this.apiBaseURI}/${route}`, {\n\t\t\tcache: skip_cache ? 'reload' : 'default',\n\t\t\t...options,\n\t\t\theaders\n\t\t});\n\n\t\tif ( ! skip_cache )\n\t\t\treturn request.catch(() => this.makeRequest(route, options, true));\n\n\t\treturn request;\n\t}\n\n\tasync requestJSON(route, options = {}) {\n\t\tconst response = await this.makeRequest(route, \n\t\t\t{\n\t\t\t\t...options,\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/json'\n\t\t\t\t}\n\t\t\t});\n\n\t\tif (response.ok) {\n\t\t\tconst json = await response.json();\n\t\t\treturn json;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tasync requestObject(route, options = {}) {\n\t\tconst json = await this.requestJSON(route, options);\n\n\t\tif (json != null && typeof json == 'object') return json;\n\n\t\treturn {};\n\t}\n\n\tasync requestArray(route, options = {}) {\n\t\tconst json = await this.requestJSON(route, options);\n\n\t\tif (json instanceof Array) return json;\n\n\t\treturn [];\n\t}\n\n\tgetEmoteAppURL(emote) {\n\t\treturn `${this.appBaseURI}/emotes/${emote.id}`;\n\t}\n}\n\nexport class User extends FrankerFaceZ.utilities.module.Module {\n\tfetchUserData(user_id) {\n\t\treturn this.parent.requestObject(`users/twitch/${user_id}`);\n\t}\n\n\tupdateUserPresences(user_id, channel_id, self = undefined, session_id = undefined) {\n\t\treturn this.parent.requestJSON(`users/${user_id}/presences`, {\n\t\t\tmethod: 'POST',\n\t\t\tbody: JSON.stringify({\n\t\t\t\tkind: 1,\n\t\t\t\tpassive: self,\n\t\t\t\tsession_id: self ? session_id : undefined,\n\t\t\t\tdata: {\n\t\t\t\t\tplatform: 'TWITCH',\n\t\t\t\t\tid: channel_id\n\t\t\t\t}\n\t\t\t})\n\t\t});\n\t}\n}\n\nexport class Emotes extends FrankerFaceZ.utilities.module.Module {\n\tfetchGlobalEmotes() {\n\t\treturn this.parent.requestObject('emote-sets/global');\n\t}\n\n\tfetchChannelEmotes(channelId) {\n\t\treturn this.parent.requestObject(`users/twitch/${channelId}`);\n\t}\n\t\n\tfetchEmoteSet(setID) {\n\t\treturn this.parent.requestObject(`emote-sets/${setID}`);\n\t}\n}\n\nexport class Cosmetics extends FrankerFaceZ.utilities.module.Module {\n\tfetchAvatars(identifiers) {\n\t\treturn this.parent.requestJSON('bridge/event-api', {\n\t\t\tmethod: 'POST',\n\t\t\tbody: JSON.stringify({\n\t\t\t\tidentifiers\n\t\t\t})\n\t\t});\n\t}\n}","export default class Avatars extends FrankerFaceZ.utilities.module.Module {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t\tthis.inject('..api');\n\n\t\tthis.inject('settings');\n\t\tthis.inject('site');\n\t\tthis.inject('site.fine');\n\n\t\tthis.settings.add('addon.seventv_emotes.animated_avatars', {\n\t\t\tdefault: true,\n\t\t\tui: {\n\t\t\t\tpath: 'Add-Ons > 7TV Emotes >> User Cosmetics',\n\t\t\t\ttitle: 'Animated Avatars',\n\t\t\t\tdescription: 'Show 7TV animated avatars on users who have them set. [(7TV Subscriber Perk)](https://7tv.app/store)',\n\t\t\t\tcomponent: 'setting-check-box',\n\t\t\t}\n\t\t});\n\n\t\tthis.avatarCache = new Map();\n\t\tthis.socketWaiters = new Map();\n\n\t\tthis.updateInterval = false;\n\t}\n\n\tonEnable() {\n\t\tthis.settings.getChanges('addon.seventv_emotes.animated_avatars', () => this.onSettingChange());\n\n\t\tthis.on('common:update-avatar', async event => {\n\t\t\tconst enabled = this.settings.get('addon.seventv_emotes.animated_avatars');\n\t\t\tif (!enabled) return;\n\n\t\t\tconst url = await this.getAvatar(event.user.login);\n\t\t\tif (url)\n\t\t\t\tevent.url = url;\n\t\t});\n\n\t\tthis.onSettingChange();\n\t}\n\n\treceiveAvatarData(data) {\n\t\tif (!data.user?.username || !data.host?.files) return;\n\t\tconst login = data.user.username.toLowerCase();\n\n\t\tconst waiter = this.socketWaiters.get(login);\n\t\tif (!waiter)\n\t\t\treturn;\n\n\t\tthis.socketWaiters.delete(login);\n\n\t\tconst webpEmoteVersions = data.host.files.filter((value => value.format === 'WEBP'));\n\t\tif (!webpEmoteVersions.length) return;\n\n\t\tconst highestQuality = webpEmoteVersions[webpEmoteVersions.length - 1];\n\t\twaiter(`${data.host.url}/${highestQuality.name}`);\n\t}\n\n\tgetAvatar(login) {\n\t\tlogin = login.toLowerCase();\n\n\t\tconst entry = this.avatarCache.get(login);\n\t\tif ( entry?.done && Date.now() < entry.expires_at )\n\t\t\treturn entry.value;\n\n\t\tif ( entry && ! entry.done )\n\t\t\treturn entry.promise;\n\n\t\tconst promise = new Promise(resolve => {\n\t\t\tlet timer;\n\t\t\tconst onDone = value => {\n\t\t\t\tclearTimeout(timer);\n\t\t\t\tif ( ! value )\n\t\t\t\t\tvalue = null;\n\n\t\t\t\tthis.avatarCache.set(login, {\n\t\t\t\t\tdone: true,\n\t\t\t\t\tvalue,\n\t\t\t\t\texpires_at: Date.now() + 1000 * 60 * 3 // 3 minutes\n\t\t\t\t});\n\n\t\t\t\tresolve(value);\n\t\t\t};\n\n\t\t\tthis.socketWaiters.set(login, onDone);\n\t\t\ttimer = setTimeout(onDone, 3000);\n\n\t\t\tthis.waitingAvatars = this.waitingAvatars || [];\n\t\t\tthis.waitingAvatars.push(login);\n\n\t\t\tif ( ! this.requestTimer )\n\t\t\t\tthis.requestTimer = setTimeout(async () => {\n\t\t\t\t\tthis.requestTimer = null;\n\t\t\t\t\tconst waiting = this.waitingAvatars;\n\t\t\t\t\tthis.waitingAvatars = null;\n\n\t\t\t\t\tconst avatars = await this.api.cosmetics.fetchAvatars(waiting.map(login => `username:${login}`));\n\t\t\t\t\tfor (const { body } of avatars) {\n\t\t\t\t\t\tconst { data } = body.object;\n\t\t\t\t\t\tthis.receiveAvatarData(data);\n\t\t\t\t\t}\n\t\t\t\t}, 1000); // request them all after 1000ms\n\t\t});\n\n\t\tthis.avatarCache.set(login, {\n\t\t\tdone: false,\n\t\t\tpromise\n\t\t});\n\n\t\treturn promise;\n\t}\n\n\tonSettingChange() {\n\t\tconst enabled = this.settings.get('addon.seventv_emotes.animated_avatars');\n\n\t\tif (enabled) {\n\t\t\tif (!this.updateInterval) {\n\t\t\t\tthis.updateInterval = setInterval(() => {\n\t\t\t\t\tthis.updateAvatars();\n\t\t\t\t}, 1000);\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tclearInterval(this.updateInterval);\n\t\t\tthis.updateInterval = false;\n\t\t}\n\n\t\tthis.updateAvatars();\n\t}\n\n\tgetVisibleAvatars() {\n\t\treturn document.querySelectorAll('.tw-image-avatar');\n\t}\n\n\tupdateAvatars() {\n\t\tconst enabled = this.settings.get('addon.seventv_emotes.animated_avatars');\n\n\t\tconst avatars = this.getVisibleAvatars();\n\t\tavatars.forEach(async avatar => {\n\t\t\tif (!enabled) {\n\t\t\t\t// Check if the avatar has an seventv-original-avatar attribute and set it\n\t\t\t\tif (avatar.hasAttribute('seventv-original-avatar')) {\n\t\t\t\t\tavatar.setAttribute('src', avatar.getAttribute('seventv-original-avatar'));\n\t\t\t\t\tavatar.removeAttribute('seventv-original-avatar');\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Get the react instance for the avatar element\n\t\t\tconst avatarComponent = this.fine.getOwner(avatar);\n\t\t\tif (!avatarComponent) return;\n\n\t\t\tconst node = this.fine.searchParentNode(avatarComponent, e => e.memoizedProps?.userLogin);\n\t\t\tconst login = node?.memoizedProps?.userLogin;\n\n\t\t\t// No login? No avatar.\n\t\t\tif (!login) return;\n\n\t\t\t// Get the current image src URL\n\t\t\tconst current_url = avatar.getAttribute('src');\n\n\t\t\t// Get the animated avatar URL for this login\n\t\t\tconst url = await this.getAvatar(login);\n\t\t\tif (url && url !== current_url) {\n\t\t\t\tif (!avatar.hasAttribute('seventv-original-avatar')) {\n\t\t\t\t\t// Set the seventv-original-avatar attribute to the current src attribute\n\t\t\t\t\tavatar.setAttribute('seventv-original-avatar', avatar.getAttribute('src'));\n\t\t\t\t}\n\n\t\t\t\t// Set the src attribute to the animated avatar\n\t\t\t\tavatar.setAttribute('src', url);\n\t\t\t}\n\t\t});\n\t}\n}\n","const SUB_BADGE_REGEX = /sub(?:\\d+|founder)/;\n\nexport default class Badges extends FrankerFaceZ.utilities.module.Module {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\t\n\t\tthis.inject('settings');\n\t\tthis.inject('chat');\n\t\tthis.inject('i18n');\n\t\tthis.injectAs('chat_badges', 'chat.badges');\n\n\t\tthis.settings.add('addon.seventv_emotes.badges', {\n\t\t\tdefault: true,\n\t\t\tui: {\n\t\t\t\tpath: 'Add-Ons > 7TV Emotes >> User Cosmetics',\n\t\t\t\ttitle: 'Badges',\n\t\t\t\tdescription: 'Show 7TV user badges.\\n\\n(Per-badge visibilty can be set in [Chat >> Badges > Visibilty > Add-Ons](~chat.badges.tabs.visibility))',\n\t\t\t\tcomponent: 'setting-check-box',\n\t\t\t}\n\t\t});\n\n\t\tthis.badges = new Map();\n\t\tthis.badgeToUsers = new Map();\n\n\t\t// Load the \"1 Month\" subscriber badge so it can be hidden in FFZ without having to be seen first\n\t\tthis.addBadge({\n\t\t\tid: '62f97c05e46eb00e438a696a',\n\t\t\tname: '7TV Subscriber - 1 Month',\n\t\t\ttag: 'sub1',\n\t\t\ttooltip: '7TV Subscriber (1 Month)',\n\t\t\thost: {\n\t\t\t\turl: '//cdn.7tv.app/badge/62f97c05e46eb00e438a696a'\n\t\t\t}\n\t\t});\n\t}\n\n\tonEnable() {\n\t\tthis.settings.getChanges('addon.seventv_emotes.badges', enabled => this.updateBadges(enabled));\n\t}\n\n\tgetUsersForBadge(badge_id) {\n\t\tconst set = this.badgeToUsers.get(badge_id);\n\t\treturn set || new Set();\n\t}\n\n\tupdateBadges(enabled) {\n\t\tif (!enabled) {\n\t\t\tfor(const user of this.chat.iterateUsers()) {\n\t\t\t\tuser.removeAllBadges('addon.seventv-emotes');\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tfor (const badge_id of this.badgeToUsers.keys()) {\n\t\t\t\tconst userSet = this.getUsersForBadge(badge_id);\n\t\t\t\tfor (const user_id of userSet) {\n\t\t\t\t\tconst user = this.chat.getUser(user_id);\n\t\t\t\t\tuser.addBadge('addon.seventv-emotes', badge_id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis.emit('chat:update-lines');\n\t}\n\n\tgetBadgeID(badge_id) {\n\t\treturn `addon.seventv_emotes.badge-${badge_id}`;\n\t}\n\n\taddBadge(badge) {\n\t\tconst host = badge.host.url;\n\n\t\tconst id = this.getBadgeID(badge.id);\n\n\t\tif (this.badges.has(id)) return;\n\n\t\tlet title = badge.tooltip;\n\t\tlet subtext;\n\t\tif (title.includes('Subscriber')) {\n\t\t\tconst split = title.split(' (');\n\t\t\ttitle = split[0];\n\t\t\tsubtext = `(${split[1]}`;\n\t\t}\n\n\t\tconst badgeData = {\n\t\t\tid: badge.id,\n\t\t\tbase_id: SUB_BADGE_REGEX.test(badge.tag)\n\t\t\t\t? 'addon.seventv_emotes.subscriber_badge'\n\t\t\t\t: undefined,\n\t\t\ttitle,\n\t\t\ttooltipExtra: () => {\n\t\t\t\tif (!subtext) return;\n\n\t\t\t\treturn `\\n${subtext}`;\n\t\t\t},\n\t\t\tslot: 69,\n\t\t\timage: `${host}/1x`,\n\t\t\turls: {\n\t\t\t\t1: `${host}/1x`,\n\t\t\t\t2: `${host}/2x`,\n\t\t\t\t4: `${host}/3x`\n\t\t\t},\n\t\t\tsvg: false,\n\t\t\tclick_url: 'https://7tv.app/',\n\t\t};\n\n\t\tthis.chat_badges.loadBadgeData(id, badgeData);\n\n\t\tthis.badges.set(id, badgeData);\n\t}\n\n\taddUserBadgeByID(user_id, badge_id) {\n\t\tbadge_id = this.getBadgeID(badge_id);\n\n\t\tconst user = this.chat.getUser(user_id);\n\t\tconst has_badge = user.getBadge(badge_id);\n\t\tif (has_badge) return;\n\n\t\tconst userBadges = this.getUsersForBadge(badge_id);\n\t\tuserBadges.add(user_id);\n\t\tthis.badgeToUsers.set(badge_id, userBadges);\n\n\t\tif (!this.settings.get('addon.seventv_emotes.badges')) return;\n\n\t\tuser.addBadge('addon.seventv-emotes', badge_id);\n\n\t\tthis.emit('chat:update-lines-by-user', user_id);\n\t}\n\n\taddUserBadge(data) {\n\t\tconst badge_id = data.ref_id || data.id;\n\t\tconst user = data.user?.connections?.find(c => c.platform === 'TWITCH');\n\n\t\tif (!user?.id) return;\n\n\t\tthis.addUserBadgeByID(user.id, badge_id);\n\t}\n\n\tremoveUserBadgeByID(user_id, badge_id) {\n\t\tbadge_id = this.getBadgeID(badge_id);\n\n\t\tconst user = this.chat.getUser(user_id);\n\t\tconst has_badge = user.getBadge(badge_id);\n\t\tif (!has_badge) return;\n\n\t\tconst userBadges = this.getUsersForBadge(badge_id);\n\t\tuserBadges.delete(user_id);\n\t\tthis.badgeToUsers.set(badge_id, userBadges);\n\n\t\tuser.removeBadge('addon.seventv-emotes', badge_id);\n\n\t\tthis.emit('chat:update-lines-by-user', user_id);\n\t}\n\n\tremoveUserBadge(data) {\n\t\tconst badge_id = data.ref_id || data.id;\n\t\tconst user = data.user?.connections?.find(c => c.platform === 'TWITCH');\n\n\t\tif (!user?.id) return;\n\n\t\tthis.removeUserBadgeByID(user.id, badge_id);\n\t}\n}","export default class Emotes extends FrankerFaceZ.utilities.module.Module {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t\tthis.inject('..api');\n\n\t\tthis.inject('settings');\n\t\tthis.inject('chat');\n\t\tthis.inject('chat.emotes');\n\n\t\tthis.setIcon = this.parent.manifest.icon;\n\n\t\tthis.settings.add('addon.seventv_emotes.global_emotes', {\n\t\t\tdefault: true,\n\t\t\tui: {\n\t\t\t\tpath: 'Add-Ons > 7TV Emotes >> Emotes',\n\t\t\t\ttitle: 'Global Emotes',\n\t\t\t\tdescription: 'Enables global emotes from 7TV.',\n\t\t\t\tcomponent: 'setting-check-box',\n\t\t\t}\n\t\t});\n\n\t\tthis.settings.add('addon.seventv_emotes.channel_emotes', {\n\t\t\tdefault: true,\n\t\t\tui: {\n\t\t\t\tpath: 'Add-Ons > 7TV Emotes >> Emotes',\n\t\t\t\ttitle: 'Channel Emotes',\n\t\t\t\tdescription: 'Enables channel specific emotes from 7TV.',\n\t\t\t\tcomponent: 'setting-check-box',\n\t\t\t}\n\t\t});\n\n\t\tthis.settings.add('addon.seventv_emotes.emote_format', {\n\t\t\tdefault: 'WEBP',\n\t\t\tui: {\n\t\t\t\tpath: 'Add-Ons > 7TV Emotes >> Emotes',\n\t\t\t\ttitle: 'Emote Format',\n\t\t\t\tdescription: 'The file format of the emotes to be used.',\n\t\t\t\tcomponent: 'setting-select-box',\n\t\t\t\tdata: [\n\t\t\t\t\t{ value: 'WEBP', title: 'Webp' },\n\t\t\t\t\t{ value: 'AVIF', title: 'Avif' },\n\t\t\t\t],\n\n\t\t\t},\n\t\t});\n\n\t\tthis.settings.add('addon.seventv_emotes.unlisted_emotes', {\n\t\t\tdefault: false,\n\t\t\tui: {\n\t\t\t\tpath: 'Add-Ons > 7TV Emotes >> Emotes > Emote Visibility',\n\t\t\t\ttitle: 'Show unlisted emotes',\n\t\t\t\tdescription: 'Show emotes which have not yet been approved or have been deemed non-TOS friendly by 7TV moderators.',\n\t\t\t\tcomponent: 'setting-check-box',\n\t\t\t}\n\t\t});\n\n\t\tthis.setToChannelMap = new Map();\n\n\t\tthis.on('chat:reload-data', flags => {\n\t\t\tif (!flags || flags.emotes) {\n\t\t\t\tthis.updateGlobalEmotes();\n\t\t\t\tthis.updateChannelSets();\n\t\t\t}\n\t\t});\n\n\t\tthis.emotes.setProvider('addon.seventv_emotes', {\n\t\t\tname: this.addon_manifest.name,\n\t\t\ticon: this.addon_manifest.icon,\n\t\t});\n\t}\n\n\tonEnable() {\n\t\tthis.on('settings:changed:addon.seventv_emotes.global_emotes', () => this.updateGlobalEmotes());\n\t\tthis.on('settings:changed:addon.seventv_emotes.emote_format', () => this.updateGlobalEmotes());\n\t\tthis.on('settings:changed:addon.seventv_emotes.emote_format', () => this.updateChannelSets());\n\t\tthis.on('settings:changed:addon.seventv_emotes.channel_emotes', () => this.updateChannelSets());\n\t\tthis.on('settings:changed:addon.seventv_emotes.unlisted_emotes', () => this.updateChannelSets());\n\n\t\tthis.on('chat:room-add', channel => this.updateChannelSet(channel));\n\t\tthis.on('chat:room-remove', channel => this.setChannelSet(channel, null));\n\n\t\tthis.updateGlobalEmotes();\n\t\tthis.updateChannelSets();\n\t}\n\n\tasync updateGlobalEmotes() {\n\t\tthis.emotes.removeDefaultSet('addon.seventv_emotes', 'addon.seventv_emotes.global');\n\t\tthis.emotes.unloadSet('addon.seventv_emotes.global');\n\n\t\tif (!this.settings.get('addon.seventv_emotes.global_emotes')) return;\n\n\t\tconst globalSet = await this.api.emotes.fetchGlobalEmotes();\n\n\t\tconst ffzEmotes = [];\n\t\tfor (const emote of globalSet.emotes) {\n\t\t\tconst convertedEmote = this.convertEmote(emote);\n\t\t\tif (!convertedEmote) continue;\n\n\t\t\tffzEmotes.push(convertedEmote);\n\t\t}\n\n\t\tthis.emotes.addDefaultSet('addon.seventv_emotes', 'addon.seventv_emotes.global', {\n\t\t\ttitle: globalSet.name,\n\t\t\tsource: '7TV',\n\t\t\ticon: this.setIcon,\n\t\t\temotes: ffzEmotes\n\t\t});\n\t}\n\n\tgetChannelSetID(channel) {\n\t\treturn `addon.seventv_emotes.channel-${channel.id}`;\n\t}\n\n\tgetChannelSet(channel) {\n\t\treturn this.emotes.emote_sets[this.getChannelSetID(channel)] || {};\n\t}\n\n\tsetChannelSet(channel, ffzEmotes) {\n\t\tconst setID = this.getChannelSetID(channel);\n\n\t\tchannel.removeSet('addon.seventv_emotes', setID);\n\t\tthis.emotes.unloadSet(setID);\n\n\t\tif (ffzEmotes && ffzEmotes.length > 0) {\n\t\t\tchannel.addSet('addon.seventv_emotes', setID, {\n\t\t\t\ttitle: 'Channel Emotes',\n\t\t\t\ttitle_is_channel: true,\n\t\t\t\tsource: '7TV',\n\t\t\t\ticon: this.setIcon,\n\t\t\t\temotes: ffzEmotes\n\t\t\t});\n\t\t}\n\t}\n\n\taddEmoteToChannelSet(channel, emote, force = false) {\n\t\tconst emoteSet = this.getChannelSet(channel);\n\n\t\tconst showUnlisted = this.settings.get('addon.seventv_emotes.unlisted_emotes');\n\n\t\tif (emoteSet) {\n\t\t\tif (showUnlisted || force || !this.isEmoteUnlisted(emote)) {\n\t\t\t\tconst emotes = emoteSet.emotes || {};\n\n\t\t\t\tconst convertedEmote = this.convertEmote(emote);\n\t\t\t\tif (!convertedEmote) return false;\n\n\t\t\t\temotes[emote.id] = convertedEmote;\n\n\t\t\t\tthis.setChannelSet(channel, Object.values(emotes));\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tremoveEmoteFromChannelSet(channel, emoteID) {\n\t\tconst emoteSet = this.getChannelSet(channel);\n\n\t\tif (emoteSet) {\n\t\t\tconst emotes = emoteSet.emotes || {};\n\n\t\t\tif (!emotes[emoteID]) return false;\n\n\t\t\tdelete emotes[emoteID];\n\n\t\t\tthis.setChannelSet(channel, Object.values(emotes));\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tgetEmoteFromChannelSet(channel, emoteID) {\n\t\tconst emoteSet = this.getChannelSet(channel);\n\n\t\tif (emoteSet && emoteSet.emotes) {\n\t\t\tconst ffzEmote = emoteSet.emotes[emoteID];\n\n\t\t\tif (ffzEmote && ffzEmote.SEVENTV_emote){\n\t\t\t\treturn ffzEmote.SEVENTV_emote;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tgetChannelBySetID(oldSetID, newSetID) {\n\t\tlet channelID = this.setToChannelMap.get(oldSetID);\n\t\tif (!channelID) {\n\t\t\tchannelID = this.setToChannelMap.get(newSetID);\n\t\t\tif (!channelID) return null;\n\t\t}\n\n\t\treturn this.chat.getRoom(channelID, null, true);\n\t}\n\n\tasync updateChannelSet(channel, setID = false) {\n\t\tif (this.settings.get('addon.seventv_emotes.channel_emotes')) {\n\t\t\tlet channelEmotes = {};\n\t\t\tif (setID) {\n\t\t\t\tchannelEmotes.emote_set = await this.api.emotes.fetchEmoteSet(setID);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tchannelEmotes = await this.api.emotes.fetchChannelEmotes(channel.id);\n\t\t\t}\n\n\t\t\tconst showUnlisted = this.settings.get('addon.seventv_emotes.unlisted_emotes');\n\n\t\t\tif (!channelEmotes.emote_set) return false;\n\n\t\t\tconst ffzEmotes = [];\n\t\t\tif (channelEmotes.emote_set.emotes) {\n\t\t\t\tfor (const emote of channelEmotes.emote_set.emotes) {\n\t\t\t\t\tif (showUnlisted || !this.isEmoteUnlisted(emote)) {\n\t\t\t\t\t\tconst convertedEmote = this.convertEmote(emote);\n\t\t\t\t\t\tif (!convertedEmote) continue;\n\n\t\t\t\t\t\tffzEmotes.push(convertedEmote);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.setToChannelMap.set(channelEmotes.emote_set.id, channel.id);\n\n\t\t\tthis.setChannelSet(channel, ffzEmotes);\n\t\t\treturn true;\n\t\t}\n\t\telse {\n\t\t\tthis.setChannelSet(channel, null);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\thandleChannelEmoteUpdate(body) {\n\t\tif (!this.settings.get('addon.seventv_emotes.channel_emotes')) return;\n\n\t\tlet channel;\n\t\tfor (const room of this.chat.iterateRooms()) {\n\t\t\tif (room) {\n\t\t\t\tchannel = room;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (channel) {\n\t\t\tlet action;\n\t\t\tlet dataType;\n\t\t\tlet completed = false;\n\n\t\t\tif (body.pushed) {\n\t\t\t\tdataType = 'pushed';\n\t\t\t\taction = 'ADD';\n\t\t\t} else if (body.pulled) {\n\t\t\t\tdataType = 'pulled';\n\t\t\t\taction = 'REMOVE';\n\t\t\t} else if (body.updated) {\n\t\t\t\tdataType = 'updated';\n\t\t\t\taction = 'UPDATE';\n\t\t\t} else {\n\t\t\t\t// No data, ignore\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor (const emote of body[dataType]) {\n\t\t\t\tif (emote.key !== 'emotes') continue;\n\n\t\t\t\tconst emoteId = emote.value?.id ?? emote.old_value.id;\n\t\t\t\tconst oldEmote = this.getEmoteFromChannelSet(channel, emoteId);\n\n\t\t\t\tswitch (action) {\n\t\t\t\t\tcase 'UPDATE':\n\t\t\t\t\t\tif (!oldEmote) break;\n\n\t\t\t\t\t\tcompleted = this.addEmoteToChannelSet(channel, emote.value);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'ADD':\n\t\t\t\t\t\tcompleted = this.addEmoteToChannelSet(channel, emote.value);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'REMOVE':\n\t\t\t\t\t\tcompleted = this.removeEmoteFromChannelSet(channel, emoteId);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (completed) {\n\t\t\t\t\tlet message = `${body.actor.display_name} `;\n\t\t\t\t\tswitch (action) {\n\t\t\t\t\t\tcase 'ADD': {\n\t\t\t\t\t\t\tmessage += `added the emote ${emote.value.name} (${emote.value.name})`;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase 'REMOVE': {\n\t\t\t\t\t\t\tmessage += `removed the emote ${emote.old_value.name}`;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase 'UPDATE': {\n\t\t\t\t\t\t\tif (oldEmote?.name !== emote.value.name) {\n\t\t\t\t\t\t\t\tmessage += `renamed the emote ${oldEmote.name} to ${emote.value.name} (${emote.value.name})`;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tmessage += `updated the emote ${emote.value.name} (${emote.value.name})`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst socket = this.resolve('..socket');\n\t\t\t\t\tsocket.addChatNotice(channel, message);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateChannelSets() {\n\t\tfor (const channel of this.chat.iterateRooms()) {\n\t\t\tthis.updateChannelSet(channel);\n\t\t}\n\t}\n\n\tgetBitFlag(byte, mask) {\n\t\treturn (byte & mask) == mask;\n\t}\n\n\tisZeroWidthEmote(flags) {\n\t\treturn flags === (1 << 0);\n\t}\n\n\tconvertEmote(emote) {\n\t\tconst emoteHostUrl = emote?.data?.host?.url;\n\t\tif (!emoteHostUrl) return null;\n\n\t\tconst format = this.settings.get('addon.seventv_emotes.emote_format');\n\t\tconst formatEmoteVersions = emote.data.host.files.filter((value => value.format === format));\n\t\tif (!formatEmoteVersions.length) return null;\n\n\t\tconst emoteUrls = formatEmoteVersions.reduce((acc, value, key) => {\n\t\t\tacc[key + 1] = `${emoteHostUrl}/${value.name}`;\n\t\t\treturn acc;\n\t\t}, {});\n\n\t\tlet staticEmoteUrls;\n\t\tif (emote.data.animated) {\n\t\t\tstaticEmoteUrls = formatEmoteVersions.reduce((acc, value, key) => {\n\t\t\t\tacc[key + 1] = `${emoteHostUrl}/${value.static_name}`;\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\t\t}\n\n\t\tconst ffzEmote = {\n\t\t\tid: emote.id,\n\t\t\tname: emote.name,\n\t\t\towner: {\n\t\t\t\tdisplay_name: emote.data?.owner?.display_name,\n\t\t\t\tname: emote.data?.owner?.username\n\t\t\t},\n\t\t\turls: emoteUrls,\n\t\t\tmodifier: this.isZeroWidthEmote(emote.flags),\n\t\t\tmodifier_offset: '0',\n\t\t\twidth: formatEmoteVersions[0]?.width,\n\t\t\theight: formatEmoteVersions[0]?.height,\n\t\t\tclick_url: this.api.getEmoteAppURL(emote),\n\t\t\tSEVENTV_emote: emote\n\t\t};\n\n\t\tif (staticEmoteUrls) {\n\t\t\tffzEmote.animated = ffzEmote.urls;\n\t\t\tffzEmote.urls = staticEmoteUrls;\n\t\t}\n\n\t\treturn ffzEmote;\n\t}\n\n\tisEmoteUnlisted(emote) {\n\t\treturn !emote.data.listed;\n\t}\n}\n","const { createElement } = FrankerFaceZ.utilities.dom;\n\nexport default class NametagPaints extends FrankerFaceZ.utilities.module.Module {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t\tthis.inject('settings');\n\t\tthis.inject('site.fine');\n\t\tthis.inject('chat');\n\n\t\tthis.settings.add('addon.seventv_emotes.nametag_paints', {\n\t\t\tdefault: true,\n\t\t\tui: {\n\t\t\t\tpath: 'Add-Ons > 7TV Emotes >> User Cosmetics',\n\t\t\t\ttitle: 'Nametag Paints',\n\t\t\t\tdescription: 'Show 7TV username gradients and images on users who have them set. [(7TV Subscriber Perk)](https://7tv.app/store)',\n\t\t\t\tcomponent: 'setting-check-box',\n\t\t\t}\n\t\t});\n\n\t\tthis.settings.add('addon.seventv_emotes.nametag_paints_drop_shadows', {\n\t\t\tdefault: true,\n\t\t\tui: {\n\t\t\t\tpath: 'Add-Ons > 7TV Emotes >> User Cosmetics',\n\t\t\t\ttitle: 'Nametag Paints Drop Shadows',\n\t\t\t\tdescription: 'Whether to show drop shadows for nametag paints **(Note: Too many drop shadows on screen can cause a drop in performance)**',\n\t\t\t\tcomponent: 'setting-check-box',\n\t\t\t}\n\t\t});\n\n\t\tthis.namepaintsApplyer = {\n\t\t\ttype: 'apply_namepaints',\n\n\t\t\tprocess: (tokens, msg) => {\n\t\t\t\tconst enabled = this.settings.get('addon.seventv_emotes.nametag_paints');\n\t\t\t\tif (!enabled) return;\n\n\t\t\t\tconst paintID = this.getUserPaint(msg.user.userID);\n\t\t\t\tif (!paintID) return;\n\n\t\t\t\tmsg.ffz_user_class = (msg.ffz_user_class || new Set());\n\t\t\t\tmsg.ffz_user_class.add('seventv-paint');\n\t\t\t\tmsg.ffz_user_class.add('seventv-painted-content');\n\t\t\t\tmsg.ffz_user_class.add('ffz-tooltip');\n\t\t\t\tmsg.ffz_user_class.add('ffz-tooltip--no-mouse');\n\n\t\t\t\tmsg.ffz_user_props = {\n\t\t\t\t\t'data-seventv-paint-id': paintID,\n\t\t\t\t\t'data-seventv-painted-text': true,\n\t\t\t\t\t'data-tooltip-type': 'seventv-paint'\n\t\t\t\t}\n\n\t\t\t\treturn tokens;\n\t\t\t}\n\t\t}\n\n\t\tthis.chat.addTokenizer(this.namepaintsApplyer);\n\n\t\tthis.resolve('tooltips').define('seventv-paint', target => {\n\t\t\tconst paint_id = target?.dataset?.seventvPaintId;\n\t\t\tconst paint_name = this.paints.get(paint_id)?.name;\n\n\t\t\tif (!paint_name) return FrankerFaceZ.utilities.tooltip.NoContent;\n\n\t\t\treturn createElement('span', { className: 'seventv-paint-tooltip' }, paint_name);\n\t\t});\n\n\t\tthis.paintSheet = false;\n\t\tthis.paints = new Map();\n\t\tthis.userPaints = new Map();\n\t}\n\n\tonEnable() {\n\t\tthis.on('settings:changed:addon.seventv_emotes.nametag_paints', () => this.updateChatLines());\n\t\tthis.on('settings:changed:addon.seventv_emotes.nametag_paints_drop_shadows', () => this.updatePaintSheet());\n\t}\n\n\tgetPaintStylesheet() {\n\t\tif (this.paintSheet) return this.paintSheet;\n\t\n\t\tconst link = document.createElement('link');\n\t\tlink.type = 'text/css';\n\t\tlink.rel = 'stylesheet';\n\t\n\t\tconst s = document.createElement('style');\n\t\ts.id = 'seventv-paint-styles';\n\t\n\t\tdocument.head.appendChild(s);\n\n\t\ts.sheet.insertRule(`.seventv-painted-content {\n\t\t\tbackground-color: currentcolor;\n\t\t}`);\n\t\t// The following CSS rule fixes international names not being visible when painted\n\t\ts.sheet.insertRule(`.seventv-painted-content > .chat-author__intl-login {\n\t\t\topacity: 1;\n\t\t}`);\n\t\ts.sheet.insertRule(`.seventv-painted-content[data-seventv-painted-text=\"true\"] {\n\t\t\t-webkit-text-fill-color: transparent;\n\t\t\tbackground-clip: text !important;\n\t\t\t/* stylelint-disable-next-line property-no-vendor-prefix */\n\t\t\t-webkit-background-clip: text !important;\n\t\t\tfont-weight: 700;\n\t\t}`);\n\t\ts.sheet.insertRule(`.seventv-paint-tooltip {\n\t\t\tfont-weight: 700;\n\t\t}`);\n\t\t\n\t\treturn (this.paintSheet = s.sheet ?? null);\n\t}\n\n\tgetUserPaint(id) {\n\t\treturn this.userPaints.get(id);\n\t}\n\n\tdeleteUserPaintByID(user_id, paint_id) {\n\t\tconst currentUserPaint = this.userPaints.get(user_id);\n\t\tif (!currentUserPaint || currentUserPaint !== paint_id) return;\n\n\t\tthis.userPaints.delete(user_id);\n\t\tthis.updateChatLines(user_id);\n\t}\n\n\tdeleteUserPaint(data) {\n\t\tconst paint_id = data.ref_id || data.id;\n\t\tconst user = data.user?.connections?.find(c => c.platform === 'TWITCH');\n\n\t\tif (!user?.id) return;\n\n\t\tthis.deleteUserPaintByID(user.id, paint_id);\n\t}\n\n\tsetUserPaintByID(user_id, paint_id) {\n\t\tconst currentUserPaint = this.userPaints.get(user_id);\n\t\tif (currentUserPaint === paint_id) return;\n\n\t\tthis.userPaints.set(user_id, paint_id);\n\n\t\tthis.updateChatLines(user_id);\n\t}\n\n\tsetUserPaint(data) {\n\t\tconst paint_id = data.ref_id || data.id;\n\t\tconst user = data.user?.connections?.find(c => c.platform === 'TWITCH');\n\n\t\tif (!user?.id) return;\n\n\t\tthis.setUserPaintByID(user.id, paint_id);\n\t}\n\n\tupdatePaintSheet() {\n\t\tfor (const paint of this.paints.values()) {\n\t\t\tthis.updatePaintStyle(paint);\n\t\t}\n\n\t\tthis.updateChatLines();\n\t}\n\n\tupdatePaintStyle(paint, remove = false) {\n\t\tthis.paints.set(paint.id, paint);\n\n\t\tconst sheet = this.getPaintStylesheet();\n\t\tif (!sheet) {\n\t\t\tthis.log.error('<Cosmetics>', 'Could not find paint stylesheet');\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (!paint.gradients?.length && paint.function) {\n\t\t\t// add base gradient if using v2 format\n\t\t\tif (!paint.gradients) paint.gradients = new Array(1);\n\t\t\tpaint.gradients[0] = {\n\t\t\t\tfunction: paint.function,\n\t\t\t\tcanvas_repeat: '',\n\t\t\t\tsize: [1, 1],\n\t\t\t\tshape: paint.shape,\n\t\t\t\timage_url: paint.image_url,\n\t\t\t\tstops: paint.stops ?? [],\n\t\t\t\trepeat: paint.repeat ?? false,\n\t\t\t\tangle: paint.angle,\n\t\t\t};\n\t\t}\n\t\t\n\t\tconst gradients = paint.gradients.map(g => this.createGradientFromPaint(g));\n\t\t\n\t\tconst drop_shadows_enabled = this.settings.get('addon.seventv_emotes.nametag_paints_drop_shadows');\n\t\t\n\t\tconst filter = (() => {\n\t\t\tif (!drop_shadows_enabled || !paint.shadows) {\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\n\t\t\treturn paint.shadows.map(v => this.createFilterDropshadow(v)).join(' ');\n\t\t})();\n\t\t\n\t\tconst selector = `.seventv-paint[data-seventv-paint-id=\"${paint.id}\"]`;\n\t\tconst text = `${selector} {\n\t\t\tcolor: ${paint.color ? this.getCSSColorFromInt(paint.color) : 'inherit'};\n\t\t\tbackground-image: ${gradients.map(v => v[0]).join(', ')};\n\t\t\tbackground-position: ${gradients.map(v => v[1]).join(', ')};\n\t\t\tbackground-size: ${gradients.map(v => v[2]).join(', ')};\n\t\t\tbackground-repeat: ${gradients.map(v => v[3]).join(', ')};\n\t\t\tfilter: ${filter || 'inherit'};\n\t\t\t${\n\tpaint.text\n\t\t? `\n\t\t\t\t\t\tfont-weight: ${paint.text.weight ? paint.text.weight * 100 : 'inherit'};\n\t\t\t\t\t\t-webkit-text-stroke-width: ${paint.text.stroke ? `${paint.text.stroke.width}px` : 'inherit'};\n\t\t\t\t\t\t-webkit-text-stroke-color: ${paint.text.stroke ? this.getCSSColorFromInt(paint.text.stroke.color) : 'inherit'};\n\t\t\t\t\t\ttext-shadow: ${\n\tpaint.text.shadows\n\t\t?.map(v => `${v.x_offset}px ${v.y_offset}px ${v.radius}px ${this.getCSSColorFromInt(v.color)}`)\n\t\t.join(', ') ?? 'unset'\n};\n\t\t\t\t\ttext-transform: ${paint.text.transform ?? 'unset'};\n\t\t\t\t\t`\n\t\t: ''\n}\n\t\t}\n\t\t`;\n\t\t\n\t\tlet currentIndex = -1;\n\t\tfor (let i = 0; i < sheet.cssRules.length; i++) {\n\t\t\tconst r = sheet.cssRules[i];\n\t\t\tif (!(r instanceof CSSStyleRule)) continue;\n\t\t\tif (r.selectorText !== selector) continue;\n\t\t\n\t\t\tcurrentIndex = i;\n\t\t\tbreak;\n\t\t}\n\n\t\tif (remove) {\n\t\t\tif (currentIndex >= 0) {\n\t\t\t\tsheet.deleteRule(currentIndex);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tif (currentIndex >= 0) {\n\t\t\tsheet.deleteRule(currentIndex);\n\t\t\tsheet.insertRule(text, currentIndex);\n\t\t} else {\n\t\t\tsheet.insertRule(text, sheet.cssRules.length);\n\t\t}\n\t}\n\n\tcreateGradientFromPaint(gradient) {\n\t\tconst result = ['', '', '', ''];\n\t\n\t\tconst args = [];\n\t\tswitch (gradient.function) {\n\t\t\tcase 'LINEAR_GRADIENT': // paint is linear gradient\n\t\t\t\targs.push(`${gradient.angle ?? 0}deg`);\n\t\t\t\tbreak;\n\t\t\tcase 'RADIAL_GRADIENT': // paint is radial gradient\n\t\t\t\targs.push(gradient.shape ?? 'circle');\n\t\t\t\tbreak;\n\t\t\tcase 'URL': // paint is an image\n\t\t\t\targs.push(gradient.image_url ?? '');\n\t\t\t\tbreak;\n\t\t}\n\t\tlet funcPrefix = '';\n\t\tif (gradient.function !== 'URL') {\n\t\t\tfuncPrefix = gradient.repeat ? 'repeating-' : '';\n\t\n\t\t\tfor (const stop of gradient.stops) {\n\t\t\t\tconst color = this.getCSSColorFromInt(stop.color);\n\t\t\t\targs.push(`${color} ${stop.at * 100}%`);\n\t\t\t}\n\t\t}\n\t\n\t\tresult[0] = `${funcPrefix}${gradient.function.toLowerCase().replace('_', '-')}(${args.join(', ')})`;\n\t\tresult[1] = gradient.at && gradient.at.length === 2 ? `${gradient.at[0] * 100}% ${gradient.at[1] * 100}%` : '';\n\t\tresult[2] =\n\t\t\tgradient.size && gradient.size.length === 2 ? `${gradient.size[0] * 100}% ${gradient.size[1] * 100}%` : '';\n\t\tresult[3] = gradient.canvas_repeat ?? 'unset';\n\t\n\t\treturn result;\n\t}\n\t\n\tcreateFilterDropshadow(shadow) {\n\t\treturn `drop-shadow(${shadow.x_offset}px ${shadow.y_offset}px ${shadow.radius}px ${this.getCSSColorFromInt(\n\t\t\tshadow.color,\n\t\t)})`;\n\t}\n\n\tgetCSSColorFromInt(int) {\n\t\tconst red = int >>> 24 & 0xFF;\n\t\tconst green = int >>> 16 & 0xFF;\n\t\tconst blue = int >>> 8 & 0xFF;\n\t\tconst alpha = int & 0xFF;\n\n\t\treturn `rgba(${red}, ${green}, ${blue}, ${alpha / 255})`\n\t}\n\n\tupdateChatLines(user_id = undefined) {\n\t\tconst enabled = this.settings.get('addon.seventv_emotes.nametag_paints');\n\n\t\tfor(const { message, update } of this.chat.iterateMessages()) {\n\t\t\tconst user = message.user;\n\t\t\tif (user_id !== undefined && user.userID !== user_id) continue;\n\n\t\t\tconst paintID = enabled ? this.getUserPaint(user.userID) : null;\n\n\t\t\tif (paintID) {\n\t\t\t\tmessage.ffz_user_class = (message.ffz_user_class || new Set());\n\t\t\t\tmessage.ffz_user_class.add('seventv-paint');\n\t\t\t\tmessage.ffz_user_class.add('seventv-painted-content');\n\t\t\t\tmessage.ffz_user_class.add('ffz-tooltip');\n\t\t\t\tmessage.ffz_user_class.add('ffz-tooltip--no-mouse');\n\n\t\t\t\tmessage.ffz_user_props = {\n\t\t\t\t\t...message.ffz_user_props,\n\t\t\t\t\t'data-seventv-paint-id': paintID,\n\t\t\t\t\t'data-seventv-painted-text': true,\n\t\t\t\t\t'data-tooltip-type': 'seventv-paint'\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tmessage.ffz_user_class = (message.ffz_user_class || new Set());\n\t\t\t\tmessage.ffz_user_class.delete('seventv-paint');\n\t\t\t\tmessage.ffz_user_class.delete('seventv-painted-content');\n\t\t\t\tmessage.ffz_user_class.delete('ffz-tooltip');\n\t\t\t\tmessage.ffz_user_class.delete('ffz-tooltip--no-mouse');\n\n\t\t\t\tif (message.ffz_user_props?.['data-seventv-paint-id']) {\n\t\t\t\t\tdelete message.ffz_user_props['data-seventv-paint-id'];\n\t\t\t\t\tdelete message.ffz_user_props['data-seventv-painted-text'];\n\t\t\t\t\tdelete message.ffz_user_props['data-tooltip-type'];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tupdate();\n\t\t}\n\t}\n}\n","export default class PersonalEmotes extends FrankerFaceZ.utilities.module.Module {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t\tthis.injectAs('seventv_emotes', '..emotes');\n\n\t\tthis.inject('settings');\n\t\tthis.inject('chat');\n\t\tthis.inject('chat.emotes');\n\n\t\tthis.setIcon = this.parent.manifest.icon;\n\n\t\tthis.settings.add('addon.seventv_emotes.personal_emotes', {\n\t\t\tdefault: true,\n\t\t\tui: {\n\t\t\t\tpath: 'Add-Ons > 7TV Emotes >> Emotes',\n\t\t\t\ttitle: 'Personal Emotes',\n\t\t\t\tdescription: 'Enables personal emotes from 7TV.',\n\t\t\t\tcomponent: 'setting-check-box',\n\t\t\t}\n\t\t});\n\n\t\t// 7TV Set ID -> Emote Set\n\t\tthis.emoteSets = new Map();\n\n\t\t// Twitch User ID -> Set(7TV Set ID)\n\t\tthis.userToSetsMap = new Map();\n\t\t\n\t\t// 7TV Set ID -> Set(Twitch User ID)\n\t\tthis.setToUsersMap = new Map();\n\t}\n\n\tonEnable() {\n\t\tthis.on('settings:changed:addon.seventv_emotes.personal_emotes', () => this.updatePersonalSets());\n\t}\n\n\tupdatePersonalSets() {\n\t\tfor (const setID of this.emoteSets.keys()) {\n\t\t\tthis.reloadSet(setID);\n\t\t}\n\t}\n\n\tgetSetID(setID) {\n\t\treturn `addon.seventv_emotes.personal-${setID}`;\n\t}\n\n\tcreatePersonalSet(set_id, set_name) {\n\t\t// In case the set was created before this method\n\t\tconst _emoteSet = this.emoteSets.get(set_id);\n\n\t\tthis.emoteSets.set(set_id, {\n\t\t\tid: _emoteSet?.id || set_id,\n\t\t\tname: _emoteSet?.name || set_name,\n\t\t\temotes: _emoteSet?.emotes || {}\n\t\t});\n\n\t\tif (_emoteSet?.id) {\n\t\t\tthis.reloadSet(set_id);\n\t\t}\n\t}\n\n\tgetPersonalSet(set_id) {\n\t\tif (!this.emoteSets.has(set_id)) {\n\t\t\tthis.emoteSets.set(set_id, {\n\t\t\t\temotes: {}\n\t\t\t});\n\t\t}\n\n\t\treturn this.emoteSets.get(set_id);\n\t}\n\n\taddUserToSets(user_id, set_id) {\n\t\tconst userToSets = this.userToSetsMap.get(user_id) || new Set();\n\t\tuserToSets.add(set_id);\n\t\tthis.userToSetsMap.set(user_id, userToSets);\n\t\t\n\t\tconst setToUsers = this.setToUsersMap.get(set_id) || new Set();\n\t\tsetToUsers.add(user_id);\n\t\tthis.setToUsersMap.set(set_id, setToUsers);\n\n\t\tthis.chat\n\t\t\t.getUser(user_id)\n\t\t\t.addSet('addon.seventv_emotes', this.getSetID(set_id));\n\t}\n\n\tgrantSetToUser(data) {\n\t\tconst setID = data.ref_id;\n\t\tconst user = data.user.connections.find(c => c.platform === 'TWITCH');\n\n\t\tthis.addUserToSets(user.id, setID);\n\t}\n\n\tupdateSet(body) {\t\t\n\t\tif (!this.settings.get('addon.seventv_emotes.personal_emotes')) return;\n\n\t\tlet action;\n\t\tlet dataType;\n\n\t\tif (body.pushed) {\n\t\t\tdataType = 'pushed';\n\t\t\taction = 'ADD';\n\t\t} else if (body.pulled) {\n\t\t\tdataType = 'pulled';\n\t\t\taction = 'REMOVE';\n\t\t} else if (body.updated) {\n\t\t\tdataType = 'updated';\n\t\t\taction = 'UPDATE';\n\t\t} else {\n\t\t\t// No data, ignore\n\t\t\treturn;\n\t\t}\n\n\t\tconst setID = body.id;\n\n\t\tfor (const emote of body[dataType]) {\n\t\t\tif (emote.key !== 'emotes') continue;\n\t\t\t\n\t\t\tconst emoteId = emote.value?.id ?? emote.old_value.id;\n\t\t\tconst oldEmote = this.getEmoteFromSet(setID, emoteId);\n\t\t\t\n\t\t\tswitch (action) {\n\t\t\t\tcase 'UPDATE':\n\t\t\t\t\tif (!oldEmote) break;\n\n\t\t\t\t\tthis.addEmoteToSet(setID, emote.value);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ADD':\n\t\t\t\t\tthis.addEmoteToSet(setID, emote.value);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'REMOVE':\n\t\t\t\t\tthis.removeEmoteFromSet(setID, emoteId);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.reloadSet(setID);\n\t}\n\n\treloadSet(setID) {\n\t\tif(!this.settings.get('addon.seventv_emotes.personal_emotes')) {\n\t\t\tconst userIDs = this.setToUsersMap.get(setID);\n\t\t\tif (userIDs?.size) {\n\t\t\t\tfor (const userID of userIDs) {\n\t\t\t\t\tthis.chat\n\t\t\t\t\t\t.getUser(userID)\n\t\t\t\t\t\t.removeSet('addon.seventv_emotes', this.getSetID(setID));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.emotes.unloadSet(this.getSetID(setID), true, true);\n\t\t\treturn;\n\t\t}\n\n\t\tconst showUnlisted = this.settings.get('addon.seventv_emotes.unlisted_emotes');\n\n\t\tconst set = this.getPersonalSet(setID);\n\n\t\tconst emotes = [];\n\n\t\tfor (const [, emote] of Object.entries(set.emotes)) {\n\t\t\tif (showUnlisted || !this.seventv_emotes.isEmoteUnlisted(emote)) {\n\t\t\t\tconst convertedEmote = this.seventv_emotes.convertEmote(emote);\n\t\t\t\tif (!convertedEmote) continue;\n\n\t\t\t\temotes.push(convertedEmote);\n\t\t\t}\n\t\t}\n\n\t\tif (emotes.length) {\n\t\t\tconst ffzSet = {\n\t\t\t\ttitle: set.name,\n\t\t\t\tsource: '7TV',\n\t\t\t\ticon: this.setIcon,\n\t\t\t\tpersonal: true,\n\t\t\t\tsort: 50,\n\t\t\t\temotes\n\t\t\t};\n\n\t\t\tthis.emotes.loadSetData(this.getSetID(setID), ffzSet, true);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tgetEmoteFromSet(setID, emoteID) {\n\t\tconst set = this.getPersonalSet(setID);\n\n\t\tif (!set?.emotes) return null;\n\t\t\n\t\treturn set.emotes[emoteID];\n\t}\n\n\taddEmoteToSet(setID, emote) {\n\t\tconst isPersonal = emote?.data?.state?.includes('PERSONAL');\n\t\tif (!isPersonal) return false;\n\n\t\tconst set = this.getPersonalSet(setID);\n\t\tset.emotes[emote.id] = emote;\n\n\t\treturn true;\n\t}\n\n\tremoveEmoteFromSet(setID, emoteID) {\n\t\tconst set = this.getPersonalSet(setID);\n\t\tif (!set.emotes[emoteID]) return false;\n\n\t\tdelete set.emotes[emoteID];\n\t\t\n\t\treturn true;\n\t}\n}","const OPCODES = {\n\t// -- Server -> Client\n\tDISPATCH: 0,\n\tHELLO: 1,\n\tHEARTBEAT: 2,\n\tRECONNECT: 4,\n\tACK: 5,\n\tERROR: 6,\n\tEND_OF_STREAM: 7,\n\n\t// -- Client -> Server\n\tIDENTIFY: 33,\n\tRESUME: 34,\n\tSUBSCRIBE: 35,\n\tUNSUBSCRIBE: 36,\n\tSIGNAL: 37,\n\tBRIDGE: 38\n}\n\nexport default class Socket extends FrankerFaceZ.utilities.module.Module {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t\tthis.inject('chat');\n\t\tthis.inject('settings');\n\t\tthis.inject('site');\n\t\tthis.injectAs('siteChat', 'site.chat');\n\t\tthis.injectAs('stv_api', '..api');\n\t\tthis.injectAs('emotes', '..emotes');\n\t\tthis.injectAs('personal_emotes', '..personal-emotes');\n\t\tthis.injectAs('nametag_paints', '..nametag-paints');\n\t\tthis.injectAs('badges', '..badges');\n\t\tthis.injectAs('avatars', '..avatars');\n\n\t\tthis.settings.add('addon.seventv_emotes.update_messages', {\n\t\t\tdefault: true,\n\t\t\tui: {\n\t\t\t\tpath: 'Add-Ons > 7TV Emotes >> Emotes > Live Emote Updates',\n\t\t\t\ttitle: 'Show update messages',\n\t\t\t\tdescription: 'Show messages in chat when emotes are updated in the current channel.',\n\t\t\t\tcomponent: 'setting-check-box',\n\t\t\t}\n\t\t});\n\n\t\tthis.OPCODES = OPCODES;\n\n\t\tthis.socket = false;\n\t\tthis._socket_buffer = [];\n\t\tthis._connected = false;\n\t\tthis._connecting = false;\n\t\tthis._connect_attempts = 0;\n\n\t\tthis._session_id = '';\n\t\tthis._last_presence_at = 0;\n\n\t\tthis._user_id = false;\n\t\tthis._active_channel_set = false;\n\t\tthis._subscriptions = {};\n\t\tthis._rooms = {};\n\t}\n\n\tonEnable() {\n\t\tthis.on('chat:room-add', this.roomAdd);\n\t\tthis.on('chat:room-remove', this.roomRemove);\n\t\tthis.on('chat:receive-message', this.onReceiveMessage);\n\n\t\tthis.get7TVUserData();\n\t}\n\n\titerateRooms() {\n\t\tfor (const room of this.chat.iterateRooms()) {\n\t\t\tif (room) this.roomAdd(room);\n\t\t}\n\t}\n\n\tasync get7TVUserData() {\n\t\tconst user = this.site.getUser();\n\t\tif (user) {\n\t\t\tconst resp = await this.stv_api.user.fetchUserData(user.id);\n\t\n\t\t\tthis._user_id = resp?.user?.id || false;\n\t\t}\n\n\t\tthis.connect();\n\t}\n\n\tonReceiveMessage(msg) {\n\t\tif (!this._user_id) return;\n\n\t\tconst user = this.site.getUser();\n\t\tif (!user) return;\n\n\t\tconst msg_user_id = msg.message.user.id;\n\t\tif (user.id !== msg_user_id) return;\n\n\t\tthis.sendPresences(false, msg.message.roomID);\n\t}\n\n\tsendPresences(self = false, room_id = undefined) {\n\t\tif (!this._user_id) return;\n\n\t\t// Only send a presence at most every 10 seconds\n\t\tif (this._last_presence_at && this._last_presence_at > Date.now() - 1000 * 10)\n\t\t\treturn;\n\n\t\tthis._last_presence_at = Date.now();\n\n\t\tif (room_id) {\n\t\t\tthis.stv_api.user.updateUserPresences(this._user_id, room_id, self, this._session_id);\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const room of this.chat.iterateRooms()) {\n\t\t\tif (room) {\n\t\t\t\tthis.stv_api.user.updateUserPresences(this._user_id, room.id, self, this._session_id);\n\t\t\t}\n\t\t}\n\n\t\tthis._last_presence_at = Date.now();\n\t}\n\n\tasync roomAdd(room) {\n\t\tif (!room) return;\n\n\t\tthis._rooms[room.id] = {};\n\n\t\tconst stv_room = await this.stv_api.emotes.fetchChannelEmotes(room.id);\n\t\tif (stv_room?.emote_set?.id) {\n\t\t\tthis._rooms[room.id] = stv_room;\n\t\n\t\t\tconst set_id = stv_room.emote_set.id;\n\t\t\tthis._active_channel_set = set_id;\n\n\t\t\tthis.subscribe('emote_set.update', {\n\t\t\t\tobject_id: set_id\n\t\t\t});\n\n\t\t\tthis.subscribe('user.*', {\n\t\t\t\tobject_id: stv_room.user.id\n\t\t\t});\n\t\t}\n\n\t\tthis.subscribe('emote_set.*', {\n\t\t\tctx: 'channel',\n\t\t\tid: room.id,\n\t\t\tplatform: 'TWITCH'\n\t\t});\n\n\t\tthis.subscribe('cosmetic.*', {\n\t\t\tctx: 'channel',\n\t\t\tid: room.id,\n\t\t\tplatform: 'TWITCH'\n\t\t});\n\n\t\tthis.subscribe('entitlement.*', {\n\t\t\tctx: 'channel',\n\t\t\tid: room.id,\n\t\t\tplatform: 'TWITCH'\n\t\t});\n\n\t\tif (this._user_id) {\n\t\t\tthis.sendPresences(true, room.id);\n\t\t}\n\t}\n\n\troomRemove(room) {\n\t\tif (!room) return;\n\n\t\tconst stv_room = this._rooms[room.id];\n\t\tif (!stv_room) return;\n\n\t\tif (stv_room?.emote_set?.id) {\n\t\t\tthis.unsubscribe('emote_set.update', {\n\t\t\t\tobject_id: stv_room.emote_set.id\n\t\t\t});\n\n\t\t\tthis.unsubscribe('user.*', {\n\t\t\t\tobject_id: stv_room.user.id\n\t\t\t});\n\t\t}\n\n\t\tthis.unsubscribe('emote_set.*', {\n\t\t\tctx: 'channel',\n\t\t\tid: room.id,\n\t\t\tplatform: 'TWITCH'\n\t\t});\n\n\t\tthis.unsubscribe('cosmetic.*', {\n\t\t\tctx: 'channel',\n\t\t\tid: room.id,\n\t\t\tplatform: 'TWITCH'\n\t\t});\n\n\t\tthis.unsubscribe('entitlement.*', {\n\t\t\tctx: 'channel',\n\t\t\tid: room.id,\n\t\t\tplatform: 'TWITCH'\n\t\t});\n\n\t\tthis.unsubscribe('user.*', {\n\t\t\tctx: 'channel',\n\t\t\tid: room.id,\n\t\t\tplatform: 'TWITCH'\n\t\t});\n\n\t\tdelete this._rooms[room.id];\n\t}\n\n\taddChatNotice(channel, message, tokenize = true) {\n\t\tif (!this.settings.get('addon.seventv_emotes.update_messages')) return;\n\t\t\n\t\tthis.siteChat.addNotice(channel.login, {\n\t\t\tmessage,\n\t\t\ticon: new URL('https://cdn2.frankerfacez.com/static/addons/7tv-emotes/logo.png'),\n\t\t\ttokenize\n\t\t});\n\t}\n\n\tonMessage({ op: opcode, d: _data }) {\n\t\tif (opcode === OPCODES.HELLO) {\n\t\t\tthis._session_id = _data.session_id;\n\n\t\t\tif (this._socket_buffer.length) {\n\t\t\t\tfor (const data of this._socket_buffer) {\n\t\t\t\t\tthis._emitSocket(data);\n\t\t\t\t}\n\n\t\t\t\tthis._socket_buffer = [];\n\t\t\t}\n\n\t\t\tthis.iterateRooms();\n\t\t}\n\t\telse if (opcode === OPCODES.DISPATCH) {\n\t\t\tconst { type, body } = _data;\n\t\t\tif (type === 'emote_set.update') {\n\t\t\t\tif (body.id === this._active_channel_set) {\n\t\t\t\t\tthis.emotes.handleChannelEmoteUpdate(body);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.personal_emotes.updateSet(body);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (type === 'emote_set.create') {\n\t\t\t\tconst { id, name } = body.object;\n\t\t\t\tthis.personal_emotes.createPersonalSet(id, name);\n\t\t\t}\n\t\t\telse if (type === 'cosmetic.create') {\n\t\t\t\tconst { kind, data } = body.object;\n\t\t\t\tif (kind === 'PAINT') {\n\t\t\t\t\tthis.nametag_paints.updatePaintStyle(data);\n\t\t\t\t}\n\t\t\t\telse if (kind === 'BADGE') {\n\t\t\t\t\tthis.badges.addBadge(data);\n\t\t\t\t}\n\t\t\t\t// Deprecated because it was causing too many issues on their websocket\n\t\t\t\t// It's using an API endpoint now\n\t\t\t\t// else if (kind === 'AVATAR') {\n\t\t\t\t// \tthis.avatars.receiveAvatarData(data);\n\t\t\t\t// }\n\t\t\t}\n\t\t\telse if (type === 'entitlement.create') {\n\t\t\t\tconst object = body.object;\n\t\t\t\tif (object?.kind === 'PAINT') {\n\t\t\t\t\tthis.nametag_paints.setUserPaint(object);\n\t\t\t\t}\n\t\t\t\telse if (object?.kind === 'BADGE') {\n\t\t\t\t\tthis.badges.addUserBadge(object);\n\t\t\t\t}\n\t\t\t\telse if (object?.kind === 'EMOTE_SET') {\n\t\t\t\t\tthis.personal_emotes.grantSetToUser(object);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (type === 'entitlement.delete') {\n\t\t\t\tconst object = body.object;\n\t\t\t\tif (object?.kind === 'PAINT') {\n\t\t\t\t\tthis.nametag_paints.deleteUserPaint(object);\n\t\t\t\t}\n\t\t\t\telse if (object?.kind === 'BADGE') {\n\t\t\t\t\tthis.badges.removeUserBadge(object);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (type === 'user.update') {\n\t\t\t\tif (!body.updated?.length) return;\n\n\t\t\t\tfor (const updates of body.updated) {\n\t\t\t\t\tfor (const value of updates.value) {\n\t\t\t\t\t\tif (value.key === 'emote_set') {\n\t\t\t\t\t\t\tconst oldSet = value.old_value;\n\t\t\t\t\t\t\tconst newSet = value.value;\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tconst channel = this.emotes.getChannelBySetID(oldSet.id, newSet.id);\n\t\t\t\t\t\t\tif (!channel) continue;\n\t\n\t\t\t\t\t\t\tthis.unsubscribe('emote_set.update', {\n\t\t\t\t\t\t\t\tobject_id: oldSet.id\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\tthis.subscribe('emote_set.update', {\n\t\t\t\t\t\t\t\tobject_id: newSet.id\n\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\tthis._active_channel_set = newSet.id;\n\t\n\t\t\t\t\t\t\tthis.emotes.updateChannelSet(channel, newSet.id);\n\t\t\t\t\t\t\tthis.addChatNotice(channel, `${body.actor.display_name} updated the active emote set to ${newSet.name}`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t// TODO: Empty data / \"updated\" array when setting to \"No Paint\" or \"No Badge\"\n\t\t\t\t\t\t// if (value.key === 'badge') {\n\t\t\t\t\t\t// \tthis.badges.addBadge(value.value);\n\n\t\t\t\t\t\t// \tconst user = body.actor.connections.find(c => c.platform === 'TWITCH');\n\n\t\t\t\t\t\t// \tthis.badges.removeUserBadgeByID(user.id, value.old_value.id);\n\t\t\t\t\t\t// \tthis.badges.addUserBadgeByID(user.id, value.value.id);\n\t\t\t\t\t\t// }\n\n\t\t\t\t\t\t// if (value.key === 'paint') {\n\t\t\t\t\t\t// \tthis.nametag_paints.updatePaintStyle(value.value);\n\n\t\t\t\t\t\t// \tconst user = body.actor.connections.find(c => c.platform === 'TWITCH');\n\n\t\t\t\t\t\t// \tthis.nametag_paints.setUserPaintByID(user.id, value.id);\n\t\t\t\t\t\t// }\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.log.debug(`Type '${type}' not implemented.`, body);\n\t\t\t}\n\t\t}\n\t\telse if (opcode === OPCODES.ACK) {\n\t\t\tconst { command, data } = _data;\n\t\t\tif (command === 'SUBSCRIBE') {\n\t\t\t\tconst sub = this.findSubscription(data.type, data.condition);\n\t\t\t\tif (!sub) return;\n\n\t\t\t\tsub._acked = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tconnect(is_planned_reconnect = false) {\n\t\tif (this._connected || this._connecting) {\n\t\t\treturn;\n\t\t}\n\t\tthis._connecting = true;\n\n\t\tif (!is_planned_reconnect) {\n\t\t\tthis.log.info('Socket: Connecting to socket server...');\n\t\t}\n\n\t\tthis.socket = new WebSocket(`wss://events.7tv.io/v3?app=ffz&version=${__addon_version__}`);\n\n\t\tthis.socket.onopen = () => {\n\t\t\tif (!is_planned_reconnect) {\n\t\t\t\tthis.log.info('Socket: Connected to socket server.');\n\t\t\t}\n\n\t\t\tthis._connected = true;\n\t\t\tthis._connecting = false;\n\t\t\tthis._connect_attempts = 0;\n\t\t};\n\n\t\tthis.socket.onerror = () => {\n\t\t\tthis.log.error('Socket: Error from socket server.');\n\n\t\t\tthis.reconnect();\n\t\t};\n\n\t\tthis.socket.onclose = evt => {\n\t\t\tif (!this._connected || !this.socket) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst is_planned_reconnect = evt.code === 4012;\n\t\t\tif (!is_planned_reconnect) {\n\t\t\t\tthis.log.info('Socket: Lost connection to socket server...', evt);\n\n\t\t\t\tthis._connect_attempts++;\n\t\t\t}\n\n\t\t\tthis._subscriptions = {};\n\t\t\tthis._rooms = {};\n\n\t\t\tthis.reconnect(is_planned_reconnect);\n\t\t};\n\n\t\tthis.socket.onmessage = message => {\n\t\t\tlet evt;\n\n\t\t\ttry {\n\t\t\t\tevt = JSON.parse(message.data);\n\t\t\t} catch (e) {\n\t\t\t\tthis.log.error('Socket: Error parsing message', e);\n\t\t\t}\n\n\t\t\tthis.onMessage(evt);\n\t\t};\n\t}\n\n\treconnect(is_planned_reconnect = false) {\n\t\tthis.disconnect();\n\n\t\tif (!is_planned_reconnect) {\n\t\t\tthis.log.info('Socket: Trying to reconnect to socket server...');\n\t\t}\n\n\t\t// Optimally this should always end up being 0 on a normal disconnect (End of Stream event)\n\t\t// meaning we'll pretty much immediately reconnect\n\t\t//\n\t\t// Just to be safe though, we will make sure the minimum is 0 seconds so we don't go into the negative.\n\t\tconst delay = Math.max(0, Math.random() * (Math.pow(2, this._connect_attempts) - 1) * 3000);\n\n\t\tthis._connect_attempts++;\n\n\t\tsetTimeout(() => {\n\t\t\tthis.connect(is_planned_reconnect);\n\t\t}, delay);\n\t}\n\n\tdisconnect() {\n\t\tif (this.socket) {\n\t\t\ttry {\n\t\t\t\tthis.socket.close();\n\t\t\t} catch (e) {\n\t\t\t\t// Error\n\t\t\t}\n\t\t}\n\n\t\tdelete this.socket;\n\n\t\tthis._connected = false;\n\t\tthis._connecting = false;\n\t}\n\n\tdisconnectInternal() {\n\t\tthis.disconnect();\n\n\t\tthis.log.info('Socket: Disconnected from socket server.');\n\t}\n\n\temitSocket(data) {\n\t\tif (!this._connected || !this.socket) {\n\t\t\tthis._socket_buffer.push(data);\n\t\t\treturn;\n\t\t}\n\n\t\tthis._emitSocket(data);\n\t}\n\n\t_emitSocket(data) {\n\t\tthis.socket?.send(JSON.stringify(data));\n\t}\n\n\tisSubscribed(type, condition) {\n\t\tconst subs = this._subscriptions[type];\n\t\tif (!subs || !subs.length) return false;\n\n\t\treturn subs.some(c => Object.entries(condition).every(([key, value]) => c.condition[key] === value));\n\t}\n\n\tfindSubscription(type, condition) {\n\t\tconst subs = this._subscriptions[type];\n\t\tif (!subs || !subs.length) return null;\n\n\t\tif (!condition) {\n\t\t\treturn subs;\n\t\t}\n\n\t\treturn subs.find(c => Object.entries(condition).every(([key, value]) => c.condition[key] === value)) ?? null;\n\t}\t\n\n\tsubscribe(type, condition) {\n\t\tconst sub = this.findSubscription(type, condition);\n\t\tif (sub) return; \n\n\t\tthis.emitSocket({\n\t\t\top: OPCODES.SUBSCRIBE,\n\t\t\td: {\n\t\t\t\ttype,\n\t\t\t\tcondition\n\t\t\t}\n\t\t});\n\n\t\tif (!Array.isArray(this._subscriptions[type])) {\n\t\t\tthis._subscriptions[type] = [];\n\t\t}\n\n\t\tthis._subscriptions[type].push({\n\t\t\tcondition\n\t\t});\n\t}\n\n\tunsubscribe(type, condition = undefined) {\n\t\tconst sub = this.findSubscription(type, condition);\n\t\tif (!sub || !sub._acked) return;\n\n\t\tconst data = {\n\t\t\ttype,\n\t\t\tcondition\n\t\t};\n\n\t\tthis.emitSocket({\n\t\t\top: OPCODES.UNSUBSCRIBE,\n\t\t\td: data\n\t\t});\n\n\t\tif (!condition) {\n\t\t\tthis._subscriptions[type] = [];\n\t\t}\n\t\telse {\n\t\t\tthis._subscriptions[type] = this._subscriptions[type].filter(c => c !== sub);\n\t\t}\n\t}\n}\n","var map = {\n\t\"./api.js\": 810,\n\t\"./avatars.js\": 6721,\n\t\"./badges.js\": 1542,\n\t\"./emotes.js\": 3833,\n\t\"./nametag-paints.js\": 9535,\n\t\"./personal-emotes.js\": 9102,\n\t\"./socket.js\": 1363\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 6058;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","class SevenTVEmotes extends Addon {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t\tthis.inject('addons');\n\n\t\tthis.addonID = this.name.replace(/^addon\\./, '');\n\n\t\tthis.manifest = this.addons.getAddon(this.addonID);\n\t}\n\n\tasync onLoad() {\n\t\tconst context = await require.context('./modules', false, /\\.js$/);\n\t\tawait this.loadFromContext(context);\n\t}\n\n\tonEnable() {\n\t\tfor (const child of Object.values(this.children)) {\n\t\t\tchild.enable();\n\t\t}\n\t}\n}\n\nSevenTVEmotes.register();"],"names":["args","User","Emotes","Cosmetics","route","options","skip_cache","headers","request","response","json","emote","API","user_id","channel_id","self","session_id","channelId","setID","identifiers","event","url","data","login","waiter","webpEmoteVersions","value","highestQuality","entry","promise","resolve","timer","onDone","waiting","avatars","body","enabled","avatar","avatarComponent","e","current_url","Avatars","SUB_BADGE_REGEX","badge_id","userSet","user","badge","host","id","title","subtext","split","badgeData","userBadges","c","Badges","flags","channel","globalSet","ffzEmotes","convertedEmote","force","emoteSet","showUnlisted","emotes","emoteID","ffzEmote","oldSetID","newSetID","channelID","channelEmotes","room","action","dataType","completed","emoteId","oldEmote","message","byte","mask","emoteHostUrl","format","formatEmoteVersions","emoteUrls","acc","key","staticEmoteUrls","createElement","tokens","msg","paintID","target","paint_id","paint_name","link","s","currentUserPaint","paint","remove","sheet","gradients","g","drop_shadows_enabled","filter","v","selector","text","currentIndex","i","r","gradient","result","funcPrefix","stop","color","shadow","int","red","green","blue","alpha","update","NametagPaints","set_id","set_name","_emoteSet","userToSets","setToUsers","userIDs","userID","set","ffzSet","PersonalEmotes","OPCODES","resp","msg_user_id","room_id","stv_room","tokenize","opcode","_data","type","name","kind","object","updates","oldSet","newSet","command","sub","is_planned_reconnect","evt","delay","condition","subs","Socket","map","webpackContext","req","webpackContextResolve","__webpack_require__","module","__webpack_module_cache__","moduleId","cachedModule","__webpack_modules__","exports","definition","obj","prop","context","child","SevenTVEmotes"],"sourceRoot":""}