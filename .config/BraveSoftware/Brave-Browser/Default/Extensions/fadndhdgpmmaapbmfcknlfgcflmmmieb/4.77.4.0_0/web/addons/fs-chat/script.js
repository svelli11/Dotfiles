(()=>{var M=Object.defineProperty;var f=(F,x)=>M(F,"name",{value:x,configurable:!0});(()=>{var F={388:function(h){/*!
 * displacejs.js 1.3.2 - Tiny javascript library to create moveable DOM elements.
 * Copyright (c) 2019 Catalin Covic - https://github.com/catc/displace
 * License: MIT
 */(function(l,n){h.exports=n()})(this,function(){return function(l){function n(g){if(u[g])return u[g].exports;var m=u[g]={exports:{},id:g,loaded:!1};return l[g].call(m.exports,m,m.exports,n),m.loaded=!0,m.exports}f(n,"t");var u={};return n.m=l,n.c=u,n.p="",n(0)}([function(l,n,u){"use strict";function g(d){return d&&d.__esModule?d:{default:d}}f(g,"n");var m=u(1),p=g(m);l.exports=p.default},function(l,n,u){"use strict";function g(i,s){if(!(i instanceof s))throw new TypeError("Cannot call a class as a function")}f(g,"n");function m(){var i=this,s=this.el,t=this.opts||a,e={};if(s.style.position="absolute",this.handle=t.handle||s,t.constrain){for(var r=t.relativeTo||s.parentNode,o=s,b=0,y=0;o!==r;)o=o.parentNode,(0,p.isRelative)(o)&&(b-=o.offsetLeft,y-=o.offsetTop),o===r&&(b+=o.offsetLeft,y+=o.offsetTop);var S=b+r.offsetWidth-s.offsetWidth,C=y+r.offsetHeight-s.offsetHeight;e.xClamp=(0,p.generateClamp)(b,S),e.yClamp=(0,p.generateClamp)(y,C)}this.opts=t,this.data=e,this.events={mousedown:d.mousedown.bind(this),mouseup:d.mouseup.bind(this),touchstart:d.touchstart.bind(this),touchstop:d.touchstop.bind(this),scrollFix:function(w){i.isDragging&&w.preventDefault()}},this.handleMove=_(this.opts.customMove),this.handle.addEventListener("mousedown",this.events.mousedown,!1),this.handle.addEventListener("touchstart",this.events.touchstart,!1),document.addEventListener("touchmove",this.events.scrollFix,{passive:!1})}f(m,"s"),Object.defineProperty(n,"__esModule",{value:!0});var p=u(2),d=u(3),_=(0,p.generateMoveFn)(),a={constrain:!1,relativeTo:null,handle:null,ignoreFn:null,highlightInputs:!1,onMouseDown:null,onMouseMove:null,onMouseUp:null,onTouchStart:null,onTouchMove:null,onTouchStop:null,customMove:null},c=function(){function i(s,t){if(g(this,i),!s)throw Error("Must include moveable element");this.el=s,this.opts=t,m.call(this)}return f(i,"e2"),i.prototype.reinit=function(){this.destroy(),m.call(this)},i.prototype.destroy=function(){var s=this.events;this.handle.removeEventListener("mousedown",s.mousedown,!1),document.removeEventListener("mousemove",s.mousemove,!1),document.removeEventListener("mouseup",s.mouseup,!1),this.handle.removeEventListener("touchstart",s.touchstart,!1),document.removeEventListener("touchmove",s.touchmove,!1),document.removeEventListener("touchstop",s.touchstop,!1),document.removeEventListener("touchmove",this.events.scrollFix,{passive:!1})},i}();n.default=function(i,s){return new c(i,s)}},function(l,n){"use strict";function u(d,_){return function(a){return Math.min(Math.max(a,d),_)}}f(u,"o");function g(d){return window.getComputedStyle(d).position==="relative"}f(g,"n");function m(){return window.requestAnimationFrame?function(d){var _=d||p;return function(a,c,i){window.requestAnimationFrame(function(){_(a,c,i)})}}:function(d){return function(_,a,c){var i=d||p;i(_,a,c)}}}f(m,"s");function p(d,_,a){d.style.left=_+"px",d.style.top=a+"px"}f(p,"i"),Object.defineProperty(n,"__esModule",{value:!0}),n.generateClamp=u,n.isRelative=g,n.generateMoveFn=m},function(l,n){"use strict";function u(a){var c=this.opts;if(c.highlightInputs){var i=a.target.tagName.toLowerCase();if(i==="input"||i==="textarea")return}if(!c.ignoreFn||!c.ignoreFn(a)){if(a.button===0){var s=this.el,t=this.events;typeof c.onMouseDown=="function"&&c.onMouseDown(s,a);var e=a.clientX-s.offsetLeft,r=a.clientY-s.offsetTop;t.mousemove=g.bind(this,e,r),document.addEventListener("mousemove",t.mousemove,!1),document.addEventListener("mouseup",t.mouseup,!1)}a.preventDefault()}}f(u,"o");function g(a,c,i){var s=this.el,t=this.opts,e=this.data;typeof t.onMouseMove=="function"&&t.onMouseMove(s,i);var r=i.clientX-a,o=i.clientY-c;return t.constrain&&(r=e.xClamp(r),o=e.yClamp(o)),this.handleMove(s,r,o),i.preventDefault(),!1}f(g,"n");function m(a){var c=this.el,i=this.opts,s=this.events;typeof i.onMouseUp=="function"&&i.onMouseUp(c,a),document.removeEventListener("mouseup",s.mouseup,!1),document.removeEventListener("mousemove",s.mousemove,!1)}f(m,"s");function p(a){var c=this.opts;if(c.highlightInputs){var i=a.target.tagName.toLowerCase();if(i==="input"||i==="textarea")return}if(!c.ignoreFn||!c.ignoreFn(a)){var s=this.el,t=this.events;typeof c.onTouchStart=="function"&&c.onTouchStart(s,a);var e=a.targetTouches[0],r=e.clientX-s.offsetLeft,o=e.clientY-s.offsetTop;t.touchmove=d.bind(this,r,o),this.isDragging=!0,document.addEventListener("touchmove",t.touchmove,!1),document.addEventListener("touchend",t.touchstop,!1),document.addEventListener("touchcancel",t.touchstop,!1)}}f(p,"i");function d(a,c,i){var s=this.el,t=this.opts,e=this.data;typeof t.onTouchMove=="function"&&t.onTouchMove(s,i);var r=i.targetTouches[0],o=r.clientX-a,b=r.clientY-c;return t.constrain&&(o=e.xClamp(o),b=e.yClamp(b)),this.handleMove(s,o,b),i.preventDefault(),!1}f(d,"u");function _(a){this.isDragging=!1;var c=this.el,i=this.opts,s=this.events;typeof i.onTouchStop=="function"&&i.onTouchStop(c,a),document.removeEventListener("touchmove",s.touchmove,!1),document.removeEventListener("touchend",s.touchstop,!1),document.removeEventListener("touchcancel",s.touchstop,!1)}f(_,"r"),Object.defineProperty(n,"__esModule",{value:!0}),n.mousedown=u,n.mousemove=g,n.mouseup=m,n.touchstart=p,n.touchmove=d,n.touchstop=_}])})}},x={};function v(h){var l=x[h];if(l!==void 0)return l.exports;var n=x[h]={exports:{}};return F[h].call(n.exports,n,n.exports,v),n.exports}f(v,"__webpack_require__"),v.n=h=>{var l=h&&h.__esModule?()=>h.default:()=>h;return v.d(l,{a:l}),l},v.d=(h,l)=>{for(var n in l)v.o(l,n)&&!v.o(h,n)&&Object.defineProperty(h,n,{enumerable:!0,get:l[n]})},v.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),v.o=(h,l)=>Object.prototype.hasOwnProperty.call(h,l),(()=>{var h;v.g.importScripts&&(h=v.g.location+"");var l=v.g.document;if(!h&&l&&(l.currentScript&&(h=l.currentScript.src),!h)){var n=l.getElementsByTagName("script");if(n.length)for(var u=n.length-1;u>-1&&!h;)h=n[u--].src}if(!h)throw new Error("Automatic publicPath is not supported in this browser");h=h.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),v.p=h+"../"})();var A={};(()=>{"use strict";var h=v(388),l=v.n(h);const n=v.p+"fs-chat/styles.css",{createElement:u,ManagedStyle:g}=FrankerFaceZ.utilities.dom,m=FrankerFaceZ.utilities.color.Color,p=u("span",null),d=window.CSS?.supports?.("backdrop-filter:blur(1px)"),_=["f","space","k","shift+up","shift+down","esc","m","?","alt+t","alt+x"];function a(s){return s?(s=s.toLowerCase().trim(),!_.includes(s)):!1}f(a,"isValidShortcut");const i=class i extends FrankerFaceZ.utilities.addon.Addon{constructor(...t){super(...t),this.inject("site.fine"),this.inject("site.player"),this.inject("site.web_munch"),this.onFSChange=this.onFSChange.bind(this),this.onShortcut=this.onShortcut.bind(this),this.settings.addFilter("fschat",{createTest(e){return r=>r.fschat===e},title:"Using FS Chat",i18n:"addon.fs-chat.using",default:!0,editor:this.settings.getFilterBasicEditor()}),this.settings.add("addon.fs-chat.shortcut",{default:"alt+c",ui:{path:"Add-Ons > FS Chat >> Behavior",title:"Shortcut Key",description:"This key sequence can be used to toggle FS Chat when in fullscreen.",component:"setting-hotkey"},changed:()=>{this.updateShortcut(),this.updateButtons()}}),this.settings.add("addon.fs-chat.automatic",{default:!1,ui:{path:"Add-Ons > FS Chat >> Behavior",title:"Automatically open FS Chat when entering fullscreen.",component:"setting-check-box"}}),this.settings.add("addon.fs-chat.bg.color",{default:"rgba(0,0,0,0.50)",ui:{path:"Add-Ons > FS Chat >> Appearance",title:"Background Color",component:"setting-color-box",alpha:!0},changed:()=>this.updateCSS()}),this.settings.add("addon.fs-chat.hide-scroll",{default:!1,ui:{path:"Add-Ons > FS Chat >> Appearance",title:"Hide Chat Scroll Bar",component:"setting-check-box"},changed:e=>this.chat&&this.chat.classList.toggle("hide-scroll",e)}),d&&this.settings.add("addon.fs-chat.bg.blur",{default:5,ui:{path:"Add-Ons > FS Chat >> Appearance",title:"Background Blur",description:"**Note:** Blur may cause performance issues depending on your browser and PC specs.",component:"setting-select-box",data:[{value:0,title:"Disabled"},{value:2,title:"Minor (2px)"},{value:5,title:"Normal (5px)"},{value:10,title:"Large (10px)"},{value:50,title:"Extreme (50px)"}]},changed:()=>this.updateCSS()}),this.settings.add("addon.fs-chat.height",{default:null,ui:{path:"Add-Ons > FS Chat >> Size and Position",title:"Height",description:"How tall FS Chat should be, in pixels. If you know CSS, you can enter a different unit.",component:"setting-text-box"},changed:()=>this.updateCSS()}),this.settings.add("addon.fs-chat.width",{default:null,requires:["chat.width"],process(e,r){return r||e.get("chat.width")},ui:{path:"Add-Ons > FS Chat >> Size and Position",title:"Width",description:"How wide FS Chat should be, in pixels. Defaults to normal chat width. If you know CSS, you can enter a different unit.",component:"setting-text-box"},changed:()=>this.updateCSS()}),this.settings.add("addon.fs-chat.minimal",{default:!0,ui:{path:"Add-Ons > FS Chat >> Appearance",sort:999,title:"Minimal Mode",component:"setting-check-box",description:"This hides the chat header and input buttons when FS Chat is open."},changed:e=>this.chat&&this.chat.classList.toggle("minimal",e)}),this.settings.add("addon.fs-chat.no-input",{default:!1,ui:{path:"Add-Ons > FS Chat >> Appearance",sort:1e3,title:"Do not display chat input.",component:"setting-check-box"},changed:e=>this.chat&&this.chat.classList.toggle("no-input",e)}),this.settings.add("addon.fs-chat.round",{default:!0,ui:{path:"Add-Ons > FS Chat >> Appearance",title:"Use rounded corners.",component:"setting-check-box"},changed:e=>this.chat&&this.chat.classList.toggle("no-rounding",!e)}),this.settings.add("addon.fs-chat.metadata",{default:2,ui:{path:"Add-Ons > FS Chat >> Appearance",title:"Metadata Position",component:"setting-select-box",data:[{value:0,title:"Disabled"},{value:1,title:"Above Chat"},{value:2,title:"Below Chat"}]},changed:()=>{this.chat&&(this.turnOff(),this.turnOn())}}),this.chat=null,this.handle_right=!1,this.style=new g,this.style_link=null,this.onParentChanges=this.onParentChanges.bind(this)}onEnable(){this.style_link||document.head.appendChild(this.style_link=u("link",{href:n,rel:"stylesheet",type:"text/css",crossOrigin:"anonymous"})),this.updateCSS(),window.addEventListener("fullscreenchange",this.onFSChange),this.on("site.player:update-gui",this.updateButton,this),this.settings.get("addon.fs-chat.automatic")&&this.turnOn(),this.updateButtons(),this.updateShortcut(),this.enableObserver()}onDisable(){this.turnOff(),this.updateButtons(),this.updateShortcut(),this.disableObserver()}updateShortcut(){const t=this.Mousetrap=this.Mousetrap||this.web_munch.getModule("mousetrap")||window.Mousetrap;if(!t||!t.bind||(this._shortcut_bound&&(t.unbind(this._shortcut_bound),this._shortcut_bound=null),this.disabling))return;const e=this.settings.get("addon.fs-chat.shortcut");e&&a(e)&&(t.bind(e,this.onShortcut),this._shortcut_bound=e)}onShortcut(){document.fullscreenElement&&(this.chat?this.turnOff():this.turnOn(),this.updateButtons())}updateCSS(){const t=d?this.settings.get("addon.fs-chat.bg.blur"):0;t>0?this.style.set("blur",`.ffz--fschat .ffz--meta-tray,.ffz--fschat .channel-root__right-column > div { backdrop-filter: blur(${t}px); }`):this.style.delete("blur"),p.style.width="",p.style.height="";let e=this.settings.get("addon.fs-chat.height")||"",r=this.settings.get("addon.fs-chat.width")||"340";/^\d+$/.test(e)&&(e=`${e}px`),/^\d+$/.test(r)&&(r=`${r}px`),p.style.width=r,p.style.height=e,r=p.style.width||"340px",e=p.style.height||"50vh",this.style.set("size",`.ffz--fschat {
	width: ${r};
	height: ${e};
}`);let o=m.RGBA.fromCSS(this.settings.get("addon.fs-chat.bg.color"));o||(o=m.RGBA.fromCSS("rgba(0,0,0,0.75)"));const b=o.toHSLA(),y=b.l;this.dark=y<.5,this.chat&&(this.settings.updateContext({"force-theme":this.dark}),this.chat.classList.toggle("tw-root--theme-dark",this.dark),this.chat.classList.toggle("tw-root--theme-light",!this.dark)),this.style.set("color",`.ffz--fschat {
	--fschat-bg-color: ${o.toCSS()};
}`)}isChatHidden(){if(document.fullscreenElement?.classList?.contains?.("video-player__container"))return!0;const t=document.querySelector(".right-column");return!!(t.classList.contains("right-column--fullscreen")&&t.classList.contains("right-column--collapsed"))}turnOn(){if(!this.isChatHidden()||this.chat||!document.fullscreenElement||(this.chat_pane=document.querySelector(".channel-root__right-column"),!this.chat_pane))return;this.old_parent=this.chat_pane.parentNode,this.chat_pane.remove();let t=this.settings.get("addon.fs-chat.metadata");t!==0&&(this.meta_pane=document.querySelector(".ffz--meta-tray"),this.meta_pane?(this.meta_parent=this.meta_pane.parentNode,this.meta_pane.remove()):t=0);let e;this.chat=u("div",{class:`ffz--fschat meta-${t}${this.settings.get("addon.fs-chat.round")?"":" no-rounding"} ${this.settings.get("addon.fs-chat.no-input")?" no-input":""}${this.settings.get("addon.fs-chat.minimal")?" minimal":""}${this.settings.get("addon.fs-chat.hide-scroll")?" hide-scroll":""} ${this.dark?"tw-root--theme-dark":"tw-root--theme-light"} tw-c-text-base ${this.handle_right?"handle--right":""}`},e=u("div",{class:"handle ffz-i-move"}),this.chat_pane,this.meta_pane),this.chat.addEventListener("mouseout",()=>this.checkHandle()),this.settings.provider.has("fschat.top")&&(this.chat.style.position="absolute",this.chat.style.top=this.settings.provider.get("fschat.top"),this.chat.style.left=this.settings.provider.get("fschat.left"),this.checkConstraints(),this.checkHandle()),document.fullscreenElement.appendChild(this.chat);const r=f(()=>{const o=this.chat.style.top,b=this.chat.style.left;this.settings.provider.set("fschat.top",o),this.settings.provider.set("fschat.left",b)},"savePos");this.chat_mover=l()(this.chat,{handle:e,constrain:!0,onMouseUp:r,onTouchStop:r}),this.settings.updateContext({fschat:!0,"force-theme":this.dark}),this.scroll_frame||(this.scroll_frame=requestAnimationFrame(()=>{this.scroll_frame=null;const o=this.chat&&this.chat.querySelector(".simplebar-scroll-content");o&&(o.scrollTop=o.scrollHeight)}))}enableObserver(){this.parent_observer||!document.fullscreenElement||!document.querySelector(".right-column")||(this.parent_observer=new MutationObserver(this.onParentChanges),this.parent_observer.observe(document.querySelector(".right-column"),{attributes:!0}))}disableObserver(){this.parent_observer&&(this.parent_observer.disconnect(),this.parent_observer=null)}onParentChanges(t){this.isChatHidden()?this.was_active&&this.turnOn():(this.was_active=!!this.chat,this.turnOff())}checkConstraints(){this._checker&&cancelAnimationFrame(this._checker),this._checker=requestAnimationFrame(()=>{if(this._checker=null,!this.chat||!document.fullscreenElement)return;const t=document.fullscreenElement.getBoundingClientRect(),e=this.chat.getBoundingClientRect();e.right>t.right&&(this.chat.style.left=`${t.right-e.width}px`,this.checkHandle()),e.bottom>t.bottom&&(this.chat.style.top=`${t.bottom-e.height}px`),e.left<0&&(this.chat.style.left="0px",this.checkHandle()),e.top<0&&(this.chat.style.top="0px")})}checkHandle(){this._handle_checker&&cancelAnimationFrame(this._handle_checker),this._handle_checker=requestAnimationFrame(()=>{if(this._handle_checker=null,!this.chat||!document.fullscreenElement)return;const t=document.fullscreenElement.getBoundingClientRect(),e=this.chat.getBoundingClientRect();this.handle_right&&e.right>=t.right-40?this.handle_right=!1:!this.handle_right&&e.left<=t.left+40&&(this.handle_right=!0),this.chat.classList.toggle("handle--right",this.handle_right)})}turnOff(){this.chat_mover&&(this.chat_mover.destroy(),this.chat_mover=null),this.meta_pane&&(this.meta_pane.remove(),this.meta_parent.appendChild(this.meta_pane),this.meta_pane=this.meta_parent=null),this.chat&&(this.chat.remove(),this.chat_pane.remove(),this.old_parent.appendChild(this.chat_pane),this.old_parent=this.chat=this.chat_pane=null),this.settings.updateContext({fschat:!1,"force-theme":null})}onFSChange(){document.fullscreenElement?(this.enableObserver(),(this.was_active||this.settings.get("addon.fs-chat.automatic"))&&this.turnOn()):(this.was_active=!!this.chat,this.turnOff(),this.disableObserver()),this.updateButtons()}updateButtons(){for(const t of this.player.Player.instances)this.updateButton(t)}updateButton(t){const e=t.props.containerRef||this.fine.getChildNode(t),r=(this.enabled||this.enabling)&&document.fullscreenElement?.contains?.(e),o=e?.querySelector?.(this.player.RIGHT_CONTROLS||".video-player__default-player .player-controls__right-control-group");if(!o)return;const b=this.chat||document.querySelector(".channel-root__right-column")!=null;let y,S,C,w=o.querySelector(".ffz--player-fschat");if(!r||!b||!this.isChatHidden()||this.disabling){w&&w.remove();return}if(w)y=w.querySelector("figure"),C=w.querySelector("button"),S=w.querySelector(".ffz-il-tooltip");else{w=u("div",{class:"ffz--player-fschat tw-inline-flex tw-relative ffz-il-tooltip__container"},C=u("button",{class:"tw-align-items-center tw-align-middle tw-border-bottom-left-radius-medium tw-border-bottom-right-radius-medium tw-border-top-left-radius-medium tw-border-top-right-radius-medium tw-button-icon tw-button-icon--overlay ffz-core-button ffz-core-button--border ffz-core-button--overlay tw-inline-flex tw-interactive tw-justify-content-center tw-overflow-hidden tw-relative",type:"button","data-a-target":"ffz-player-fschat-button",onClick:this.onButtonClick.bind(this,t)},u("div",{class:"tw-align-items-center tw-flex tw-flex-grow-0"},u("div",{class:"tw-button-icon__icon"},y=u("figure",{class:"ffz-player-icon"})))),S=u("div",{class:"ffz-il-tooltip ffz-il-tooltip--align-right ffz-il-tooltip--up",role:"tooltip"}));const E=o.querySelector('button[data-a-target="player-fullscreen-button"]');E?o.insertBefore(w,E.parentElement):o.appendChild(w)}const L=this.chat!=null;let k=L?this.i18n.t("addon.fs-chat.button.active","Disable FS Chat"):this.i18n.t("addon.fs-chat.button.inactive","FS Chat");const O=this.settings.get("addon.fs-chat.shortcut");O&&a(O)&&(k=`${k} (${O})`),y.classList.toggle("ffz-i-chat-empty",!L),y.classList.toggle("ffz-i-chat",L),C.setAttribute("aria-label",k),S.textContent=k}onButtonClick(t,e){this.chat?this.turnOff():this.turnOn(),this.updateButton(t)}};f(i,"FSChat");let c=i;c.register("fs-chat",null,"1.5.2")})()})();})();

//# sourceMappingURL=script.js.map