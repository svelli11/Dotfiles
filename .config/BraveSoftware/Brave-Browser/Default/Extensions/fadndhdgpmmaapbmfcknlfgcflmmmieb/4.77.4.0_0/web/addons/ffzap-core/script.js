(()=>{var S=Object.defineProperty;var f=(g,m)=>S(g,"name",{value:m,configurable:!0});(()=>{var g={},m={};function n(s){var t=m[s];if(t!==void 0)return t.exports;var e=m[s]={exports:{}};return g[s](e,e.exports,n),e.exports}f(n,"__webpack_require__"),n.m=g,n.d=(s,t)=>{for(var e in t)n.o(t,e)&&!n.o(s,e)&&Object.defineProperty(s,e,{enumerable:!0,get:t[e]})},n.f={},n.e=s=>Promise.all(Object.keys(n.f).reduce((t,e)=>(n.f[e](s,t),t),[])),n.u=s=>"ffzap-core/vue.js",n.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),n.o=(s,t)=>Object.prototype.hasOwnProperty.call(s,t),(()=>{var s={},t="ffz-addons:";n.l=(e,o,a,r)=>{if(s[e]){s[e].push(o);return}var i,u;if(a!==void 0)for(var h=document.getElementsByTagName("script"),c=0;c<h.length;c++){var l=h[c];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==t+a){i=l;break}}i||(u=!0,i=document.createElement("script"),i.charset="utf-8",i.timeout=120,n.nc&&i.setAttribute("nonce",n.nc),i.setAttribute("data-webpack",t+a),i.src=e,i.src.indexOf(window.location.origin+"/")!==0&&(i.crossOrigin="anonymous")),s[e]=[o];var d=f((b,z)=>{i.onerror=i.onload=null,clearTimeout(p);var w=s[e];if(delete s[e],i.parentNode&&i.parentNode.removeChild(i),w&&w.forEach(y=>y(z)),b)return b(z)},"onScriptComplete"),p=setTimeout(d.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=d.bind(null,i.onerror),i.onload=d.bind(null,i.onload),u&&document.head.appendChild(i)}})(),n.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},(()=>{var s;n.g.importScripts&&(s=n.g.location+"");var t=n.g.document;if(!s&&t&&(t.currentScript&&(s=t.currentScript.src),!s)){var e=t.getElementsByTagName("script");if(e.length)for(var o=e.length-1;o>-1&&!s;)s=e[o--].src}if(!s)throw new Error("Automatic publicPath is not supported in this browser");s=s.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=s+"../"})(),(()=>{var s={444:0};n.f.j=(o,a)=>{var r=n.o(s,o)?s[o]:void 0;if(r!==0)if(r)a.push(r[2]);else{var i=new Promise((l,d)=>r=s[o]=[l,d]);a.push(r[2]=i);var u=n.p+n.u(o),h=new Error,c=f(l=>{if(n.o(s,o)&&(r=s[o],r!==0&&(s[o]=void 0),r)){var d=l&&(l.type==="load"?"missing":l.type),p=l&&l.target&&l.target.src;h.message="Loading chunk "+o+` failed.
(`+d+": "+p+")",h.name="ChunkLoadError",h.type=d,h.request=p,r[1](h)}},"loadingEnded");n.l(u,c,"chunk-"+o,o)}};var t=f((o,a)=>{var[r,i,u]=a,h,c,l=0;if(r.some(p=>s[p]!==0)){for(h in i)n.o(i,h)&&(n.m[h]=i[h]);if(u)var d=u(n)}for(o&&o(a);l<r.length;l++)c=r[l],n.o(s,c)&&s[c]&&s[c][0](),s[c]=0},"webpackJsonpCallback"),e=globalThis.ffzAddonsWebpackJsonp=globalThis.ffzAddonsWebpackJsonp||[];e.forEach(t.bind(null,0)),e.push=t.bind(null,e.push.bind(e))})();var A={};const _=class _ extends FrankerFaceZ.utilities.addon.Addon{constructor(...t){super(...t),this.inject("settings"),this.inject("chat"),this.inject("chat.emotes"),this.inject("chat.badges"),this.inject("site"),this.helpers={26964566:{title:"FFZ:AP Developer"},11819690:{title:"FFZ:AP Helper"},36442149:{title:"FFZ:AP Helper"},29519423:{title:"FFZ:AP Helper"},22025290:{title:"FFZ:AP Helper"},4867723:{title:"FFZ:AP Helper"}},this.supporters={},this.added_supporters=[],this.settings.add("ffzap.core.remove_spaces",{default:!1,ui:{path:"Add-Ons > FFZ:AP Core >> Emotes",title:"Remove Spaces Between Emotes",description:"Remove spaces inbetween emotes when they are right after one another. (e.g. combo emotes)",component:"setting-check-box"}}),this.settings.add("ffzap.core.message_deletion",{default:0,ui:{path:"Add-Ons > FFZ:AP Core >> Chat",title:"Message User-Level Filtering",description:"Messages will be removed from chat entirely if they aren't sent by a user of this level or higher.",component:"setting-select-box",data:[{value:0,title:"Display All Messages"},{value:1,title:"Display Subscriber Messages"},{value:2,title:"Display Moderator Messages"}]}}),this.settings.add("ffzap.core.enable_highlight_sound",{default:!1,requires:["ffzap.core.highlight_sound_types"],process(e,o){const a=e.get("ffzap.core.highlight_sound_types");return!Array.isArray(a)||!a.length?!1:o},ui:{sort:-10,path:"Add-Ons > FFZ:AP Core >> Highlight Sounds",title:"Enable Highlight Sound",description:"Hear a sound every time a message is highlighted.",component:"setting-check-box"}}),this.settings.add("ffzap.core.highlight_sound",{default:"https://cdn.ffzap.com/sounds/default_wet.mp3",ui:{sort:-5,path:"Add-Ons > FFZ:AP Core >> Highlight Sounds",title:"Sound",description:"Change the sound that will play when a sound trigger is activated.",component:()=>n.e(31).then(n.bind(n,108)),no_i18n:!0,data:[{value:"https://cdn.ffzap.com/sounds/default_wet.mp3",title:"Default - Wet"},{value:"https://cdn.ffzap.com/sounds/default_graceful.mp3",title:"Default - Graceful"},{value:"https://cdn.ffzap.com/sounds/default_blocker.mp3",title:"Default - Blocker"},{value:"https://cdn.ffzap.com/sounds/coin.mp3",title:"Mario - Coin Sound"},{value:"https://cdn.ffzap.com/sounds/recovery.mp3",title:"Pokemon - Recovery"},{value:"https://cdn.ffzap.com/sounds/icq.mp3",title:"ICQ - Notification"},{value:"https://cdn.ffzap.com/sounds/aol.mp3",title:"AOL - You've got mail!"},{value:"https://cdn.ffzap.com/sounds/mailmf.mp3",title:"Euro Trip - Mail Motherf**ker!"},{value:"https://cdn.ffzap.com/sounds/zelda_secret.mp3",title:"Zelda - Secret Sound"},{value:"https://cdn.ffzap.com/sounds/brainpower.mp3",title:"O-oooooooooo AAAAE-A-A-I-A-U"},{value:"https://cdn.ffzap.com/sounds/the_best.mp3",title:"THE BEST THE BEST"},{value:"https://cdn.ffzap.com/sounds/wow.mp3",title:"WOW!"},{value:"https://cdn.ffzap.com/sounds/vsauce.mp3",title:"Hey Vsauce, Michael here."},{value:"https://cdn.ffzap.com/sounds/number_1.mp3",title:"We are number one, HEY!"},{value:"https://cdn.ffzap.com/sounds/hello.mp3",title:"Hello.webm"},{value:"https://cdn.ffzap.com/sounds/tuturu.mp3",title:"Tuturu~~"},{value:"https://cdn.ffzap.com/sounds/omae_wa_mou_shindeiru.mp3",title:"Omae wa mou shindeiru"},{value:"https://cdn.ffzap.com/sounds/never_asked_for_this.mp3",title:"I never asked for this."},{value:"https://cdn.ffzap.com/sounds/nani.mp3",title:"N-NANI?!"},{value:"https://cdn.ffzap.com/sounds/oh_no.mp3",title:"Knuckles - Oh no"},{value:"https://cdn.ffzap.com/sounds/whats_going_on.mp3",title:"He-Man - What's going on?!"},{value:"https://cdn.ffzap.com/sounds/gnome.mp3",title:"Gnome"},{value:"https://cdn.ffzap.com/sounds/oof.mp3",title:"Roblox Death Sound (OOF)"}],onUIChange:(e,o)=>e&&this.playPreviewSound(o,e,null),buttons:()=>n.e(31).then(n.bind(n,5694))}}),this.settings.add("ffzap.core.highlight_sound_volume",{default:50,ui:{sort:-4,path:"Add-Ons > FFZ:AP Core >> Highlight Sounds",title:"Highlight Sound Volume",description:"Change the volume at which the highlight sounds will be played at.",component:"setting-select-box",data:[{value:5,title:"5%"},{value:10,title:"10%"},{value:20,title:"20%"},{value:30,title:"30%"},{value:40,title:"40%"},{value:50,title:"50%"},{value:60,title:"60%"},{value:70,title:"70%"},{value:80,title:"80%"},{value:90,title:"90%"},{value:100,title:"100%"}],onUIChange:(e,o)=>this.playPreviewSound(o,null,e)}}),this.settings.add("ffzap.core.highlight_sound_prevent_own_channel",{default:!1,ui:{path:"Add-Ons > FFZ:AP Core >> Highlight Sounds >> Sound Trigger Settings",title:"Prevent In Own Channel",description:"Prevent the sound from playing in your own channel.",component:"setting-check-box"}}),this.settings.add("ffzap.core.highlight_sound_types",{default:["badge","mention","term","user"],type:"basic_array_merge",ui:{path:"Add-Ons > FFZ:AP Core >> Highlight Sounds >> Sound Trigger Settings",title:"Play When",description:"Play a highlight sound when a chat line is highlighted for one of the selected reasons.",component:"setting-select-box",multiple:!0,data:()=>this.chat.getHighlightReasons()}}),this.chat.context.on("changed:ffzap.core.highlight_sound",async e=>{this.highlight_sound.src=await this.getSoundURL(e)},this),this.chat.context.on("changed:ffzap.core.highlight_sound_volume",e=>{this.highlight_sound.volume=e/100},this),this.setupHighlightSound(),this.remove_spaces_tokenizer={type:"remove_spaces",priority:-100,process:e=>{if(!e||!e.length||!this.chat.context.get("ffzap.core.remove_spaces"))return e;const o=[];for(let a=0,r=e.length;a<r;a++){const i=e[a];if(a+1===r){o.push(i);continue}const u=a-1>=0?e[a-1]:null,h=a+1<r?e[a+1]:null;if(i.type==="text"&&i.text===" "&&u?.type==="emote"&&h?.type==="emote"){u.text+=" ";continue}o.push(i)}return o}},this.receive_event=!1,this.buffer_event=!1,this.updateEvents(),this.chat.context.on("changed:ffzap.core.message_deletion",this.updateEvents,this),this.chat.context.on("changed:ffzap.core.enable_highlight_sound",this.updateEvents,this),this.chat.addTokenizer(this.remove_spaces_tokenizer)}onEnable(){this.log.debug("FFZ:AP's Core module was enabled successfully."),this.fetchSupporters()}updateEvents(){const t=this.chat.context.get("ffzap.core.enable_highlight_sound"),e=this.chat.context.get("ffzap.core.message_deletion");t&&!this.buffer_event?this.on("chat:buffer-message",this.onBufferMessage,this):!t&&this.buffer_event&&this.off("chat:buffer-message",this.onBufferMessage,this),e&&!this.receive_event?this.on("chat:receive-message",this.onReceiveMessage,this):!e&&this.receive_event&&this.off("chat:receive-message",this.onReceiveMessage,this),this.buffer_event=t,this.receive_event=e}isModeratorOrHigher(t){return"broadcaster"in t||"staff"in t||"admin"in t||"global_mod"in t||"moderator"in t}handleMessageDeletion(t){const e=this.chat.context.get("ffzap.core.message_deletion"),o=t.message.badges;e==1?!("subscriber"in o)&&!this.isModeratorOrHigher(o)&&(t.message.ffz_removed=!0):e==2&&!this.isModeratorOrHigher(o)&&(t.message.ffz_removed=!0)}async setupHighlightSound(){this.highlight_sound=new Audio(await this.getSoundURL(this.chat.context.get("ffzap.core.highlight_sound"))),this.highlight_sound.volume=this.chat.context.get("ffzap.core.highlight_sound_volume")/100}async getSoundURL(t){if(t.startsWith("ffzap.sound-file:")){const o=await this.settings.provider.getBlob(t);t=URL.createObjectURL(o)}return t}getElementSetting(t,e){return t?t.profile.get(e)||this.chat.context.get(e):this.chat.context.get(e)}async playPreviewSound(t,e,o){e==null&&(e=this.getElementSetting(t,"ffzap.core.highlight_sound")),e=await this.getSoundURL(e);let a;this._preview_sound?(a=this._preview_sound,a.pause(),a.src=e,a.currentTime=0):a=this._preview_sound=new Audio(e),a.volume=(o??this.getElementSetting(t,"ffzap.core.highlight_sound_volume"))/100,a.play()}playHighlightSound(){this.highlight_sound.paused||this.highlight_sound.pause(),this.highlight_sound.play()}onReceiveMessage(t){this.handleMessageDeletion(t)}onBufferMessage(t){if(this.chat.context.get("ffzap.core.enable_highlight_sound")&&t.message.mentioned){if(this.chat.context.get("ffzap.core.highlight_sound_prevent_own_channel")){const a=this.resolve("site").getUser();if(a&&t.channel==a.login)return}const e=t.message.highlights;if(!e||!e.size)return;const o=this.chat.context.get("ffzap.core.highlight_sound_types");for(const a of o)if(e.has(a)){this.playHighlightSound();break}}}getBuster(t=5){const e=Math.floor(Date.now()/1e3);return e-e%t}async fetchSupporters(){const t=`https://api.ffzap.com/v1/supporters?_=${this.getBuster(30)}`,e={id:"supporter",title:"FFZ:AP Supporter",color:"#755000",slot:6,image:"https://api.ffzap.com/v1/user/badge/default/1",urls:{1:"https://api.ffzap.com/v1/user/badge/default/1",2:"https://api.ffzap.com/v1/user/badge/default/2",4:"https://api.ffzap.com/v1/user/badge/default/3"},click_url:"https://ffzap.com/"},o=await fetch(t);if(o.ok){const a=await o.json();this.badges.loadBadgeData("addon--ffzap.core--badges-supporter",e);for(let r=0;r<a.length;r++){const i=a[r];if(i.id===26964566||!i.tier)continue;const u=this.chat.getUser(i.id),h={title:this.helpers[i.id]&&this.helpers[i.id].title||"FFZ:AP Supporter",color:i.tier>=2&&i.badge_color||e.color,image:`https://api.ffzap.com/v1/user/badge/${i.id}/1`,urls:{1:`https://api.ffzap.com/v1/user/badge/${i.id}/1`,2:`https://api.ffzap.com/v1/user/badge/${i.id}/2`,4:`https://api.ffzap.com/v1/user/badge/${i.id}/3`},click_url:"https://ffzap.com/"};i.tier>=3&&i.badge_is_colored&&(h.color="transparent",h.no_invert=!0),u.addBadge("addon--ffzap.core","addon--ffzap.core--badges-supporter",h),this.added_supporters.push(i.id)}}}};f(_,"FFZAP");let v=_;v.register("ffzap-core",null,"3.3.11")})();})();

//# sourceMappingURL=script.js.map