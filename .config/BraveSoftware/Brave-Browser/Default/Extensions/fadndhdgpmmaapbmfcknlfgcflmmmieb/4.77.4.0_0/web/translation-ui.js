(()=>{var A=Object.defineProperty;var h=(_,l)=>A(_,"name",{value:l,configurable:!0});(globalThis.ffzWebpackJsonp=globalThis.ffzWebpackJsonp||[]).push([[1871],{68088:(_,l,r)=>{"use strict";r.r(l),r.d(l,{default:()=>f});const f=r(39628)},23512:(_,l,r)=>{"use strict";r.r(l),r.d(l,{default:()=>n});var f=h(function(){var e=this,s=e.$createElement,i=e._self._c||s;return i("div",{staticClass:"ffz--i18n-entry tw-pd-x-1 tw-pd-y-05 tw-border-b"},[i("div",{staticClass:"tw-flex tw-full-width"},[i("div",{staticClass:"ffz--i18n-sub-entry tw-mg-r-05 tw-c-text-alt tw-mg-b-2"},[i("div",{staticClass:"tw-font-size-7 tw-c-text-alt-2 tw-pd-b-05 tw-strong tw-upcase tw-ellipsis",attrs:{title:e.entry.key}},[e._v(`
				`+e._s(e.entry.key)+`
			`)]),e._v(" "),i("code",e._l(e.diff,function(a,o){return i("span",{key:o,class:{"ffz-tooltip":a[0]!==0,"tw-c-text-base":a[0]===0,"tw-c-text-error":a[0]===-1,"tw-c-text-prime":a[0]===1},attrs:{"data-title":e.getDiffTooltip(a)}},[e._v(e._s(a[1]))])}),0)]),e._v(" "),i("div",{staticClass:"ffz--i18n-sub-entry tw-flex-grow-1"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],ref:"editor",staticClass:"tw-block tw-font-size-6 tw-full-width ffz-textarea",class:{"ffz-textarea--error":!e.valid},domProps:{value:e.value},on:{input:[function(a){a.target.composing||(e.value=a.target.value)},e.onInput],blur:e.onBlur,focus:function(a){e.open=!0}}})]),e._v(" "),i("div",{staticClass:"ffz--i18n-sub-entry tw-mg-l-05 tw-flex-grow-1"},[e.error&&!e.open?i("div",[i("div",{staticClass:"tw-strong"},[e._v(e._s(e.t("i18n.ui.error","Error")))]),e._v(" "),i("code",{staticClass:"tw-font-size-7 tw-c-text-alt-2"},[e._v(e._s(e.error))])]):e._e(),e._v(" "),e.source?i("div",[i("div",{staticClass:"tw-strong"},[e._v(e._s(e.t("i18n.ui.source","Source")))]),e._v(" "),e._l(e.source,function(a,o){return i("div",{key:o,staticClass:"tw-font-size-7 tw-c-text-alt-2 tw-ellipsis tw-full-width",attrs:{title:Array.isArray(a)?a[0]+" ("+a[1]+")":a}},[Array.isArray(a)?i("span",[e._v(`
						`+e._s(a[0])+" ("),i("a",{attrs:{href:a[2],rel:"noopener noreferrer",target:"_blank"}},[e._v(e._s(a[1]))]),e._v(`)
					`)]):i("span",[e._v(`
						`+e._s(a)+`
					`)])])})],2):e._e(),e._v(" "),e.context_str&&!e.open?i("div",[i("div",{staticClass:"tw-strong"},[e._v(e._s(e.t("i18n.ui.context","Context")))]),e._v(" "),i("code",{staticClass:"tw-font-size-7 tw-c-text-alt-2"},[e._v(e._s(e.context_str))])]):e._e()])]),e._v(" "),e.open?i("div",{staticClass:"tw-flex tw-full-width tw-mg-t-05"},[i("div",{staticClass:"ffz--i18n-sub-entry tw-mg-r-05 tw-c-text-alt tw-mg-b-2"},[i("div",{staticClass:"tw-font-size-7 tw-c-text-alt-2 tw-pd-b-05 tw-strong tw-upcase tw-ellipsis"},[e._v(`
				`+e._s(e.t("i18n.ui.preview","Preview"))+`
			`)]),e._v(" "),e.error?i("code",[e._v(e._s(e.error))]):i("code",[e._v(e._s(e.preview))])]),e._v(" "),i("div",{staticClass:"ffz--i18n-sub-entry tw-flex-grow-1"},[i("div",{staticClass:"tw-font-size-7 tw-c-text-alt-2 tw-pd-b-05 tw-strong tw-upcase tw-ellipsis"},[e._v(`
				`+e._s(e.t("i18n.ui.context","Context"))+`
			`)]),e._v(" "),e._l(e.context,function(a){return i("div",{key:a.key,staticClass:"tw-flex tw-align-items-center tw-mg-b-05"},[i("label",{staticClass:"tw-mg-r-05",attrs:{for:"ui-ctx:"+e.entry.key+":"+a.key}},[e._v(`
					`+e._s(a.key)+`
				`)]),e._v(" "),i("input",{staticClass:"tw-full-width tw-block tw-border-radius-medium tw-font-size-6 ffz-input tw-pd-x-1 tw-pd-y-05",attrs:{id:"ui-ctx:"+e.entry.key+":"+a.key,type:a.is_number?"number":"text"},domProps:{value:a.value},on:{input:function(o){return e.updateContext(a.key,o)}}})])})],2),e._v(" "),i("button",{staticClass:"tw-button-icon tw-mg-l-05 tw-relative ffz-il-tooltip__container",on:{click:function(a){e.open=!1}}},[e._m(0)])]):e._e()])},"render"),d=[function(){var e=this,s=e.$createElement,i=e._self._c||s;return i("span",{staticClass:"tw-button-icon__icon"},[i("figure",{staticClass:"ffz-i-cancel"})])}],g=r(296),c=r.n(g),p=r(22923),C=r.n(p),x=r(46949);const b=new(C()),z=new(c());function v(e){try{return b.parse(e)}catch{return null}}h(v,"parse");const P=["number","plural","selectordinal","duration"];function w(e,s,i,a){for(const o of e){if(typeof o!="object"||!o.v)continue;const m=o.v,S=o.t;let u=a?a[m]:null,y=typeof u=="number";if(!y&&P.includes(S)){y=!0;try{u=parseFloat(u),(isNaN(u)||!isFinite(u))&&(u=0)}catch{u=0}}if(i[m]=u,(0,x.has)(s,m)||(s[m]={key:m,value:u,is_number:y}),y&&(s[m].is_number=!0),typeof o.o=="object")for(const j of Object.values(o.o))w(j,s,i,a)}}h(w,"extractVariables");const k={props:["entry","getI18n"],data(){return{value:this.entry.translation,valid:!0,pending:!1,error:null,open:!1}},computed:{diff(){if(!this.entry.different||!this.entry.known)return[[0,this.entry.phrase]];const e=z.main(this.entry.known,this.entry.phrase);return z.cleanupSemantic(e),e},source(){const e=this.entry.calls;if(!Array.isArray(e)||!e.length)return null;const s=e.join(`
`).split(/\n/),i=[];for(const a of s){const o=/^(?:(.*?) \()?(\/[^:\)]+):(\d+):(\d+)\)?$/.exec(a);o?i.push([o[1]||"???",`${o[2]}:${o[3]}:${o[4]}`,`https://www.github.com/FrankerFaceZ/FrankerFaceZ/blob/master${o[2]}#L${o[3]}`]):i.push(a)}return i},preview(){try{return this.getI18n()._.t(null,this.value,this.variables,{noCache:!0,throwParse:!0})}catch(e){return e}},context(){const e={},s={};let i=v(this.entry.phrase);return i&&w(i,e,s,this.entry.options),this.open&&(i=v(this.value),i&&w(i,e,s,this.entry.options)),Object.values(e)},variables(){const e={},s={};let i=v(this.entry.phrase);return i&&w(i,e,s,this.entry.options),this.open&&(i=v(this.value),i&&w(i,e,s,this.entry.options)),s},context_str(){const e=[];for(const s of this.context)e.push(`${s.key}: ${JSON.stringify(s.value)}`);return e.join(`
`)}},watch:{"entry.translation"(){document.activeElement!==this.$refs.editor&&(this.value=this.entry.translation)}},created(){this.validate(),this.onInput=(0,x.debounce)(this.onInput,250)},methods:{getDiffTooltip(e){const s=e[0];return s===-1?this.t("i18n.diff.removed",`Removed:
{text}`,{text:e[1]}):s===1?this.t("i18n.diff.added",`Added:
{text}`,{text:e[1]}):""},updateContext(e,s){this.entry.options||this.$set(this.entry,"options",{});let i=s.target.value;if(s.target.type==="number")try{i=parseFloat(i),(isNaN(i)||!isFinite(i))&&(i=0)}catch{i=0}this.$set(this.entry.options,e,i),this.$emit("update-context",this.variables)},onBlur(){this.pending&&this.$emit("update",this.value)},onInput(){this.validate(),this.pending=!this.valid,this.valid&&this.$emit("update",this.value)},validate(){try{b.parse(this.value)}catch(e){this.error=e,this.valid=!1;return}this.error=null,this.valid=!0}}};var $=r(72934),t=(0,$.Z)(k,f,d,!1,null,null,null);const n=t.exports},72900:(_,l,r)=>{"use strict";r.r(l),r.d(l,{default:()=>$});var f=h(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"ffz-dialog tw-elevation-3 tw-c-background-alt tw-c-text-base tw-border tw-flex tw-flex-nowrap tw-flex-column",class:{maximized:t.maximized||t.exclusive,exclusive:t.exclusive,faded:t.faded}},[e("header",{staticClass:"tw-c-background-base tw-full-width tw-align-items-center tw-flex tw-flex-nowrap",on:{dblclick:t.resize}},[e("h3",{staticClass:"ffz-i-zreknarf ffz-i-pd-1"},[t._v(t._s(t.t("i18n.ui.title","Translation Tester")))]),t._v(" "),e("div",{staticClass:"tw-flex-grow-1 tw-pd-x-2"},[e("div",{staticClass:"tw-search-input"},[e("label",{staticClass:"tw-hide-accessible",attrs:{for:"ffz-main-menu.search"}},[t._v(t._s(t.t("i18n.ui.search","Search Strings")))]),t._v(" "),e("div",{staticClass:"tw-relative"},[t._m(0),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],staticClass:"tw-block tw-border-radius-medium tw-font-size-6 tw-full-width ffz-input tw-pd-l-3 tw-pd-r-1 tw-pd-y-05",attrs:{id:"ffz-main-menu.search",placeholder:t.t("i18n.ui.search","Search Strings"),type:"search",autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false"},domProps:{value:t.query},on:{input:function(s){s.target.composing||(t.query=s.target.value)}}})])])]),t._v(" "),e("button",{staticClass:"tw-button-icon tw-mg-x-05 tw-relative ffz-il-tooltip__container",on:{click:t.saveBlob}},[t._m(1),t._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[t._v(`
				`+t._s(t.t("i18n.ui.save","Generate Change Blob"))+`
			`)])]),t._v(" "),t.can_upload?e("button",{staticClass:"tw-button-icon tw-mg-x-05 tw-relative ffz-il-tooltip__container",on:{click:t.uploadBlob}},[t._m(2),t._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[t._v(`
				`+t._s(t.t("i18n.ui.upload","Upload Changes"))+`
			`)])]):t._e(),t._v(" "),e("button",{staticClass:"tw-button-icon tw-mg-x-05 tw-relative ffz-il-tooltip__container",on:{click:t.requestKeys}},[t._m(3),t._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[t._v(`
				`+t._s(t.t("i18n.ui.refresh","Refresh Strings"))+`
			`)])]),t._v(" "),!t.maximized&&!t.exclusive?e("button",{staticClass:"tw-button-icon tw-mg-x-05",on:{click:function(s){t.faded=!t.faded}}},[e("span",{staticClass:"tw-button-icon__icon"},[e("figure",{class:t.faded?"ffz-i-eye-off":"ffz-i-eye"})])]):t._e(),t._v(" "),t.exclusive?t._e():e("button",{staticClass:"tw-button-icon tw-mg-x-05 tw-relative ffz-il-tooltip__container",on:{click:t.popout}},[t._m(4),t._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-center"},[t._v(`
				`+t._s(t.t("i18n.ui.popout","Open the Translation Editor in a New Window"))+`
			`)])]),t._v(" "),t.exclusive?t._e():e("button",{staticClass:"tw-button-icon tw-mg-x-05",on:{click:t.resize}},[e("span",{staticClass:"tw-button-icon__icon"},[e("figure",{class:{"ffz-i-window-maximize":!t.maximized,"ffz-i-window-restore":t.maximized}})])]),t._v(" "),t.exclusive?t._e():e("button",{staticClass:"tw-button-icon tw-mg-x-05",on:{click:t.close}},[t._m(5)])]),t._v(" "),e("section",{staticClass:"tw-border-t tw-full-height tw-full-width tw-flex tw-flex-column tw-overflow-hidden"},[e("header",{staticClass:"tw-border-b tw-pd-05 tw-c-background-base tw-flex tw-align-items-center"},[e("button",{staticClass:"tw-border-radius-medium tw-pd-x-05 ffz-core-button ffz-core-button--text tw-c-text-base tw-interactive tw-relative ffz-il-tooltip__container",on:{click:t.prevPage}},[t._m(6),t._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down"},[t._v(`
					`+t._s(t.t("page.previous","Previous Page"))+`
				`)])]),t._v(" "),t.page_open?t._e():e("button",{staticClass:"tw-border-radius-medium tw-pd-x-05 ffz-core-button ffz-core-button--text tw-c-text-base tw-interactive",on:{click:t.openPage}},[t._v(`
				`+t._s(t.t("i18n.ui.pages","Page {current,number} of {total,number}",{current:t.page,total:t.pages}))+`
			`)]),t._v(" "),t.page_open?e("input",{ref:"pager",staticClass:"tw-block tw-border-radius-medium tw-font-size-6 ffz-input tw-pd-x-1 tw-pd-y-05",attrs:{max:t.pages,type:"number",min:"1"},domProps:{value:t.page},on:{keydown:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.closePage.apply(null,arguments)},blur:t.closePage}}):t._e(),t._v(" "),e("button",{staticClass:"tw-border-radius-medium tw-pd-x-05 ffz-core-button ffz-core-button--text tw-c-text-base tw-interactive tw-relative ffz-il-tooltip__container",on:{click:t.nextPage}},[t._m(7),t._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down"},[t._v(`
					`+t._s(t.t("page.next","Next Page"))+`
				`)])]),t._v(" "),e("div",{staticClass:"tw-flex-grow-1"}),t._v(" "),e("button",{staticClass:"tw-border-radius-medium tw-pd-x-05 ffz-core-button tw-c-text-base tw-interactive tw-relative ffz-il-tooltip__container",class:[t.mode===0?"ffz-core-button--primary":"ffz-core-button--text"],on:{click:function(s){t.mode=0}}},[e("div",{staticClass:"tw-align-items-center tw-flex tw-flex-grow-0"},[e("figure",{staticClass:"ffz-i-search"}),t._v(" "),e("div",{staticClass:"tw-mg-l-05"},[t._v(`
						`+t._s(t.total)+`
					`)])]),t._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[t._v(`
					`+t._s(t.t("i18n.ui.all","All Strings"))+`
				`)])]),t._v(" "),t.existing!=t.total?e("button",{staticClass:"tw-mg-l-05 tw-border-radius-medium tw-pd-x-05 ffz-core-button tw-c-text-base tw-interactive tw-relative ffz-il-tooltip__container",class:[t.mode===1?"ffz-core-button--primary":"ffz-core-button--text"],on:{click:function(s){t.mode=1}}},[e("div",{staticClass:"tw-align-items-center tw-flex tw-flex-grow-0"},[e("figure",{staticClass:"ffz-i-star-empty"}),t._v(" "),e("div",{staticClass:"tw-mg-l-05"},[t._v(`
						`+t._s(t.existing)+`
					`)])]),t._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[t._v(`
					`+t._s(t.t("i18n.ui.existing","Existing Strings"))+`
				`)])]):t._e(),t._v(" "),t.added?e("button",{staticClass:"tw-mg-l-05 tw-border-radius-medium tw-pd-x-05 ffz-core-button tw-c-text-base tw-interactive tw-relative ffz-il-tooltip__container",class:[t.mode===2?"ffz-core-button--primary":"ffz-core-button--text"],on:{click:function(s){t.mode=2}}},[e("div",{staticClass:"tw-align-items-center tw-flex tw-flex-grow-0"},[e("figure",{staticClass:"ffz-i-star"}),t._v(" "),e("div",{staticClass:"tw-mg-l-05"},[t._v(`
						`+t._s(t.added)+`
					`)])]),t._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[t._v(`
					`+t._s(t.t("i18n.ui.added","New Strings"))+`
				`)])]):t._e(),t._v(" "),t.changed?e("button",{staticClass:"tw-mg-l-05 tw-border-radius-medium tw-pd-x-05 ffz-core-button tw-c-text-base tw-interactive tw-relative ffz-il-tooltip__container",class:[t.mode===3?"ffz-core-button--primary":"ffz-core-button--text"],on:{click:function(s){t.mode=3}}},[e("div",{staticClass:"tw-align-items-center tw-flex tw-flex-grow-0"},[e("figure",{staticClass:"ffz-i-floppy"}),t._v(" "),e("div",{staticClass:"tw-mg-l-05"},[t._v(`
						`+t._s(t.changed)+`
					`)])]),t._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[t._v(`
					`+t._s(t.t("i18n.ui.changed","Changed Strings"))+`
				`)])]):t._e(),t._v(" "),t.pending?e("button",{staticClass:"tw-mg-l-05 tw-border-radius-medium tw-pd-x-05 ffz-core-button tw-c-text-base tw-interactive tw-relative ffz-il-tooltip__container",class:[t.mode===4?"ffz-core-button--primary":"ffz-core-button--text"],on:{click:function(s){t.mode=4}}},[e("div",{staticClass:"tw-align-items-center tw-flex tw-flex-grow-0"},[e("figure",{staticClass:"ffz-i-upload-cloud"}),t._v(" "),e("div",{staticClass:"tw-mg-l-05"},[t._v(`
						`+t._s(t.pending)+`
					`)])]),t._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[t._v(`
					`+t._s(t.t("i18n.ui.pending","Pending Strings"))+`
				`)])]):t._e(),t._v(" "),t.invalid?e("button",{staticClass:"tw-mg-l-05 tw-border-radius-medium tw-pd-x-05 ffz-core-button tw-c-text-base tw-interactive tw-relative ffz-il-tooltip__container",class:[t.mode===5?"ffz-core-button--primary":"ffz-core-button--text"],on:{click:function(s){t.mode=5}}},[e("div",{staticClass:"tw-align-items-center tw-flex tw-flex-grow-0"},[e("figure",{staticClass:"ffz-i-attention"}),t._v(" "),e("div",{staticClass:"tw-mg-l-05"},[t._v(`
						`+t._s(t.invalid)+`
					`)])]),t._v(" "),e("div",{staticClass:"ffz-il-tooltip ffz-il-tooltip--down ffz-il-tooltip--align-right"},[t._v(`
					`+t._s(t.t("i18n.ui.invalid","Invalid Strings"))+`
				`)])]):t._e()]),t._v(" "),e("simplebar",{attrs:{classes:"tw-flex-grow-1"}},t._l(t.paged,function(s){return e("i18n-entry",{key:s.key,attrs:{entry:s,"get-i18n":t.getI18n},on:{update:function(i){return t.update(s,i)},"update-context":function(i){return t.updateContext(s,i)}}})}),1)],1)])},"render"),d=[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"tw-absolute tw-align-items-center tw-c-text-alt-2 tw-flex tw-full-height ffz-input__icon tw-justify-content-center tw-left-0 tw-top-0 tw-z-default"},[e("figure",{staticClass:"ffz-i-search"})])},function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("span",{staticClass:"tw-button-icon__icon"},[e("figure",{staticClass:"ffz-i-floppy"})])},function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("span",{staticClass:"tw-button-icon__icon"},[e("figure",{staticClass:"ffz-i-upload-cloud"})])},function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("span",{staticClass:"tw-button-icon__icon"},[e("figure",{staticClass:"ffz-i-arrows-cw"})])},function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("span",{staticClass:"tw-button-icon__icon"},[e("figure",{staticClass:"ffz-i-link-ext"})])},function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("span",{staticClass:"tw-button-icon__icon"},[e("figure",{staticClass:"ffz-i-window-close"})])},function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("span",{staticClass:"tw-button-icon__icon"},[e("figure",{staticClass:"ffz-i-left-dir"})])},function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("span",{staticClass:"tw-button-icon__icon"},[e("figure",{staticClass:"ffz-i-right-dir"})])}],g=r(10388),c=r.n(g),p=r(22923),C=r.n(p),x=r(11227),b=r(46949);const z=new(C()),v=20,w={data(){const t=this.$vnode.data;return t.mode=0,t.page=1,t.page_open=!1,t.can_upload=!1,t.uploading=!1,t},computed:{filter(){return this.query.toLowerCase()},filtered(){const t=this.mode,n=this.query,e=n?.length>0;return t===0&&!e?this.phrases:this.phrases.filter(s=>e&&!(s.key&&s.key.toLowerCase().includes(n))&&!(s.phrase&&s.phrase.toLowerCase().includes(n))&&!(s.translation&&s.translation.toLowerCase().includes(n))?!1:t===1?s.known&&!s.different:t===2?!s.known:t===3?s.different:t===4?!s.known||s.different||s.context_changed:t===5?!s.valid:!0)},total(){return this.phrases.length},invalid(){return this.phrases.filter(t=>!t.valid).length},existing(){return this.total-(this.added+this.changed)},added(){return this.phrases.filter(t=>!t.known).length},changed(){return this.phrases.filter(t=>t.different).length},pending(){return this.phrases.filter(t=>!t.known||t.different||t.context_changed).length},pages(){return Math.ceil(this.filtered.length/v)},paged(){const t=(this.page-1)*v;return this.filtered.slice(t,t+v)}},watch:{pages(){this.pages==0?this.page=1:this.page>this.pages&&(this.page=this.pages)},maximized(){this.updateDrag()}},created(){this.checkUpload(),this.requestKeys(),this.grabKeys(),this.listen("i18n:got-keys",this.grabKeys,this),this.listen("i18n:loaded",this.grabKeys,this),this.listen("i18n:strings-loaded",this.grabKeys,this)},mounted(){this.updateDrag(),this._on_resize=this.handleResize.bind(this),window.addEventListener("resize",this._on_resize)},beforeDestroy(){this.destroyDrag(),this._on_resize&&(window.removeEventListener("resize",this._on_resize),this._on_resize=null),this.unlisten("i18n:got-keys",this.grabKeys,this),this.unlisten("i18n:loaded",this.grabKeys,this),this.unlisten("i18n:strings-loaded",this.grabKeys,this)},methods:{getBlob(){const t=[];for(const n of this.phrases)n.known&&!n.different&&!n.context_changed||t.push({key:n.key,calls:n.calls,options:n.options,phrase:n.translation});return t},saveBlob(){const t=this.getBlob();try{const n=new Blob([JSON.stringify(t,null,"	")],{type:"application/json;charset=utf-8"});(0,x.saveAs)(n,"ffz-strings.json")}catch(n){alert("Unable to save: "+n)}},async uploadBlob(){if(this.uploading||!this.can_upload)return;const t=JSON.stringify(this.getBlob()),n=this.getI18n().resolve("socket");if(!n)return;this.uploading=!0;const e=await n.getAPIToken();if(!e?.token)return;const s=await fetch("https://api-test.frankerfacez.com/v2/i18n/strings",{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e.token}`},body:t}).then(i=>i.json());alert(`Uploaded ${s?.added||0} new strings and ${s?.changed||0} changed strings.`),this.uploading=!1,this.getI18n().loadStrings(!0)},async checkUpload(){this.can_upload=!1;const t=this.getI18n().resolve("socket");if(!t)return;const n=await t.getAPIToken();!n?.token||!(await fetch(`https://api-test.frankerfacez.com/v2/user/${n.id}/role/strings_upload`,{headers:{Authorization:`Bearer ${n.token}`}}).then(s=>s.json()))?.has_role||(this.can_upload=!0)},openPage(){this.page_open=!0,this.$nextTick(()=>{this.$refs.pager.focus(),this.$refs.pager.select()})},closePage(){if(this.page_open){try{this.page=parseInt(this.$refs.pager.value,10),this.page<1?this.page=1:this.page>this.pages&&(this.page=this.pages)}catch{}this.page_open=!1}},prevPage(){this.page>1&&this.page--},nextPage(){this.page<this.pages&&this.page++},grabKeys(){this.phrases=[];for(const t of this.getKeys()){try{z.parse(t.translation),t.valid=!0}catch{t.valid=!1}t.original_opts=(0,b.deep_copy)(t.options),t.context_changed=!1,this.phrases.push(t)}this.phrases.sort((t,n)=>t.key.localeCompare(n.key))},update(t,n){t.translation=n;try{z.parse(n),t.valid=!0}catch{t.valid=!1}this.updatePhrase(t.key,n)},updateContext(t,n){n&&Object.keys(n).length===0&&(n=null),t.options=n,t.context_changed=!(0,b.deep_equals)(t.options,t.original_opts)},updateDrag(){this.maximized?this.destroyDrag():this.createDrag()},destroyDrag(){this.displace&&(this.displace.destroy(),this.displace=null)},createDrag(){this.$nextTick(()=>{this.maximized||(this.displace=c()(this.$el,{handle:this.$el.querySelector("header"),highlightInputs:!0,constrain:!0}))})},handleResize(){this.displace&&this.displace.reinit()}}};var E=r(72934),k=(0,E.Z)(w,f,d,!1,null,null,null);const $=k.exports},39628:(_,l,r)=>{var f={"./i18n-entry.vue":23512,"./translation-ui.vue":72900};function d(c){var p=g(c);return r(p)}h(d,"webpackContext");function g(c){if(!r.o(f,c)){var p=new Error("Cannot find module '"+c+"'");throw p.code="MODULE_NOT_FOUND",p}return f[c]}h(g,"webpackContextResolve"),d.keys=h(function(){return Object.keys(f)},"webpackContextKeys"),d.resolve=g,_.exports=d,d.id=39628}}]);})();

//# sourceMappingURL=translation-ui.js.map