{"version":3,"file":"script.min.js","mappings":"mGAEC,IAAM,CACN,MAAMA,EAAU,WAAW,SAAW,WAAW,OAEjD,GAEC,yEAAyE,KAAK,SAAS,QAAQ,GAG/F,uBAAuB,KAAK,SAAS,MAAM,GAG3C,SAAS,KAAK,QAAQ,UACrB,CAEDA,EAAQ,QAAQ,YAAY,CAC3B,KAAM,mBACP,CAAC,EACD,MACD,CAEA,SAAS,KAAK,QAAQ,UAAY,YAGlCA,EAAQ,QAAQ,YAAY,CAC3B,KAAM,eACP,CAAC,EAID,MAAMC,EAAc,IAAI,IAExB,SAASC,EAAcC,EAAI,CAC1B,GAAKF,EAAY,IAAIE,CAAE,EACtB,OAED,MAAMC,EAAOJ,EAAQ,QAAQ,QAAQ,EACrCC,EAAY,IAAIE,EAAIC,CAAI,EAExBA,EAAK,UAAU,YAAYC,GAAO,CACjC,OAAO,YAAY,CAClB,KAAM,kBACN,GAAAF,EACA,QAASE,CACV,CAAC,CACF,CAAC,EAEDD,EAAK,aAAa,YAAY,IAAM,CACnCH,EAAY,OAAOE,CAAE,EACrB,OAAO,YAAY,CAClB,KAAM,qBACN,GAAAA,CACD,CAAC,CACF,CAAC,CACF,CAtBS,EAAAD,EAAA,iBAwBT,SAASI,EAAiBH,EAAI,CAC7B,MAAMC,EAAOH,EAAY,IAAIE,CAAE,EAC1BC,IACJH,EAAY,OAAOE,CAAE,EACrBC,EAAK,WAAW,EAElB,CANS,EAAAE,EAAA,oBAQT,SAASC,EAAcJ,EAAIK,EAAS,CACnC,MAAMJ,EAAO,WAAW,IAAID,CAAE,EACzBC,GACJA,EAAK,YAAYI,CAAO,CAE1B,CALS,EAAAD,EAAA,iBAOT,OAAO,iBAAiB,UAAWE,GAAO,CACzC,GAAIA,EAAI,SAAW,QAAU,CAAEA,EAAI,KAClC,OAED,KAAM,CAAE,KAAAC,EAAM,GAAAP,EAAI,QAAAK,CAAQ,EAAIC,EAAI,KAE7BC,IAAS,kBACbR,EAAcC,CAAE,EAEPO,IAAS,kBAClBH,EAAcJ,EAAIK,CAAO,EAEhBE,IAAS,sBAClBJ,EAAiBH,CAAE,CACrB,CAAC,EAIDH,EAAQ,QAAQ,UAAU,YAAY,CAACK,EAAKM,KACvCN,GAAK,OAAS,eACjB,OAAO,YAAYA,EAAI,KAAM,GAAG,EAE1B,GACP,EAGD,MAAMO,EAAO,SAAS,SACrBC,EAASb,EAAQ,QAAQ,OAAO,KAAK,EACrCc,EAAS,SAAS,cAAc,QAAQ,EAEzC,IAAIC,EACFH,EAAK,SAAS,QAAQ,EAAI,SACzBA,EAAK,SAAS,OAAO,EAAI,QACvB,SAAS,WAAa,iBAAmB,SAAW,SAErDG,IAAW,SAAW,SAAS,WAAa,WAC/CA,EAAS,UAEVD,EAAO,GAAK,aACZA,EAAO,MAAQ,GACfA,EAAO,YAAc,YACrBA,EAAO,IAAM,GAAGD,CAAM,IAAIE,CAAM,SAAS,KAAK,IAAI,CAAC,GACnDD,EAAO,QAAQ,KAAOD,EAEtB,SAAS,KAAK,YAAYC,CAAM,CACjC,GAAG","sources":["webpack://frankerfacez/script.min.js"],"sourcesContent":["/* eslint strict: off */\n'use strict';\n(() => {\n\tconst browser = globalThis.browser ?? globalThis.chrome;\n\n\tif (\n\t\t// Don't run on certain sub-domains.\n\t\t/^(?:localhost\\.rig|blog|im|chatdepot|tmi|api|brand|dev|gql|passport)\\./.test(location.hostname)\n\t\t||\n\t\t// Don't run on pages that have disabled FFZ.\n\t\t/disable_frankerfacez/.test(location.search)\n\t\t||\n\t\t// Don't run on pages we've already run on.\n\t\tdocument.body.dataset.ffzSource\n\t) {\n\t\t// Tell the service worker we aren't injecting.\n\t\tbrowser.runtime.sendMessage({\n\t\t\ttype: 'ffz_not_supported'\n\t\t});\n\t\treturn;\n\t}\n\n\tdocument.body.dataset.ffzSource = 'extension';\n\n\t// Make sure to wake the service worker up early.\n\tbrowser.runtime.sendMessage({\n\t\ttype: 'ffz_injecting'\n\t});\n\n\t// Set up a bridge for connections, since Firefox\n\t// doesn't support externally_connectable.\n\tconst connections = new Map;\n\n\tfunction handleConnect(id) {\n\t\tif ( connections.has(id) )\n\t\t\treturn;\n\n\t\tconst port = browser.runtime.connect();\n\t\tconnections.set(id, port);\n\n\t\tport.onMessage.addListener(msg => {\n\t\t\twindow.postMessage({\n\t\t\t\ttype: 'ffz-con-message',\n\t\t\t\tid,\n\t\t\t\tpayload: msg\n\t\t\t})\n\t\t});\n\n\t\tport.onDisconnect.addListener(() => {\n\t\t\tconnections.delete(id);\n\t\t\twindow.postMessage({\n\t\t\t\ttype: 'ffz-con-disconnect',\n\t\t\t\tid\n\t\t\t});\n\t\t});\n\t}\n\n\tfunction handleDisconnect(id) {\n\t\tconst port = connections.get(id);\n\t\tif ( port ) {\n\t\t\tconnections.delete(id);\n\t\t\tport.disconnect();\n\t\t}\n\t}\n\n\tfunction handleMessage(id, payload) {\n\t\tconst port = connection.get(id);\n\t\tif ( port ) {\n\t\t\tport.postMessage(payload);\n\t\t}\n\t}\n\n\twindow.addEventListener('message', evt => {\n\t\tif (evt.source !== window || ! evt.data )\n\t\t\treturn;\n\n\t\tconst { type, id, payload } = evt.data;\n\n\t\tif ( type === 'ffz-con-connect' )\n\t\t\thandleConnect(id);\n\n\t\telse if ( type === 'ffz-con-message' )\n\t\t\thandleMessage(id, payload);\n\n\t\telse if ( type === 'ffz-con-disconnect' )\n\t\t\thandleDisconnect(id);\n\t});\n\n\n\t// Let the extension send messages to the page directly.\n\tbrowser.runtime.onMessage.addListener((msg, sender) => {\n\t\tif (msg?.type === 'ffz_to_page')\n\t\t\twindow.postMessage(msg.data, '*');\n\n\t\treturn false;\n\t});\n\n\t// Now, inject our script into the page context.\n\tconst HOST = location.hostname,\n\t\tSERVER = browser.runtime.getURL(\"web\"),\n\t\tscript = document.createElement('script');\n\n\tlet FLAVOR =\n\t\t\tHOST.includes('player') ? 'player' :\n\t\t\t\tHOST.includes('clips') ? 'clips' :\n\t\t\t\t\t(location.pathname === '/p/ffz_bridge/' ? 'bridge' : 'avalon');\n\n\tif (FLAVOR === 'clips' && location.pathname === '/embed')\n\t\tFLAVOR = 'player';\n\n\tscript.id = 'ffz-script';\n\tscript.async = true;\n\tscript.crossOrigin = 'anonymous';\n\tscript.src = `${SERVER}/${FLAVOR}.js?_=${Date.now()}`;\n\tscript.dataset.path = SERVER;\n\n\tdocument.head.appendChild(script);\n})();\n"],"names":["browser","connections","handleConnect","id","port","msg","handleDisconnect","handleMessage","payload","evt","type","sender","HOST","SERVER","script","FLAVOR"],"sourceRoot":""}