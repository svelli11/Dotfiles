{"version":3,"file":"content/proxy/proxy_Hidive.js","mappings":"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","sources":["webpack://MALSync/./src/utils/console.ts","webpack://MALSync/webpack/bootstrap","webpack://MALSync/webpack/runtime/define property getters","webpack://MALSync/webpack/runtime/hasOwnProperty shorthand","webpack://MALSync/webpack/runtime/make namespace object","webpack://MALSync/./src/utils/scriptProxyWrapper.ts","webpack://MALSync/./src/pages/Hidive/proxy.ts","data:text/javascript;base64,CiAgICAgIGltcG9ydCB7IHNjcmlwdCB9IGZyb20gJy4vc3JjL3BhZ2VzL0hpZGl2ZS9wcm94eS50cyc7CiAgICAgIGltcG9ydCB7IFNjcmlwdFByb3h5V3JhcHBlciB9IGZyb20gJy4vc3JjL3V0aWxzL3NjcmlwdFByb3h5V3JhcHBlci50cyc7CgogICAgICBTY3JpcHRQcm94eVdyYXBwZXIoc2NyaXB0KTsKICAgIA=="],"sourcesContent":["/* eslint-disable no-bitwise */\n\nexport const log = (function () {\n  return Function.prototype.bind.call(\n    console.log,\n    console,\n    '%cMAL-Sync',\n    'background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;',\n  );\n})();\n\nexport const error = (function () {\n  return Function.prototype.bind.call(\n    console.error,\n    console,\n    '%cMAL-Sync',\n    'background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;',\n  );\n})();\n\nexport const info = (function () {\n  return Function.prototype.bind.call(\n    console.info,\n    console,\n    '%cMAL-Sync',\n    'background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;',\n  );\n})();\n\nexport const debug = (function () {\n  return Function.prototype.bind.call(\n    console.debug,\n    console,\n    '%cMAL-Sync',\n    'background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;',\n  );\n})();\n\nexport const m = (name, color = '', blocks: { name: string; style: string }[] = []) => {\n  let fontColor = 'white';\n  if (!color) color = stringToColour(name);\n  if (color[0] === '#') fontColor = getColorByBgColor(color);\n  const style = `background-color: ${color}; color: ${fontColor}; padding: 2px 10px; border-radius: 3px; margin-left: -5px; border-left: 1px solid white;`;\n  blocks.push({\n    name,\n    style,\n  });\n\n  const temp: any = {};\n\n  temp.m = (name2, color2 = '') => {\n    return m(name2, color2, [...blocks]);\n  };\n\n  const moduleText = blocks.reduce((sum, el) => `${sum}%c${el.name}`, '');\n  const moduleStyle = blocks.map(el => el.style);\n\n  temp.log = (function () {\n    return Function.prototype.bind.call(\n      console.log,\n      console,\n      `%cM ${moduleText}`,\n      'background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;',\n      ...moduleStyle,\n    );\n  })();\n\n  temp.error = (function () {\n    return Function.prototype.bind.call(\n      console.error,\n      console,\n      `%cM ${moduleText}`,\n      'background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;',\n      ...moduleStyle,\n    );\n  })();\n\n  temp.info = (function () {\n    return Function.prototype.bind.call(\n      console.info,\n      console,\n      `%cM ${moduleText}`,\n      'background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;',\n      ...moduleStyle,\n    );\n  })();\n\n  temp.debug = (function () {\n    return Function.prototype.bind.call(\n      console.debug,\n      console,\n      `%cM ${moduleText}`,\n      'background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;',\n      ...moduleStyle,\n    );\n  })();\n\n  return temp;\n};\n\nfunction stringToColour(str) {\n  if (!str) return '#ffffff';\n  str = String(str);\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    hash = str.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  let colour = '#';\n  for (let i = 0; i < 3; i++) {\n    const value = (hash >> (i * 8)) & 0xff;\n    colour += `00${value.toString(16)}`.substr(-2);\n  }\n  return colour;\n}\n\nfunction getColorByBgColor(bgColor) {\n  return parseInt(bgColor.replace('#', ''), 16) > 0xffffff / 2 ? '#000' : '#fff';\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * Generates a (hex) string ID for randomisation/verification.\n */\nexport function generateUniqueID(arraySize = 10): string {\n  const array = new Uint32Array(arraySize);\n  window.crypto.getRandomValues(array);\n  return Array.from(array, value => value.toString(16)).join('');\n}\n\nexport function ScriptProxyWrapper(fnc: () => void) {\n  const tag = document.currentScript as HTMLScriptElement;\n  const idAttribute = tag.getAttribute('id')!;\n  const logger = con.m('ScriptProxyWrapper');\n\n  window.addEventListener(\n    'message',\n    event => {\n      if (!(event instanceof MessageEvent)) {\n        return;\n      }\n\n      const eventData: MessageEvent = event;\n\n      if (!eventData.data.eventId || eventData.data.resultId) return;\n\n      const resultId = generateUniqueID();\n      const res = fnc();\n\n      const scriptElement = document.createElement('script');\n      scriptElement.id = resultId;\n      scriptElement.setAttribute(\n        `data-${eventData.data.eventId}`,\n        JSON.stringify({\n          [idAttribute]: res,\n        }),\n      );\n      document.documentElement.appendChild(scriptElement);\n\n      window.postMessage({ eventId: eventData.data.eventId, resultId }, '*');\n    },\n    false,\n  );\n\n  window.postMessage({ uniqueId: tag.getAttribute(`data-${idAttribute}`) }, '*');\n\n  logger.log('Listener Added');\n  tag.remove();\n}\n","/* eslint-disable consistent-return */\nexport function script() {\n  if (!(window as any).fetchOverride) {\n    (window as any).malsyncData = {};\n\n    // eslint-disable-next-line no-var\n    var originalFetch = fetch;\n    // @ts-ignore\n    // eslint-disable-next-line no-global-assign\n    fetch = (input, init) =>\n      originalFetch(input, init).then(response => {\n        try {\n          const url = input.url || input;\n          if (url.includes('/api/')) {\n            const res = response.clone();\n            res.json().then(data => {\n              if (data && data.type && data.type === 'VOD' && data.id) {\n                (window as any).malsyncData[data.id] = data;\n                checkForTitle(url, data, init)\n                  .then(title => {\n                    if (title) {\n                      (window as any).malsyncData[data.id].malsync_title = title;\n                    }\n                  })\n                  .finally(() => {\n                    (window as any).malsyncData[data.id].done = true;\n                  });\n              }\n            });\n          }\n        } catch (e) {\n          console.error('MALSYNC', e);\n        }\n\n        return response;\n      });\n\n    console.log('MALSYNC', 'Fetch override added.');\n    (window as any).fetchOverride = true;\n  }\n\n  if (Object.prototype.hasOwnProperty.call(window as any, 'malsyncData')) {\n    return (window as any).malsyncData;\n  }\n  return undefined;\n\n  async function checkForTitle(url, data, options) {\n    if (!url) return;\n    if (!data.episodeInformation || !data.episodeInformation.season) return;\n    const seriesId = String(data.episodeInformation.season);\n    if (!seriesId) return;\n    const storageTitle = window.sessionStorage.getItem(`malsyncData_${seriesId}`);\n    if (storageTitle) return storageTitle;\n    url = new URL(url);\n    url.pathname = 'api/v1/view';\n    url.search = `?type=season&id=${seriesId}`;\n    return originalFetch(url.toString(), options).then(response => {\n      return response.json().then(data2 => {\n        const header = data2.elements.find(x => x.$zone === 'header');\n        if (!header) return;\n        const title = header.attributes.header.attributes.text;\n        if (!title) return;\n        window.sessionStorage.setItem(`malsyncData_${seriesId}`, title);\n        return title;\n      });\n    });\n  }\n}\n","\n      import { script } from './src/pages/Hidive/proxy.ts';\n      import { ScriptProxyWrapper } from './src/utils/scriptProxyWrapper.ts';\n\n      ScriptProxyWrapper(script);\n    "],"names":["log","Function","prototype","bind","call","console","error","info","debug","m","name","color","blocks","fontColor","str","String","hash","i","length","charCodeAt","colour","toString","substr","stringToColour","parseInt","replace","style","push","temp","name2","color2","moduleText","reduce","sum","el","moduleStyle","map","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","hasOwnProperty","r","Symbol","toStringTag","value","tag","document","currentScript","idAttribute","getAttribute","logger","con","window","addEventListener","event","MessageEvent","eventData","data","eventId","resultId","arraySize","array","Uint32Array","crypto","getRandomValues","Array","from","join","generateUniqueID","res","fetchOverride","malsyncData","originalFetch","fetch","input","init","then","response","url","includes","clone","json","type","id","async","options","episodeInformation","season","seriesId","sessionStorage","getItem","URL","pathname","search","data2","header","elements","find","x","$zone","title","attributes","text","setItem","checkForTitle","malsync_title","finally","done","e","fnc","scriptElement","createElement","setAttribute","JSON","stringify","documentElement","appendChild","postMessage","uniqueId","remove","ScriptProxyWrapper"],"sourceRoot":""}