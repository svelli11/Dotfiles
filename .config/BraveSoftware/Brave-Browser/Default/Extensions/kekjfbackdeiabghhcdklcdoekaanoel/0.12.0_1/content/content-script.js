/*! For license information please see content-script.js.LICENSE.txt */
(()=>{var e={50953:(e,t,n)=>{"use strict";n.d(t,{C4:()=>E,EW:()=>Oe,Gc:()=>pe,IG:()=>_e,KR:()=>ke,Kh:()=>he,Pr:()=>$e,R1:()=>xe,X2:()=>l,bl:()=>k,fE:()=>ye,g8:()=>ge,hV:()=>Re,hZ:()=>R,i9:()=>Ee,ju:()=>ve,lJ:()=>we,qA:()=>D,u4:()=>P,ux:()=>be,wB:()=>Pe,yC:()=>r});var s=n(90033);let i,a;class r{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=i,!e&&i&&(this.index=(i.scopes||(i.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){let e,t;if(this._isPaused=!0,this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].pause();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){let e,t;if(this._isPaused=!1,this.scopes)for(e=0,t=this.scopes.length;e<t;e++)this.scopes[e].resume();for(e=0,t=this.effects.length;e<t;e++)this.effects[e].resume()}}run(e){if(this._active){const t=i;try{return i=this,e()}finally{i=t}}}on(){i=this}off(){i=this.parent}stop(e){if(this._active){let t,n;for(this._active=!1,t=0,n=this.effects.length;t<n;t++)this.effects[t].stop();for(this.effects.length=0,t=0,n=this.cleanups.length;t<n;t++)this.cleanups[t]();if(this.cleanups.length=0,this.scopes){for(t=0,n=this.scopes.length;t<n;t++)this.scopes[t].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const e=this.parent.scopes.pop();e&&e!==this&&(this.parent.scopes[this.index]=e,e.index=this.index)}this.parent=void 0}}}const o=new WeakSet;class l{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,i&&i.active&&i.effects.push(this)}pause(){this.flags|=64}resume(){64&this.flags&&(this.flags&=-65,o.has(this)&&(o.delete(this),this.trigger()))}notify(){2&this.flags&&!(32&this.flags)||8&this.flags||p(this)}run(){if(!(1&this.flags))return this.fn();this.flags|=2,I(this),g(this);const e=a,t=w;a=this,w=!0;try{return this.fn()}finally{f(this),a=e,w=t,this.flags&=-3}}stop(){if(1&this.flags){for(let e=this.deps;e;e=e.nextDep)b(e);this.deps=this.depsTail=void 0,I(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){64&this.flags?o.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){y(this)&&this.run()}get dirty(){return y(this)}}let c,u,h=0;function p(e,t=!1){if(e.flags|=8,t)return e.next=u,void(u=e);e.next=c,c=e}function m(){h++}function d(){if(--h>0)return;if(u){let e=u;for(u=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let e;for(;c;){let t=c;for(c=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,1&t.flags)try{t.trigger()}catch(t){e||(e=t)}t=n}}if(e)throw e}function g(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function f(e){let t,n=e.depsTail,s=n;for(;s;){const e=s.prevDep;-1===s.version?(s===n&&(n=e),b(s),_(s)):t=s,s.dep.activeLink=s.prevActiveLink,s.prevActiveLink=void 0,s=e}e.deps=t,e.depsTail=n}function y(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(v(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function v(e){if(4&e.flags&&!(16&e.flags))return;if(e.flags&=-17,e.globalVersion===x)return;e.globalVersion=x;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!y(e))return void(e.flags&=-3);const n=a,i=w;a=e,w=!0;try{g(e);const n=e.fn(e._value);(0===t.version||(0,s.$H)(n,e._value))&&(e._value=n,t.version++)}catch(e){throw t.version++,e}finally{a=n,w=i,f(e),e.flags&=-3}}function b(e,t=!1){const{dep:n,prevSub:s,nextSub:i}=e;if(s&&(s.nextSub=i,e.prevSub=void 0),i&&(i.prevSub=s,e.nextSub=void 0),n.subs===e&&(n.subs=s,!s&&n.computed)){n.computed.flags&=-5;for(let e=n.computed.deps;e;e=e.nextDep)b(e,!0)}t||--n.sc||!n.map||n.map.delete(n.key)}function _(e){const{prevDep:t,nextDep:n}=e;t&&(t.nextDep=n,e.prevDep=void 0),n&&(n.prevDep=t,e.nextDep=void 0)}let w=!0;const S=[];function E(){S.push(w),w=!1}function k(){const e=S.pop();w=void 0===e||e}function I(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const e=a;a=void 0;try{t()}finally{a=e}}}let x=0;class T{constructor(e,t){this.sub=e,this.dep=t,this.version=t.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class ${constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!a||!w||a===this.computed)return;let t=this.activeLink;if(void 0===t||t.sub!==a)t=this.activeLink=new T(a,this),a.deps?(t.prevDep=a.depsTail,a.depsTail.nextDep=t,a.depsTail=t):a.deps=a.depsTail=t,N(t);else if(-1===t.version&&(t.version=this.version,t.nextDep)){const e=t.nextDep;e.prevDep=t.prevDep,t.prevDep&&(t.prevDep.nextDep=e),t.prevDep=a.depsTail,t.nextDep=void 0,a.depsTail.nextDep=t,a.depsTail=t,a.deps===t&&(a.deps=e)}return t}trigger(e){this.version++,x++,this.notify(e)}notify(e){m();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{d()}}}function N(e){if(e.dep.sc++,4&e.sub.flags){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let e=t.deps;e;e=e.nextDep)N(e)}const n=e.dep.subs;n!==e&&(e.prevSub=n,n&&(n.nextSub=e)),e.dep.subs=e}}const O=new WeakMap,C=Symbol(""),L=Symbol(""),A=Symbol("");function P(e,t,n){if(w&&a){let t=O.get(e);t||O.set(e,t=new Map);let s=t.get(n);s||(t.set(n,s=new $),s.map=t,s.key=n),s.track()}}function R(e,t,n,i,a,r){const o=O.get(e);if(!o)return void x++;const l=e=>{e&&e.trigger()};if(m(),"clear"===t)o.forEach(l);else{const a=(0,s.cy)(e),r=a&&(0,s.yI)(n);if(a&&"length"===n){const e=Number(i);o.forEach(((t,n)=>{("length"===n||n===A||!(0,s.Bm)(n)&&n>=e)&&l(t)}))}else switch((void 0!==n||o.has(void 0))&&l(o.get(n)),r&&l(o.get(A)),t){case"add":a?r&&l(o.get("length")):(l(o.get(C)),(0,s.CE)(e)&&l(o.get(L)));break;case"delete":a||(l(o.get(C)),(0,s.CE)(e)&&l(o.get(L)));break;case"set":(0,s.CE)(e)&&l(o.get(C))}}d()}function M(e){const t=be(e);return t===e?t:(P(t,0,A),ye(e)?t:t.map(we))}function D(e){return P(e=be(e),0,A),e}const U={__proto__:null,[Symbol.iterator](){return j(this,Symbol.iterator,we)},concat(...e){return M(this).concat(...e.map((e=>(0,s.cy)(e)?M(e):e)))},entries(){return j(this,"entries",(e=>(e[1]=we(e[1]),e)))},every(e,t){return V(this,"every",e,t,void 0,arguments)},filter(e,t){return V(this,"filter",e,t,(e=>e.map(we)),arguments)},find(e,t){return V(this,"find",e,t,we,arguments)},findIndex(e,t){return V(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return V(this,"findLast",e,t,we,arguments)},findLastIndex(e,t){return V(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return V(this,"forEach",e,t,void 0,arguments)},includes(...e){return H(this,"includes",e)},indexOf(...e){return H(this,"indexOf",e)},join(e){return M(this).join(e)},lastIndexOf(...e){return H(this,"lastIndexOf",e)},map(e,t){return V(this,"map",e,t,void 0,arguments)},pop(){return B(this,"pop")},push(...e){return B(this,"push",e)},reduce(e,...t){return z(this,"reduce",e,t)},reduceRight(e,...t){return z(this,"reduceRight",e,t)},shift(){return B(this,"shift")},some(e,t){return V(this,"some",e,t,void 0,arguments)},splice(...e){return B(this,"splice",e)},toReversed(){return M(this).toReversed()},toSorted(e){return M(this).toSorted(e)},toSpliced(...e){return M(this).toSpliced(...e)},unshift(...e){return B(this,"unshift",e)},values(){return j(this,"values",we)}};function j(e,t,n){const s=D(e),i=s[t]();return s===e||ye(e)||(i._next=i.next,i.next=()=>{const e=i._next();return e.value&&(e.value=n(e.value)),e}),i}const F=Array.prototype;function V(e,t,n,s,i,a){const r=D(e),o=r!==e&&!ye(e),l=r[t];if(l!==F[t]){const t=l.apply(e,a);return o?we(t):t}let c=n;r!==e&&(o?c=function(t,s){return n.call(this,we(t),s,e)}:n.length>2&&(c=function(t,s){return n.call(this,t,s,e)}));const u=l.call(r,c,s);return o&&i?i(u):u}function z(e,t,n,s){const i=D(e);let a=n;return i!==e&&(ye(e)?n.length>3&&(a=function(t,s,i){return n.call(this,t,s,i,e)}):a=function(t,s,i){return n.call(this,t,we(s),i,e)}),i[t](a,...s)}function H(e,t,n){const s=be(e);P(s,0,A);const i=s[t](...n);return-1!==i&&!1!==i||!ve(n[0])?i:(n[0]=be(n[0]),s[t](...n))}function B(e,t,n=[]){E(),m();const s=be(e)[t].apply(e,n);return d(),k(),s}const W=(0,s.pD)("__proto__,__v_isRef,__isVue"),G=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(s.Bm));function K(e){(0,s.Bm)(e)||(e=String(e));const t=be(this);return P(t,0,e),t.hasOwnProperty(e)}class q{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if("__v_skip"===t)return e.__v_skip;const i=this._isReadonly,a=this._isShallow;if("__v_isReactive"===t)return!i;if("__v_isReadonly"===t)return i;if("__v_isShallow"===t)return a;if("__v_raw"===t)return n===(i?a?ue:ce:a?le:oe).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const r=(0,s.cy)(e);if(!i){let e;if(r&&(e=U[t]))return e;if("hasOwnProperty"===t)return K}const o=Reflect.get(e,t,Ee(e)?e:n);return((0,s.Bm)(t)?G.has(t):W(t))?o:(i||P(e,0,t),a?o:Ee(o)?r&&(0,s.yI)(t)?o:o.value:(0,s.Gv)(o)?i?me(o):he(o):o)}}class X extends q{constructor(e=!1){super(!1,e)}set(e,t,n,i){let a=e[t];if(!this._isShallow){const t=fe(a);if(ye(n)||fe(n)||(a=be(a),n=be(n)),!(0,s.cy)(e)&&Ee(a)&&!Ee(n))return!t&&(a.value=n,!0)}const r=(0,s.cy)(e)&&(0,s.yI)(t)?Number(t)<e.length:(0,s.$3)(e,t),o=Reflect.set(e,t,n,Ee(e)?e:i);return e===be(i)&&(r?(0,s.$H)(n,a)&&R(e,"set",t,n):R(e,"add",t,n)),o}deleteProperty(e,t){const n=(0,s.$3)(e,t),i=(e[t],Reflect.deleteProperty(e,t));return i&&n&&R(e,"delete",t,void 0),i}has(e,t){const n=Reflect.has(e,t);return(0,s.Bm)(t)&&G.has(t)||P(e,0,t),n}ownKeys(e){return P(e,0,(0,s.cy)(e)?"length":C),Reflect.ownKeys(e)}}class Y extends q{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const J=new X,Z=new Y,Q=new X(!0),ee=e=>e,te=e=>Reflect.getPrototypeOf(e);function ne(e){return function(...t){return"delete"!==e&&("clear"===e?void 0:this)}}function se(e,t){const n=function(e,t){const n={get(n){const i=this.__v_raw,a=be(i),r=be(n);e||((0,s.$H)(n,r)&&P(a,0,n),P(a,0,r));const{has:o}=te(a),l=t?ee:e?Se:we;return o.call(a,n)?l(i.get(n)):o.call(a,r)?l(i.get(r)):void(i!==a&&i.get(n))},get size(){const t=this.__v_raw;return!e&&P(be(t),0,C),Reflect.get(t,"size",t)},has(t){const n=this.__v_raw,i=be(n),a=be(t);return e||((0,s.$H)(t,a)&&P(i,0,t),P(i,0,a)),t===a?n.has(t):n.has(t)||n.has(a)},forEach(n,s){const i=this,a=i.__v_raw,r=be(a),o=t?ee:e?Se:we;return!e&&P(r,0,C),a.forEach(((e,t)=>n.call(s,o(e),o(t),i)))}};return(0,s.X$)(n,e?{add:ne("add"),set:ne("set"),delete:ne("delete"),clear:ne("clear")}:{add(e){t||ye(e)||fe(e)||(e=be(e));const n=be(this);return te(n).has.call(n,e)||(n.add(e),R(n,"add",e,e)),this},set(e,n){t||ye(n)||fe(n)||(n=be(n));const i=be(this),{has:a,get:r}=te(i);let o=a.call(i,e);o||(e=be(e),o=a.call(i,e));const l=r.call(i,e);return i.set(e,n),o?(0,s.$H)(n,l)&&R(i,"set",e,n):R(i,"add",e,n),this},delete(e){const t=be(this),{has:n,get:s}=te(t);let i=n.call(t,e);i||(e=be(e),i=n.call(t,e)),s&&s.call(t,e);const a=t.delete(e);return i&&R(t,"delete",e,void 0),a},clear(){const e=be(this),t=0!==e.size,n=e.clear();return t&&R(e,"clear",void 0,void 0),n}}),["keys","values","entries",Symbol.iterator].forEach((i=>{n[i]=function(e,t,n){return function(...i){const a=this.__v_raw,r=be(a),o=(0,s.CE)(r),l="entries"===e||e===Symbol.iterator&&o,c="keys"===e&&o,u=a[e](...i),h=n?ee:t?Se:we;return!t&&P(r,0,c?L:C),{next(){const{value:e,done:t}=u.next();return t?{value:e,done:t}:{value:l?[h(e[0]),h(e[1])]:h(e),done:t}},[Symbol.iterator](){return this}}}}(i,e,t)})),n}(e,t);return(t,i,a)=>"__v_isReactive"===i?!e:"__v_isReadonly"===i?e:"__v_raw"===i?t:Reflect.get((0,s.$3)(n,i)&&i in t?n:t,i,a)}const ie={get:se(!1,!1)},ae={get:se(!1,!0)},re={get:se(!0,!1)},oe=new WeakMap,le=new WeakMap,ce=new WeakMap,ue=new WeakMap;function he(e){return fe(e)?e:de(e,!1,J,ie,oe)}function pe(e){return de(e,!1,Q,ae,le)}function me(e){return de(e,!0,Z,re,ce)}function de(e,t,n,i,a){if(!(0,s.Gv)(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const r=a.get(e);if(r)return r;const o=function(e){return e.__v_skip||!Object.isExtensible(e)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((0,s.Zf)(e))}(e);if(0===o)return e;const l=new Proxy(e,2===o?i:n);return a.set(e,l),l}function ge(e){return fe(e)?ge(e.__v_raw):!(!e||!e.__v_isReactive)}function fe(e){return!(!e||!e.__v_isReadonly)}function ye(e){return!(!e||!e.__v_isShallow)}function ve(e){return!!e&&!!e.__v_raw}function be(e){const t=e&&e.__v_raw;return t?be(t):e}function _e(e){return!(0,s.$3)(e,"__v_skip")&&Object.isExtensible(e)&&(0,s.yQ)(e,"__v_skip",!0),e}const we=e=>(0,s.Gv)(e)?he(e):e,Se=e=>(0,s.Gv)(e)?me(e):e;function Ee(e){return!!e&&!0===e.__v_isRef}function ke(e){return n=!1,Ee(t=e)?t:new Ie(t,n);var t,n}class Ie{constructor(e,t){this.dep=new $,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:be(e),this._value=t?e:we(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,n=this.__v_isShallow||ye(e)||fe(e);e=n?e:be(e),(0,s.$H)(e,t)&&(this._rawValue=e,this._value=n?e:we(e),this.dep.trigger())}}function xe(e){return Ee(e)?e.value:e}const Te={get:(e,t,n)=>"__v_raw"===t?e:xe(Reflect.get(e,t,n)),set:(e,t,n,s)=>{const i=e[t];return Ee(i)&&!Ee(n)?(i.value=n,!0):Reflect.set(e,t,n,s)}};function $e(e){return ge(e)?e:new Proxy(e,Te)}class Ne{constructor(e,t,n){this.fn=e,this.setter=t,this._value=void 0,this.dep=new $(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=x-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!t,this.isSSR=n}notify(){if(this.flags|=16,!(8&this.flags||a===this))return p(this,!0),!0}get value(){const e=this.dep.track();return v(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function Oe(e,t,n=!1){let i,a;return(0,s.Tn)(e)?i=e:(i=e.get,a=e.set),new Ne(i,a,n)}const Ce={},Le=new WeakMap;let Ae;function Pe(e,t,n=s.MZ){const{immediate:a,deep:r,once:o,scheduler:c,augmentJob:u,call:h}=n,p=e=>r?e:ye(e)||!1===r||0===r?Re(e,1):Re(e);let m,d,g,f,y=!1,v=!1;if(Ee(e)?(d=()=>e.value,y=ye(e)):ge(e)?(d=()=>p(e),y=!0):(0,s.cy)(e)?(v=!0,y=e.some((e=>ge(e)||ye(e))),d=()=>e.map((e=>Ee(e)?e.value:ge(e)?p(e):(0,s.Tn)(e)?h?h(e,2):e():void 0))):d=(0,s.Tn)(e)?t?h?()=>h(e,2):e:()=>{if(g){E();try{g()}finally{k()}}const t=Ae;Ae=m;try{return h?h(e,3,[f]):e(f)}finally{Ae=t}}:s.tE,t&&r){const e=d,t=!0===r?1/0:r;d=()=>Re(e(),t)}const b=i,_=()=>{m.stop(),b&&b.active&&(0,s.TF)(b.effects,m)};if(o&&t){const e=t;t=(...t)=>{e(...t),_()}}let w=v?new Array(e.length).fill(Ce):Ce;const S=e=>{if(1&m.flags&&(m.dirty||e))if(t){const e=m.run();if(r||y||(v?e.some(((e,t)=>(0,s.$H)(e,w[t]))):(0,s.$H)(e,w))){g&&g();const n=Ae;Ae=m;try{const n=[e,w===Ce?void 0:v&&w[0]===Ce?[]:w,f];h?h(t,3,n):t(...n),w=e}finally{Ae=n}}}else m.run()};return u&&u(S),m=new l(d),m.scheduler=c?()=>c(S,!1):S,f=e=>function(e,t=!1,n=Ae){if(n){let t=Le.get(n);t||Le.set(n,t=[]),t.push(e)}}(e,!1,m),g=m.onStop=()=>{const e=Le.get(m);if(e){if(h)h(e,4);else for(const t of e)t();Le.delete(m)}},t?a?S(!0):w=m.run():c?c(S.bind(null,!0),!0):m.run(),_.pause=m.pause.bind(m),_.resume=m.resume.bind(m),_.stop=_,_}function Re(e,t=1/0,n){if(t<=0||!(0,s.Gv)(e)||e.__v_skip)return e;if((n=n||new Set).has(e))return e;if(n.add(e),t--,Ee(e))Re(e.value,t,n);else if((0,s.cy)(e))for(let s=0;s<e.length;s++)Re(e[s],t,n);else if((0,s.vM)(e)||(0,s.CE)(e))e.forEach((e=>{Re(e,t,n)}));else if((0,s.Qd)(e)){for(const s in e)Re(e[s],t,n);for(const s of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,s)&&Re(e[s],t,n)}return e}},90033:(e,t,n)=>{"use strict";function s(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return e=>e in t}n.d(t,{$3:()=>m,$H:()=>D,BH:()=>B,BX:()=>Q,Bm:()=>w,C4:()=>Y,CE:()=>g,CP:()=>c,DY:()=>U,Gv:()=>S,J$:()=>J,Kg:()=>_,MZ:()=>i,Mp:()=>l,NO:()=>o,Oj:()=>a,PT:()=>L,Qd:()=>T,Ro:()=>V,SU:()=>N,TF:()=>h,Tg:()=>P,Tn:()=>b,Tr:()=>W,We:()=>H,X$:()=>u,Y2:()=>Z,ZH:()=>R,Zf:()=>x,bB:()=>F,cy:()=>d,gd:()=>v,pD:()=>s,rU:()=>M,tE:()=>r,u3:()=>ee,vM:()=>f,v_:()=>ne,yI:()=>$,yL:()=>E,yQ:()=>j});const i={},a=[],r=()=>{},o=()=>!1,l=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),c=e=>e.startsWith("onUpdate:"),u=Object.assign,h=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},p=Object.prototype.hasOwnProperty,m=(e,t)=>p.call(e,t),d=Array.isArray,g=e=>"[object Map]"===I(e),f=e=>"[object Set]"===I(e),y=e=>"[object Date]"===I(e),v=e=>"[object RegExp]"===I(e),b=e=>"function"==typeof e,_=e=>"string"==typeof e,w=e=>"symbol"==typeof e,S=e=>null!==e&&"object"==typeof e,E=e=>(S(e)||b(e))&&b(e.then)&&b(e.catch),k=Object.prototype.toString,I=e=>k.call(e),x=e=>I(e).slice(8,-1),T=e=>"[object Object]"===I(e),$=e=>_(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,N=s(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),O=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},C=/-(\w)/g,L=O((e=>e.replace(C,((e,t)=>t?t.toUpperCase():"")))),A=/\B([A-Z])/g,P=O((e=>e.replace(A,"-$1").toLowerCase())),R=O((e=>e.charAt(0).toUpperCase()+e.slice(1))),M=O((e=>e?`on${R(e)}`:"")),D=(e,t)=>!Object.is(e,t),U=(e,...t)=>{for(let n=0;n<e.length;n++)e[n](...t)},j=(e,t,n,s=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:s,value:n})},F=e=>{const t=parseFloat(e);return isNaN(t)?e:t},V=e=>{const t=_(e)?Number(e):NaN;return isNaN(t)?e:t};let z;const H=()=>z||(z="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==n.g?n.g:{}),B=s("Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol");function W(e){if(d(e)){const t={};for(let n=0;n<e.length;n++){const s=e[n],i=_(s)?X(s):W(s);if(i)for(const e in i)t[e]=i[e]}return t}if(_(e)||S(e))return e}const G=/;(?![^(]*\))/g,K=/:([^]+)/,q=/\/\*[^]*?\*\//g;function X(e){const t={};return e.replace(q,"").split(G).forEach((e=>{if(e){const n=e.split(K);n.length>1&&(t[n[0].trim()]=n[1].trim())}})),t}function Y(e){let t="";if(_(e))t=e;else if(d(e))for(let n=0;n<e.length;n++){const s=Y(e[n]);s&&(t+=s+" ")}else if(S(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const J=s("itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly");function Z(e){return!!e||""===e}function Q(e,t){if(e===t)return!0;let n=y(e),s=y(t);if(n||s)return!(!n||!s)&&e.getTime()===t.getTime();if(n=w(e),s=w(t),n||s)return e===t;if(n=d(e),s=d(t),n||s)return!(!n||!s)&&function(e,t){if(e.length!==t.length)return!1;let n=!0;for(let s=0;n&&s<e.length;s++)n=Q(e[s],t[s]);return n}(e,t);if(n=S(e),s=S(t),n||s){if(!n||!s)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e){const s=e.hasOwnProperty(n),i=t.hasOwnProperty(n);if(s&&!i||!s&&i||!Q(e[n],t[n]))return!1}}return String(e)===String(t)}function ee(e,t){return e.findIndex((e=>Q(e,t)))}const te=e=>!(!e||!0!==e.__v_isRef),ne=e=>_(e)?e:null==e?"":d(e)||S(e)&&(e.toString===k||!b(e.toString))?te(e)?ne(e.value):JSON.stringify(e,se,2):String(e),se=(e,t)=>te(t)?se(e,t.value):g(t)?{[`Map(${t.size})`]:[...t.entries()].reduce(((e,[t,n],s)=>(e[ie(t,s)+" =>"]=n,e)),{})}:f(t)?{[`Set(${t.size})`]:[...t.values()].map((e=>ie(e)))}:w(t)?ie(t):!S(t)||d(t)||T(t)?t:String(t),ie=(e,t="")=>{var n;return w(e)?`Symbol(${null!=(n=e.description)?n:t})`:e}},53011:(e,t,n)=>{var s;!function(i){var a=Object.hasOwnProperty,r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o="object"==typeof process&&"function"==typeof process.nextTick,l="function"==typeof Symbol,c="object"==typeof Reflect,u="function"==typeof setImmediate?setImmediate:setTimeout,h=l?c&&"function"==typeof Reflect.ownKeys?Reflect.ownKeys:function(e){var t=Object.getOwnPropertyNames(e);return t.push.apply(t,Object.getOwnPropertySymbols(e)),t}:Object.keys;function p(){this._events={},this._conf&&m.call(this,this._conf)}function m(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners!==i&&(this._maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this._newListener=e.newListener),e.removeListener&&(this._removeListener=e.removeListener),e.verboseMemoryLeak&&(this.verboseMemoryLeak=e.verboseMemoryLeak),e.ignoreErrors&&(this.ignoreErrors=e.ignoreErrors),this.wildcard&&(this.listenerTree={}))}function d(e,t){var n="(node) warning: possible EventEmitter memory leak detected. "+e+" listeners added. Use emitter.setMaxListeners() to increase limit.";if(this.verboseMemoryLeak&&(n+=" Event name: "+t+"."),"undefined"!=typeof process&&process.emitWarning){var s=new Error(n);s.name="MaxListenersExceededWarning",s.emitter=this,s.count=e,process.emitWarning(s)}else console.error(n),console.trace&&console.trace()}var g=function(e,t,n){var s=arguments.length;switch(s){case 0:return[];case 1:return[e];case 2:return[e,t];case 3:return[e,t,n];default:for(var i=new Array(s);s--;)i[s]=arguments[s];return i}};function f(e,t){for(var n={},s=e.length,a=t?value.length:0,r=0;r<s;r++)n[e[r]]=r<a?t[r]:i;return n}function y(e,t,n){var s,i;if(this._emitter=e,this._target=t,this._listeners={},this._listenersCount=0,(n.on||n.off)&&(s=n.on,i=n.off),t.addEventListener?(s=t.addEventListener,i=t.removeEventListener):t.addListener?(s=t.addListener,i=t.removeListener):t.on&&(s=t.on,i=t.off),!s&&!i)throw Error("target does not implement any known event API");if("function"!=typeof s)throw TypeError("on method must be a function");if("function"!=typeof i)throw TypeError("off method must be a function");this._on=s,this._off=i;var a=e._observers;a?a.push(this):e._observers=[this]}function v(e,t,n,s){var r=Object.assign({},t);if(!e)return r;if("object"!=typeof e)throw TypeError("options must be an object");var o,l,c,u=Object.keys(e),h=u.length;function p(e){throw Error('Invalid "'+o+'" option value'+(e?". Reason: "+e:""))}for(var m=0;m<h;m++){if(o=u[m],!s&&!a.call(t,o))throw Error('Unknown "'+o+'" option');(l=e[o])!==i&&(c=n[o],r[o]=c?c(l,p):l)}return r}function b(e,t){return"function"==typeof e&&e.hasOwnProperty("prototype")||t("value must be a constructor"),e}function _(e){var t="value must be type of "+e.join("|"),n=e.length,s=e[0],i=e[1];return 1===n?function(e,n){if(typeof e===s)return e;n(t)}:2===n?function(e,n){var a=typeof e;if(a===s||a===i)return e;n(t)}:function(s,i){for(var a=typeof s,r=n;r-- >0;)if(a===e[r])return s;i(t)}}Object.assign(y.prototype,{subscribe:function(e,t,n){var s=this,i=this._target,a=this._emitter,r=this._listeners,o=function(){var s=g.apply(null,arguments),r={data:s,name:t,original:e};n?!1!==n.call(i,r)&&a.emit.apply(a,[r.name].concat(s)):a.emit.apply(a,[t].concat(s))};if(r[e])throw Error("Event '"+e+"' is already listening");this._listenersCount++,a._newListener&&a._removeListener&&!s._onNewListener?(this._onNewListener=function(n){n===t&&null===r[e]&&(r[e]=o,s._on.call(i,e,o))},a.on("newListener",this._onNewListener),this._onRemoveListener=function(n){n===t&&!a.hasListeners(n)&&r[e]&&(r[e]=null,s._off.call(i,e,o))},r[e]=null,a.on("removeListener",this._onRemoveListener)):(r[e]=o,s._on.call(i,e,o))},unsubscribe:function(e){var t,n,s,i=this,a=this._listeners,r=this._emitter,o=this._off,l=this._target;if(e&&"string"!=typeof e)throw TypeError("event must be a string");function c(){i._onNewListener&&(r.off("newListener",i._onNewListener),r.off("removeListener",i._onRemoveListener),i._onNewListener=null,i._onRemoveListener=null);var e=k.call(r,i);r._observers.splice(e,1)}if(e){if(!(t=a[e]))return;o.call(l,e,t),delete a[e],--this._listenersCount||c()}else{for(s=(n=h(a)).length;s-- >0;)e=n[s],o.call(l,e,a[e]);this._listeners={},this._listenersCount=0,c()}}});var w=_(["function"]),S=_(["object","function"]);function E(e,t,n){var s,i,a,r=0,o=new e((function(l,c,u){function h(){i&&(i=null),r&&(clearTimeout(r),r=0)}n=v(n,{timeout:0,overload:!1},{timeout:function(e,t){return("number"!=typeof(e*=1)||e<0||!Number.isFinite(e))&&t("timeout must be a positive number"),e}}),s=!n.overload&&"function"==typeof e.prototype.cancel&&"function"==typeof u;var p=function(e){h(),l(e)},m=function(e){h(),c(e)};s?t(p,m,u):(i=[function(e){m(e||Error("canceled"))}],t(p,m,(function(e){if(a)throw Error("Unable to subscribe on cancel event asynchronously");if("function"!=typeof e)throw TypeError("onCancel callback must be a function");i.push(e)})),a=!0),n.timeout>0&&(r=setTimeout((function(){var e=Error("timeout");e.code="ETIMEDOUT",r=0,o.cancel(e),c(e)}),n.timeout))}));return s||(o.cancel=function(e){if(i){for(var t=i.length,n=1;n<t;n++)i[n](e);i[0](e),i=null}}),o}function k(e){var t=this._observers;if(!t)return-1;for(var n=t.length,s=0;s<n;s++)if(t[s]._target===e)return s;return-1}function I(e,t,n,s,i){if(!n)return null;if(0===s){var a=typeof t;if("string"===a){var r,o,l=0,c=0,u=this.delimiter,p=u.length;if(-1!==(o=t.indexOf(u))){r=new Array(5);do{r[l++]=t.slice(c,o),c=o+p}while(-1!==(o=t.indexOf(u,c)));r[l++]=t.slice(c),t=r,i=l}else t=[t],i=1}else"object"===a?i=t.length:(t=[t],i=1)}var m,d,g,f,y,v,b,_=null,w=t[s],S=t[s+1];if(s===i)n._listeners&&("function"==typeof n._listeners?(e&&e.push(n._listeners),_=[n]):(e&&e.push.apply(e,n._listeners),_=[n]));else{if("*"===w){for(o=(v=h(n)).length;o-- >0;)"_listeners"!==(m=v[o])&&(b=I(e,t,n[m],s+1,i))&&(_?_.push.apply(_,b):_=b);return _}if("**"===w){for((y=s+1===i||s+2===i&&"*"===S)&&n._listeners&&(_=I(e,t,n,i,i)),o=(v=h(n)).length;o-- >0;)"_listeners"!==(m=v[o])&&("*"===m||"**"===m?(n[m]._listeners&&!y&&(b=I(e,t,n[m],i,i))&&(_?_.push.apply(_,b):_=b),b=I(e,t,n[m],s,i)):b=I(e,t,n[m],m===S?s+2:s,i),b&&(_?_.push.apply(_,b):_=b));return _}n[w]&&(_=I(e,t,n[w],s+1,i))}if((d=n["*"])&&I(e,t,d,s+1,i),g=n["**"])if(s<i)for(g._listeners&&I(e,t,g,i,i),o=(v=h(g)).length;o-- >0;)"_listeners"!==(m=v[o])&&(m===S?I(e,t,g[m],s+2,i):m===w?I(e,t,g[m],s+1,i):((f={})[m]=g[m],I(e,t,{"**":f},s+1,i)));else g._listeners?I(e,t,g,i,i):g["*"]&&g["*"]._listeners&&I(e,t,g["*"],i,i);return _}function x(e,t,n){var s,i,a=0,r=0,o=this.delimiter,l=o.length;if("string"==typeof e)if(-1!==(s=e.indexOf(o))){i=new Array(5);do{i[a++]=e.slice(r,s),r=s+l}while(-1!==(s=e.indexOf(o,r)));i[a++]=e.slice(r)}else i=[e],a=1;else i=e,a=e.length;if(a>1)for(s=0;s+1<a;s++)if("**"===i[s]&&"**"===i[s+1])return;var c,u=this.listenerTree;for(s=0;s<a;s++)if(u=u[c=i[s]]||(u[c]={}),s===a-1)return u._listeners?("function"==typeof u._listeners&&(u._listeners=[u._listeners]),n?u._listeners.unshift(t):u._listeners.push(t),!u._listeners.warned&&this._maxListeners>0&&u._listeners.length>this._maxListeners&&(u._listeners.warned=!0,d.call(this,u._listeners.length,c))):u._listeners=t,!0;return!0}function T(e,t,n,s){for(var i,a,r,o,l=h(e),c=l.length,u=e._listeners;c-- >0;)i=e[a=l[c]],r="_listeners"===a?n:n?n.concat(a):[a],o=s||"symbol"==typeof a,u&&t.push(o?r:r.join(this.delimiter)),"object"==typeof i&&T.call(this,i,t,r,o);return t}function $(e){for(var t,n,s,i=h(e),a=i.length;a-- >0;)(t=e[n=i[a]])&&(s=!0,"_listeners"===n||$(t)||delete e[n]);return s}function N(e,t,n){this.emitter=e,this.event=t,this.listener=n}function O(e,t,n){if(!0===n)a=!0;else if(!1===n)s=!0;else{if(!n||"object"!=typeof n)throw TypeError("options should be an object or true");var s=n.async,a=n.promisify,r=n.nextTick,l=n.objectify}if(s||r||a){var c=t,h=t._origin||t;if(r&&!o)throw Error("process.nextTick is not supported");a===i&&(a="AsyncFunction"===t.constructor.name),t=function(){var e=arguments,t=this,n=this.event;return a?r?Promise.resolve():new Promise((function(e){u(e)})).then((function(){return t.event=n,c.apply(t,e)})):(r?process.nextTick:u)((function(){t.event=n,c.apply(t,e)}))},t._async=!0,t._origin=h}return[t,l?new N(this,e,t):this]}function C(e){this._events={},this._newListener=!1,this._removeListener=!1,this.verboseMemoryLeak=!1,m.call(this,e)}N.prototype.off=function(){return this.emitter.off(this.event,this.listener),this},C.EventEmitter2=C,C.prototype.listenTo=function(e,t,n){if("object"!=typeof e)throw TypeError("target musts be an object");var s=this;function a(t){if("object"!=typeof t)throw TypeError("events must be an object");var i,a=n.reducers,r=k.call(s,e);i=-1===r?new y(s,e,n):s._observers[r];for(var o,l=h(t),c=l.length,u="function"==typeof a,p=0;p<c;p++)o=l[p],i.subscribe(o,t[o]||o,u?a:a&&a[o])}return n=v(n,{on:i,off:i,reducers:i},{on:w,off:w,reducers:S}),r(t)?a(f(t)):a("string"==typeof t?f(t.split(/\s+/)):t),this},C.prototype.stopListeningTo=function(e,t){var n=this._observers;if(!n)return!1;var s,i=n.length,a=!1;if(e&&"object"!=typeof e)throw TypeError("target should be an object");for(;i-- >0;)s=n[i],e&&s._target!==e||(s.unsubscribe(t),a=!0);return a},C.prototype.delimiter=".",C.prototype.setMaxListeners=function(e){e!==i&&(this._maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e)},C.prototype.getMaxListeners=function(){return this._maxListeners},C.prototype.event="",C.prototype.once=function(e,t,n){return this._once(e,t,!1,n)},C.prototype.prependOnceListener=function(e,t,n){return this._once(e,t,!0,n)},C.prototype._once=function(e,t,n,s){return this._many(e,1,t,n,s)},C.prototype.many=function(e,t,n,s){return this._many(e,t,n,!1,s)},C.prototype.prependMany=function(e,t,n,s){return this._many(e,t,n,!0,s)},C.prototype._many=function(e,t,n,s,i){var a=this;if("function"!=typeof n)throw new Error("many only accepts instances of Function");function r(){return 0==--t&&a.off(e,r),n.apply(this,arguments)}return r._origin=n,this._on(e,r,s,i)},C.prototype.emit=function(){if(!this._events&&!this._all)return!1;this._events||p.call(this);var e,t,n,s,i,a,r=arguments[0],o=this.wildcard;if("newListener"===r&&!this._newListener&&!this._events.newListener)return!1;if(o&&(e=r,"newListener"!==r&&"removeListener"!==r&&"object"==typeof r)){if(n=r.length,l)for(s=0;s<n;s++)if("symbol"==typeof r[s]){a=!0;break}a||(r=r.join(this.delimiter))}var c,u=arguments.length;if(this._all&&this._all.length)for(s=0,n=(c=this._all.slice()).length;s<n;s++)switch(this.event=r,u){case 1:c[s].call(this,r);break;case 2:c[s].call(this,r,arguments[1]);break;case 3:c[s].call(this,r,arguments[1],arguments[2]);break;default:c[s].apply(this,arguments)}if(o)c=[],I.call(this,c,e,this.listenerTree,0,n);else{if("function"==typeof(c=this._events[r])){switch(this.event=r,u){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(u-1),i=1;i<u;i++)t[i-1]=arguments[i];c.apply(this,t)}return!0}c&&(c=c.slice())}if(c&&c.length){if(u>3)for(t=new Array(u-1),i=1;i<u;i++)t[i-1]=arguments[i];for(s=0,n=c.length;s<n;s++)switch(this.event=r,u){case 1:c[s].call(this);break;case 2:c[s].call(this,arguments[1]);break;case 3:c[s].call(this,arguments[1],arguments[2]);break;default:c[s].apply(this,t)}return!0}if(!this.ignoreErrors&&!this._all&&"error"===r)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},C.prototype.emitAsync=function(){if(!this._events&&!this._all)return!1;this._events||p.call(this);var e,t,n,s,i,a,r=arguments[0],o=this.wildcard;if("newListener"===r&&!this._newListener&&!this._events.newListener)return Promise.resolve([!1]);if(o&&(e=r,"newListener"!==r&&"removeListener"!==r&&"object"==typeof r)){if(s=r.length,l)for(i=0;i<s;i++)if("symbol"==typeof r[i]){t=!0;break}t||(r=r.join(this.delimiter))}var c,u=[],h=arguments.length;if(this._all)for(i=0,s=this._all.length;i<s;i++)switch(this.event=r,h){case 1:u.push(this._all[i].call(this,r));break;case 2:u.push(this._all[i].call(this,r,arguments[1]));break;case 3:u.push(this._all[i].call(this,r,arguments[1],arguments[2]));break;default:u.push(this._all[i].apply(this,arguments))}if(o?(c=[],I.call(this,c,e,this.listenerTree,0)):c=this._events[r],"function"==typeof c)switch(this.event=r,h){case 1:u.push(c.call(this));break;case 2:u.push(c.call(this,arguments[1]));break;case 3:u.push(c.call(this,arguments[1],arguments[2]));break;default:for(n=new Array(h-1),a=1;a<h;a++)n[a-1]=arguments[a];u.push(c.apply(this,n))}else if(c&&c.length){if(c=c.slice(),h>3)for(n=new Array(h-1),a=1;a<h;a++)n[a-1]=arguments[a];for(i=0,s=c.length;i<s;i++)switch(this.event=r,h){case 1:u.push(c[i].call(this));break;case 2:u.push(c[i].call(this,arguments[1]));break;case 3:u.push(c[i].call(this,arguments[1],arguments[2]));break;default:u.push(c[i].apply(this,n))}}else if(!this.ignoreErrors&&!this._all&&"error"===r)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(u)},C.prototype.on=function(e,t,n){return this._on(e,t,!1,n)},C.prototype.prependListener=function(e,t,n){return this._on(e,t,!0,n)},C.prototype.onAny=function(e){return this._onAny(e,!1)},C.prototype.prependAny=function(e){return this._onAny(e,!0)},C.prototype.addListener=C.prototype.on,C.prototype._onAny=function(e,t){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),t?this._all.unshift(e):this._all.push(e),this},C.prototype._on=function(e,t,n,s){if("function"==typeof e)return this._onAny(e,t),this;if("function"!=typeof t)throw new Error("on only accepts instances of Function");this._events||p.call(this);var a,r=this;return s!==i&&(t=(a=O.call(this,e,t,s))[0],r=a[1]),this._newListener&&this.emit("newListener",e,t),this.wildcard?(x.call(this,e,t,n),r):(this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),n?this._events[e].unshift(t):this._events[e].push(t),!this._events[e].warned&&this._maxListeners>0&&this._events[e].length>this._maxListeners&&(this._events[e].warned=!0,d.call(this,this._events[e].length,e))):this._events[e]=t,r)},C.prototype.off=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");var n,s=[];if(this.wildcard){var i="string"==typeof e?e.split(this.delimiter):e.slice();if(!(s=I.call(this,null,i,this.listenerTree,0)))return this}else{if(!this._events[e])return this;n=this._events[e],s.push({_listeners:n})}for(var a=0;a<s.length;a++){var o=s[a];if(n=o._listeners,r(n)){for(var l=-1,c=0,u=n.length;c<u;c++)if(n[c]===t||n[c].listener&&n[c].listener===t||n[c]._origin&&n[c]._origin===t){l=c;break}if(l<0)continue;return this.wildcard?o._listeners.splice(l,1):this._events[e].splice(l,1),0===n.length&&(this.wildcard?delete o._listeners:delete this._events[e]),this._removeListener&&this.emit("removeListener",e,t),this}(n===t||n.listener&&n.listener===t||n._origin&&n._origin===t)&&(this.wildcard?delete o._listeners:delete this._events[e],this._removeListener&&this.emit("removeListener",e,t))}return this.listenerTree&&$(this.listenerTree),this},C.prototype.offAny=function(e){var t,n=0,s=0;if(e&&this._all&&this._all.length>0){for(n=0,s=(t=this._all).length;n<s;n++)if(e===t[n])return t.splice(n,1),this._removeListener&&this.emit("removeListenerAny",e),this}else{if(t=this._all,this._removeListener)for(n=0,s=t.length;n<s;n++)this.emit("removeListenerAny",t[n]);this._all=[]}return this},C.prototype.removeListener=C.prototype.off,C.prototype.removeAllListeners=function(e){if(e===i)return!this._events||p.call(this),this;if(this.wildcard){var t,n=I.call(this,null,e,this.listenerTree,0);if(!n)return this;for(t=0;t<n.length;t++)n[t]._listeners=null;this.listenerTree&&$(this.listenerTree)}else this._events&&(this._events[e]=null);return this},C.prototype.listeners=function(e){var t,n,s,a,r,o=this._events;if(e===i){if(this.wildcard)throw Error("event name required for wildcard emitter");if(!o)return[];for(a=(t=h(o)).length,s=[];a-- >0;)"function"==typeof(n=o[t[a]])?s.push(n):s.push.apply(s,n);return s}if(this.wildcard){if(!(r=this.listenerTree))return[];var l=[],c="string"==typeof e?e.split(this.delimiter):e.slice();return I.call(this,l,c,r,0),l}return o&&(n=o[e])?"function"==typeof n?[n]:n:[]},C.prototype.eventNames=function(e){var t=this._events;return this.wildcard?T.call(this,this.listenerTree,[],null,e):t?h(t):[]},C.prototype.listenerCount=function(e){return this.listeners(e).length},C.prototype.hasListeners=function(e){if(this.wildcard){var t=[],n="string"==typeof e?e.split(this.delimiter):e.slice();return I.call(this,t,n,this.listenerTree,0),t.length>0}var s=this._events,a=this._all;return!!(a&&a.length||s&&(e===i?h(s).length:s[e]))},C.prototype.listenersAny=function(){return this._all?this._all:[]},C.prototype.waitFor=function(e,t){var n=this,s=typeof t;return"number"===s?t={timeout:t}:"function"===s&&(t={filter:t}),E((t=v(t,{timeout:0,filter:i,handleError:!1,Promise,overload:!1},{filter:w,Promise:b})).Promise,(function(s,i,a){function r(){var a=t.filter;if(!a||a.apply(n,arguments))if(n.off(e,r),t.handleError){var o=arguments[0];o?i(o):s(g.apply(null,arguments).slice(1))}else s(g.apply(null,arguments))}a((function(){n.off(e,r)})),n._on(e,r,!1)}),{timeout:t.timeout,overload:t.overload})};var L=C.prototype;Object.defineProperties(C,{defaultMaxListeners:{get:function(){return L._maxListeners},set:function(e){if("number"!=typeof e||e<0||Number.isNaN(e))throw TypeError("n must be a non-negative number");L._maxListeners=e},enumerable:!0},once:{value:function(e,t,n){return E((n=v(n,{Promise,timeout:0,overload:!1},{Promise:b})).Promise,(function(n,s,i){var a;if("function"==typeof e.addEventListener)return a=function(){n(g.apply(null,arguments))},i((function(){e.removeEventListener(t,a)})),void e.addEventListener(t,a,{once:!0});var r,o=function(){r&&e.removeListener("error",r),n(g.apply(null,arguments))};"error"!==t&&(r=function(n){e.removeListener(t,o),s(n)},e.once("error",r)),i((function(){r&&e.removeListener("error",r),e.removeListener(t,o)})),e.once(t,o)}),{timeout:n.timeout,overload:n.overload})},writable:!0,configurable:!0}}),Object.defineProperties(L,{_maxListeners:{value:10,writable:!0,configurable:!0},_observers:{value:null,writable:!0,configurable:!0}}),(s=function(){return C}.call(t,n,t,e))===i||(e.exports=s)}()},53908:(e,t,n)=>{const s=n(57272),{MAX_LENGTH:i,MAX_SAFE_INTEGER:a}=n(16874),{safeRe:r,safeSrc:o,t:l}=n(99718),c=n(98587),{compareIdentifiers:u}=n(61123);class h{constructor(e,t){if(t=c(t),e instanceof h){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);s("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?r[l.LOOSE]:r[l.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>a||this.major<0)throw new TypeError("Invalid major version");if(this.minor>a||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>a||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<a)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(s("SemVer.compare",this.version,this.options,e),!(e instanceof h)){if("string"==typeof e&&e===this.version)return 0;e=new h(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof h||(e=new h(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof h||(e=new h(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(s("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}compareBuild(e){e instanceof h||(e=new h(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(s("build compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(t){const e=new RegExp(`^${this.options.loose?o[l.PRERELEASELOOSE]:o[l.PRERELEASE]}$`),n=`-${t}`.match(e);if(!n||n[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let s=this.prerelease.length;for(;--s>=0;)"number"==typeof this.prerelease[s]&&(this.prerelease[s]++,s=-2);if(-1===s){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let s=[t,e];!1===n&&(s=[t]),0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=h},50560:(e,t,n)=>{const s=n(53908);e.exports=(e,t,n)=>new s(e,n).compare(new s(t,n))},35580:(e,t,n)=>{const s=n(50560);e.exports=(e,t,n)=>s(e,t,n)>0},54089:(e,t,n)=>{const s=n(50560);e.exports=(e,t,n)=>s(e,t,n)>=0},16874:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},57272:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},61123:e=>{const t=/^[0-9]+$/,n=(e,n)=>{const s=t.test(e),i=t.test(n);return s&&i&&(e=+e,n=+n),e===n?0:s&&!i?-1:i&&!s?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},98587:e=>{const t=Object.freeze({loose:!0}),n=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:n},99718:(e,t,n)=>{const{MAX_SAFE_COMPONENT_LENGTH:s,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:a}=n(16874),r=n(57272),o=(t=e.exports={}).re=[],l=t.safeRe=[],c=t.src=[],u=t.safeSrc=[],h=t.t={};let p=0;const m="[a-zA-Z0-9-]",d=[["\\s",1],["\\d",a],[m,i]],g=(e,t,n)=>{const s=(e=>{for(const[t,n]of d)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=p++;r(e,i,t),h[e]=i,c[i]=t,u[i]=s,o[i]=new RegExp(t,n?"g":void 0),l[i]=new RegExp(s,n?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${m}*`),g("MAINVERSION",`(${c[h.NUMERICIDENTIFIER]})\\.(${c[h.NUMERICIDENTIFIER]})\\.(${c[h.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${c[h.NUMERICIDENTIFIERLOOSE]})\\.(${c[h.NUMERICIDENTIFIERLOOSE]})\\.(${c[h.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${c[h.NUMERICIDENTIFIER]}|${c[h.NONNUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${c[h.NUMERICIDENTIFIERLOOSE]}|${c[h.NONNUMERICIDENTIFIER]})`),g("PRERELEASE",`(?:-(${c[h.PRERELEASEIDENTIFIER]}(?:\\.${c[h.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${c[h.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[h.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${m}+`),g("BUILD",`(?:\\+(${c[h.BUILDIDENTIFIER]}(?:\\.${c[h.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${c[h.MAINVERSION]}${c[h.PRERELEASE]}?${c[h.BUILD]}?`),g("FULL",`^${c[h.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${c[h.MAINVERSIONLOOSE]}${c[h.PRERELEASELOOSE]}?${c[h.BUILD]}?`),g("LOOSE",`^${c[h.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${c[h.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${c[h.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${c[h.XRANGEIDENTIFIER]})(?:\\.(${c[h.XRANGEIDENTIFIER]})(?:\\.(${c[h.XRANGEIDENTIFIER]})(?:${c[h.PRERELEASE]})?${c[h.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${c[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[h.XRANGEIDENTIFIERLOOSE]})(?:${c[h.PRERELEASELOOSE]})?${c[h.BUILD]}?)?)?`),g("XRANGE",`^${c[h.GTLT]}\\s*${c[h.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${c[h.GTLT]}\\s*${c[h.XRANGEPLAINLOOSE]}$`),g("COERCEPLAIN",`(^|[^\\d])(\\d{1,${s}})(?:\\.(\\d{1,${s}}))?(?:\\.(\\d{1,${s}}))?`),g("COERCE",`${c[h.COERCEPLAIN]}(?:$|[^\\d])`),g("COERCEFULL",c[h.COERCEPLAIN]+`(?:${c[h.PRERELEASE]})?`+`(?:${c[h.BUILD]})?(?:$|[^\\d])`),g("COERCERTL",c[h.COERCE],!0),g("COERCERTLFULL",c[h.COERCEFULL],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${c[h.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",g("TILDE",`^${c[h.LONETILDE]}${c[h.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${c[h.LONETILDE]}${c[h.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${c[h.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",g("CARET",`^${c[h.LONECARET]}${c[h.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${c[h.LONECARET]}${c[h.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${c[h.GTLT]}\\s*(${c[h.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${c[h.GTLT]}\\s*(${c[h.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${c[h.GTLT]}\\s*(${c[h.LOOSEPLAIN]}|${c[h.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${c[h.XRANGEPLAIN]})\\s+-\\s+(${c[h.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${c[h.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[h.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},25721:e=>{function t(e,t){if((e=e.replace(/\s+/g,""))===(t=t.replace(/\s+/g,"")))return 1;if(e.length<2||t.length<2)return 0;let n=new Map;for(let t=0;t<e.length-1;t++){const s=e.substring(t,t+2),i=n.has(s)?n.get(s)+1:1;n.set(s,i)}let s=0;for(let e=0;e<t.length-1;e++){const i=t.substring(e,e+2),a=n.has(i)?n.get(i):0;a>0&&(n.set(i,a-1),s++)}return 2*s/(e.length+t.length-2)}e.exports={compareTwoStrings:t,findBestMatch:function(e,n){if(!function(e,t){return"string"==typeof e&&!!Array.isArray(t)&&!!t.length&&!t.find((function(e){return"string"!=typeof e}))}(e,n))throw new Error("Bad arguments: First argument should be a string, second should be an array of strings");const s=[];let i=0;for(let a=0;a<n.length;a++){const r=n[a],o=t(e,r);s.push({target:r,rating:o}),o>s[i].rating&&(i=a)}return{ratings:s,bestMatch:s[i],bestMatchIndex:i}}}},13647:(e,t,n)=>{"use strict";n.r(t),n.d(t,{request:()=>f,settings:()=>y,storage:()=>g,type:()=>v});var s=n(13647),i=n(78584),a=n(26017);const r={async set(e,t){const n={};return n[e]=t,new Promise(((t,s)=>{o(e).set(n,(function(){chrome.runtime.lastError?s(chrome.runtime.lastError):t()}))}))},get:async e=>new Promise(((t,n)=>{o(e).get(e,(function(s){chrome.runtime.lastError?n(chrome.runtime.lastError):t(s[e])}))})),remove:async e=>new Promise(((t,n)=>{o(e).remove(e,(function(){chrome.runtime.lastError?n(chrome.runtime.lastError):t()}))})),list:async(e="local")=>new Promise(((t,n)=>{"local"===e?chrome.storage.local.get(null,(function(e){t(e)})):chrome.storage.sync.get(null,(function(e){t(e)}))})),async addStyle(e){try{const t=document.createElement("style");t.textContent=e,(document.head||document.body||document.documentElement||document).appendChild(t)}catch(e){console.log(`Could not add css:${e}`)}},version:()=>chrome.runtime.getManifest().version,lang(e,t){if(s.settings.get("forceEn")&&"undefined"!=typeof i18n){let n=i18n[e];if(void 0!==t)for(let e=0;e<t.length;e++)n=n.replace(`$${e+1}`,t[e]);return n}return chrome.i18n.getMessage(e,t)},langDirection(){try{const e=chrome.i18n.getUILanguage();if(/^(ar)(-|$)/i.test(e)&&!s.settings.get("forceEn"))return"rtl"}catch(e){i.error(e)}return"ltr"},assetUrl:e=>chrome.runtime.getURL(`assets/${e}`),injectCssResource(e,t){alert("injectCssResource not supported in webextension")},injectjsResource(e,t){const n=document.createElement("script");n.src=chrome.runtime.getURL(`vendor/${e}`),n.onload=function(){this.remove()},t.get(0).appendChild(n)},addProxyScriptToTag:(e,t)=>(e.src=chrome.runtime.getURL(`/content/proxy/proxy_${t}.js`),e),updateDom(e){const t=document.createElement("script");t.text="\n        document.getElementsByTagName('head')[0].onclick = function(e){\n          try{\n            componentHandler.upgradeDom();\n          }catch(e){\n            console.log(e);\n            setTimeout(function(){\n              componentHandler.upgradeDom();\n            },500);\n          }\n        }",t.onload=function(){this.remove()},e.get(0).appendChild(t)},storageOnChanged(e){chrome.storage.onChanged.addListener(e)}};function o(e){return a.syncRegex.test(e)?chrome.storage.sync:chrome.storage.local}const l={async xhr(e,t){if(void 0!==l.sendMessage)return l.sendMessage({name:"xhr",method:e,url:t}).then((e=>{if(429===e.status)throw"Rate limit Timeout";if(0===e.status)throw e.responseText;return e}));throw"Could not send xhr"},sendMessage:async e=>new Promise(((t,n)=>{chrome.runtime.sendMessage(e,(function(e){t(e)}))})),notification(e){this.sendMessage({name:"notification",options:e})},database(e,t){return this.sendMessage({name:"database",options:{call:e,param:t}})}};var c=n(50953),u=n(40111),h=n(13647),p=n(78584),m=n(26017);const d={options:(0,c.Kh)({autoTrackingModeanime:"video",readerTracking:!0,askBefore:!0,autoTrackingModemanga:"instant",enablePages:{},forceEn:!1,forceEnglishTitles:!1,rpc:!0,presenceLargeImage:"cover",presenceShowButtons:!0,presenceShowMalsync:!1,userscriptModeButton:!1,syncMode:"MAL",syncModeSimkl:"MAL",localSync:!0,delay:0,videoDuration:85,malTags:!1,malContinue:!0,malResume:!0,usedPage:!0,epPredictions:!0,mangaCompletionPercentage:90,theme:"auto",themeSidebars:!0,themeColor:"#000000",themeOpacity:100,themeImage:"",minimalWindow:!1,posLeft:"left",miniMALonMal:!1,floatButtonStealth:!1,minimizeBigPopup:!1,floatButtonCorrection:!0,floatButtonHide:!1,autoCloseMinimal:!1,outWay:!0,miniMalWidth:"550px",miniMalHeight:"90%",malThumbnail:100,friendScore:!0,loadPTWForProgress:!1,quicklinks:["Crunchyroll","Gogoanime","Mangadex","MangaNato","MangaFox","MangaSee","MangaFire","HiAnime","Hulu","Netflix","Hidive","VIZ","MangaPlus","MangaReader","ComicK","WeebCentral","KickAssAnime","animepahe"],quicklinksPosition:"default",autofull:!1,autoresume:!1,autoNextEp:!1,highlightAllEp:!1,checkForFiller:!0,crashReport:!0,introSkip:85,introSkipFwd:[17,39],introSkipBwd:[17,37],nextEpShort:[],correctionShort:[67],syncShort:[],progressInterval:120,progressIntervalDefaultAnime:"en/sub",progressIntervalDefaultManga:"en/sub",progressNotificationsAnime:!0,progressNotificationsManga:!0,notificationsSticky:!0,bookMarksList:!1,bookMarksListManga:!1,customDomains:[],anilistUpdateUi:!0,anilistToken:"",anilistOptions:{displayAdultContent:!0,scoreFormat:"POINT_10"},kitsuToken:"",kitsuOptions:{titleLanguagePreference:"canonical",sfwFilter:!1,ratingSystem:"regular"},simklToken:"",malToken:"",malRefresh:"",shikiToken:"",shikiOptions:{locale:"ru"}}),debounceArray:{},chibiList:{},isInit:(0,c.KR)(!1),async init(){const e=[];for(const t in this.options){const n=await h.storage.get(`settings/${t}`);void 0!==n&&(this.options[t]=n,e[t]=/(token|refresh)/i.test(t)&&n?"********":n)}try{const e=await u.I.getInstance(!0).init();this.chibiList=e.getList()}catch(e){p.error("Error loading chibi repo",e)}let t;return p.log("Settings",e),h.storage.storageOnChanged(((e,n)=>{if("sync"===n)for(const t in e){const n=e[t];/^settings\//i.test(t)&&(this.options[t.replace("settings/","")]=n.newValue,p.info(`Update ${t} option to ${JSON.stringify(n.newValue,null,2)}`))}if("local"===n&&e.rateLimit)try{clearTimeout(t),e.rateLimit.newValue?(p.log("Rate limited"),$(".type-rate").length||m.flashm("Rate limited. Retrying in a moment",{error:!0,type:"rate",permanent:!0})):t=setTimeout((()=>{p.log("No Rate limited"),$(".type-rate").remove()}),5e3)}catch(e){p.error(e)}})),this.isInit.value=!0,this},get(e){if(!this.isInit.value)throw"Settings not initialized";return this.options[e]},set(e,t){if(!Object.prototype.hasOwnProperty.call(this.options,e)){const t=Error(`${e} is not a defined option`);throw p.error(t),t}return this.options[e]=t,h.storage.set(`settings/${e}`,t)},setDebounce(e,t){this.options[e]=t,clearTimeout(this.debounceArray[e]),this.debounceArray[e]=setTimeout((()=>{this.set(e,t),delete this.debounceArray[e]}),1e3)},async getAsync(e){const t=await h.storage.get(`settings/${e}`);return void 0===t&&void 0!==this.options[e]?this.options[e]:t},getStaticChibi(){if(!this.isInit.value)throw"Settings not initialized";return this.chibiList}},g=r,f=l,y=d,v="webextension"},40111:(e,t,n)=>{"use strict";n.d(t,{I:()=>a});var s=n(96789),i=n(13647);class a{static getInstance(e=!1){let t;return t="userscript"===i.type?["https://chibi.malsync.moe/config"]:[chrome.runtime.getURL("chibi"),"https://chibi.malsync.moe/config"],new a(t,e)}constructor(e,t=!1){this.pages=null,this.collections=e,this.useCache=t}async init(){const e=`chibiPages-${i.storage.version()}`,t=await i.storage.get(e)||{chibiPages:{},errors:{}};if(this.useCache&&t.chibiPages&&Object.keys(t.chibiPages).length>0)return this.pages=t.chibiPages,this;const n={},a=(await Promise.all(this.collections.map((e=>this.retrieveCollection(e).catch((t=>(n[e]=t,null))))))).filter((e=>e));return t.errors=n,a.forEach((e=>{Object.keys(e.pages).forEach((n=>{if(e.pages[n].minimumVersion&&(0,s.GT)(e.pages[n].minimumVersion))return;const i=t.chibiPages[n]&&t.chibiPages[n].version.hash!==e.pages[n].version.hash&&Number(t.chibiPages[n].version.timestamp)<Number(e.pages[n].version.timestamp);t.chibiPages[n]&&!i||(t.chibiPages[n]=e.pages[n])}))})),await i.storage.set(e,t),this.pages=t.chibiPages,this}async retrieveCollection(e){const t=await i.request.xhr("GET",`${e}/list.json`),n=JSON.parse(t.responseText);return Object.keys(n.pages).forEach((t=>{n.pages[t].root=e})),n}getList(){if(!this.pages)throw new Error("Pages not loaded");return this.pages}async getPage(e){if(!this.pages)throw new Error("Pages not loaded");const t=this.pages[e];if(!t)throw new Error(`Page ${e} not found`);const n=await i.request.xhr("GET",`${t.root}/pages/${e}.json?version=${t.version.hash}`);return JSON.parse(n.responseText)}getPermissions(){const e=this.getList();return Object.values(e).map((e=>e.urls.match.map((t=>({page:`${e.name} (chibi)`,domain:t,auto:!0,chibi:!0}))))).flat()}getPermissionsElements(){const e=this.getList();return Object.values(e).map((e=>({name:`${e.name} (chibi)`,match:e.urls.match})))}}},78584:(e,t,n)=>{"use strict";n.r(t),n.d(t,{debug:()=>r,error:()=>i,info:()=>a,log:()=>s,m:()=>o});const s=Function.prototype.bind.call(console.log,console,"%cMAL-Sync","background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;"),i=Function.prototype.bind.call(console.error,console,"%cMAL-Sync","background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;"),a=Function.prototype.bind.call(console.info,console,"%cMAL-Sync","background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;"),r=Function.prototype.bind.call(console.debug,console,"%cMAL-Sync","background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;"),o=(e,t="",n=[])=>{let s="white";t||(t=function(e){if(!e)return"#ffffff";e=String(e);let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);let n="#";for(let e=0;e<3;e++)n+=`00${(t>>8*e&255).toString(16)}`.substr(-2);return n}(e)),"#"===t[0]&&(s=parseInt(t.replace("#",""),16)>8388607.5?"#000":"#fff");const i=`background-color: ${t}; color: ${s}; padding: 2px 10px; border-radius: 3px; margin-left: -5px; border-left: 1px solid white;`;n.push({name:e,style:i});const a={m:(e,t="")=>o(e,t,[...n])},r=n.reduce(((e,t)=>`${e}%c${t.name}`),""),l=n.map((e=>e.style));return a.log=Function.prototype.bind.call(console.log,console,`%cM ${r}`,"background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;",...l),a.error=Function.prototype.bind.call(console.error,console,`%cM ${r}`,"background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;",...l),a.info=Function.prototype.bind.call(console.info,console,`%cM ${r}`,"background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;",...l),a.debug=Function.prototype.bind.call(console.debug,console,`%cM ${r}`,"background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;",...l),a}},26017:(e,t,n)=>{"use strict";n.r(t),n.d(t,{absoluteLink:()=>b,canHideTabs:()=>F,changeDetect:()=>E,checkDoubleExecution:()=>T,clearCache:()=>se,elementInViewport:()=>Y,episode:()=>d,favicon:()=>h,flashConfirm:()=>G,flashm:()=>W,fullUrlChangeDetect:()=>S,getAsyncWaitUntilTrue:()=>I,getBaseText:()=>u,getContinueWaching:()=>P,getEntrySettings:()=>M,getResumeWaching:()=>L,getStatusText:()=>z,getTooltip:()=>U,getUrlFromTags:()=>N,getselect:()=>v,handleMalImages:()=>D,htmlDecode:()=>ee,isDomainMatching:()=>ae,isFirefox:()=>te,lazyload:()=>X,notifications:()=>H,pageUrl:()=>Z,parseHtml:()=>_,planTo:()=>m,rateLimitExclude:()=>f,returnYYYYMMDD:()=>Q,setContinueWaching:()=>A,setEntrySettings:()=>R,setResumeWaching:()=>C,setUrlInTags:()=>O,sortAlphabetically:()=>ie,status:()=>y,statusTag:()=>V,syncRegex:()=>g,timeCache:()=>B,timeDiffToText:()=>j,upperCaseFirstLetter:()=>re,urlChangeDetect:()=>w,urlParam:()=>c,urlPart:()=>o,urlStrip:()=>l,wait:()=>J,waitForPageToBeVisible:()=>ne,waitUntilTrue:()=>k,watching:()=>p});var s=n(7263),i=n(13647),a=n(78584),r=n(26017);function o(e,t){if(!e)return"";const n=e.split("/");return n[t]?n[t].replace(/[#?].*/,""):""}function l(e){return e.replace(/[#?].*/,"")}function c(e,t){const n=new RegExp(`[?&]${t}=([^&#]*)`).exec(e);return null===n?null:decodeURI(n[1])||0}function u(e){let t=e.text();return e.children().each((function(){t=t.replace(s.$(this).text(),"")})),t}function h(e){if(!e)return"";const t=e.match(/^(https?:\/\/)?[^/]+/);return t&&(e=t[0]),`https://favicon.malsync.moe/?domain=${e}`}function p(e){return"manga"===e?"Reading":"Watching"}function m(e){return"manga"===e?"Plan to Read":"Plan to Watch"}function d(e){return"manga"===e?i.storage.lang("UI_Chapter"):i.storage.lang("UI_Episode")}const g=/(^settings\/.*|^updateCheckTime$|^tempVersion$|^local:\/\/|^list-tagSettings$)/,f=/^https:\/\/api.malsync.moe\/(shark|mal\/|nc\/mal\/.*\/progress$)/i;var y;function v(e,t){let n=e.split(`name="${t}"`)[1].split("</select>")[0];if(n.indexOf('selected="selected"')>-1){n=n.split("<option");for(let e=0;e<n.length;++e)if(n[e].indexOf('selected="selected"')>-1)return n[e].split('value="')[1].split('"')[0]}return""}function b(e,t){return void 0===e||e.startsWith("http")||("/"!==e.charAt(0)&&(e=`/${e}`),e=t+e),e}function _(e){return(new DOMParser).parseFromString(`<!doctype html><body>${e}`,"text/html").body.textContent}function w(e){let t=window.location.href;return setInterval((function(){t!==window.location.href&&(t=window.location.href,e())}),100)}function S(e,t=!1){let n="";const s=setInterval((function(){const s=t?l(window.location.href):window.location.href;n!==s&&(n=s,e())}),100);return Number(s)}function E(e,t,n=!1){let s=t();const i=setInterval((function(){const n=t();void 0!==n&&s!==n&&(s=t(),e())}),500);return n&&e(),Number(i)}function k(e,t,n=100){let s=0;const i=setInterval((function(){s++;let r=!1;try{r=e()}catch(e){a.info("Error in waitUntilTrue",e)}if(r&&(clearInterval(i),t()),s>10){clearInterval(i);const s=Math.max(Math.min(2*n,15e3),500);k(e,t,s)}}),n);return i}function I(e,t=100){let n,s;const i=()=>{clearTimeout(n),s&&s("AsyncWait stopped")};return{asyncWaitUntilTrue:()=>(i(),new Promise(((i,a)=>{s=a,n=k(e,(()=>i()),t)}))),reset:i}}!function(e){e[e.watching=1]="watching",e[e.completed=2]="completed",e[e.onhold=3]="onhold",e[e.dropped=4]="dropped",e[e.planToWatch=6]="planToWatch"}(y||(y={}));const x=Math.random();function T(){$(".mal-sync-double-detect").length&&$(".mal-sync-double-detect").each((function(e){$(this).text()!==x.toString()&&alert("Double execution detected! Please run MAL-Sync once only.")})),$("body").after(s.html(`<div class="mal-sync-double-detect" style="display: none;">${x.toString()}</div>`))}function N(e){return/malSync::[\d\D]+::/.test(e)?t(e.split("malSync::")[1].split("::")[0]):/last::[\d\D]+::/.test(e)?t(e.split("last::")[1].split("::")[0]):void 0;function t(e){try{return atob(e)}catch(t){return e}}}function O(e,t){if(""===e)return t.replace(/,?(malSync|last)::[^ \n]+?::/,"");if(!i.settings.get("malTags"))return t;const n=`malSync::${btoa(e)}::`;return/(last|malSync)::[\d\D]+::/.test(t)?t.replace(/(last|malSync)::[^^]*?::/,n):`${t},${n}`}async function C(e,t,n,s){return i.storage.set(`resume/${n}/${s}`,{url:e,ep:t})}async function L(e,t){if(i.settings.get("malResume"))return i.storage.get(`resume/${e}/${t}`)}async function A(e,t,n,s){return i.storage.set(`continue/${n}/${s}`,{url:e,ep:t})}async function P(e,t){if(i.settings.get("malContinue"))return i.storage.get(`continue/${e}/${t}`)}async function R(e,t,n,s=""){const a={};if(n){for(const e in n)switch(e){case"u":case"p":a[e]=n[e]}i.settings.get("malTags")?s=O(JSON.stringify(a),s):await i.storage.set(`tagSettings/${e}/${t}`,JSON.stringify(a))}return Object.values(a).find((e=>Boolean(e)))||(s=O("",s),i.settings.get("malTags")||await i.storage.remove(`tagSettings/${e}/${t}`)),s}async function M(e,t,n=""){const s={u:null,c:null,r:null,p:""};if(i.settings.get("malTags")){const e=N(n);if(e)if("{"===e[0])try{const t=JSON.parse(e);for(const e in s)t[e]&&(s[e]=t[e])}catch(e){a.error(e)}else s.u=e}else{let n=await i.storage.get(`tagSettings/${e}/${t}`);if(n){n=JSON.parse(n);for(const e in s)n[e]&&(s[e]=n[e])}}const r=await P(e,t);r&&(s.c=r);const o=await L(e,t);return o&&(s.r=o),i.settings.get("usedPage")||(s.u=null),s}function D(e){return-1!==e.indexOf("questionmark")?i.storage.assetUrl("questionmark.gif"):e}function U(e,t="",n="top"){const s=Math.floor(1e3*Math.random()+1);return`<div id="tt${s}" class="icon material-icons" style="font-size:16px; line-height: 0; color: #7f7f7f; padding-bottom: 20px; padding-left: 3px; ${t}">contact_support</div>  <div class="mdl-tooltip mdl-tooltip--${n} mdl-tooltip--large" for="tt${s}">${e}</div>`}function j(e){let t="";e/=1e3;const n=Math.floor(e/31536e3);e-=31536e3*n,n&&(t+=`${n}y `);const s=Math.floor(e/86400);e-=86400*s,s&&(t+=`${s}d `);const i=Math.floor(e/3600)%24;e-=3600*i,i&&s<2&&(t+=`${i}h `);const a=Math.floor(e/60)%60;return e-=60*a,a&&!s&&i<3&&(t+=`${a}min `),t}function F(){return"undefined"!=typeof browser&&void 0!==browser.tabs.hide}function V(e,t,n){const s={anime:{1:{class:"watching",text:"CW",title:i.storage.lang(`UI_Status_watching_${t}`)},2:{class:"completed",text:"CMPL",title:i.storage.lang("UI_Status_Completed")},3:{class:"on-hold",text:"HOLD",title:i.storage.lang("UI_Status_OnHold")},4:{class:"dropped",text:"DROP",title:i.storage.lang("UI_Status_Dropped")},6:{class:"plantowatch",text:"PTW",title:i.storage.lang(`UI_Status_planTo_${t}`)},23:{class:"rewatching",text:"RE",title:i.storage.lang(`UI_Status_Rewatching_${t}`)}},manga:{1:{class:"reading",text:"CR",title:i.storage.lang(`UI_Status_watching_${t}`)},2:{class:"completed",text:"CMPL",title:i.storage.lang("UI_Status_Completed")},3:{class:"on-hold",text:"HOLD",title:i.storage.lang("UI_Status_OnHold")},4:{class:"dropped",text:"DROP",title:i.storage.lang("UI_Status_Dropped")},6:{class:"plantoread",text:"PTR",title:i.storage.lang(`UI_Status_planTo_${t}`)},23:{class:"rewatching",text:"RE",title:i.storage.lang(`UI_Status_Rewatching_${t}`)}}};if($.each([1,2,3,4,6,23],(function(e,t){s.anime[s.anime[t].title]=s.anime[t],s.manga[s.manga[t].title]=s.manga[t]})),e&&s[t][e]){const i=s[t][e];return` <a href="https://myanimelist.net/ownlist/${t}/${n}/edit?hideLayout=1" title="${i.title}" class="Lightbox_AddEdit button_edit ${i.class}">${i.text}</a>`}return!1}function z(e,t){switch(t){case 1:return i.storage.lang(`UI_Status_watching_${e}`);case 2:return i.storage.lang("UI_Status_Completed");case 3:return i.storage.lang("UI_Status_OnHold");case 4:return i.storage.lang("UI_Status_Dropped");case 6:return i.storage.lang(`UI_Status_planTo_${e}`);case 7:return i.storage.lang("UI_Status_All");case 23:return i.storage.lang(`UI_Status_Rewatching_${e}`);default:return""}}function H(e,t,n,s=""){const r={type:"basic",title:t,message:n,iconUrl:s};a.log("Notification",e,r),i.storage.get("notificationHistory").then((t=>{void 0===t&&(t=[]),"object"==typeof t&&(t.length>=10&&t.shift(),t.push({url:e,title:r.title,message:r.message,iconUrl:r.iconUrl,timestamp:Date.now()}),i.storage.set("notificationHistory",t))}));try{return chrome.notifications.create(e,r)}catch(e){a.error(e)}}async function B(e,t,n){const s=await i.storage.get(e);if("object"==typeof s&&(new Date).getTime()<s.timestamp)return s.data;const a=await t();return i.storage.set(e,{data:a,timestamp:(new Date).getTime()+n}).then((()=>a))}function W(e,t){s.$("#flash-div-top").length||function(){i.storage.addStyle('.flashinfo{\n                    transition: max-height 2s, opacity 2s 2s;\n                 }\n                 .mini-stealth .flashinfo{\n                    opacity: 0;\n                 }\n                  #flashinfo-div.hover.mini-stealth .flashinfo.type-update{\n                    opacity: 0.7;\n                 }\n                 #flashinfo-div.hover .flashinfo{\n                    opacity: 1;\n                 }\n                 .flashinfo:hover{\n                    max-height:5000px !important;\n                    z-index: 2147483647;\n                    opacity: 1;\n                    transition: max-height 2s;\n                 }\n                 .flashinfo .synopsis{\n                    transition: max-height 2s, max-width 2s ease 2s;\n                 }\n                 .flashinfo:hover .synopsis{\n                    max-height:9999px !important;\n                    max-width: 500px !important;\n                    transition: max-height 2s;\n                 }\n                 #flashinfo-div{\n                  z-index: 2;\n                  transition: 2s;\n                 }\n                 #flashinfo-div:hover, #flashinfo-div.hover{\n                  z-index: 2147483647;\n                 }\n                 #flashinfo-div.player-error {\n                   z-index: 2147483647;\n                 }\n                 #flashinfo-div.player-error .type-update{\n                  overflow: visible !important;\n                  opacity: 1 !important;\n                 }\n                 #flashinfo-div.player-error .player-error{\n                  display: block !important\n                 }\n                 #flashinfo-div.player-error-missing-permissions .player-error-missing-permissions{\n                  display: block !important\n                 }\n                 #flashinfo-div.player-error-missing-permissions .player-error-default{\n                  display: none !important\n                 }\n\n                 #flash-div-top, #flash-div-bottom, #flashinfo-div{\n                    font-family: "Helvetica","Arial",sans-serif;\n                    color: white;\n                    font-size: 14px;\n                    font-weight: 400;\n                    line-height: 17px;\n                 }\n                 #flash-div-top h2, #flash-div-bottom h2, #flashinfo-div h2{\n                    font-family: "Helvetica","Arial",sans-serif;\n                    color: white;\n                    font-size: 14px;\n                    font-weight: 700;\n                    line-height: 17px;\n                    padding: 0;\n                    margin: 0;\n                 }\n                 #flash-div-top a, #flash-div-bottom a, #flashinfo-div a{\n                    color: #DF6300;\n                 }');let e="";i.settings.get("floatButtonStealth")&&(e="mini-stealth"),s.$("body").after(s.html(`<div id="flash-div-top" dir="${i.storage.langDirection()}" style="text-align: center;pointer-events: none;position: fixed;top:-5px;width:100%;z-index: 2147483647;left: 0;"></div>        <div id="flash-div-bottom" dir="${i.storage.langDirection()}" style="text-align: center;pointer-events: none;position: fixed;bottom:0px;width:100%;z-index: 2147483647;left: 0;"><div id="flash" style="display:none;  background-color: red;padding: 20px; margin: 0 auto;max-width: 60%;          -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 20px;background:rgba(227,0,0,0.6);"></div></div>        <div id="flashinfo-div" dir="${i.storage.langDirection()}" class="${e}" style="text-align: center;pointer-events: none;position: fixed;bottom:0px;width:100%;left: 0;">`))}(),a.log("[Flash] Message:",e);let n="#323232";void 0!==t&&void 0!==t.error&&t.error&&(n="#3e0808");let r="#flash-div-bottom";void 0!==t&&void 0!==t.position&&t.position&&(r=`#flash-div-${t.position}`);let o="flash";if(void 0!==t&&void 0!==t.type&&t.type){const e=`type-${t.type}`;s.$(`${r} .${e}, #flashinfo-div .${e}`).removeClass(e).fadeOut({duration:1e3,queue:!1,complete(){s.$(this).remove()}}),o+=` ${e}`}let l,c=`<div class="${o}" style="display:none;">        <div style="display:table; pointer-events: all; padding: 14px 24px 14px 24px; margin: 0 auto; margin-top: 5px; max-width: 60%; -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 2px;color: white;background:${n}; ">          ${e}        </div>      </div>`;return void 0!==t&&void 0!==t.hoverInfo&&t.hoverInfo?(o+=" flashinfo",c=`<div class="${o}" style="display:none; max-height: 5000px; overflow: hidden;"><div style="display:table; pointer-events: all; margin: 0 auto; margin-top: -2px; max-width: 60%; -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 2px;color: white;background:${n}; position: relative;"><div style="max-height: 60vh; overflow-y: auto; padding: 14px 24px 14px 24px;">${e}</div></div></div>`,s.$("#flashinfo-div").addClass("hover"),l=s.$(s.html(c)).appendTo("#flashinfo-div"),void 0!==t&&void 0!==t.minimized&&t.minimized&&l.css("max-height","8px")):l=s.$(s.html(c)).appendTo(r),void 0!==t&&void 0!==t.permanent&&t.permanent?l.slideDown(800):void 0!==t&&void 0!==t.hoverInfo&&t.hoverInfo?l.slideDown(800).delay(4e3).queue((function(){s.$("#flashinfo-div").removeClass("hover"),l.css("max-height","8px")})):l.slideDown(800).delay(4e3).slideUp(800,(()=>{s.$(this).remove()})),l}async function G(e,t,n=()=>{},a=()=>{},r=!1){return new Promise((function(o,l){let c=i.storage.lang("Ok"),u=i.storage.lang("Cancel");r&&(c=i.storage.lang("Yes"),u=i.storage.lang("No"));const h=W(e=`<div style="text-align: center;">${e}</div><div style="display: flex; justify-content: space-around;"><button class="Yes" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px; cursor:pointer;">${c}</button><button class="Cancel" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px; cursor:pointer;">${u}</button></div>`,{permanent:!0,position:"top",type:t});h.find(".Yes").click((function(e){o(!0),s.$(e.target).parentsUntil(".flash").fadeOut(300,(function(){s.$(this).remove()})),n()})),h.find(".Cancel").click((function(e){o(!1),s.$(e.target).parentsUntil(".flash").fadeOut(300,(function(){s.$(this).remove()})),a()}))}))}let K=!1,q=[];function X(e,t=".mdl-layout__content"){function n(e,t){if(!s.$(e).is(":visible"))return!1;if(s.$(e).hasClass("lazyBack"))s.$(e).css("background-image",`url(${e.getAttribute("data-src")})`).removeClass("lazyBack");else{const n=new Image,s=e.getAttribute("data-src");n.onload=function(){e.parent?e.parent.replaceChild(n,e):e.src=s,t&&t()},n.src=s}}for(let e=0;e<q.length;e++)$(q[e]).addClass("init");q=[];const i=e.find("img.lazy.init, .lazyBack.init"),a=function(){for(let e=0;e<q.length;e++)r.elementInViewport(q[e],600)&&n(q[e],(function(){q.splice(e,e)})),$(q[e]).length||q.splice(e,e)};for(let e=0;e<i.length;e++)q.push(i[e]),$(i[e]).removeClass("init");a(),K||(K=!0,e.find(t).scroll((function(){a()})))}function Y(e,t=0){const n=e.getBoundingClientRect();return n.top>=0&&n.left>=0&&n.top-t<=(window.innerHeight||document.documentElement.clientHeight)}function J(e){return new Promise((t=>{setTimeout(t,e)}))}function Z(e,t,n){switch(e){case"mal":return`https://myanimelist.net/${t}/${n}`;case"anilist":return`https://anilist.co/${t}/${n}`;case"kitsu":return`https://kitsu.app/${t}/${n}`;case"simkl":return`https://simkl.com/${t}/${n}`;default:throw`${e} not a valid page`}}function Q(e=0){const t=new Date;t.setDate(t.getDate()+e);const n=(t.getMonth()+1).toString().padStart(2,"0"),s=t.getDate().toString().padStart(2,"0");return`${t.getFullYear()}-${n}-${s}`}function ee(e){return $("<textarea/>").html(s.html(e)).text()}function te(){return Boolean("undefined"!=typeof browser&&"undefined"!=typeof chrome)}function ne(){const e=()=>Boolean(!document.visibilityState||"visible"===document.visibilityState);if(e())return Promise.resolve();a.log("Page in background");const{asyncWaitUntilTrue:t}=I((()=>e()));return t().then((()=>{a.log("Page is visible")}))}async function se(){const e=await i.storage.list();let t=0;for(const n in e)r.syncRegex.test(n)||/(^tagSettings\/.*)/.test(n)||(i.storage.remove(n),t++);r.flashm(`Cache Cleared [${t}]`)}function ie(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}function ae(e,t){const n=new URL(e),{host:s}=n;return s===t||s.endsWith(`.${t}`)}function re(e){return!e||e.length<2?e:e.charAt(0).toUpperCase()+e.slice(1)}},7263:(e,t,n)=>{"use strict";n.r(t),n.d(t,{$:()=>i,html:()=>a});var s=n(99418);const i=jQuery;function a(e){return s.A.sanitize(e,{ALLOW_UNKNOWN_PROTOCOLS:!0,ADD_ATTR:["target"]})}},96789:(e,t,n)=>{"use strict";n.d(t,{GT:()=>u,Lu:()=>c});var s=n(54089),i=n.n(s),a=n(35580),r=n.n(a),o=n(13647);function l(){return o.storage.version()}function c(e){return i()(e,l())}function u(e){return r()(e,l())&&e!==l()}},66262:(e,t)=>{"use strict";t.A=(e,t)=>{const n=e.__vccOpts||e;for(const[e,s]of t)n[e]=s;return n}},99418:(e,t,n)=>{"use strict";n.d(t,{A:()=>ne});const{entries:s,setPrototypeOf:i,isFrozen:a,getPrototypeOf:r,getOwnPropertyDescriptor:o}=Object;let{freeze:l,seal:c,create:u}=Object,{apply:h,construct:p}="undefined"!=typeof Reflect&&Reflect;l||(l=function(e){return e}),c||(c=function(e){return e}),h||(h=function(e,t,n){return e.apply(t,n)}),p||(p=function(e,t){return new e(...t)});const m=$(Array.prototype.forEach),d=$(Array.prototype.lastIndexOf),g=$(Array.prototype.pop),f=$(Array.prototype.push),y=$(Array.prototype.splice),v=$(String.prototype.toLowerCase),b=$(String.prototype.toString),_=$(String.prototype.match),w=$(String.prototype.replace),S=$(String.prototype.indexOf),E=$(String.prototype.trim),k=$(Object.prototype.hasOwnProperty),I=$(RegExp.prototype.test),x=(T=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return p(T,t)});var T;function $(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];return h(e,t,s)}}function N(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v;i&&i(e,null);let s=t.length;for(;s--;){let i=t[s];if("string"==typeof i){const e=n(i);e!==i&&(a(t)||(t[s]=e),i=e)}e[i]=!0}return e}function O(e){for(let t=0;t<e.length;t++)k(e,t)||(e[t]=null);return e}function C(e){const t=u(null);for(const[n,i]of s(e))k(e,n)&&(Array.isArray(i)?t[n]=O(i):i&&"object"==typeof i&&i.constructor===Object?t[n]=C(i):t[n]=i);return t}function L(e,t){for(;null!==e;){const n=o(e,t);if(n){if(n.get)return $(n.get);if("function"==typeof n.value)return $(n.value)}e=r(e)}return function(){return null}}const A=l(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),P=l(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),R=l(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),M=l(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),D=l(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),U=l(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),j=l(["#text"]),F=l(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),V=l(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),z=l(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),H=l(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),B=c(/\{\{[\w\W]*|[\w\W]*\}\}/gm),W=c(/<%[\w\W]*|[\w\W]*%>/gm),G=c(/\$\{[\w\W]*/gm),K=c(/^data-[\-\w.\u00B7-\uFFFF]+$/),q=c(/^aria-[\-\w]+$/),X=c(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Y=c(/^(?:\w+script|data):/i),J=c(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Z=c(/^html$/i),Q=c(/^[a-z][.\w]*(-[.\w]+)+$/i);var ee=Object.freeze({__proto__:null,ARIA_ATTR:q,ATTR_WHITESPACE:J,CUSTOM_ELEMENT:Q,DATA_ATTR:K,DOCTYPE_NAME:Z,ERB_EXPR:W,IS_ALLOWED_URI:X,IS_SCRIPT_OR_DATA:Y,MUSTACHE_EXPR:B,TMPLIT_EXPR:G});const te=function(){return"undefined"==typeof window?null:window};var ne=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te();const n=t=>e(t);if(n.version="3.2.5",n.removed=[],!t||!t.document||9!==t.document.nodeType||!t.Element)return n.isSupported=!1,n;let{document:i}=t;const a=i,r=a.currentScript,{DocumentFragment:o,HTMLTemplateElement:c,Node:h,Element:p,NodeFilter:T,NamedNodeMap:$=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:O,DOMParser:B,trustedTypes:W}=t,G=p.prototype,K=L(G,"cloneNode"),q=L(G,"remove"),Y=L(G,"nextSibling"),J=L(G,"childNodes"),Q=L(G,"parentNode");if("function"==typeof c){const e=i.createElement("template");e.content&&e.content.ownerDocument&&(i=e.content.ownerDocument)}let ne,se="";const{implementation:ie,createNodeIterator:ae,createDocumentFragment:re,getElementsByTagName:oe}=i,{importNode:le}=a;let ce={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof s&&"function"==typeof Q&&ie&&void 0!==ie.createHTMLDocument;const{MUSTACHE_EXPR:ue,ERB_EXPR:he,TMPLIT_EXPR:pe,DATA_ATTR:me,ARIA_ATTR:de,IS_SCRIPT_OR_DATA:ge,ATTR_WHITESPACE:fe,CUSTOM_ELEMENT:ye}=ee;let{IS_ALLOWED_URI:ve}=ee,be=null;const _e=N({},[...A,...P,...R,...D,...j]);let we=null;const Se=N({},[...F,...V,...z,...H]);let Ee=Object.seal(u(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),ke=null,Ie=null,xe=!0,Te=!0,$e=!1,Ne=!0,Oe=!1,Ce=!0,Le=!1,Ae=!1,Pe=!1,Re=!1,Me=!1,De=!1,Ue=!0,je=!1,Fe=!0,Ve=!1,ze={},He=null;const Be=N({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let We=null;const Ge=N({},["audio","video","img","source","image","track"]);let Ke=null;const qe=N({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Xe="http://www.w3.org/1998/Math/MathML",Ye="http://www.w3.org/2000/svg",Je="http://www.w3.org/1999/xhtml";let Ze=Je,Qe=!1,et=null;const tt=N({},[Xe,Ye,Je],b);let nt=N({},["mi","mo","mn","ms","mtext"]),st=N({},["annotation-xml"]);const it=N({},["title","style","font","a","script"]);let at=null;const rt=["application/xhtml+xml","text/html"];let ot=null,lt=null;const ct=i.createElement("form"),ut=function(e){return e instanceof RegExp||e instanceof Function},ht=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!lt||lt!==e){if(e&&"object"==typeof e||(e={}),e=C(e),at=-1===rt.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,ot="application/xhtml+xml"===at?b:v,be=k(e,"ALLOWED_TAGS")?N({},e.ALLOWED_TAGS,ot):_e,we=k(e,"ALLOWED_ATTR")?N({},e.ALLOWED_ATTR,ot):Se,et=k(e,"ALLOWED_NAMESPACES")?N({},e.ALLOWED_NAMESPACES,b):tt,Ke=k(e,"ADD_URI_SAFE_ATTR")?N(C(qe),e.ADD_URI_SAFE_ATTR,ot):qe,We=k(e,"ADD_DATA_URI_TAGS")?N(C(Ge),e.ADD_DATA_URI_TAGS,ot):Ge,He=k(e,"FORBID_CONTENTS")?N({},e.FORBID_CONTENTS,ot):Be,ke=k(e,"FORBID_TAGS")?N({},e.FORBID_TAGS,ot):{},Ie=k(e,"FORBID_ATTR")?N({},e.FORBID_ATTR,ot):{},ze=!!k(e,"USE_PROFILES")&&e.USE_PROFILES,xe=!1!==e.ALLOW_ARIA_ATTR,Te=!1!==e.ALLOW_DATA_ATTR,$e=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ne=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Oe=e.SAFE_FOR_TEMPLATES||!1,Ce=!1!==e.SAFE_FOR_XML,Le=e.WHOLE_DOCUMENT||!1,Re=e.RETURN_DOM||!1,Me=e.RETURN_DOM_FRAGMENT||!1,De=e.RETURN_TRUSTED_TYPE||!1,Pe=e.FORCE_BODY||!1,Ue=!1!==e.SANITIZE_DOM,je=e.SANITIZE_NAMED_PROPS||!1,Fe=!1!==e.KEEP_CONTENT,Ve=e.IN_PLACE||!1,ve=e.ALLOWED_URI_REGEXP||X,Ze=e.NAMESPACE||Je,nt=e.MATHML_TEXT_INTEGRATION_POINTS||nt,st=e.HTML_INTEGRATION_POINTS||st,Ee=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ut(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ee.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ut(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ee.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ee.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Oe&&(Te=!1),Me&&(Re=!0),ze&&(be=N({},j),we=[],!0===ze.html&&(N(be,A),N(we,F)),!0===ze.svg&&(N(be,P),N(we,V),N(we,H)),!0===ze.svgFilters&&(N(be,R),N(we,V),N(we,H)),!0===ze.mathMl&&(N(be,D),N(we,z),N(we,H))),e.ADD_TAGS&&(be===_e&&(be=C(be)),N(be,e.ADD_TAGS,ot)),e.ADD_ATTR&&(we===Se&&(we=C(we)),N(we,e.ADD_ATTR,ot)),e.ADD_URI_SAFE_ATTR&&N(Ke,e.ADD_URI_SAFE_ATTR,ot),e.FORBID_CONTENTS&&(He===Be&&(He=C(He)),N(He,e.FORBID_CONTENTS,ot)),Fe&&(be["#text"]=!0),Le&&N(be,["html","head","body"]),be.table&&(N(be,["tbody"]),delete ke.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw x('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw x('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');ne=e.TRUSTED_TYPES_POLICY,se=ne.createHTML("")}else void 0===ne&&(ne=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const s="data-tt-policy-suffix";t&&t.hasAttribute(s)&&(n=t.getAttribute(s));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(W,r)),null!==ne&&"string"==typeof se&&(se=ne.createHTML(""));l&&l(e),lt=e}},pt=N({},[...P,...R,...M]),mt=N({},[...D,...U]),dt=function(e){f(n.removed,{element:e});try{Q(e).removeChild(e)}catch(t){q(e)}},gt=function(e,t){try{f(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){f(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(Re||Me)try{dt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},ft=function(e){let t=null,n=null;if(Pe)e="<remove></remove>"+e;else{const t=_(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===at&&Ze===Je&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const s=ne?ne.createHTML(e):e;if(Ze===Je)try{t=(new B).parseFromString(s,at)}catch(e){}if(!t||!t.documentElement){t=ie.createDocument(Ze,"template",null);try{t.documentElement.innerHTML=Qe?se:s}catch(e){}}const a=t.body||t.documentElement;return e&&n&&a.insertBefore(i.createTextNode(n),a.childNodes[0]||null),Ze===Je?oe.call(t,Le?"html":"body")[0]:Le?t.documentElement:a},yt=function(e){return ae.call(e.ownerDocument||e,e,T.SHOW_ELEMENT|T.SHOW_COMMENT|T.SHOW_TEXT|T.SHOW_PROCESSING_INSTRUCTION|T.SHOW_CDATA_SECTION,null)},vt=function(e){return e instanceof O&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof $)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},bt=function(e){return"function"==typeof h&&e instanceof h};function _t(e,t,s){m(e,(e=>{e.call(n,t,s,lt)}))}const wt=function(e){let t=null;if(_t(ce.beforeSanitizeElements,e,null),vt(e))return dt(e),!0;const s=ot(e.nodeName);if(_t(ce.uponSanitizeElement,e,{tagName:s,allowedTags:be}),e.hasChildNodes()&&!bt(e.firstElementChild)&&I(/<[/\w!]/g,e.innerHTML)&&I(/<[/\w!]/g,e.textContent))return dt(e),!0;if(7===e.nodeType)return dt(e),!0;if(Ce&&8===e.nodeType&&I(/<[/\w]/g,e.data))return dt(e),!0;if(!be[s]||ke[s]){if(!ke[s]&&Et(s)){if(Ee.tagNameCheck instanceof RegExp&&I(Ee.tagNameCheck,s))return!1;if(Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(s))return!1}if(Fe&&!He[s]){const t=Q(e)||e.parentNode,n=J(e)||e.childNodes;if(n&&t)for(let s=n.length-1;s>=0;--s){const i=K(n[s],!0);i.__removalCount=(e.__removalCount||0)+1,t.insertBefore(i,Y(e))}}return dt(e),!0}return e instanceof p&&!function(e){let t=Q(e);t&&t.tagName||(t={namespaceURI:Ze,tagName:"template"});const n=v(e.tagName),s=v(t.tagName);return!!et[e.namespaceURI]&&(e.namespaceURI===Ye?t.namespaceURI===Je?"svg"===n:t.namespaceURI===Xe?"svg"===n&&("annotation-xml"===s||nt[s]):Boolean(pt[n]):e.namespaceURI===Xe?t.namespaceURI===Je?"math"===n:t.namespaceURI===Ye?"math"===n&&st[s]:Boolean(mt[n]):e.namespaceURI===Je?!(t.namespaceURI===Ye&&!st[s])&&!(t.namespaceURI===Xe&&!nt[s])&&!mt[n]&&(it[n]||!pt[n]):!("application/xhtml+xml"!==at||!et[e.namespaceURI]))}(e)?(dt(e),!0):"noscript"!==s&&"noembed"!==s&&"noframes"!==s||!I(/<\/no(script|embed|frames)/i,e.innerHTML)?(Oe&&3===e.nodeType&&(t=e.textContent,m([ue,he,pe],(e=>{t=w(t,e," ")})),e.textContent!==t&&(f(n.removed,{element:e.cloneNode()}),e.textContent=t)),_t(ce.afterSanitizeElements,e,null),!1):(dt(e),!0)},St=function(e,t,n){if(Ue&&("id"===t||"name"===t)&&(n in i||n in ct))return!1;if(Te&&!Ie[t]&&I(me,t));else if(xe&&I(de,t));else if(!we[t]||Ie[t]){if(!(Et(e)&&(Ee.tagNameCheck instanceof RegExp&&I(Ee.tagNameCheck,e)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(e))&&(Ee.attributeNameCheck instanceof RegExp&&I(Ee.attributeNameCheck,t)||Ee.attributeNameCheck instanceof Function&&Ee.attributeNameCheck(t))||"is"===t&&Ee.allowCustomizedBuiltInElements&&(Ee.tagNameCheck instanceof RegExp&&I(Ee.tagNameCheck,n)||Ee.tagNameCheck instanceof Function&&Ee.tagNameCheck(n))))return!1}else if(Ke[t]);else if(I(ve,w(n,fe,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==S(n,"data:")||!We[e])if($e&&!I(ge,w(n,fe,"")));else if(n)return!1;return!0},Et=function(e){return"annotation-xml"!==e&&_(e,ye)},kt=function(e){_t(ce.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||vt(e))return;const s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:we,forceKeepAttr:void 0};let i=t.length;for(;i--;){const a=t[i],{name:r,namespaceURI:o,value:l}=a,c=ot(r);let u="value"===r?l:E(l);if(s.attrName=c,s.attrValue=u,s.keepAttr=!0,s.forceKeepAttr=void 0,_t(ce.uponSanitizeAttribute,e,s),u=s.attrValue,!je||"id"!==c&&"name"!==c||(gt(r,e),u="user-content-"+u),Ce&&I(/((--!?|])>)|<\/(style|title)/i,u)){gt(r,e);continue}if(s.forceKeepAttr)continue;if(gt(r,e),!s.keepAttr)continue;if(!Ne&&I(/\/>/i,u)){gt(r,e);continue}Oe&&m([ue,he,pe],(e=>{u=w(u,e," ")}));const h=ot(e.nodeName);if(St(h,c,u)){if(ne&&"object"==typeof W&&"function"==typeof W.getAttributeType)if(o);else switch(W.getAttributeType(h,c)){case"TrustedHTML":u=ne.createHTML(u);break;case"TrustedScriptURL":u=ne.createScriptURL(u)}try{o?e.setAttributeNS(o,r,u):e.setAttribute(r,u),vt(e)?dt(e):g(n.removed)}catch(e){}}}_t(ce.afterSanitizeAttributes,e,null)},It=function e(t){let n=null;const s=yt(t);for(_t(ce.beforeSanitizeShadowDOM,t,null);n=s.nextNode();)_t(ce.uponSanitizeShadowNode,n,null),wt(n),kt(n),n.content instanceof o&&e(n.content);_t(ce.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=null,i=null,r=null,l=null;if(Qe=!e,Qe&&(e="\x3c!--\x3e"),"string"!=typeof e&&!bt(e)){if("function"!=typeof e.toString)throw x("toString is not a function");if("string"!=typeof(e=e.toString()))throw x("dirty is not a string, aborting")}if(!n.isSupported)return e;if(Ae||ht(t),n.removed=[],"string"==typeof e&&(Ve=!1),Ve){if(e.nodeName){const t=ot(e.nodeName);if(!be[t]||ke[t])throw x("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof h)s=ft("\x3c!----\x3e"),i=s.ownerDocument.importNode(e,!0),1===i.nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?s=i:s.appendChild(i);else{if(!Re&&!Oe&&!Le&&-1===e.indexOf("<"))return ne&&De?ne.createHTML(e):e;if(s=ft(e),!s)return Re?null:De?se:""}s&&Pe&&dt(s.firstChild);const c=yt(Ve?e:s);for(;r=c.nextNode();)wt(r),kt(r),r.content instanceof o&&It(r.content);if(Ve)return e;if(Re){if(Me)for(l=re.call(s.ownerDocument);s.firstChild;)l.appendChild(s.firstChild);else l=s;return(we.shadowroot||we.shadowrootmode)&&(l=le.call(a,l,!0)),l}let u=Le?s.outerHTML:s.innerHTML;return Le&&be["!doctype"]&&s.ownerDocument&&s.ownerDocument.doctype&&s.ownerDocument.doctype.name&&I(Z,s.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+s.ownerDocument.doctype.name+">\n"+u),Oe&&m([ue,he,pe],(e=>{u=w(u,e," ")})),ne&&De?ne.createHTML(u):u},n.setConfig=function(){ht(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Ae=!0},n.clearConfig=function(){lt=null,Ae=!1},n.isValidAttribute=function(e,t,n){lt||ht({});const s=ot(e),i=ot(t);return St(s,i,n)},n.addHook=function(e,t){"function"==typeof t&&f(ce[e],t)},n.removeHook=function(e,t){if(void 0!==t){const n=d(ce[e],t);return-1===n?void 0:y(ce[e],n,1)[0]}return g(ce[e])},n.removeHooks=function(e){ce[e]=[]},n.removeAllHooks=function(){ce={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}()},52163:e=>{"use strict";e.exports=JSON.parse('[{"key":"Crunchyroll","name":"Crunchyroll","domain":"https://www.crunchyroll.com","database":"Crunchyroll","search":{"anime":"https://www.crunchyroll.com/search?q={searchtermPlus}","manga":null}},{"key":"Mangadex","name":"Mangadex","domain":"https://www.mangadex.org","database":"Mangadex","search":{"anime":null,"manga":"https://mangadex.org/titles?q={searchterm}"}},{"key":"Gogoanime","name":"Gogoanime","domain":"https://gogoanime.tv","database":"Gogoanime","search":{"anime":"https://anitaku.pe/search.html?keyword={searchterm}","manga":null}},{"key":"TurkAnime","name":"TurkAnime","domain":"https://www.turkanime.co","database":null,"search":{"anime":"home","manga":null}},{"key":"animepahe","name":"animepahe","domain":"https://animepahe.com","database":"animepahe","search":{"anime":"home","manga":null}},{"key":"Netflix","name":"Netflix","domain":"https://www.netflix.com","database":"Netflix","search":{"anime":"https://www.netflix.com/search?q={searchterm}","manga":null}},{"key":"Animeflv","name":"Animeflv","domain":"https://animeflv.net","database":null,"search":{"anime":"https://www3.animeflv.net/browse?q={searchtermPlus}","manga":null}},{"key":"Jkanime","name":"Jkanime","domain":"https://jkanime.net","database":null,"search":{"anime":"https://jkanime.net/buscar/{searchterm}","manga":null}},{"key":"Proxer","name":"Proxer","domain":"https://proxer.me","database":null,"search":{"anime":"https://proxer.me/search?s=search&name={searchterm}&typ=all-anime&tags=&notags=#top","manga":"https://proxer.me/search?s=search&name={searchterm}&typ=all-manga&tags=&notags=#top"}},{"key":"Emby","name":"Emby","domain":"http://app.emby.media","database":null,"search":{"anime":"home","manga":null}},{"key":"Plex","name":"Plex","domain":"http://app.plex.tv","database":null,"search":{"anime":"home","manga":null}},{"key":"Aniflix","name":"Aniflix","domain":"https://aniflix.cc","database":null,"search":{"anime":"home","manga":null}},{"key":"KickAssAnime","name":"KickAssAnime","domain":"https://kickassanime.am","database":"KickAssAnime","search":{"anime":"https://kaas.am/search?q={searchterm}","manga":null}},{"key":"Shinden","name":"Shinden","domain":"https://shinden.pl","database":null,"search":{"anime":"https://shinden.pl/series?search={searchtermPlus}","manga":null}},{"key":"Voiranime","name":"Voiranime","domain":"https://voiranime.com","database":null,"search":{"anime":"https://voiranime.com/?s={searchtermPlus}","manga":null}},{"key":"VIZ","name":"VIZ","domain":"https://www.viz.com","database":"VIZ","search":{"anime":null,"manga":"https://www.viz.com/search?search={searchtermPlus}"}},{"key":"AnimeOdcinki","name":"AnimeOdcinki","domain":"https://anime-odcinki.pl","database":null,"search":{"anime":"https://anime-odcinki.pl/szukaj/{searchtermPlus}","manga":null}},{"key":"AnimeZone","name":"AnimeZone","domain":"https://www.animezone.pl","database":null,"search":{"anime":"https://www.animezone.pl/szukaj?q={searchtermPlus}","manga":null}},{"key":"serimanga","name":"serimanga","domain":"https://serimanga.com","database":null,"search":{"anime":null,"manga":"https://serimanga.com/mangalar?search={searchtermPlus}"}},{"key":"mangadenizi","name":"mangadenizi","domain":"https://www.mangadenizi.net","database":null,"search":{"anime":null,"manga":"home"}},{"key":"moeclip","name":"moeclip","domain":"https://moeclip.com","database":null,"search":{"anime":"https://moeclip.com/search/{searchtermPlus}","manga":null}},{"key":"mangalivre","name":"Mangá Livre","domain":"https://mangalivre.net","database":null,"search":{"anime":null,"manga":"home"}},{"key":"tmofans","name":"tmofans","domain":"https://zonatmo.com","database":null,"search":{"anime":null,"manga":"https://zonatmo.com/library?_pg=1&title={searchtermPlus}"}},{"key":"MangaPlus","name":"MangaPlus","domain":"https://mangaplus.shueisha.co.jp","database":"MangaPlus","search":{"anime":null,"manga":"https://mangaplus.shueisha.co.jp/search_result?keyword={searchterm}"}},{"key":"JapScan","name":"JapScan","domain":"https://www.japscan.ws","database":null,"search":{"anime":null,"manga":"home"}},{"key":"Hulu","name":"Hulu","domain":"https://www.hulu.com","database":"Hulu","search":{"anime":"home","manga":null}},{"key":"Hidive","name":"Hidive","domain":"https://www.hidive.com","database":"Hidive","search":{"anime":"https://www.hidive.com/search?q={searchtermPlus}","manga":null}},{"key":"MangaKatana","name":"MangaKatana","domain":"http://mangakatana.com","database":null,"search":{"anime":null,"manga":"http://mangakatana.com/?search={searchtermPlus}&search_by=book_name"}},{"key":"manga4life","name":"manga4life","domain":"https://manga4life.com","database":null,"search":{"anime":null,"manga":"https://manga4life.com/search/?name={searchterm}"}},{"key":"bato","name":"bato","domain":"https://bato.to","database":null,"search":{"anime":null,"manga":"https://bato.to/search?word={searchtermPlus}"}},{"key":"MangaPark","name":"MangaPark","domain":"https://mangapark.net","database":null,"search":{"anime":null,"manga":"https://mangapark.net/search?word={searchterm}"}},{"key":"AnimeXin","name":"AnimeXin","domain":"https://animexin.vip","database":null,"search":{"anime":"https://animexin.vip/?s={searchtermPlus}","manga":null}},{"key":"MonosChinos","name":"MonosChinos","domain":"https://monoschinos2.com","database":null,"search":{"anime":"https://monoschinos2.com/buscar?q={searchtermPlus}","manga":null}},{"key":"Anime365","name":"Anime365","domain":"https://smotret-anime.org","database":null,"search":{"anime":"https://smotret-anime.net/catalog/search?q={searchtermPlus}","manga":null}},{"key":"AnimeFire","name":"AnimeFire","domain":"https://animefire.net","database":null,"search":{"anime":"home","manga":null}},{"key":"OtakuFR","name":"OtakuFR","domain":"https://otakufr.cc","database":null,"search":{"anime":"https://otakufr.cc/toute-la-liste-affiches/?q={searchtermPlus}","manga":null}},{"key":"mangatx","name":"mangatx","domain":"https://mangatx.com","database":null,"search":{"anime":null,"manga":"https://mangatx.com/?s={searchtermPlus}&post_type=wp-manga&post_type=wp-manga"}},{"key":"manhuafast","name":"manhuafast","domain":"https://manhuafast.com","database":null,"search":{"anime":null,"manga":"https://manhuafast.com/?s={searchtermPlus}&post_type=wp-manga&post_type=wp-manga"}},{"key":"TRanimeizle","name":"TRanimeizle","domain":"https://www.tranimeizle.net/","database":null,"search":{"anime":"home","manga":null}},{"key":"AnimeStreamingFR","name":"AnimeStreamingFR","domain":"https://beta.animestreamingfr.fr","database":null,"search":{"anime":"https://beta.animestreamingfr.fr/catalogue/search?query={searchtermPlus}","manga":null}},{"key":"Furyosociety","name":"Furyosociety","domain":"https://furyosociety.com/","database":null,"search":{"anime":null,"manga":"home"}},{"key":"AnimeId","name":"AnimeId","domain":"https://www.animeid.tv","database":null,"search":{"anime":"home","manga":null}},{"key":"MyAnimeListVideo","name":"MyAnimeList","domain":"https://myanimelist.net","database":null,"search":{"anime":"https://myanimelist.net/anime.php?q={searchterm}","manga":"https://myanimelist.net/manga.php?q={searchterm}"}},{"key":"AnimeUnity","name":"AnimeUnity","domain":"https://animeunity.it","database":null,"search":{"anime":"home","manga":null}},{"key":"MangaHere","name":"MangaHere","domain":"http://www.mangahere.cc","database":null,"search":{"anime":null,"manga":"http://www.mangahere.cc/search?title={searchtermPlus}"}},{"key":"MangaFox","name":"MangaFox","domain":"https://fanfox.net","database":"MangaFox","search":{"anime":null,"manga":"http://fanfox.net/search?title={searchtermPlus}"}},{"key":"DesuOnline","name":"DesuOnline","domain":"https://desu-online.pl","database":null,"search":{"anime":"https://desu-online.pl/?s={searchtermPlus}","manga":null}},{"key":"WuxiaWorld","name":"WuxiaWorld","domain":"https://wuxiaworld.site","database":null,"search":{"anime":null,"manga":"https://wuxiaworld.site/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"LeviatanScans","name":"LeviatanScans","domain":"https://lscomic.com","database":null,"search":{"anime":null,"manga":"https://lscomic.com/?s={searchtermPlus}"}},{"key":"ReaperScans","name":"ReaperScans","domain":"https://reaperscans.com","database":null,"search":{"anime":null,"manga":"home"}},{"key":"LynxScans","name":"LynxScans","domain":"https://lynxscans.com","database":null,"search":{"anime":null,"manga":"https://lynxscans.com/comics?query={searchtermPlus}"}},{"key":"ZeroScans","name":"ZeroScans","domain":"https://zeroscans.com","database":null,"search":{"anime":null,"manga":"home"}},{"key":"DeathTollScans","name":"DeathTollScans","domain":"https://reader.deathtollscans.net","database":null,"search":{"anime":null,"manga":"home"}},{"key":"ManhuaPlus","name":"ManhuaPlus","domain":"https://manhuaplus.com","database":null,"search":{"anime":null,"manga":"https://manhuaplus.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"Readm","name":"Readm","domain":"https://readm.today","database":null,"search":{"anime":null,"manga":"home"}},{"key":"tioanime","name":"tioanime","domain":"https://tioanime.com","database":null,"search":{"anime":"https://tioanime.com/directorio?q={searchtermPlus}","manga":null}},{"key":"MangaSee","name":"MangaSee","domain":"https://mangasee123.com","database":"MangaSee","search":{"anime":null,"manga":"https://mangasee123.com/search/?name={searchterm}"}},{"key":"Okanime","name":"Okanime","domain":"https://okanime.tv","database":null,"search":{"anime":"https://okanime.tv/search?search={searchtermPlus}","manga":null}},{"key":"BSTO","name":"bs.to","domain":"https://bs.to","database":null,"search":{"anime":"home","manga":null}},{"key":"AsuraScans","name":"AsuraScans","domain":"https://asuratoon.com","database":null,"search":{"anime":null,"manga":"https://asuracomics.com/?s={searchtermPlus}"}},{"key":"Jellyfin","name":"Jellyfin","domain":"https://jellyfin.org/","database":null,"search":{"anime":"home","manga":null}},{"key":"An1me","name":"An1me","domain":"https://an1me.to","database":null,"search":{"anime":"https://an1me.to/?s={searchtermPlus}&post_type=wp-manga","manga":null}},{"key":"MangaJar","name":"MangaJar","domain":"https://mangajar.pro","database":null,"search":{"anime":null,"manga":"https://mangajar.pro/search?q={searchtermPlus}"}},{"key":"Otakustv","name":"Otakustv","domain":"https://www.otakustv.com","database":null,"search":{"anime":"https://www.otakustv.com/buscador.php?buscador={searchterm}","manga":null}},{"key":"Komga","name":"Komga","domain":"https://komga.org","database":null,"search":{"anime":null,"manga":"home"}},{"key":"AnimeWho","name":"AnimeWho","domain":"https://animewho.com","database":null,"search":{"anime":"home","manga":null}},{"key":"Fumetsu","name":"Fumetsu","domain":"https://fumetsu.pl","database":null,"search":{"anime":"home","manga":null}},{"key":"FrixySubs","name":"FrixySubs","domain":"https://frixysubs.pl","database":null,"search":{"anime":"https://frixysubs.pl/anime-list?search={searchtermPlus}","manga":null}},{"key":"Guya","name":"Guya & Cubari","domain":"https://guya.moe","database":null,"search":{"anime":null,"manga":"home"}},{"key":"MangaHub","name":"MangaHub","domain":"https://mangahub.io","database":null,"search":{"anime":null,"manga":"https://mangahub.io/search?q={searchterm}"}},{"key":"ComicK","name":"ComicK","domain":"https://comick.io","database":"Comick","search":{"anime":null,"manga":"https://comick.io/search?q={searchterm}"}},{"key":"Bentomanga","name":"Bentomanga","domain":"https://bentomanga.com","database":null,"search":{"anime":null,"manga":"https://www.bentomanga.com/manga_list?search={searchterm}"}},{"key":"MangaSushi","name":"MangaSushi","domain":"https://mangasushi.net","database":null,"search":{"anime":null,"manga":"https://mangasushi.net/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"TritiniaScans","name":"TritiniaScans","domain":"https://tritinia.com","database":null,"search":{"anime":null,"manga":"https://tritinia.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"ReadManhua","name":"ReadManhua","domain":"https://readmanhua.net","database":null,"search":{"anime":null,"manga":"https://readmanhua.net/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"FlameScans","name":"FlameScans","domain":"https://flamecomics.xyz","database":null,"search":{"anime":null,"manga":"https://flamecomics.xyz/browse?search={searchterm}"}},{"key":"ImmortalUpdates","name":"ImmortalUpdates","domain":"https://immortalupdates.com","database":null,"search":{"anime":null,"manga":"https://immortalupdates.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"Zoro","name":"HiAnime","domain":"https://hianime.to","database":"Zoro","search":{"anime":"https://hianime.to/search?keyword={searchtermPlus}","manga":null}},{"key":"Kitsune","name":"Kitsune","domain":"https://beta.kitsune.tv","database":null,"search":{"anime":"https://kitsune.tv/shows?q={searchterm}","manga":null}},{"key":"LHTranslation","name":"LHTranslation","domain":"https://lhtranslation.net","database":null,"search":{"anime":null,"manga":"https://lhtranslation.net/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"MangasOrigines","name":"MangasOrigines","domain":"https://mangas-origines.fr/","database":null,"search":{"anime":null,"manga":"https://mangas-origines.fr/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"BlueSolo","name":"BlueSolo","domain":"https://www.bluesolo.org","database":null,"search":{"anime":null,"manga":"home"}},{"key":"DisasterScans","name":"DisasterScans","domain":"https://disasterscans.com","database":null,"search":{"anime":null,"manga":"https://disasterscans.com/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"DynastyScans","name":"DynastyScans","domain":"https://dynasty-scans.com","database":null,"search":{"anime":null,"manga":"https://dynasty-scans.com/search?q={searchtermPlus}"}},{"key":"Aniworld","name":"Aniworld","domain":"https://aniworld.to","database":null,"search":{"anime":"https://aniworld.to/search?q={searchterm}","manga":null}},{"key":"BetterAnime","name":"BetterAnime","domain":"https://betteranime.net","database":null,"search":{"anime":"https://betteranime.net/pesquisa?titulo={searchtermPlus}","manga":null}},{"key":"BilibiliComics","name":"BilibiliComics","domain":"https://manga.bilibili.com","database":null,"search":{"anime":null,"manga":"https://manga.bilibili.com/search?keyword={searchterm( )[noLowercase]}"}},{"key":"MangaReader","name":"MangaReader","domain":"https://mangareader.to","database":"MangaReader","search":{"anime":null,"manga":"https://mangareader.to/search?keyword={searchtermPlus}"}},{"key":"AnimeOnsen","name":"AnimeOnsen","domain":"https://animeonsen.xyz","database":null,"search":{"anime":"https://www.animeonsen.xyz/search/{searchterm}","manga":null}},{"key":"Animetoast","name":"Animetoast","domain":"https://www.animetoast.cc","database":null,"search":{"anime":"https://www.animetoast.cc/?s={searchterm}","manga":null}},{"key":"LuminousScans","name":"LuminousScans","domain":"https://luminous-scans.com","database":null,"search":{"anime":null,"manga":"https://luminous-scans.com/?s={searchtermPlus}"}},{"key":"Animeworld","name":"Animeworld","domain":"https://www.animeworld.tv","database":null,"search":{"anime":"home","manga":null}},{"key":"MangaBuddy","name":"MangaBuddy","domain":"https://mangabuddy.com","database":null,"search":{"anime":null,"manga":"https://mangabuddy.com/search?q={searchtermPlus}"}},{"key":"ToonAnime","name":"ToonAnime","domain":"https://vvww.toonanime.cc","database":null,"search":{"anime":"https://vvww.toonanime.cc/?story={searchtermPlus}&do=search&subaction=search","manga":null}},{"key":"ADKami","name":"ADKami","domain":"https://www.adkami.com/","database":null,"search":{"anime":"https://www.adkami.com/video?search={searchtermPlus}","manga":null}},{"key":"Kaguya","name":"Kaguya","domain":"https://kaguya.app","database":null,"search":{"anime":"https://kaguya.app/browse?keyword={searchtermPlus}","manga":null}},{"key":"Hdrezka","name":"Hdrezka","domain":"https://hdrezka.ag","database":null,"search":{"anime":"https://hdrezka.ag/search/?do=search&subaction=search&q={searchterm}","manga":null}},{"key":"SovetRomantica","name":"SovetRomantica","domain":"https://sovetromantica.com","database":null,"search":{"anime":"https://sovetromantica.com/anime?query={searchterm}","manga":null}},{"key":"ADN","name":"ADN","domain":"https://animationdigitalnetwork.com","database":null,"search":{"anime":"https://animationdigitalnetwork.fr/video?search={searchterm}","manga":null}},{"key":"Aniyan","name":"Aniyan","domain":"https://aniyan.net","database":null,"search":{"anime":"https://aniyan.net/?s={searchtermPlus}","manga":null}},{"key":"Docchi","name":"Docchi","domain":"https://docchi.pl","database":null,"search":{"anime":"home","manga":null}},{"key":"FRAnime","name":"FRAnime","domain":"https://franime.fr","database":null,"search":{"anime":"https://franime.fr/recherche?search={searchtermPlus}","manga":null}},{"key":"FMTeam","name":"FMTeam","domain":"https://fmteam.fr","database":null,"search":{"anime":null,"manga":"home"}},{"key":"Animelon","name":"Animelon","domain":"https://www.animelon.com","database":null,"search":{"anime":"https://www.animelon.com/search?searchTerm={searchTerm}","manga":null}},{"key":"AnimeNoSub","name":"AnimeNoSub","domain":"https://animenosub.to","database":null,"search":{"anime":"https://animenosub.to/?s={searchtermPlus}","manga":null}},{"key":"AnimeSama","name":"AnimeSama","domain":"https://anime-sama.fr","database":null,"search":{"anime":"https://anime-sama.fr/catalogue/","manga":null}},{"key":"MangaFire","name":"MangaFire","domain":"https://mangafire.to","database":"MangaFire","search":{"anime":null,"manga":"https://mangafire.to/filter?keyword={searchtermPlus}"}},{"key":"projectsuki","name":"projectsuki","domain":"https://projectsuki.com","database":null,"search":{"anime":null,"manga":"https://projectsuki.com/search?q={searchtermPlus}"}},{"key":"AnimeBuff","name":"AnimeBuff","domain":"https://animebuff.ru","database":null,"search":{"anime":"https://animebuff.ru/search?q={searchtermPlus}","manga":null}},{"key":"AnimeOnegai","name":"AnimeOnegai","domain":"https://www.animeonegai.com","database":null,"search":{"anime":"https://www.animeonegai.com/es/search?q={searchterm}","manga":null}},{"key":"AnimeKO","name":"AnimeKO","domain":"https://animeko.co","database":null,"search":{"anime":"https://animeko.co/anime?search={searchtermPlus}","manga":null}},{"key":"AnimeGO","name":"AnimeGO","domain":"https://animego.org","database":null,"search":{"anime":"https://animego.org/search/all?q={searchterm}","manga":null}},{"key":"LuciferDonghua","name":"Lucifer Donghua","domain":"https://luciferdonghua.in","database":null,"search":{"anime":"https://luciferdonghua.in/?s={searchterm}","manga":null}},{"key":"NeoxScans","name":"NeoxScans","domain":"https://neoxscans.com/","database":null,"search":{"anime":null,"manga":"https://neoxscans.com/?post_type=wp-manga&s={searchtermPlus}"}},{"key":"HinataSoul","name":"HinataSoul","domain":"https://hinatasoul.com","database":null,"search":{"anime":"https://www.hinatasoul.com/busca?busca={searchtermPlus}","manga":null}},{"key":"OgladajAnime","name":"OgladajAnime","domain":"https://ogladajanime.pl","database":null,"search":{"anime":"https://ogladajanime.pl/search/name/{searchtermPlus}","manga":null}},{"key":"hachi","name":"hachi","domain":"https://hachi.moe","database":null,"search":{"anime":null,"manga":"https://hachi.moe/search?query={searchterm}"}},{"key":"WitAnime","name":"WitAnime","domain":"https://witanime.pics","database":null,"search":{"anime":"https://witanime.pics/?search_param=animes&s={searchtermPlus}","manga":null}},{"key":"Suwayomi","name":"Suwayomi","domain":"https://suwayomi-webui-preview.github.io/","database":null,"search":{"anime":null,"manga":"https://suwayomi-webui-preview.github.io/sources/all/search/?query={searchtermPlus}"}},{"key":"ManhuaUS","name":"ManhuaUS","domain":"https://manhuaus.com","database":null,"search":{"anime":null,"manga":"https://manhuaus.com/?s={searchterm}&post_type=wp-manga&op=&author=&artist=&release=&adult="}},{"key":"Taiyo","name":"Taiyo","domain":"https://taiyo.moe","database":null,"search":{"anime":null,"manga":"home"}},{"key":"AnimesOnline","name":"Animes Online","domain":"https://animesonline.in","database":null,"search":{"anime":"https://www.animesonline.in/busca?s={searchtermPlus}","manga":null}},{"key":"Miruro","name":"Miruro","domain":"https://www.miruro.to","database":null,"search":{"anime":"https://www.miruro.tv/search?query={searchterm}&sort=POPULARITY_DESC","manga":null}},{"key":"Latanime","name":"Latanime","domain":"https://latanime.org","database":null,"search":{"anime":"https://latanime.org/buscar?q={searchtermPlus}","manga":null}},{"key":"MangaRead","name":"MangaRead","domain":"https://www.mangaread.org","database":null,"search":{"anime":null,"manga":"https://www.mangaread.org/?s={searchtermPlus}&post_type=wp-manga"}},{"key":"Q1N","name":"Q1N","domain":"https://q1n.net","database":null,"search":{"anime":"https://q1n.net/?s={searchtermPlus}","manga":null}},{"key":"TempleScan","name":"TempleScan","domain":"https://templescan.net","database":null,"search":{"anime":null,"manga":"home"}},{"key":"ScyllaScans","name":"ScyllaScans","domain":"https://scyllacomics.xyz","database":null,"search":{"anime":null,"manga":"home"}},{"key":"VortexScans","name":"VortexScans","domain":"https://vortexscans.org","database":null,"search":{"anime":null,"manga":"home"}},{"key":"WeebCentral","name":"WeebCentral","domain":"https://weebcentral.com","database":"Weebcentral","search":{"anime":null,"manga":"https://weebcentral.com/search?text={searchterm}"}},{"key":"Kavita","name":"Kavita","domain":"https://demo.kavitareader.com","database":null,"search":{"anime":null,"manga":"home"}},{"key":"Rawkuma","name":"Rawkuma","domain":"https://rawkuma.com","database":null,"search":{"anime":null,"manga":"https://rawkuma.com/?s={searchtermPlus}"}},{"key":"Aninexus","name":"Aninexus","domain":"https://aninexus.to","database":null,"search":{"anime":"https://aninexus.to/search/{searchterm}","manga":null}},{"key":"AnimeKAI","name":"AnimeKAI","domain":"https://animekai.to","database":null,"search":{"anime":"https://animekai.to/browser?keyword={searchtermPlus}","manga":null}},{"key":"Hikari","name":"Hikari","domain":"https://watch.hikaritv.xyz","database":null,"search":{"anime":"https://watch.hikaritv.xyz/search?keyword={searchterm}","manga":null}},{"key":"AniDream","name":"AniDream","domain":"https://anidream.cc","database":null,"search":{"anime":"https://anidream.cc/archive/?title={searchtermPlus}","manga":null}}]')}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var a=t[s]={exports:{}};return e[s](a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=n(13647);function t(t=""){const n=e.settings.get("syncMode");return"SIMKL"!==n||"manga"!==t&&-1===t.indexOf("/manga/")?n:e.settings.get("syncModeSimkl")}var s=n(78584);let i;if(function(){try{return localStorage.getItem("x"),!0}catch(e){return s.info("Local storage is not available",e),!1}}())i=localStorage;else{let e={};i={getItem:t=>t in e?e[t]:null,setItem(t,n){e[t]=n},removeItem(t){t in e&&delete e[t]},clear(){e={}}}}const a=i;var r,o,l,c=n(13647);class u{constructor(e,t,n=!0,s=0){return this.key=e,this.ttl=t,this.localStorage=n,this.refetchTtl=s,this}containsValue(e){return null!=e}valueValid(e,t){return!(!e||!e.timestamp)&&(new Date).getTime()<e.timestamp+t}ttlValid(e){return this.valueValid(e,this.ttl)}refetchTtlValid(e){return this.valueValid(e,this.refetchTtl)}async hasValue(){const e=await this.getStorage();return!(!this.containsValue(e)||!this.ttlValid(e))}async hasValueAndIsNotEmpty(){const e=await this.getStorage();return!!(this.containsValue(e)&&void 0!==e.data&&null!==e.data&&Object.keys(e.data).length&&this.ttlValid(e))}async fullState(){const e=await this.getStorage(),t=this.containsValue(e)&&this.refetchTtlValid(e),n=this.ttlValid(e);return{value:e,hasValue:t,isValid:n,refetch:t&&!n}}async getValue(){return(await this.getStorage()).data}async setValue(e){const t={data:e,timestamp:(new Date).getTime()};return this.localStorage?a.setItem(this.key,JSON.stringify(t)):c.storage.set(this.key,t)}async clearValue(){return this.localStorage?a.removeItem(this.key):c.storage.remove(this.key)}async getStorage(){return this.localStorage?JSON.parse(a.getItem(this.key)):c.storage.get(this.key)}}(l=r||(r={}))[l.NoState=0]="NoState",l[l.Watching=1]="Watching",l[l.Completed=2]="Completed",l[l.Onhold=3]="Onhold",l[l.Dropped=4]="Dropped",l[l.PlanToWatch=6]="PlanToWatch",l[l.All=7]="All",l[l.Rewatching=23]="Rewatching",function(e){e[e.NoScore=0]="NoScore",e[e.R1=1]="R1",e[e.R2=2]="R2",e[e.R3=3]="R3",e[e.R4=4]="R4",e[e.R5=5]="R5",e[e.R6=6]="R6",e[e.R7=7]="R7",e[e.R8=8]="R8",e[e.R9=9]="R9",e[e.R10=10]="R10"}(o||(o={}));var h=n(13647),p=n(26017),m=n(78584);async function d(e,t){if(!t)return{};const n=await h.request.xhr("GET",`https://api.malsync.moe/nc/mal/${e}/${t}/pr`);return JSON.parse(n.responseText)}var g=n(13647);const f={years:31536e6,months:2592e6,weeks:6048e5,days:864e5,hours:36e5,minutes:6e4,seconds:1e3,milliseconds:1};class y{constructor(e=g.storage.lang("locale")){return this.isFallback=!Intl.DurationFormat,this.locale=e,this}setLocale(e){return this.locale=e,this}setDuration(e){return this.duration=e,this}setDurationFormatted(e,t="Duration"){const n=y.durationToMs(e);return this.setRelativeTime(n,"milliseconds",t),this}setRelativeTime(e,t,n="Duration"){const s=e*f[t];return this.duration=this.process(s,n),this}setTimestamp(e,t="Duration",n=Date.now()){const s=e-new Date(n).getTime();return this.setRelativeTime(s,"milliseconds",t),this}process(e,t){switch(t){case"Duration":return b(e,["seconds","minutes","hours","days"]).duration;case"Progress":if(!e)break;return function(e){let t=e.days||0;return e.years?e.years>1?e.days&&e.days>182?{years:e.years+1}:{years:e.years}:{years:e.years,days:e.days}:((e.months||e.weeks)&&(t+=e.months?30*e.months:0,t+=e.weeks?7*e.weeks:0),t?t>3?e.hours&&e.hours>11?{days:t+1}:{days:t}:{days:t,hours:e.hours}:e.hours?e.hours>5?e.minutes&&e.minutes>29?{hours:e.hours+1}:{hours:e.hours}:{hours:e.hours,minutes:e.minutes}:e.minutes&&e.minutes>14?{minutes:e.minutes}:{minutes:e.minutes||0,seconds:e.seconds||0})}(b(e,["seconds","minutes","hours","days","years"]).duration);case"M/H/D/Y":if(!e)break;return b(e,["minutes","hours","days","years"]).duration;default:return{}}return{}}static durationToMs(e){const t=Object.keys(e);let n=0;if(t.length<=0)return n;for(let s=0;s<t.length;s++){const i=t[s],a=e[i];n+=f[i]*a}return n||0}getRelativeText(e={style:"narrow"}){if(!this.duration)return"";if(this.isFallback)return function(e){let t="";return e.years&&(1===e.years?t+=` ${e.years} ${g.storage.lang("bookmarksItem_Year")}`:t+=` ${e.years} ${g.storage.lang("bookmarksItem_Years")}`),e.days&&(1===e.days?t+=` ${e.days} ${g.storage.lang("bookmarksItem_Day")}`:t+=` ${e.days} ${g.storage.lang("bookmarksItem_Days")}`),e.hours&&(1===e.hours?t+=` ${e.hours} ${g.storage.lang("bookmarksItem_Hour")}`:t+=` ${e.hours} ${g.storage.lang("bookmarksItem_Hours")}`),e.minutes&&(1===e.minutes?t+=` ${e.minutes} ${g.storage.lang("bookmarksItem_min")}`:t+=` ${e.minutes} ${g.storage.lang("bookmarksItem_mins")}`),e.seconds&&(1===e.seconds?t+=` ${e.seconds} ${g.storage.lang("bookmarksItem_sec")}`:t+=` ${e.seconds} ${g.storage.lang("bookmarksItem_secs")}`),t.trim()}(this.duration);const t=e;if("significantLongNarrow"===e.style){const e=Object.keys(f);for(let n=0;n<e.length;n++){const s=e[n];if(this.duration[s]){t[s]="long",t.style="narrow";break}}}return new Intl.DurationFormat(this.locale,t).format(this.duration)}getDuration(){return this.duration}getLocale(){return this.locale}}class v{constructor(e,t=g.storage.lang("locale")){if(this.locale=t,"string"==typeof e){const t=Number(e);if(!Number.isNaN(t))return this.date=new Date(t),this}return this.date=new Date(e),this}setDate(e){return this.date=new Date(e),this}setLocale(e){return this.locale=e,this}isValidDate(){return _(this.date)}isNow(){return function(e,t=Date.now(),n={seconds:30}){if(Number.isNaN(e))return!1;const s=new Date(t).getTime(),i=y.durationToMs(n);return!(Math.abs(e-s)>i)}(this.date.getTime())}isFuture(){return this.date.getTime()>Date.now()}getDate(){return this.date}getLocale(){return this.locale}getDateTimeText(e={dateStyle:"medium"}){return _(this.date)?new Intl.DateTimeFormat(this.locale,e).format(this.date):""}getRelativeNowText(e="Duration",t){if(!this.isValidDate())return"";const n=new y(this.locale);return n.setTimestamp(this.date.getTime(),e),n.getRelativeText(t)}getRelativeNowFriendlyText(e="Duration",t){if(!this.isValidDate())return"";if(this.isNow())return g.storage.lang("bookmarksItem_now");const n=this.getRelativeNowText(e,t);return this.isFuture()?n:g.storage.lang("bookmarksItem_ago",[n])}}function b(e,t=["minutes","hours","days","years"],n=0){const s={},i=new Date(n).getTime();let a=Math.abs(i-e);const r=e>i;for(const e in f){if(!t.includes(e))continue;const n=Math.floor(a/f[e]);s[e]=n}const o=Object.keys(s);for(let e=1;e<o.length;e++){const t=o[e-1],n=s[t],i=o[e];a-=f[t]*n;const r=Math.floor(a/f[i]);s[i]=r}return{duration:s,isFuture:r}}function _(e){if(!e)return!1;if("number"==typeof e)return!0;const t="string"==typeof e?new Date(e):e;return t instanceof Date&&!Number.isNaN(t.getTime())}var w=n(78584),S=n(13647);class E{constructor(e,t){return this.cacheKey=e,this.type=t,this.releaseItem=void 0,this.logger=w.m("progress").m(e.toString()),this}async initReleaseProgress(e){e&&await async function(e,t,n="default",s=m.m("release")){if(n||(n="default"),(s=s.m(e.uid.toString())).log(e.title,e.cacheKey,e.apiCacheKey,`Mode: ${n}`),!e.apiCacheKey)return void s.log("No Api Cache Id");if(!h.settings.get("epPredictions"))return void s.log("epPredictions disabled");const i=await h.storage.get(`release/${t}/${e.cacheKey}`);s.m("Load").log(i);let a,r=!1;if(i&&i.mode&&i.mode!==n&&(r=!0),i&&i.timestamp&&Date.now()-i.timestamp<12e4&&!r)return void s.log("Up to date");if(i&&i.finished&&i.timestamp&&Date.now()-i.timestamp<6048e5&&!r)return void s.log("Finished");if(i&&!i.value&&i.timestamp&&Date.now()-i.timestamp<864e5&&!r)return void s.log("Nulled");r&&s.log("Update forced"),"off"===n&&(s.log("Disabled"),e.xhr=[]),void 0!==e.xhr?a=e.xhr:(a=await d(t,e.apiCacheKey),await p.wait(500)),s.log(a);const o=function(e,t,n){const s={};if(!e.length)return null;let i;if("default"===t?(s.mainId="anime"===n?h.settings.get("progressIntervalDefaultAnime"):h.settings.get("progressIntervalDefaultManga"),s.fallback="en/sub"):s.mainId=t,s.fallbackPrediction="jp/dub",s.mainId){const t=e.find((e=>e.id===s.mainId));t&&(i=t)}if(s.fallback&&!i){const t=e.find((e=>e.id===s.fallback));t&&(i=t)}if(s.fallbackPrediction&&i&&!i.predicition&&i.lastEp&&i.lastEp.timestamp){const t=e.find((e=>e.id===s.fallbackPrediction)),n=i.lastEp.timestamp+6048e5;n&&t&&t.predicition&&(i.lastEp.total===t.lastEp.total?Math.abs(n-t.predicition.timestamp)<108e6&&(i.predicition={timestamp:n,probability:"medium"}):t.lastEp.total&&i.lastEp.total===t.lastEp.total-1&&Math.abs(n-(t.predicition.timestamp-6048e5))<108e6&&(i.predicition={timestamp:n,probability:"medium"}))}if(s.fallbackPrediction&&!i){const t=e.find((e=>e.id===s.fallbackPrediction));t&&t.lastEp&&t.predicition&&0===t.lastEp.total&&(i=t,i.predicition.probability="medium")}return i||null}(a,n,t);o||s.log("No value for the selected mode");let l=!1;o&&o.state&&"complete"===o.state&&(l=!0),s.m("Save").log(o),i&&i.value&&async function(e,t,n,s){try{if("anime"===s&&!h.settings.get("progressNotificationsAnime")||"manga"===s&&!h.settings.get("progressNotificationsManga"))return;if(e&&n&&n&&t.lastEp&&void 0!==t.lastEp.total&&n.lastEp&&n.lastEp.total&&t.lang===n.lang&&t.type===n.type&&t.lastEp.total<n.lastEp.total&&e.watchedEp+1===n.lastEp.total){let t;t=e.single?{title:e.title,text:h.storage.lang(`syncPage_malObj_nextEp_${s}`,[n.lastEp.total]),sticky:h.settings.get("notificationsSticky"),image:await e.single.getImage(),url:e.single.getStreamingUrl()?e.single.getStreamingUrl():e.single.getUrl()}:{title:e.title,text:h.storage.lang(`syncPage_malObj_nextEp_${s}`,[n.lastEp.total]),sticky:h.settings.get("notificationsSticky"),image:e.image,url:e.options&&e.options.u?e.options.u:e.url},h.request.notification(t)}}catch(e){m.error("Could not check notification Progress",e)}}(e,i.value,o,t),await h.storage.set(`release/${t}/${e.cacheKey}`,{timestamp:Date.now(),value:o,mode:n,finished:l})}(e,this.type,e.progressMode);const t=await S.storage.get(`release/${this.type}/${this.cacheKey}`);this.logger.m("Init Release").log(t),t&&(function(e){if(e&&e.timestamp){const t=(new Date).getTime()-e.timestamp;if(e.finished&&t<6048e5)return!1;if(!e.value&&t<864e5)return!1;if(t<864e5)return!1}return!0}(t)?this.logger.log("Too old"):this.releaseItem=t)}getProgressCurrentEpisode(){const e=this.releaseItem;return e&&e.value&&e.value.lastEp&&e.value.lastEp.total?e.value.lastEp.total:null}isProgressFinished(){const e=this.releaseItem;return!(!e||!e.finished)}getProgressPrediction(){const e=this.releaseItem;return e&&e.value&&e.value.predicition&&e.value.predicition.timestamp?e.value.predicition.timestamp:null}getProgressLastTimestamp(){const e=this.releaseItem;return e&&e.value&&e.value.lastEp&&e.value.lastEp.timestamp?e.value.lastEp.timestamp:null}async init(e=!1){return await Promise.all([this.initReleaseProgress(e)]),this}getCurrentEpisode(){return S.settings.get("epPredictions")?this.getProgressCurrentEpisode():null}isFinished(){return this.isProgressFinished()}isAiring(){return!this.isFinished()}getPredictionTimestamp(){return!this.getProgressPrediction()||(new Date).getTime()>this.getProgressPrediction()?NaN:this.getProgressPrediction()}getPrediction(){const e=Number(this.getPredictionTimestamp());return Number.isNaN(e)?"":new v(e).getRelativeNowFriendlyText("Progress",{style:"significantLongNarrow"})}getPredictionText(){const e=Number(this.getPredictionTimestamp());if(Number.isNaN(e))return"";const t=new v(Number(e)),n=t.getRelativeNowText("Progress",{style:"long"});return t.isValidDate()?t.isNow()?S.storage.lang("bookmarksItem_now"):S.storage.lang(`prediction_Episode_${this.type}`,[n]):""}getLastTimestamp(){return this.getProgressLastTimestamp()?this.getProgressLastTimestamp():NaN}getLast(){const e=Number(this.getLastTimestamp());return Number.isNaN(e)?"":new v(e).getRelativeNowFriendlyText("Progress",{style:"significantLongNarrow"})}getLastText(){const e=Number(this.getLastTimestamp());if(Number.isNaN(e))return"";const t=new v(Number(e)),n=t.getRelativeNowText("Progress",{style:"long"});return t.isValidDate()?t.isNow()?S.storage.lang("bookmarksItem_now"):S.storage.lang(`prediction_Last_${this.type}`,[n]):""}getAuto(){const e=this.getPrediction();if(e)return e;return this.getLast()||""}getAutoText(){const e=this.getPredictionText();if(e)return e;return this.getLastText()||""}getColor(){return"#f57c00"}getBars(e,t){const n=this.getCurrentEpisode(),s={totalWidth:100,epWidth:0,predWidth:0};if(!t)if(s.totalWidth=0,e&&(!n||e>=n))t=Math.ceil(1.2*e);else{if(!n||e&&!(e<n))return s;t=Math.ceil(1.2*n)}return e&&(s.epWidth=e/t*100,s.epWidth>100&&(s.epWidth=100)),n&&(s.predWidth=n/t*100,s.predWidth>100&&(s.predWidth=100)),s}}var k=n(53011),I=n(78584),x=n(13647);const T=Math.floor(1e9*Math.random()),N=new k.EventEmitter2({wildcard:!0});function O(e,...t){I.m("Global").m("Emit").debug(e,...t),N.emit(`${e}`,...t),void 0!==x&&x&&"webextension"===x.type&&chrome.runtime.sendMessage({name:"emitter",item:{event:e,params:t,id:T}})}void 0!==x&&x&&"webextension"===x.type&&(chrome.runtime.sendMessage({name:"registerEmitter"}),chrome.runtime.onMessage.addListener(((e,t,n)=>{e.name&&"emitter"===e.name&&(I.m("Global").m("Event").debug(e.item.id,e.item.event,e.item.params),e.item.id!==T&&N.emit(e.item.event,...e.item.params))}))),Error;class C extends Error{constructor(e){super(e),this.name="SafeError"}}Error,Error;var L=n(26017),A=n(13647);class P extends Error{constructor(e){super(e),this.name="NotAutenticatedError"}}class R extends Error{constructor(e){super(e),this.name="UrlNotSupportedError"}}class M extends Error{constructor(e){super(e),this.name="ServerOfflineError"}}class D extends Error{constructor(e){super(e),this.name="NotFoundError"}}class U extends Error{constructor(e){super(e),this.name="UnexpectedResponseError"}}function j(e){try{return JSON.parse(e)}catch(e){throw new U(e.message)}}var F=n(13647);const V={ui:{module:"dropdown"},getOptions:()=>[{value:0,label:F.storage.lang("UI_Score_Not_Rated")},{value:100,label:F.storage.lang("UI_Score_Masterpiece")},{value:90,label:F.storage.lang("UI_Score_Great")},{value:80,label:F.storage.lang("UI_Score_VeryGood")},{value:70,label:F.storage.lang("UI_Score_Good")},{value:60,label:F.storage.lang("UI_Score_Fine")},{value:50,label:F.storage.lang("UI_Score_Average")},{value:40,label:F.storage.lang("UI_Score_Bad")},{value:30,label:F.storage.lang("UI_Score_VeryBad")},{value:20,label:F.storage.lang("UI_Score_Horrible")},{value:10,label:F.storage.lang("UI_Score_Appalling")}],valueToOptionValue:e=>e?e<10?10:10*Math.round(e/10):0,optionValueToValue:e=>e?Number(e):0};var z=n(78584),H=n(13647),B=n(26017),W=n(7263);Object.seal(N);class G{constructor(e){return this.url=e,this.type=null,this.syncMethod="normal",this.askCompleted=!1,this.rewatchingSupport=!0,this.datesSupport=!0,this.ids={mal:NaN,ani:NaN,kitsu:{id:NaN,slug:""},simkl:NaN},this.options=null,this.progress=!1,this.updateProgress=!1,this._onList=!1,this._authenticated=!1,this.handleUrl(e),this.logger=z.m("[S]","#348fff"),this}getType(){return this.type}getUrl(){return this.url}supportsRewatching(){return this.rewatchingSupport}supportsDates(){return this.datesSupport}getApiCacheKey(){return this.getKey(["ANILIST"])}getRulesCacheKey(){return this.getKey(["ANILIST","KITSU"],!1)}setStatus(e){return e=Number(e),this._setStatus(e),this}getStatus(){return this.isOnList()?this._getStatus():r.NoState}setStartDate(e){return this.supportsDates()&&this._setStartDate(e),this}getStartDate(){return this.supportsDates()?this._getStartDate():null}setFinishDate(e){return this.supportsDates()&&this._setFinishDate(e),this}getFinishDate(){return this.supportsDates()?this._getFinishDate():null}setRewatchCount(e){return this.supportsRewatching()&&this._setRewatchCount(e),this}getRewatchCount(){return this.supportsRewatching()?this._getRewatchCount():null}getScoreMode(){return V}setScore(e){return(e=parseInt(`${e}`))||(e=0),this._setScore(e),this}getScore(){return this._getScore()||0}setAbsoluteScore(e){return e=parseInt(`${e}`),this._setAbsoluteScore(e),this}getAbsoluteScore(){return this._getAbsoluteScore()||0}setEpisode(e){return e=parseInt(`${e}`),this.getTotalEpisodes()&&e>this.getTotalEpisodes()&&(e=this.getTotalEpisodes()),this._setEpisode(e),this}getEpisode(){return this._getEpisode()}setVolume(e){return this._setVolume(e),this}getVolume(){return this._getVolume()}setStreamingUrl(e){return this.options&&(this.options.u=e),this}getStreamingUrl(){if(this.options&&this.options.u)return this.options.u}cleanTags(){this.options=null}async initProgress(){const e=await d(this.getType(),this.getApiCacheKey());return new E(this.getCacheKey(),this.getType()).init({uid:this.getCacheKey(),apiCacheKey:this.getApiCacheKey(),title:this.getTitle(),cacheKey:this.getCacheKey(),progressMode:this.getProgressMode(),watchedEp:this.getEpisode(),single:this,xhr:e}).then((t=>{this.updateProgress=!1,this.progress=t,this.progressXhr=e}))}getProgress(){return!!this.progress&&this.progress}getProgressFormated(){const e=[],t=new Intl.DisplayNames("en",{type:"language"});return z.log(this.progressXhr),this.progressXhr&&Object.keys(this.progressXhr).length&&this.progressXhr.forEach((n=>{e.push({type:n.type,key:n.id,state:n.state,label:t.of(n.lang.replace(/^jp$/,"ja"))||n.lang,dropped:"dropped"===n.state||"discontinued"===n.state,episode:n.lastEp&&n.lastEp.total?n.lastEp.total:0,lastEp:n.lastEp,predicition:n.prediction})})),e}getProgressOptions(){return this.getProgressFormated().filter((e=>"complete"!==e.state))}getProgressCompleted(){return this.getProgressFormated().filter((e=>"complete"===e.state))}getProgressMode(){return this.options&&this.options.p?this.options.p:""}setProgressMode(e){this.options&&(this.options.p=e,this.updateProgress=!0),H.settings.get("malTags")||B.setEntrySettings(this.type,this.getCacheKey(),this.options,this._getTags()).then((()=>this.initProgress()))}getProgressKey(){let e=this.getProgressMode();if(e||(e="anime"===this.getType()?H.settings.get("progressIntervalDefaultAnime"):H.settings.get("progressIntervalDefaultManga")),!e)return null;const t=/^([^/]*)\/(.*)$/.exec(e);return t?{key:e,lang:t[1],type:t[2]}:null}getPageRelations(){const e=this.shortName,t=[];return this.ids.mal&&"MAL"!==e&&t.push({name:"MAL",icon:"https://cdn.myanimelist.net/images/favicon.ico",link:`https://myanimelist.net/${this.type}/${this.ids.mal}`}),this.ids.ani&&"AniList"!==e&&t.push({name:"AniList",icon:"https://anilist.co/img/icons/favicon-32x32.png",link:`https://anilist.co/${this.type}/${this.ids.ani}`}),this.ids.kitsu.id&&"Kitsu"!==e&&t.push({name:"Kitsu",icon:"https://kitsu.app/favicon-32x32-3e0ecb6fc5a6ae681e65dcbc2bdf1f17.png",link:`https://kitsu.app/${this.type}/${this.ids.kitsu.id}`}),this.ids.simkl&&"Simkl"!==e&&t.push({name:"Simkl",icon:"https://eu.simkl.in/img_favicon/v2/favicon-32x32.png",link:`https://simkl.com/${this.type}/${this.ids.simkl}`}),t}fillRelations(){return Promise.resolve()}update(){return this.logger.log("[SINGLE]","Update info",this.ids),this.lastError=null,this._update().catch((e=>{throw this.lastError=e,e})).then((()=>(this.persistanceState=this.getStateEl(),B.getEntrySettings(this.type,this.getCacheKey(),this._getTags())))).then((e=>{this.options=e,this.registerEvent(),this.emitUpdate("state")}))}async sync(){return this.logger.log("[SINGLE]","Sync",this.ids),this.lastError=null,this._setTags(await B.setEntrySettings(this.type,this.getCacheKey(),this.options,this._getTags())),this.fixDates(),this._sync().catch((e=>{throw this.lastError=e,e})).then((()=>{this.undoState=this.persistanceState,this.updateProgress&&this.initProgress(),this._onList=!0,this.emitUpdate()}))}emitUpdate(e="update"){O(`${e}.${this.getCacheKey()}`,{id:this.getPageId(),type:this.getType(),cacheKey:this.getCacheKey(),state:this.getStateEl(),meta:{title:this.getTitle(),image:this.getImage(),malId:this.getMalId(),totalEp:this.getTotalEpisodes(),url:this.getUrl()}})}async delete(){return this._delete().then((()=>{this._onList=!1,O(`delete.${this.getCacheKey()}`,{id:this.getPageId(),type:this.getType(),cacheKey:this.getCacheKey()})}))}registerEvent(){this.globalUpdateEvent||(this.globalUpdateEvent=N.on(`update.${this.getCacheKey()}`,(e=>this.updateEvent(e))))}updateEvent(e){this.isDirty()?this.logger.log("Ignore event"):e&&e.state&&(this.setStateEl(e.state),this.persistanceState=this.getStateEl(),N.emit("syncPage_fillUi"))}isDirty(){return JSON.stringify(this.persistanceState)!==JSON.stringify(this.getStateEl())||this.updateProgress}undo(){if(this.logger.log("[SINGLE]","Undo",this.undoState),!this.undoState)throw new C("No undo state found");if(!this.undoState.onList){if(void 0===this.delete)throw new Error("Deleting an entry is not supported");return this.delete().then((()=>{this.setStateEl(this.undoState),this.undoState=null}))}return this.setStateEl(this.undoState),this.sync().then((()=>{this.undoState=null}))}getTitle(e=!1){return this._getTitle(e)}getTotalEpisodes(){let e=this._getTotalEpisodes();return e||(e=0),e}getTotalVolumes(){return this._getTotalVolumes()}isOnList(){return this._onList}isAuthenticated(){return this._authenticated}getDisplayUrl(){return this._getDisplayUrl()}getMalUrl(){return Number.isNaN(this.ids.mal)?null:`https://myanimelist.net/${this.getType()}/${this.ids.mal}`}getMalId(){return Number.isNaN(this.ids.mal)?null:this.ids.mal}getIds(){return this.ids}getImage(){return this._getImage()}getRating(){return this._getRating().then((e=>e||"N/A"))}setResumeWatching(e,t){return B.setResumeWaching(e,t,this.type,this.getCacheKey())}getResumeWatching(){return this.options&&this.options.r?this.options.r:null}setContinueWatching(e,t){return B.setContinueWaching(e,t,this.type,this.getCacheKey())}getContinueWatching(){return this.options&&this.options.c?this.options.c:null}increaseRewatchCount(){}getStateEl(){return{onList:this.isOnList(),episode:this.getEpisode(),volume:this.getVolume(),status:this.getStatus(),startDate:this.getStartDate(),finishDate:this.getFinishDate(),rewatchCount:this.getRewatchCount(),score:this.getScore(),absoluteScore:this.getAbsoluteScore()}}setStateEl(e){this._onList=e.onList,this.setEpisode(e.episode),this.setVolume(e.volume),this.setStatus(e.status),this.setStartDate(e.startDate),this.setFinishDate(e.finishDate),this.setRewatchCount(e.rewatchCount),this.setScore(e.score),e.absoluteScore&&this.setAbsoluteScore(e.absoluteScore)}getStateDiff(){const e=this.getStateEl();if(e&&this.undoState){const t={};for(const n in e)e[n]!==this.undoState[n]&&(t[n]=e[n]);return t}}getSyncMethod(){return this.syncMethod}setSyncMethod(e){this.syncMethod=e}fixDates(){if(!this.supportsDates()||"listSync"===this.getSyncMethod())return;const e=(0,L.returnYYYYMMDD)();null===this.getStartDate()&&this._getStatus()===r.Watching&&this._getEpisode()>0&&this.setStartDate(e),null===this.getFinishDate()&&this._getStatus()===r.Completed&&(this.setFinishDate(e),null===this.getStartDate()&&this.setStartDate(e))}async lifeCycleHook(e){this.askCompleted&&("afterCheckSync"===e&&H.settings.get("askBefore")||"beforeSync"===e&&!H.settings.get("askBefore"))&&(this.askCompleted=!1,this.getStatus()===r.Rewatching?await this.finishRewatchingMessage():await this.finishWatchingMessage())}async checkSync(e,t){const n=this.getEpisode(),s=this.getStatus(),i=this.getVolume();return s===r.Completed?1===e&&this.startRewatchingMessage():!(n>=e&&!(void 0!==t&&(i||t>1||!e)&&t>i))&&(e&&e===this.getTotalEpisodes()?(this.askCompleted=!0,!0):s===r.Watching||s===r.Rewatching||this.startWatchingMessage())}async startWatchingMessage(){return B.flashConfirm(H.storage.lang(`syncPage_flashConfirm_start_${this.getType()}`),"add").then((e=>(e&&(this.setStatus(r.Watching),this.setStartDate((0,L.returnYYYYMMDD)())),e)))}async finishWatchingMessage(){const e=this.getScoreCheckboxValue();let t='<div><select id="finish_score" style="margin-top:5px; color:white; background-color:#4e4e4e; border: none;">';return this.getScoreCheckbox().forEach((n=>{t+=`<option value="${n.value}" ${e===n.value?"selected":""}>${n.label}</option>`})),t+="</select></div>",B.flashConfirm(H.storage.lang("syncPage_flashConfirm_complete")+t,"complete").then((e=>(e&&(this.setStatus(r.Completed),this.setFinishDate((0,L.returnYYYYMMDD)()),this.getStartDate()||this.setStartDate((0,L.returnYYYYMMDD)()),Number(W.$("#finish_score").val())>0&&(this.logger.log(`finish_score: ${W.$("#finish_score :selected").val()}`),this.handleScoreCheckbox(W.$("#finish_score :selected").val()))),e)))}async startRewatchingMessage(){return B.flashConfirm(H.storage.lang(`syncPage_flashConfirm_rewatch_start_${this.getType()}`),"add").then((e=>(e&&this.setStatus(r.Rewatching),e)))}async finishRewatchingMessage(){return B.flashConfirm(H.storage.lang(`syncPage_flashConfirm_rewatch_finish_${this.getType()}`),"complete").then((e=>(e&&(this.setStatus(r.Completed),this.increaseRewatchCount()),e)))}getScoreCheckbox(){return this.getScoreMode().getOptions()}getScoreCheckboxValue(){return this.getScoreMode().valueToOptionValue(this.getAbsoluteScore())}handleScoreCheckbox(e){this.setAbsoluteScore(this.getScoreMode().optionValueToValue(e))}getDisplayScoreCheckbox(){const e=this.getScoreCheckboxValue(),t=this.getScoreCheckbox().filter((t=>t.value===e));return t.length?t[0].label:""}getStatusCheckbox(){const e=[{value:r.Watching.toString(),label:H.storage.lang(`UI_Status_watching_${this.getType()}`)},{value:r.Completed.toString(),label:H.storage.lang("UI_Status_Completed")},{value:r.Onhold.toString(),label:H.storage.lang("UI_Status_OnHold")},{value:r.Dropped.toString(),label:H.storage.lang("UI_Status_Dropped")},{value:r.PlanToWatch.toString(),label:H.storage.lang(`UI_Status_planTo_${this.getType()}`)}];return this.supportsRewatching()&&e.push({value:r.Rewatching.toString(),label:H.storage.lang(`UI_Status_Rewatching_${this.getType()}`)}),e}handleStatusCheckbox(e){this.setStatus(e)}getStatusCheckboxValue(){return this.getStatus()}getKey(e,t=!0){return t&&this.ids.mal?this.ids.mal:this.ids.ani&&e.includes("ANILIST")?`anilist:${this.ids.ani}`:this.ids.kitsu.id&&e.includes("KITSU")?`kitsu:${this.ids.kitsu.id}`:this.ids.simkl&&e.includes("SIMKL")?`simkl:${this.ids.simkl}`:this.ids.mal}getLastError(){return this.lastError}getLastErrorMessage(){return this.errorMessage(this.getLastError())}flashmError(e){B.flashm(this.errorMessage(e),{error:!0,type:"error"})}errorMessage(e){return function(e,t){return e instanceof P?A.storage.lang("Error_Authenticate",[t]):e instanceof M?"Server Offline":e instanceof R?`Incorrect url provided [${e.message}]`:e instanceof D?"Could not find this entry":e.message}(e,this.authenticationUrl)}}n(7263),n(26017),n(13647);var K,q,X=n(13647);async function Y(e){let t="https://api.myanimelist.net/v2/"+e.path;e.fields&&e.fields.length&&(t+=t.includes("?")?"&":"?",t+=`fields=${e.fields.join(",")}`);const n={Authorization:`Bearer ${X.settings.get("malToken")}`,"Content-Type":"application/x-www-form-urlencoded"};let s="";if(e.dataObj){const t=[];for(const n in e.dataObj){const s=encodeURIComponent(n),i=encodeURIComponent(e.dataObj[n]);t.push(`${s}=${i}`)}s=t.join("&")}return X.request.xhr(e.type,{url:t,headers:n,data:s}).then((async t=>{if(t.status>499&&t.status<600||0===t.status)throw new M(`Server Offline status: ${t.status}`);let n;try{n=JSON.parse(t.responseText)}catch(e){if(J(t.responseText))throw new Error(X.storage.lang("Error_Blocked",["MyAnimeList"]));throw e}if(n&&n.error)switch(n.error){case"forbidden":case"invalid_token":if(await async function(e){const t=e.m("Refresh");t.log("Refresh Access Token");const n=X.settings.get("malRefresh");return!!n&&X.request.xhr("POST",{url:"https://myanimelist.net/v1/oauth2/token",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:`client_id=10093a3f9f0174b6b5577c40e9accdae&grant_type=refresh_token&refresh_token=${n}`}).then((e=>{try{return j(e.responseText)}catch(t){if(J(e.responseText))throw new Error(X.storage.lang("Error_Blocked",["MyAnimeList"]));throw t}})).then((e=>e&&e.refresh_token&&e.access_token?(X.settings.set("malToken",e.access_token),X.settings.set("malRefresh",e.refresh_token),!0):e&&e.error?(t.error(e.error,"|",e.message),X.settings.set("malRefresh",""),!1):(t.error("Something went wrong"),!1)))}(this.logger))return this.apiCall(e);throw new P(n.message??n.error);case"not_found":throw new D(n.message??n.error);case"invalid_content":throw new Error("This Entry is currently pending approval. It can´t be saved to mal for now");default:throw new Error(n.message??n.error)}if(400===t.status)throw new Error("Invalid Parameters");return n}))}function J(e){return Boolean(e.includes("Request blocked")||e.includes("your IP has been banned"))}function Z(e){if(!e||!/^\d{4}(?:-\d\d){0,2}$/.test(e))return null;const t=e.substring(0,4);let n=e.substring(5,7);2!==n.length&&(n="01");let s=e.substring(8,10);return 2!==s.length&&(s="01"),`${t}-${n}-${s}`}!function(e){e[e.watching=r.Watching]="watching",e[e.completed=r.Completed]="completed",e[e.on_hold=r.Onhold]="on_hold",e[e.dropped=r.Dropped]="dropped",e[e.plan_to_watch=r.PlanToWatch]="plan_to_watch"}(K||(K={})),function(e){e[e.reading=r.Watching]="reading",e[e.completed=r.Completed]="completed",e[e.on_hold=r.Onhold]="on_hold",e[e.dropped=r.Dropped]="dropped",e[e.plan_to_read=r.PlanToWatch]="plan_to_read"}(q||(q={}));var Q=n(78584),ee=n(13647);const te=Q.m("anilist","#3db4f2");var ne;function se(e){return e?.year&&e?.month&&e?.day?`${String(e.year).padStart(4,"0")}-${String(e.month).padStart(2,"0")}-${String(e.day).padStart(2,"0")}`:null}function ie(e){const t={year:null,month:null,day:null},n=e?.match(/^(\d{4})-(\d{2})-(\d{2})$/);return n?.[1]&&n?.[2]&&n?.[3]&&(t.year=parseInt(n[1]),t.month=parseInt(n[2]),t.day=parseInt(n[3])),t}async function ae(e,t,n=!0){if(n&&!ee.settings.get("anilistToken"))throw new P("No token found");const s={"Content-Type":"application/json",Accept:"application/json"};return ee.settings.get("anilistToken")&&(s.Authorization=`Bearer ${ee.settings.get("anilistToken")}`),ee.request.xhr("POST",{url:"https://graphql.anilist.co",headers:s,data:JSON.stringify({query:e,variables:t})}).then((s=>{try{const i=j(s.responseText);if(void 0!==i.errors&&i.errors.length){te.error("[SINGLE]","Error",i.errors);const s=i.errors[0];switch(s.status){case 400:if("Invalid token"===s.message&&!n)return ee.settings.set("anilistToken",null),ae(e,t,n);if("validation"===s.message)throw new Error("Wrong request format");if(s.message.includes("invalid"))throw new Error("Wrong request format");throw new P(s.message);case 404:throw new D(s.message);default:throw new Error(s.message)}}return i}catch(e){if(e instanceof U){if(s.status>499&&s.status<600||0===s.status)throw new M(`Server Offline status: ${s.status}`);if(403===s.status)throw new Error(ee.storage.lang("Error_Blocked",["AniList"]))}throw e}}))}function re(e){return!e||e.endsWith("/default.jpg")?"":e}!function(e){e[e.CURRENT=r.Watching]="CURRENT",e[e.PLANNING=r.PlanToWatch]="PLANNING",e[e.COMPLETED=r.Completed]="COMPLETED",e[e.DROPPED=r.Dropped]="DROPPED",e[e.PAUSED=r.Onhold]="PAUSED",e[e.REPEATING=r.Rewatching]="REPEATING"}(ne||(ne={}));var oe=n(78584),le=n(26017);class ce extends G{constructor(e){return super(e),this.url=e,this.displayUrl="",this.pending=!1,this.shortName="MAL",this.authenticationUrl="https://malsync.moe/mal/oauth",this.apiCall=Y,this.logger=oe.m(this.shortName,"#2e51a2"),this}handleUrl(e){if(e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))return this.type="anime"===le.urlPart(e,3)?"anime":"manga",void(this.ids.mal=Number(le.urlPart(e,4)));throw new R(e)}getCacheKey(){return this.ids.mal}getPageId(){return this.ids.mal}_getStatus(){let e;return e="manga"===this.type?parseInt(q[this.animeInfo.my_list_status.status]):parseInt(K[this.animeInfo.my_list_status.status]),this.getRewatching()&&e===r.Completed?r.Rewatching:e}_setStatus(e){e===r.Rewatching?(e=r.Completed,this.setRewatching(!0)):this.setRewatching(!1),"manga"!==this.type?this.animeInfo.my_list_status.status=K[e]:this.animeInfo.my_list_status.status=q[e]}increaseRewatchCount(){"manga"===this.type?this.animeInfo.my_list_status.num_times_reread++:this.animeInfo.my_list_status.num_times_rewatched++}_getStartDate(){return Z(this.animeInfo.my_list_status.start_date)}_setStartDate(e){this.animeInfo.my_list_status.start_date=e}_getFinishDate(){return Z(this.animeInfo.my_list_status.finish_date)}_setFinishDate(e){this.animeInfo.my_list_status.finish_date=e}_getRewatchCount(){return"manga"===this.type?this.animeInfo.my_list_status.num_times_reread:this.animeInfo.my_list_status.num_times_rewatched}_setRewatchCount(e){"manga"===this.type?this.animeInfo.my_list_status.num_times_reread=e:this.animeInfo.my_list_status.num_times_rewatched=e}_getScore(){return this.animeInfo.my_list_status.score}_setScore(e){this.animeInfo.my_list_status.score=e}_getAbsoluteScore(){return 10*this.getScore()}_setAbsoluteScore(e){e?e<10?this.setScore(1):this.setScore(Math.round(e/10)):this.setScore(0)}_getEpisode(){return"manga"===this.type?this.animeInfo.my_list_status.num_chapters_read:this.animeInfo.my_list_status.num_watched_episodes}_setEpisode(e){e||(e=0),"manga"!==this.type?this.animeInfo.my_list_status.num_watched_episodes=e:this.animeInfo.my_list_status.num_chapters_read=e}_getVolume(){return"manga"===this.type?this.animeInfo.my_list_status.num_volumes_read:0}_setVolume(e){"manga"===this.type&&(this.animeInfo.my_list_status.num_volumes_read=e)}_getTags(){return this.animeInfo.my_list_status.tags.length?this.animeInfo.my_list_status.tags.join(","):""}_setTags(e){e&&","!==e.trim()?this.animeInfo.my_list_status.tags=e.split(","):this.animeInfo.my_list_status.tags=[]}getRewatching(){return"manga"===this.type?this.animeInfo.my_list_status.is_rereading:this.animeInfo.my_list_status.is_rewatching}setRewatching(e){"manga"!==this.type?this.animeInfo.my_list_status.is_rewatching=e:this.animeInfo.my_list_status.is_rereading=e}_getTitle(){return this.animeInfo.title}_getTotalEpisodes(){return"manga"===this.type?this.animeInfo.num_chapters:this.animeInfo.num_episodes}_getTotalVolumes(){return"manga"===this.type?this.animeInfo.num_volumes:0}_getDisplayUrl(){return this.url}_getImage(){return this.animeInfo.main_picture?.medium??""}_getRating(){return Promise.resolve(this.animeInfo.mean)}async _update(){return this.apiCall({type:"GET",path:`${this.type}/${this.ids.mal}`,fields:["my_list_status{tags,is_rewatching,is_rereading,num_times_rewatched,num_times_reread,start_date,finish_date}","num_episodes","mean","num_chapters","num_volumes"]}).catch((e=>{throw e instanceof P&&(this._authenticated=!1),e})).then((e=>{this.logger.m("Api").log(e),this._authenticated=!0,this.animeInfo=e,this._onList=!0,this.animeInfo.my_list_status||(this._onList=!1,"manga"===this.type?this.animeInfo.my_list_status={is_rereading:!1,num_chapters_read:0,num_volumes_read:0,num_times_reread:0,score:0,status:"plan_to_read",tags:[]}:this.animeInfo.my_list_status={is_rewatching:!1,num_watched_episodes:0,num_times_rewatched:0,score:0,status:"plan_to_watch",tags:[]}),this.animeInfo.my_list_status&&void 0!==this.animeInfo.my_list_status.num_episodes_watched&&(this.animeInfo.my_list_status.num_watched_episodes=this.animeInfo.my_list_status.num_episodes_watched,delete this.animeInfo.my_list_status.num_episodes_watched)}))}async _sync(){const e={};for(const t in this.animeInfo.my_list_status)switch(t){case"priority":case"num_watched_episodes":case"num_volumes_read":case"num_chapters_read":case"score":case"is_rewatching":case"is_rereading":case"num_times_rewatched":case"num_times_reread":case"rewatch_value":case"reread_value":case"tags":case"comments":case"status":e[t]=this.animeInfo.my_list_status[t];break;case"start_date":case"finish_date":e[t]=this.animeInfo.my_list_status[t]??""}return this.logger.m("Sync").log(this.ids.mal,e),this.apiCall({type:"PUT",path:`${this.type}/${this.ids.mal}/my_list_status`,dataObj:e}).then((e=>{this.logger.m("Sync").log("res",e)}))}_delete(){return this.apiCall({type:"DELETE",path:`${this.type}/${this.ids.mal}/my_list_status`})}async fillRelations(){const e=new u(`fillRelations/${this.ids.mal}/${this.getType()}`,6048e5);return e.hasValueAndIsNotEmpty().then((t=>t?e.getValue().then((e=>{e&&e.da&&parseInt(e.da)&&(this.ids.ani=parseInt(e.da))})):function(e,t){const n={id:e,type:t.toUpperCase()};return ee.request.xhr("POST",{url:"https://graphql.anilist.co",headers:{"Content-Type":"application/json",Accept:"application/json"},data:JSON.stringify({query:"\n  query ($id: Int, $type: MediaType) {\n    Media (idMal: $id, type: $type) {\n      id\n      idMal\n    }\n  }\n  ",variables:n})}).then((e=>{if(404===e.status)return NaN;const t=j(e.responseText);return Q.log(t),t.data.Media.id}))}(this.ids.mal,this.getType()).then((t=>(t&&parseInt(t)&&(this.ids.ani=parseInt(t)),e.setValue({da:t}))))))}}const ue=ce;var he=n(13647);const pe={ui:{module:"input",pattern:"^([0-9]{1,2}|100)$"},getOptions(){const e=[{value:0,label:he.storage.lang("UI_Score_Not_Rated")}];for(let t=1;t<101;t++)e.push({value:t,label:String(t)});return e},valueToOptionValue:e=>e?Number(e):0,optionValueToValue:e=>e?Number(e):0};var me=n(13647);const de={ui:{module:"click",type:"smiley"},getOptions:()=>[{value:0,label:me.storage.lang("UI_Score_Not_Rated")},{value:85,label:"🙂"},{value:60,label:"😐"},{value:35,label:"🙁"}],valueToOptionValue:e=>e?e>=73?85:e<=47?35:60:0,optionValueToValue:e=>e?Number(e):0};var ge=n(13647);const fe={ui:{module:"click",type:"star"},getOptions:()=>[{value:0,label:ge.storage.lang("UI_Score_Not_Rated")},{value:90,label:"★★★★★"},{value:70,label:"★★★★"},{value:50,label:"★★★"},{value:30,label:"★★"},{value:10,label:"★"}],valueToOptionValue:e=>e?e<20?10:e<40?30:e<60?50:e<80?70:90:0,optionValueToValue:e=>e?Number(e):0};var ye=n(13647);const ve={ui:{module:"input",pattern:"^([0-9](\\.[0-9]?)?|10(.0)?)$"},getOptions(){const e=[{value:0,label:ye.storage.lang("UI_Score_Not_Rated")}];for(let t=1;t<101;t++)e.push({value:t/10,label:(t/10).toFixed(1)});return e},valueToOptionValue:e=>e?Number(e/10):0,optionValueToValue:e=>e?Number(10*e):0};var be=n(78584),_e=n(26017),we=n(13647);class Se extends G{constructor(e){return super(e),this.url=e,this.displayUrl="",this.shortName="AniList",this.authenticationUrl="https://anilist.co/api/v2/oauth/authorize?client_id=1487&response_type=token",this.logger=be.m(this.shortName,"#3db4f2"),this}handleUrl(e){if(e.match(/anilist\.co\/(anime|manga)\/\d*/i))return this.type="anime"===_e.urlPart(e,3)?"anime":"manga",void(this.ids.ani=Number(_e.urlPart(e,4)));if(e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))return this.type="anime"===_e.urlPart(e,3)?"anime":"manga",void(this.ids.mal=Number(_e.urlPart(e,4)));throw new R(e)}getCacheKey(){return this.getKey(["ANILIST"])}getPageId(){return this.ids.ani}_getStatus(){return parseInt(ne[this.animeInfo.mediaListEntry.status])}_setStatus(e){this.animeInfo.mediaListEntry.status=ne[e]}_getStartDate(){return se(this.animeInfo.mediaListEntry.startedAt)}_setStartDate(e){this.animeInfo.mediaListEntry.startedAt=ie(e)}_getFinishDate(){return se(this.animeInfo.mediaListEntry.completedAt)}_setFinishDate(e){this.animeInfo.mediaListEntry.completedAt=ie(e)}_getRewatchCount(){return this.animeInfo.mediaListEntry.repeat}_setRewatchCount(e){this.animeInfo.mediaListEntry.repeat=e}_getScore(){if(0===Number(this.animeInfo.mediaListEntry.score))return 0;const e=Math.round(Number(this.animeInfo.mediaListEntry.score)/10);return 0===e?1:e}_setScore(e){this.animeInfo.mediaListEntry.score=10*e}_getAbsoluteScore(){return Number(this.animeInfo.mediaListEntry.score)}_setAbsoluteScore(e){this.animeInfo.mediaListEntry.score=Number(e)}_getEpisode(){return this.animeInfo.mediaListEntry.progress}_setEpisode(e){this.animeInfo.mediaListEntry.progress=parseInt(`${e}`)}_getVolume(){return this.animeInfo.mediaListEntry.progressVolumes}_setVolume(e){this.animeInfo.mediaListEntry.progressVolumes=e}_getTags(){let e=this.animeInfo.mediaListEntry.notes;return null!==e&&"null"!==e||(e=""),e}_setTags(e){this.animeInfo.mediaListEntry.notes=e}_getTitle(){return this.animeInfo.title.userPreferred}_getTotalEpisodes(){const e=this.animeInfo.episodes?this.animeInfo.episodes:this.animeInfo.chapters;return null===e?0:e}_getTotalVolumes(){return this.animeInfo.volumes||0}_getDisplayUrl(){return""!==this.displayUrl&&null!==this.displayUrl?this.displayUrl:this.url}_getImage(){return re(this.animeInfo.coverImage.large)}_getRating(){return Promise.resolve(this.animeInfo.averageScore)}async _update(){let e=this.ids.mal,t="idMal";Number.isNaN(this.ids.mal)&&(e=this.ids.ani,t="id");const n=`\n    query ($id: Int, $type: MediaType) {\n      Media (${t}: $id, type: $type) {\n        id\n        idMal\n        siteUrl\n        episodes\n        chapters\n        volumes\n        averageScore\n        coverImage{\n          large\n        }\n        title {\n          userPreferred\n        }\n        mediaListEntry {\n          id\n          status\n          startedAt {\n            year\n            month\n            day\n          }\n          completedAt {\n            year\n            month\n            day\n          }\n          progress\n          progressVolumes\n          score(format: POINT_100)\n          repeat\n          notes\n        }\n      }\n    }\n    `,s={id:e,type:this.type.toUpperCase()};return this._authenticated=!0,this.apiCall(n,s).catch((e=>{if(e instanceof P)return this._authenticated=!1,this.apiCall(n,s,!1);throw e})).then((e=>{if(this.logger.log("[SINGLE]","Data",e),this.animeInfo=e.data.Media,this.ids.ani=this.animeInfo.id,Number.isNaN(this.ids.mal)&&this.animeInfo.idMal&&(this.ids.mal=this.animeInfo.idMal),this.displayUrl=this.animeInfo.siteUrl,this._onList=!0,null===this.animeInfo.mediaListEntry&&(this._onList=!1,this.animeInfo.mediaListEntry={notes:"",progress:0,progressVolumes:0,repeat:0,score:0,status:"PLANNING",startedAt:{year:null,month:null,day:null},completedAt:{year:null,month:null,day:null}}),!this._authenticated)throw new P("Not Authenticated")}))}async _sync(){let e="\n      mutation ($mediaId: Int, $status: MediaListStatus, $startedAt: FuzzyDateInput, $completedAt: FuzzyDateInput, $progress: Int, $scoreRaw: Int, $repeat: Int, $notes: String) {\n        SaveMediaListEntry (mediaId: $mediaId, status: $status, startedAt: $startedAt, completedAt: $completedAt, progress: $progress, scoreRaw: $scoreRaw, repeat: $repeat, notes: $notes) {\n          id\n          status\n          progress\n        }\n      }\n    ";const t={mediaId:this.ids.ani,status:this.animeInfo.mediaListEntry.status,startedAt:this.animeInfo.mediaListEntry.startedAt,completedAt:this.animeInfo.mediaListEntry.completedAt,progress:this.animeInfo.mediaListEntry.progress,scoreRaw:this.animeInfo.mediaListEntry.score,repeat:this.animeInfo.mediaListEntry.repeat,notes:this.animeInfo.mediaListEntry.notes,volumes:null};return"manga"===this.type&&(e="\n        mutation ($mediaId: Int, $status: MediaListStatus, $startedAt: FuzzyDateInput, $completedAt: FuzzyDateInput, $progress: Int, $scoreRaw: Int, $repeat: Int, $notes: String, $volumes: Int) {\n          SaveMediaListEntry (mediaId: $mediaId, status: $status, startedAt: $startedAt, completedAt: $completedAt, progress: $progress, scoreRaw: $scoreRaw, repeat: $repeat, notes: $notes, progressVolumes: $volumes) {\n            id\n            status\n            progress\n            progressVolumes\n          }\n        }\n      ",t.volumes=this.animeInfo.mediaListEntry.progressVolumes),this.apiCall(e,t).then((e=>(e&&e.data&&e.data.SaveMediaListEntry&&e.data.SaveMediaListEntry.id&&(this.animeInfo.mediaListEntry.id=e.data.SaveMediaListEntry.id),e)))}apiCall(e,t,n=!0){return ae(e,t,n)}getScoreMode(){switch(we.settings.get("anilistOptions").scoreFormat){case"POINT_100":return pe;case"POINT_3":return de;case"POINT_5":return fe;case"POINT_10_DECIMAL":return ve;default:return V}}_delete(){const e={mediaId:this.animeInfo.mediaListEntry.id};return this.apiCall("\n      mutation ($mediaId: Int) {\n        DeleteMediaListEntry(id: $mediaId) {\n          deleted\n        }\n      }\n    ",e)}}var Ee=n(78584),ke=n(13647);const Ie=Ee.m("kitsu","#d65e43");function xe(e,t=null){const n={current:r.Watching,planned:r.PlanToWatch,completed:r.Completed,dropped:r.Dropped,on_hold:r.Onhold};return null!==t?Object.keys(n).find((e=>n[e]===t)):n[e]}function Te(e){return"string"!=typeof e?null:e.substring(0,10)}function $e(e){return"string"!=typeof e?null:`${e}T00:00:00.000Z`}function Ne(e,t){let n;switch(ke.settings.get("kitsuOptions").titleLanguagePreference){case"english":n=e.en;break;case"romanized":n=e.en_jp;break;default:n=t}if(void 0!==n&&n||(n=e.en),void 0!==n&&n||(n=e.en_jp),void 0!==n&&n||(n=e.ja_jp),void 0===n||!n){const t=Object.keys(e);if(!t.length)return"No Title";n=e[t[0]]}return n}function Oe(e,t,n={},s=!0){const i={"Content-Type":"application/vnd.api+json",Accept:"application/vnd.api+json"};return s&&(i.Authorization=`Bearer ${ke.settings.get("kitsuToken")}`),ke.request.xhr(e,{url:t,headers:i,data:"GET"!==e?JSON.stringify(n):void 0}).then((e=>{if(e.status>499&&e.status<600||0===e.status)throw new M(`Server Offline status: ${e.status}`);if(204===e.status)return{};const t=j(e.responseText);if(void 0!==t.errors&&t.errors.length){Ie.error("[SINGLE]","Error",t.errors);const e=t.errors[0];switch(parseInt(e.status)){case 401:case 403:throw new P(e.detail);case 404:throw new D(e.detail);default:throw new Error(e.detail)}}return t}))}var Ce=n(13647);const Le={ui:{module:"dropdown"},getOptions(){const e=[{value:0,label:Ce.storage.lang("UI_Score_Not_Rated")}];for(let t=2;t<21;t++)e.push({value:5*t,label:(t/2).toFixed(1).toString()});return e},valueToOptionValue:e=>e?e<10?10:5*Math.round(Number(e)/5):0,optionValueToValue:e=>e?Number(e):0};var Ae=n(13647);const Pe={ui:{module:"click",type:"smiley"},getOptions:()=>[{value:0,label:Ae.storage.lang("UI_Score_Not_Rated")},{value:100,label:"😀"},{value:70,label:"🙂"},{value:40,label:"😐"},{value:10,label:"🙁"}],valueToOptionValue:e=>e?e<25?10:e<55?40:e<85?70:100:0,optionValueToValue:e=>e?Number(e):0};var Re=n(13647);const Me={ui:{module:"dropdown"},getOptions(){const e=[{value:0,label:Re.storage.lang("UI_Score_Not_Rated")}];for(let t=1;t<11;t++)e.push({value:10*t,label:(t/2).toFixed(1).toString()});return e},valueToOptionValue:e=>e?e<10?10:10*Math.round(e/10):0,optionValueToValue:e=>e?Number(e):0};var De=n(78584),Ue=n(26017),je=n(13647);class Fe extends G{constructor(e){return super(e),this.url=e,this.shortName="Kitsu",this.authenticationUrl="https://kitsu.app/404?mal-sync=authentication",this.logger=De.m(this.shortName,"#d65e43"),this}listI(){return this.animeInfo.data[0]}animeI(){return this.animeInfo.included[0]}handleUrl(e){if(e.match(/kitsu\.app\/(anime|manga)\/.*/i))return this.type="anime"===Ue.urlPart(e,3)?"anime":"manga",void(this.ids.kitsu.slug=Ue.urlPart(e,4));if(e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))return this.type="anime"===Ue.urlPart(e,3)?"anime":"manga",void(this.ids.mal=Number(Ue.urlPart(e,4)));throw new R(e)}getCacheKey(){return this.getKey(["KITSU"])}getPageId(){return this.ids.kitsu.id}_getStatus(){return this.listI().attributes.reconsuming&&"current"===this.listI().attributes.status?r.Rewatching:parseInt(xe(this.listI().attributes.status))}_setStatus(e){e===r.Rewatching?(e=r.Watching,this.listI().attributes.reconsuming=!0):this.listI().attributes.reconsuming=!1,this.listI().attributes.status=xe(e,parseInt(e.toString()))}_getStartDate(){return Te(this.listI().attributes.startedAt)}_setStartDate(e){this.listI().attributes.startedAt=$e(e)}_getFinishDate(){return Te(this.listI().attributes.finishedAt)}_setFinishDate(e){this.listI().attributes.finishedAt=$e(e)}_getRewatchCount(){return this.listI().attributes.reconsumeCount}_setRewatchCount(e){this.listI().attributes.reconsumeCount=e}_getScore(){if(!this.listI().attributes.ratingHundred)return 0;const e=Math.round(this.listI().attributes.ratingHundred/10);return 0===e?1:e}_setScore(e){this.listI().attributes.ratingHundred=e?10*e:null}_getAbsoluteScore(){return Number(this.listI().attributes.ratingHundred)}_setAbsoluteScore(e){this.listI().attributes.ratingHundred=Number(e)}_getTwentyScore(){const e=this.listI().attributes.ratingHundred;return e?e<5?1:Math.round(e/5):null}_getEpisode(){return this.listI().attributes.progress}_setEpisode(e){this.listI().attributes.progress=parseInt(`${e}`)}_getVolume(){return this.listI().attributes.volumesOwned}_setVolume(e){this.listI().attributes.volumesOwned=e}_getTags(){let e=this.listI().attributes.notes;return null!==e&&"null"!==e||(e=""),e}_setTags(e){this.listI().attributes.notes=e}_getTitle(){try{return Ne(this.animeI().attributes.titles,this.animeI().attributes.canonicalTitle)}catch(e){return console.error("title",e),"Failed"}}_getTotalEpisodes(){const e=this.animeI().attributes.episodeCount?this.animeI().attributes.episodeCount:this.animeI().attributes.chapterCount;return null===e?0:e}_getTotalVolumes(){return this.animeI().attributes.volumeCount||0}_getDisplayUrl(){return`https://kitsu.app/${this.getType()}/${this.animeI().attributes.slug}`}_getImage(){return this.animeI().attributes.posterImage&&this.animeI().attributes.posterImage.large?this.animeI().attributes.posterImage.large:""}_getRating(){return null===this.animeI().attributes.averageRating?Promise.resolve(""):Promise.resolve(`${this.animeI().attributes.averageRating}%`)}async _update(){if(Number.isNaN(this.ids.mal)){var e=await this.kitsuSlugtoKitsu(this.ids.kitsu.slug,this.getType());try{this.ids.kitsu.id=Number(e.res.data[0].id),this.ids.mal=Number(e.malId)}catch(e){throw this._authenticated=!0,new D("Not found")}}if(Number.isNaN(this.ids.kitsu.id)){var t=await this.malToKitsu(this.ids.mal,this.getType());try{const e=t.data.find((e=>e.relationships.item.data.type===this.getType()));if(!e)throw new D("Not found");this.ids.kitsu.id=Number(e.relationships.item.data.id)}catch(e){throw this._authenticated=!0,new D(`No entry found for malId ${this.ids.mal}`)}}return this._authenticated=!0,this.userId().then((e=>this.apiCall("GET",`https://kitsu.app/api/edge/library-entries?filter[user_id]=${e}&filter[kind]=${this.getType()}&filter[${this.getType()}_id]=${this.ids.kitsu.id}&page[limit]=1&page[limit]=1&include=${this.getType()}&fields[${this.getType()}]=slug,titles,canonicalTitle,averageRating,posterImage,${"anime"===this.getType()?"episodeCount":"chapterCount,volumeCount"}`))).catch((e=>{if(e instanceof P)return this._authenticated=!1,{data:[],included:[]};throw e})).then((async n=>{const s=n;this._onList=!0,n.data.length||(this._onList=!1,s.data[0]={attributes:{notes:"",progress:0,volumesOwned:0,reconsuming:!1,reconsumeCount:0,ratingTwenty:null,status:"planned",startedAt:null,finishedAt:null}},void 0!==t?s.included=t.included:e?s.included=e.res.data:(t=await this.malToKitsu(this.ids.mal,this.getType()),s.included=t.included)),s.data[0].attributes.ratingHundred?s.data[0].attributes.ratingHundred=0:s.data[0].attributes.ratingHundred=Number(5*s.data[0].attributes.ratingTwenty),this.animeInfo=s;try{this.animeI()}catch(e){throw this.logger.error(e),new D("Not found")}if(!this._authenticated)throw new P("Not Authenticated")}))}async _sync(){const e={data:{attributes:{notes:this.listI().attributes.notes,progress:this.listI().attributes.progress,volumesOwned:this.listI().attributes.volumesOwned,reconsuming:this.listI().attributes.reconsuming,reconsumeCount:this.listI().attributes.reconsumeCount,ratingTwenty:this._getTwentyScore(),status:this.listI().attributes.status,startedAt:this.listI().attributes.startedAt,finishedAt:this.listI().attributes.finishedAt},type:"library-entries"}},t=this.getType();if(!t)return Promise.resolve();let n,s;return this.isOnList()?(n=`https://kitsu.app/api/edge/library-entries/${this.listI().id}`,e.data.id=this.listI().id,s="PATCH"):(n="https://kitsu.app/api/edge/library-entries/",e.data.relationships={[t]:{data:{type:t,id:this.ids.kitsu.id}},user:{data:{type:"users",id:await this.userId()}}},s="POST"),this.logger.log(s,e),this.apiCall(s,n,e).then((e=>(e&&e.data&&e.data.id&&(this.listI().id=e.data.id),e)))}apiCall(e,t,n={},s=!0){return Oe(e,t,n,s).catch((e=>{if(e instanceof P)throw new P(e.message);throw e}))}kitsuSlugtoKitsu(e,t){return this.apiCall("GET",`https://kitsu.app/api/edge/${t}?filter[slug]=${e}&page[limit]=1&include=mappings`,{}).catch((n=>{if(n instanceof P)return this._authenticated=!1,this.apiCall("GET",`https://kitsu.app/api/edge/${t}?filter[slug]=${e}&page[limit]=1&include=mappings`,{},!1);throw n})).then((e=>{let n=NaN;if(void 0!==e&&void 0!==e.included)for(let s=0;s<e.included.length;s++){const i=e.included[s];if("mappings"===i.type){if(i.attributes.externalSite===`myanimelist/${t}`){n=Number(i.attributes.externalId),e.included.splice(s,1);break}i.attributes.externalSite===`anilist/${t}`&&(this.ids.ani=Number(i.attributes.externalId))}}return{res:e,malId:n}}))}malToKitsu(e,t){return this.apiCall("GET",`https://kitsu.app/api/edge/mappings?filter[externalSite]=myanimelist/${t}&filter[externalId]=${e}&include=item&fields[item]=id`,{}).catch((n=>{if(n instanceof P)return this._authenticated=!1,this.apiCall("GET",`https://kitsu.app/api/edge/mappings?filter[externalSite]=myanimelist/${t}&filter[externalId]=${e}&include=item&fields[item]=id`,{},!1);throw n})).then((e=>e))}async userId(){const e=await je.storage.get("kitsuUserId");return void 0!==e&&e?e:this.apiCall("GET","https://kitsu.app/api/edge/users?filter[self]=true").then((e=>{if(void 0===e.data||!e.data.length||void 0===e.data[0])throw new P("Not Authenticated");return je.storage.set("kitsuUserId",e.data[0].id),e.data[0].id}))}getScoreMode(){switch(je.settings.get("kitsuOptions").ratingSystem){case"simple":return Pe;case"regular":return Me;case"advanced":return Le;default:return V}}_delete(){return this.apiCall("DELETE",`https://kitsu.app/api/edge/library-entries/${this.listI().id}`)}}var Ve=n(78584),ze=n(13647);const He="39e8640b6f1a60aaf60f3f3313475e830517badab8048a4e52ff2d10deb2b9b0";function Be(){return`https://simkl.com/oauth/authorize?response_type=code&client_id=${He}&redirect_uri=https://simkl.com/apps/chrome/mal-sync/connected/`}function We(e,t=null){const n={watching:r.Watching,plantowatch:r.PlanToWatch,completed:r.Completed,notinteresting:r.Dropped,hold:r.Onhold};return null!==t?Object.keys(n).find((e=>n[e]===t)):n[e]}function Ge(e){if("number"==typeof e)return e;if(e){const t=e.match(/e\d+/i);if(null!==t){const e=parseInt(t[0].replace(/\D/,""));return Number.isNaN(e)?0:e}}return 0}let Ke;async function qe(e=!1){const t=Ve.m("Simkl","#9b7400").m("list");if(void 0===Ke)Ke=await ze.storage.get("simklList");else if(e)return Ke;const n=await ze.storage.get("simklLastCheck"),s=await this.call("https://api.simkl.com/sync/activities");if(t.log("Activity",n,s.anime),n&&n.removed_from_list!==s.anime.removed_from_list){const e=await this.call("https://api.simkl.com/sync/all-items/anime"),n={};if(e)for(let t=0;t<e.anime.length;t++){const s=e.anime[t];void 0!==Ke[s.show.ids.simkl]&&(n[s.show.ids.simkl]=Ke[s.show.ids.simkl])}Ke=n,t.log("remove",Ke)}let i="";if(n&&Ke&&(i=`date_from=${n.all}`,n.all===s.anime.all))return t.log("Up to date"),Ke;if(Ke||(Ke={}),n&&n.rated_at!==s.anime.rated_at){const e=await this.call(`https://api.simkl.com/sync/ratings/anime?${i}`);if(t.log("ratedUpdate",e),e)for(let t=0;t<e.anime.length;t++){const n=e.anime[t];Ke[n.show.ids.simkl]=n}}const a=await this.call(`https://api.simkl.com/sync/all-items/anime?${i}`);if(t.log("listUpdate",a),a)for(let e=0;e<a.anime.length;e++){const t=a.anime[e];Ke[t.show.ids.simkl]=t}return t.log("totalList",Ke),await ze.storage.set("simklList",Ke),await ze.storage.set("simklLastCheck",s.anime),Ke}async function Xe(e,t=!1){const n=await this.syncList(t);if(e.simkl){if(void 0!==n[e.simkl])return n[e.simkl]}else{if(!e.mal)throw"No id passed";{const t=Object.values(n);for(let n=0;n<t.length;n++){const s=t[n];if(void 0!==s.show.ids.mal&&Number(s.show.ids.mal)===Number(e.mal))return s}}}return null}async function Ye(e,t={},n=!1,s="GET",i=!0){const a=Ve.m("Simkl","#9b7400").m("call");n&&(e+=`?${new URLSearchParams(Object.entries(t))}`,t=void 0),a.log(s,e,t);const r={"simkl-api-key":He,Accept:"application/vnd.api+json","Content-Type":"application/json"};return i?r.Authorization=`Bearer ${ze.settings.get("simklToken")}`:a.log("No login"),"GET"===s&&(t=void 0),ze.request.xhr(s,{url:e,headers:r,data:t}).then((async e=>{const t=j(e.responseText);return this.errorHandling(t,e.status),t}))}function Je(e,t){if(t>499&&t<600||0===t)throw new M(`Server Offline status: ${t}`);if(e&&void 0!==e.error){this.logger.error("[SINGLE]","Error",e.error);const{error:t}=e;if(t.code)throw t.code,new Error(t.error);if("user_token_failed"===t)throw new P("user_token_failed");throw t}}var Ze=n(78584),Qe=n(26017);class et extends G{constructor(e){return super(e),this.url=e,this.episodeUpdate=!1,this.statusUpdate=!1,this.ratingUpdate=!1,this.minWatchedEp=1,this.curWatchedEp=0,this.shortName="Simkl",this.authenticationUrl=Be(),this.rewatchingSupport=!1,this.datesSupport=!1,this.syncList=qe,this.getSingle=Xe,this.call=Ye,this.errorHandling=Je,this.logger=Ze.m(this.shortName,"#9b7400"),this}handleUrl(e){if(e.match(/simkl\.com\/(anime|manga)\/\d*/i)){if(this.type="anime"===Qe.urlPart(e,3)?"anime":"manga",this.ids.simkl=parseInt(Qe.urlPart(e,4)),"manga"===this.type)throw"Simkl has no manga support"}else{if(!e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))throw new R(e);if(this.type="anime"===Qe.urlPart(e,3)?"anime":"manga",this.ids.mal=Number(Qe.urlPart(e,4)),"manga"===this.type)throw"Simkl has no manga support"}}getCacheKey(){return this.getKey(["SIMKL"])}getPageId(){return this.ids.simkl}_getStatus(){return parseInt(We(this.animeInfo.status))}_setStatus(e){e===r.Rewatching&&(e=r.Watching),(e=We(e,parseInt(e.toString())))!==this.animeInfo.status&&(this.statusUpdate=!0),this.animeInfo.status=e}_getStartDate(){throw new Error("Simkl does not support Start Date")}_setStartDate(e){throw new Error("Simkl does not support Start Date")}_getFinishDate(){throw new Error("Simkl does not support Finish Date")}_setFinishDate(e){throw new Error("Simkl does not support Finish Date")}_getRewatchCount(){throw new Error("Simkl does not support Rewatch Count")}_setRewatchCount(e){throw new Error("Simkl does not support Rewatch Count")}_getScore(){const e=this.animeInfo.user_rating;return null===e?0:e}_setScore(e){0===e&&(e=null),e!==this.animeInfo.user_rating&&(this.ratingUpdate=!0),this.animeInfo.user_rating=e}_getAbsoluteScore(){return 10*this.getScore()}_setAbsoluteScore(e){e?e<10?this.setScore(1):this.setScore(Math.round(e/10)):this.setScore(0)}_getEpisode(){return this._getStatus()===r.Completed?this._getTotalEpisodes():this.curWatchedEp}_setEpisode(e){e!==this.curWatchedEp&&(this.episodeUpdate=!0),this.curWatchedEp=e}_getVolume(){return 0}_setVolume(e){this.logger.error("You cant set Volumes for animes")}_getTags(){let e=this.animeInfo.private_memo;return null!==e&&"null"!==e||(e=""),e}_setTags(e){this.animeInfo.private_memo=e}_getTitle(){return this.animeInfo.show.title}_getTotalEpisodes(){const e=this.animeInfo.total_episodes_count;return null===e?0:e}_getTotalVolumes(){return 0}_getDisplayUrl(){return`https://simkl.com/${this.getType()}/${this.ids.simkl}`}_getImage(){return`https://simkl.in/posters/${this.animeInfo.show.poster}_ca.jpg`}async _getRating(){try{return(await this.call("https://api.simkl.com/ratings",{simkl:this.ids.simkl},!0)).simkl.rating}catch(e){return this.logger.error(e),"N/A"}}async _update(){let e;return e=Number.isNaN(this.ids.mal)?{simkl:this.ids.simkl}:{mal:this.ids.mal},this._authenticated=!0,this.getSingle(e).catch((e=>{if(e instanceof P)return this._authenticated=!1,"";throw e})).then((async t=>{if(this.logger.log(t),this.episodeUpdate=!1,this.statusUpdate=!1,this.ratingUpdate=!1,this.animeInfo=t,this._onList=!0,!this.animeInfo){let t;if(this._onList=!1,e.simkl){if(t=await this.call(`https://api.simkl.com/anime/${e.simkl}`,{extended:"full"},!0),!t)throw new D("Anime not found")}else{if(t=await this.call("https://api.simkl.com/search/id",e,!0),!t?.length)throw new D("Anime not found");if(t[0].mal&&t[0].mal.type&&"Special"===t[0].mal.type)throw new Error("Is a special");t=t[0]}this.animeInfo={last_watched:"",last_watched_at:"",next_to_watch:"",not_aired_episodes_count:0,private_memo:"",status:"plantowatch",total_episodes_count:0,user_rating:null,watched_episodes_count:0,show:t},this.logger.log("Add anime",this.animeInfo)}if(Number.isNaN(this.ids.simkl)&&(this.ids.simkl=parseInt(this.animeInfo.show.ids.simkl)),Number.isNaN(this.ids.mal)&&void 0!==this.animeInfo.show.ids.mal&&(this.ids.mal=this.animeInfo.show.ids.mal),this.curWatchedEp=Ge(this.animeInfo.last_watched),!this.curWatchedEp&&this.animeInfo.next_to_watch){const e=Ge(this.animeInfo.next_to_watch);e&&(this.curWatchedEp=e-1)}if(this.minWatchedEp=this.curWatchedEp+1,!this._authenticated)throw new P("Not Authenticated")}))}async _sync(){if(this.logger.log("[SET] Object:",this.animeInfo,"status",this.statusUpdate,"episode",this.episodeUpdate,"rating",this.ratingUpdate,"minWatchedEp",this.minWatchedEp,"curWatchedEp",this.curWatchedEp),this.statusUpdate||!this.isOnList()){const e=await this.call("https://api.simkl.com/sync/add-to-list",JSON.stringify({shows:[{to:this.animeInfo.status,ids:{simkl:this.ids.simkl}}]}),!1,"POST");this.logger.log("Status response",e)}if(this.episodeUpdate||!this.isOnList()){const e=this.curWatchedEp,t=[];if(this.minWatchedEp<=e){if(e){for(let n=this.minWatchedEp;n<=e;n++)t.push({number:n});const n=await this.call("https://api.simkl.com/sync/history",JSON.stringify({shows:[{ids:{simkl:this.ids.simkl},private_memo:this.animeInfo.private_memo,seasons:[{number:1,episodes:t}]}]}),!1,"POST");this.logger.log("Episode response",n)}}else{for(let n=this.minWatchedEp-1;n>e;n-=1)t.push({number:n});const n=await this.call("https://api.simkl.com/sync/history/remove",JSON.stringify({shows:[{ids:{simkl:this.ids.simkl},seasons:[{number:1,episodes:t}]}]}),!1,"POST");this.logger.log("Episode remove response",n)}this.minWatchedEp=e+1}if(this.ratingUpdate)if(this.animeInfo.user_rating){const e=await this.call("https://api.simkl.com/sync/ratings",JSON.stringify({shows:[{rating:this.animeInfo.user_rating,ids:{simkl:this.ids.simkl}}]}),!1,"POST");this.logger.log("Rating response",e)}else{const e=await this.call("https://api.simkl.com/sync/ratings/remove",JSON.stringify({shows:[{ids:{simkl:this.ids.simkl}}]}),!1,"POST");this.logger.log("Rating remove response",e)}this.episodeUpdate=!1,this.statusUpdate=!1,this.ratingUpdate=!1}_delete(){return this.call("https://api.simkl.com/sync/history/remove",JSON.stringify({shows:[{ids:{simkl:this.ids.simkl}}]}),!1,"POST")}}var tt=n(13647);const nt="z3NJ84kK9iy5NU6SnhdCDB38rr4-jFIJ67bMIUDzdoo",st=`https://shikimori.one/oauth/authorize?client_id=${nt}&redirect_uri=https%3A%2F%2Fmalsync.moe%2Fshikimori%2Foauth&response_type=code&scope=user_rates`,it="https://shikimori.one";async function at(e){const t=e.type||"GET",n=tt.settings.get("shikiToken");if(!n&&!n.access_token&&!e.auth)throw new P("No token set");let s="https://shikimori.one/api/"+e.path;if(e.parameter&&Object.keys(e.parameter).length){s+=s.includes("?")?"&":"?";const t=[];for(const n in e.parameter)t.push(`${n}=${e.parameter[n]}`);s+=t.join("&")}const i={Authorization:`Bearer ${n.access_token}`,"User-Agent":"MAL-Sync","Content-Type":"application/json"};let a="";return e.dataObj&&(a=JSON.stringify(e.dataObj)),e.auth&&(delete i.Authorization,s="https://shikimori.one/oauth/token"),tt.request.xhr(t,{url:s,headers:i,data:a}).then((async t=>{if(t.status>499&&t.status<600||0===t.status)throw new M(`Server Offline status: ${t.status}`);let s=null;if(t.responseText&&(s=JSON.parse(t.responseText)),401===t.status){if(e.auth)throw new P(s.message??s.error);return await rt(n.refresh_token),at(e)}if(s&&s.error)switch(s.error){case"forbidden":case"invalid_token":if(e.auth)throw new P(s.message??s.error);return await rt(n.refresh_token),at(e);case"not_found":throw new D(s.message??s.error);default:throw new Error(s.message??s.error)}if(400===t.status)throw new Error("Invalid Parameters");return s}))}async function rt(e){const t=await function(e){const t={client_id:nt,client_secret:"6vkFaJN_wxQHmBoq23ac1z6tZKiAD7xqsXGudkkOqTg",redirect_uri:"https://malsync.moe/shikimori/oauth"};return"code"in e&&(t.code=e.code,t.grant_type="authorization_code"),"refresh_token"in e&&(t.refresh_token=e.refresh_token,t.grant_type="refresh_token"),at({type:"POST",path:"oauth/token",auth:!0,dataObj:t})}({refresh_token:e}).catch((e=>{throw"invalid_request"===e.message&&tt.settings.set("shikiToken",""),e}));await tt.settings.set("shikiToken",{access_token:t.access_token,refresh_token:t.refresh_token})}function ot(e,t,n=!1){const s=tt.settings.get("shikiOptions");return"ru"===(s&&s.locale?s.locale:"ru")?e||t:n&&t&&e?`${t} / ${e}`:t||e}var lt;!function(e){e[e.watching=r.Watching]="watching",e[e.planned=r.PlanToWatch]="planned",e[e.completed=r.Completed]="completed",e[e.dropped=r.Dropped]="dropped",e[e.on_hold=r.Onhold]="on_hold",e[e.rewatching=r.Rewatching]="rewatching"}(lt||(lt={}));var ct=n(78584),ut=n(26017);class ht extends G{constructor(e){return super(e),this.url=e,this.shortName="Shiki",this.authenticationUrl=st,this.datesSupport=!1,this.logger=ct.m(this.shortName,"#3db4f2"),this}handleUrl(e){if(e.match(/shikimori\.one\/(animes|mangas|ranobe)\/\D?\d+/i)){this.type="animes"===ut.urlPart(e,3)?"anime":"manga";const t=ut.urlPart(e,4).match(/^\D?(\d+)/);if(t&&t[1])return void(this.ids.mal=Number(t[1]))}if(e.match(/myanimelist\.net\/(anime|manga)\/\d*/i))return this.type="anime"===ut.urlPart(e,3)?"anime":"manga",void(this.ids.mal=Number(ut.urlPart(e,4)));throw new R(e)}getCacheKey(){return this.ids.mal}getPageId(){return this.ids.mal}_getStatus(){return lt[this.animeInfo.status]}_setStatus(e){this.animeInfo.status=lt[e]}_getStartDate(){throw new Error("Shikimori does not support Start Date")}_setStartDate(e){throw new Error("Shikimori does not support Start Date")}_getFinishDate(){throw new Error("Shikimori does not support Finish Date")}_setFinishDate(e){throw new Error("Shikimori does not support Finish Date")}_getRewatchCount(){return this.animeInfo.rewatches}_setRewatchCount(e){this.animeInfo.rewatches=e}_getScore(){return this.animeInfo.score}_setScore(e){this.animeInfo.score=e}_getAbsoluteScore(){return 10*this.getScore()}_setAbsoluteScore(e){e?e<10?this.setScore(1):this.setScore(Math.round(e/10)):this.setScore(0)}_getEpisode(){return"manga"===this.type?this.animeInfo.chapters:this.animeInfo.episodes}_setEpisode(e){"manga"!==this.type?this.animeInfo.episodes=parseInt(`${e}`):this.animeInfo.chapters=parseInt(`${e}`)}_getVolume(){return this.animeInfo.volumes}_setVolume(e){this.animeInfo.volumes=e}_getTags(){let e=this.animeInfo.text;return null!==e&&"null"!==e||(e=""),e}_setTags(e){this.animeInfo.text=e}_getTitle(){return ot(this.animeMeta.russian,this.animeMeta.name)}_getTotalEpisodes(){return("anime"===this.type?this.animeMeta.episodes:this.animeMeta.chapters)||0}_getTotalVolumes(){return this.animeMeta.volumes||0}_getDisplayUrl(){return this.animeMeta.url?`${it}${this.animeMeta.url}`:this.url}_getImage(){return this.animeMeta.image.preview?`${it}${this.animeMeta.image.preview}`:""}_getRating(){return Promise.resolve(this.animeMeta.score)}async _update(){const e=await async function(){const e=new u("shiki/userId",144e5);if(await e.hasValue())return e.getValue();const t=await at({type:"GET",path:"users/whoami"}).then((e=>(e.locale&&tt.settings.set("shikiOptions",{locale:e.locale}),e)));return t.id&&e.setValue(t.id),t.id}(),t=await at({path:`${this.type}s/${this.ids.mal}`,type:"GET"});if(!t.id)throw new D(this.url);this.animeMeta=t;const n=await at({path:"v2/user_rates",type:"GET",parameter:{target_id:this.ids.mal,user_id:e,target_type:"anime"===this.type?"Anime":"Manga"}});return n.length?(this._onList=!0,[this.animeInfo]=n):(this._onList=!1,this.animeInfo={user_id:e,target_id:this.ids.mal,target_type:"anime"===this.type?"Anime":"Manga",score:0,status:"planned",rewatches:0,episodes:0,volumes:0,chapters:0,text:""}),this._authenticated=!0,Promise.resolve()}async _sync(){return at({type:this._onList?"PUT":"POST",path:this._onList?`v2/user_rates/${this.animeInfo.id}`:"v2/user_rates",dataObj:{user_rate:this.animeInfo}})}getScoreMode(){return V}_delete(){return at({type:"DELETE",path:`v2/user_rates/${this.animeInfo.id}`})}}var pt=n(78584),mt=n(26017),dt=n(13647);class gt extends G{constructor(e){return super(e),this.url=e,this.shortName="Local",this.authenticationUrl="",this.rewatchingSupport=!1,this.datesSupport=!1,this.logger=pt.m(this.shortName,"black"),this}handleUrl(e){if(e.match(/local:\/\/.*/i))return this.id=mt.urlPart(e,4),this.type="anime"===mt.urlPart(e,3)?"anime":"manga",this.page=mt.urlPart(e,2),this.key=`local://${this.page}/${this.type}/${this.id}`,void(mt.urlPart(e,5)?this.title=decodeURIComponent(mt.urlPart(e,5)):this.title="Unknown");throw new R(e)}getCacheKey(){return`local:${this.id}:${this.page}`}getPageId(){return this.getCacheKey()}_getStatus(){return this.animeInfo.status}_setStatus(e){e!==r.Rewatching||this.supportsRewatching()||(e=r.Watching),this.animeInfo.status=e}_getStartDate(){throw new Error("Local sync does not support Start Date")}_setStartDate(e){throw new Error("Local sync does not support Start Date")}_getFinishDate(){throw new Error("Local sync does not support Finish Date")}_setFinishDate(e){throw new Error("Local sync does not support Finish Date")}_getRewatchCount(){throw new Error("Local sync does not support Rewatch Count")}_setRewatchCount(e){throw new Error("Local sync does not support Rewatch Count")}_getScore(){return this.animeInfo.score}_setScore(e){this.animeInfo.score=e}_getAbsoluteScore(){return 10*this.getScore()}_setAbsoluteScore(e){e?e<10?this.setScore(1):this.setScore(Math.round(e/10)):this.setScore(0)}_getEpisode(){return this.animeInfo.progress}_setEpisode(e){this.animeInfo.progress=parseInt(`${e}`)}_getVolume(){return this.animeInfo.volumeprogress}_setVolume(e){this.animeInfo.volumeprogress=e}_getTags(){let{tags:e}=this.animeInfo;return e||(e=""),e}_setTags(e){this.animeInfo.tags=e}_getTitle(e=!1){return e?this.animeInfo.name:`[L] ${this.animeInfo.name}`}_getTotalEpisodes(){return 0}_getTotalVolumes(){return 0}_getDisplayUrl(){return"https://github.com/MALSync/MALSync/wiki/Local-Sync"}_getImage(){return this.animeInfo&&this.animeInfo.image?this.animeInfo.image:""}setImage(e){this.animeInfo.image=e,this._onList&&this.sync()}_getRating(){return Promise.resolve("Local")}async _update(){this._authenticated=!0,this.animeInfo=await dt.storage.get(this.key),this._onList=!0,this.animeInfo||(this._onList=!1,this.animeInfo={name:this.title,tags:"",sUrl:"",image:"",progress:0,volumeprogress:0,score:0,status:r.PlanToWatch})}async _sync(){return dt.storage.set(this.key,this.animeInfo)}_delete(){return dt.storage.remove(this.key)}setStreamingUrl(e){return this.animeInfo&&e&&(this.animeInfo.sUrl=e),super.setStreamingUrl(e)}getStreamingUrl(){return this.animeInfo&&this.animeInfo.sUrl?this.animeInfo.sUrl:super.getStreamingUrl()}}function ft(e){if(/^local:\/\//i.test(e))return new gt(e);const n=t(e);if("MAL"===n)return new ue(e);if("MALAPI"===n)return new ce(e);if("ANILIST"===n)return new Se(e);if("KITSU"===n)return new Fe(e);if("SIMKL"===n)return new et(e);if("SHIKI"===n)return new ht(e);throw"Unknown sync mode"}var yt=n(13647),vt=n(7263);let bt;function _t(){clearTimeout(bt),bt=null,vt.$(".floatbutton").fadeIn()}function wt(e=!1){e?vt.$(".floatbutton").fadeOut():bt||(bt=setTimeout((()=>{bt=null,vt.$(".floatbutton").fadeOut()}),500))}const St={shortName:"MAL",score:"MAL Score:"},Et={shortName:"AniList",score:"AniList Score:"},kt={shortName:"Kitsu",score:"Kitsu Score:"},It={shortName:"Simkl",score:"Simkl Score:"},xt={shortName:"local storage",score:"Local storage Score:"},Tt={shortName:"Shiki",score:"Shikimori Score:"};var $t=n(13647);function Nt(e){if(/^local:\/\//i.test(e))return xt;const t=$t.settings.get("syncMode");return"MAL"===t||"MALAPI"===t?St:"ANILIST"===t?Et:"KITSU"===t?kt:"SHIKI"===t?Tt:It}var Ot=n(78584),Ct=n(13647),Lt=n(7263);let At;const Pt=Ot.m("Player");let Rt="";function Mt(e,t){const n=t.currentSrc;e.current>1&&Rt!==n&&(Rt=n,Pt.log("New player detected",t.currentSrc),async function(e){if(await Ct.settings.getAsync("autofull"))if(window.fullScreen||window.innerWidth===window.screen.width&&window.innerHeight===window.screen.height)Ot.info("Browser already in fullscreen");else{let t=e;const n=["player","vstr","vplayer","mgvideo","myVideo","b-video-wrapper","vilos"],s=["AT-player","plyr","AkiraPlayer","video-js"];let i=!1;for(const a in n){const r=document.getElementById(n[a]);if(null!==r){i=!0,t=r;break}}for(const o in s){const l=document.getElementsByClassName(s[o]).item(0);if(null!==l){i=!0,t=l;break}}if(!i){const c=t.offsetHeight,u=t.offsetWidth;for(;t.parentElement&&c===t.parentElement.offsetHeight&&u===t.parentElement.offsetWidth;)t=t.parentElement,i=!0}if(!i&&!e.getAttribute("controls")){function h(){(document.webkitIsFullScreen||document.mozFullScreen||null!==document.msFullscreenElement)&&e.removeAttribute("controls","controls")}document.addEventListener&&(document.addEventListener("fullscreenchange",h,!1),document.addEventListener("mozfullscreenchange",h,!1),document.addEventListener("MSFullscreenChange",h,!1),document.addEventListener("webkitfullscreenchange",h,!1)),e.setAttribute("controls","controls")}t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen()}}(t))}let Dt,Ut=!1;const jt=["introSkipFwd","introSkipBwd","nextEpShort","correctionShort","syncShort"];var Ft=n(50953),Vt=n(90033);function zt(e,t,n,s){try{return s?e(...s):e()}catch(e){Bt(e,t,n)}}function Ht(e,t,n,s){if((0,Vt.Tn)(e)){const i=zt(e,t,n,s);return i&&(0,Vt.yL)(i)&&i.catch((e=>{Bt(e,t,n)})),i}if((0,Vt.cy)(e)){const i=[];for(let a=0;a<e.length;a++)i.push(Ht(e[a],t,n,s));return i}}function Bt(e,t,n,s=!0){t&&t.vnode;const{errorHandler:i,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||Vt.MZ;if(t){let s=t.parent;const a=t.proxy,r=`https://vuejs.org/error-reference/#runtime-${n}`;for(;s;){const t=s.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,a,r))return;s=s.parent}if(i)return(0,Ft.C4)(),zt(i,null,10,[e,a,r]),void(0,Ft.bl)()}!function(e,t,n,s=!0,i=!1){if(i)throw e;console.error(e)}(e,0,0,s,a)}const Wt=[];let Gt=-1;const Kt=[];let qt=null,Xt=0;const Yt=Promise.resolve();let Jt=null;function Zt(e){const t=Jt||Yt;return e?t.then(this?e.bind(this):e):t}function Qt(e){if(!(1&e.flags)){const t=sn(e),n=Wt[Wt.length-1];!n||!(2&e.flags)&&t>=sn(n)?Wt.push(e):Wt.splice(function(e){let t=Gt+1,n=Wt.length;for(;t<n;){const s=t+n>>>1,i=Wt[s],a=sn(i);a<e||a===e&&2&i.flags?t=s+1:n=s}return t}(t),0,e),e.flags|=1,en()}}function en(){Jt||(Jt=Yt.then(an))}function tn(e,t,n=Gt+1){for(;n<Wt.length;n++){const t=Wt[n];if(t&&2&t.flags){if(e&&t.id!==e.uid)continue;Wt.splice(n,1),n--,4&t.flags&&(t.flags&=-2),t(),4&t.flags||(t.flags&=-2)}}}function nn(e){if(Kt.length){const e=[...new Set(Kt)].sort(((e,t)=>sn(e)-sn(t)));if(Kt.length=0,qt)return void qt.push(...e);for(qt=e,Xt=0;Xt<qt.length;Xt++){const e=qt[Xt];4&e.flags&&(e.flags&=-2),8&e.flags||e(),e.flags&=-2}qt=null,Xt=0}}const sn=e=>null==e.id?2&e.flags?-1:1/0:e.id;function an(e){Vt.tE;try{for(Gt=0;Gt<Wt.length;Gt++){const e=Wt[Gt];!e||8&e.flags||(4&e.flags&&(e.flags&=-2),zt(e,e.i,e.i?15:14),4&e.flags||(e.flags&=-2))}}finally{for(;Gt<Wt.length;Gt++){const e=Wt[Gt];e&&(e.flags&=-2)}Gt=-1,Wt.length=0,nn(),Jt=null,(Wt.length||Kt.length)&&an(e)}}let rn=null,on=null;function ln(e){const t=rn;return rn=e,on=e&&e.type.__scopeId||null,t}function cn(e,t){if(null===rn)return e;const n=Ti(rn),s=e.dirs||(e.dirs=[]);for(let e=0;e<t.length;e++){let[i,a,r,o=Vt.MZ]=t[e];i&&((0,Vt.Tn)(i)&&(i={mounted:i,updated:i}),i.deep&&(0,Ft.hV)(a),s.push({dir:i,instance:n,value:a,oldValue:void 0,arg:r,modifiers:o}))}return e}function un(e,t,n,s){const i=e.dirs,a=t&&t.dirs;for(let r=0;r<i.length;r++){const o=i[r];a&&(o.oldValue=a[r].value);let l=o.dir[s];l&&((0,Ft.C4)(),Ht(l,n,8,[e.el,o,e,t]),(0,Ft.bl)())}}const hn=Symbol("_vte");Symbol("_leaveCb"),Symbol("_enterCb");function pn(e,t){6&e.shapeFlag&&e.component?(e.transition=t,pn(e.component.subTree,t)):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function mn(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function dn(e,t,n,s,i=!1){if((0,Vt.cy)(e))return void e.forEach(((e,a)=>dn(e,t&&((0,Vt.cy)(t)?t[a]:t),n,s,i)));if(gn(s)&&!i)return void(512&s.shapeFlag&&s.type.__asyncResolved&&s.component.subTree.component&&dn(e,t,n,s.component.subTree));const a=4&s.shapeFlag?Ti(s.component):s.el,r=i?null:a,{i:o,r:l}=e,c=t&&t.r,u=o.refs===Vt.MZ?o.refs={}:o.refs,h=o.setupState,p=(0,Ft.ux)(h),m=h===Vt.MZ?()=>!1:e=>(0,Vt.$3)(p,e);if(null!=c&&c!==l&&((0,Vt.Kg)(c)?(u[c]=null,m(c)&&(h[c]=null)):(0,Ft.i9)(c)&&(c.value=null)),(0,Vt.Tn)(l))zt(l,o,12,[r,u]);else{const t=(0,Vt.Kg)(l),s=(0,Ft.i9)(l);if(t||s){const o=()=>{if(e.f){const n=t?m(l)?h[l]:u[l]:l.value;i?(0,Vt.cy)(n)&&(0,Vt.TF)(n,a):(0,Vt.cy)(n)?n.includes(a)||n.push(a):t?(u[l]=[a],m(l)&&(h[l]=u[l])):(l.value=[a],e.k&&(u[e.k]=l.value))}else t?(u[l]=r,m(l)&&(h[l]=r)):s&&(l.value=r,e.k&&(u[e.k]=r))};r?(o.id=-1,bs(o,n)):o()}}}Boolean,Boolean,(0,Vt.We)().requestIdleCallback,(0,Vt.We)().cancelIdleCallback;const gn=e=>!!e.type.__asyncLoader,fn=e=>e.type.__isKeepAlive;function yn(e,t){bn(e,"a",t)}function vn(e,t){bn(e,"da",t)}function bn(e,t,n=gi){const s=e.__wdc||(e.__wdc=()=>{let t=n;for(;t;){if(t.isDeactivated)return;t=t.parent}return e()});if(wn(t,s,n),n){let e=n.parent;for(;e&&e.parent;)fn(e.parent.vnode)&&_n(s,t,n,e),e=e.parent}}function _n(e,t,n,s){const i=wn(t,e,s,!0);$n((()=>{(0,Vt.TF)(s[t],i)}),n)}function wn(e,t,n=gi,s=!1){if(n){const i=n[e]||(n[e]=[]),a=t.__weh||(t.__weh=(...s)=>{(0,Ft.C4)();const i=vi(n),a=Ht(t,n,e,s);return i(),(0,Ft.bl)(),a});return s?i.unshift(a):i.push(a),a}}RegExp,RegExp;const Sn=e=>(t,n=gi)=>{Ei&&"sp"!==e||wn(e,((...e)=>t(...e)),n)},En=Sn("bm"),kn=Sn("m"),In=Sn("bu"),xn=Sn("u"),Tn=Sn("bum"),$n=Sn("um"),Nn=Sn("sp"),On=Sn("rtg"),Cn=Sn("rtc");function Ln(e,t=gi){wn("ec",e,t)}const An="components";function Pn(e,t){return function(e,t,n=!0,s=!1){const i=rn||gi;if(i){const n=i.type;if(e===An){const e=function(e,t=!0){return(0,Vt.Tn)(e)?e.displayName||e.name:e.name||t&&e.__name}(n,!1);if(e&&(e===t||e===(0,Vt.PT)(t)||e===(0,Vt.ZH)((0,Vt.PT)(t))))return n}const a=Mn(i[e]||n[e],t)||Mn(i.appContext[e],t);return!a&&s?n:a}}(An,e,!0,t)||e}const Rn=Symbol.for("v-ndc");function Mn(e,t){return e&&(e[t]||e[(0,Vt.PT)(t)]||e[(0,Vt.ZH)((0,Vt.PT)(t))])}function Dn(e,t,n,s){let i;const a=n&&n[s],r=(0,Vt.cy)(e);if(r||(0,Vt.Kg)(e)){let n=!1;r&&(0,Ft.g8)(e)&&(n=!(0,Ft.fE)(e),e=(0,Ft.qA)(e)),i=new Array(e.length);for(let s=0,r=e.length;s<r;s++)i[s]=t(n?(0,Ft.lJ)(e[s]):e[s],s,void 0,a&&a[s])}else if("number"==typeof e){i=new Array(e);for(let n=0;n<e;n++)i[n]=t(n+1,n,void 0,a&&a[n])}else if((0,Vt.Gv)(e))if(e[Symbol.iterator])i=Array.from(e,((e,n)=>t(e,n,void 0,a&&a[n])));else{const n=Object.keys(e);i=new Array(n.length);for(let s=0,r=n.length;s<r;s++){const r=n[s];i[s]=t(e[r],r,s,a&&a[s])}}else i=[];return n&&(n[s]=i),i}const Un=e=>e?_i(e)?Ti(e):Un(e.parent):null,jn=(0,Vt.X$)(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Un(e.parent),$root:e=>Un(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>Gn(e),$forceUpdate:e=>e.f||(e.f=()=>{Qt(e.update)}),$nextTick:e=>e.n||(e.n=Zt.bind(e.proxy)),$watch:e=>Os.bind(e)}),Fn=(e,t)=>e!==Vt.MZ&&!e.__isScriptSetup&&(0,Vt.$3)(e,t),Vn={get({_:e},t){if("__v_skip"===t)return!0;const{ctx:n,setupState:s,data:i,props:a,accessCache:r,type:o,appContext:l}=e;let c;if("$"!==t[0]){const o=r[t];if(void 0!==o)switch(o){case 1:return s[t];case 2:return i[t];case 4:return n[t];case 3:return a[t]}else{if(Fn(s,t))return r[t]=1,s[t];if(i!==Vt.MZ&&(0,Vt.$3)(i,t))return r[t]=2,i[t];if((c=e.propsOptions[0])&&(0,Vt.$3)(c,t))return r[t]=3,a[t];if(n!==Vt.MZ&&(0,Vt.$3)(n,t))return r[t]=4,n[t];Hn&&(r[t]=0)}}const u=jn[t];let h,p;return u?("$attrs"===t&&(0,Ft.u4)(e.attrs,"get",""),u(e)):(h=o.__cssModules)&&(h=h[t])?h:n!==Vt.MZ&&(0,Vt.$3)(n,t)?(r[t]=4,n[t]):(p=l.config.globalProperties,(0,Vt.$3)(p,t)?p[t]:void 0)},set({_:e},t,n){const{data:s,setupState:i,ctx:a}=e;return Fn(i,t)?(i[t]=n,!0):s!==Vt.MZ&&(0,Vt.$3)(s,t)?(s[t]=n,!0):!((0,Vt.$3)(e.props,t)||"$"===t[0]&&t.slice(1)in e||(a[t]=n,0))},has({_:{data:e,setupState:t,accessCache:n,ctx:s,appContext:i,propsOptions:a}},r){let o;return!!n[r]||e!==Vt.MZ&&(0,Vt.$3)(e,r)||Fn(t,r)||(o=a[0])&&(0,Vt.$3)(o,r)||(0,Vt.$3)(s,r)||(0,Vt.$3)(jn,r)||(0,Vt.$3)(i.config.globalProperties,r)},defineProperty(e,t,n){return null!=n.get?e._.accessCache[t]=0:(0,Vt.$3)(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};function zn(e){return(0,Vt.cy)(e)?e.reduce(((e,t)=>(e[t]=null,e)),{}):e}let Hn=!0;function Bn(e,t,n){Ht((0,Vt.cy)(e)?e.map((e=>e.bind(t.proxy))):e.bind(t.proxy),t,n)}function Wn(e,t,n,s){let i=s.includes(".")?Cs(n,s):()=>n[s];if((0,Vt.Kg)(e)){const n=t[e];(0,Vt.Tn)(n)&&$s(i,n)}else if((0,Vt.Tn)(e))$s(i,e.bind(n));else if((0,Vt.Gv)(e))if((0,Vt.cy)(e))e.forEach((e=>Wn(e,t,n,s)));else{const s=(0,Vt.Tn)(e.handler)?e.handler.bind(n):t[e.handler];(0,Vt.Tn)(s)&&$s(i,s,e)}}function Gn(e){const t=e.type,{mixins:n,extends:s}=t,{mixins:i,optionsCache:a,config:{optionMergeStrategies:r}}=e.appContext,o=a.get(t);let l;return o?l=o:i.length||n||s?(l={},i.length&&i.forEach((e=>Kn(l,e,r,!0))),Kn(l,t,r)):l=t,(0,Vt.Gv)(t)&&a.set(t,l),l}function Kn(e,t,n,s=!1){const{mixins:i,extends:a}=t;a&&Kn(e,a,n,!0),i&&i.forEach((t=>Kn(e,t,n,!0)));for(const i in t)if(s&&"expose"===i);else{const s=qn[i]||n&&n[i];e[i]=s?s(e[i],t[i]):t[i]}return e}const qn={data:Xn,props:Qn,emits:Qn,methods:Zn,computed:Zn,beforeCreate:Jn,created:Jn,beforeMount:Jn,mounted:Jn,beforeUpdate:Jn,updated:Jn,beforeDestroy:Jn,beforeUnmount:Jn,destroyed:Jn,unmounted:Jn,activated:Jn,deactivated:Jn,errorCaptured:Jn,serverPrefetch:Jn,components:Zn,directives:Zn,watch:function(e,t){if(!e)return t;if(!t)return e;const n=(0,Vt.X$)(Object.create(null),e);for(const s in t)n[s]=Jn(e[s],t[s]);return n},provide:Xn,inject:function(e,t){return Zn(Yn(e),Yn(t))}};function Xn(e,t){return t?e?function(){return(0,Vt.X$)((0,Vt.Tn)(e)?e.call(this,this):e,(0,Vt.Tn)(t)?t.call(this,this):t)}:t:e}function Yn(e){if((0,Vt.cy)(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Jn(e,t){return e?[...new Set([].concat(e,t))]:t}function Zn(e,t){return e?(0,Vt.X$)(Object.create(null),e,t):t}function Qn(e,t){return e?(0,Vt.cy)(e)&&(0,Vt.cy)(t)?[...new Set([...e,...t])]:(0,Vt.X$)(Object.create(null),zn(e),zn(null!=t?t:{})):t}function es(){return{app:null,config:{isNativeTag:Vt.NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ts=0;function ns(e,t){return function(n,s=null){(0,Vt.Tn)(n)||(n=(0,Vt.X$)({},n)),null==s||(0,Vt.Gv)(s)||(s=null);const i=es(),a=new WeakSet,r=[];let o=!1;const l=i.app={_uid:ts++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:Ni,get config(){return i.config},set config(e){},use:(e,...t)=>(a.has(e)||(e&&(0,Vt.Tn)(e.install)?(a.add(e),e.install(l,...t)):(0,Vt.Tn)(e)&&(a.add(e),e(l,...t))),l),mixin:e=>(i.mixins.includes(e)||i.mixins.push(e),l),component:(e,t)=>t?(i.components[e]=t,l):i.components[e],directive:(e,t)=>t?(i.directives[e]=t,l):i.directives[e],mount(a,r,c){if(!o){const u=l._ceVNode||ii(n,s);return u.appContext=i,!0===c?c="svg":!1===c&&(c=void 0),r&&t?t(u,a):e(u,a,c),o=!0,l._container=a,a.__vue_app__=l,Ti(u.component)}},onUnmount(e){r.push(e)},unmount(){o&&(Ht(r,l._instance,16),e(null,l._container),delete l._container.__vue_app__)},provide:(e,t)=>(i.provides[e]=t,l),runWithContext(e){const t=ss;ss=l;try{return e()}finally{ss=t}}};return l}}let ss=null;function is(e,t,n=!1){const s=gi||rn;if(s||ss){const i=ss?ss._context.provides:s?null==s.parent?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:void 0;if(i&&e in i)return i[e];if(arguments.length>1)return n&&(0,Vt.Tn)(t)?t.call(s&&s.proxy):t}}const as={},rs=()=>Object.create(as),os=e=>Object.getPrototypeOf(e)===as;function ls(e,t,n,s){const[i,a]=e.propsOptions;let r,o=!1;if(t)for(let l in t){if((0,Vt.SU)(l))continue;const c=t[l];let u;i&&(0,Vt.$3)(i,u=(0,Vt.PT)(l))?a&&a.includes(u)?(r||(r={}))[u]=c:n[u]=c:Rs(e.emitsOptions,l)||l in s&&c===s[l]||(s[l]=c,o=!0)}if(a){const t=(0,Ft.ux)(n),s=r||Vt.MZ;for(let r=0;r<a.length;r++){const o=a[r];n[o]=cs(i,t,o,s[o],e,!(0,Vt.$3)(s,o))}}return o}function cs(e,t,n,s,i,a){const r=e[n];if(null!=r){const e=(0,Vt.$3)(r,"default");if(e&&void 0===s){const e=r.default;if(r.type!==Function&&!r.skipFactory&&(0,Vt.Tn)(e)){const{propsDefaults:a}=i;if(n in a)s=a[n];else{const r=vi(i);s=a[n]=e.call(null,t),r()}}else s=e;i.ce&&i.ce._setProp(n,s)}r[0]&&(a&&!e?s=!1:!r[1]||""!==s&&s!==(0,Vt.Tg)(n)||(s=!0))}return s}const us=new WeakMap;function hs(e,t,n=!1){const s=n?us:t.propsCache,i=s.get(e);if(i)return i;const a=e.props,r={},o=[];let l=!1;if(!(0,Vt.Tn)(e)){const s=e=>{l=!0;const[n,s]=hs(e,t,!0);(0,Vt.X$)(r,n),s&&o.push(...s)};!n&&t.mixins.length&&t.mixins.forEach(s),e.extends&&s(e.extends),e.mixins&&e.mixins.forEach(s)}if(!a&&!l)return(0,Vt.Gv)(e)&&s.set(e,Vt.Oj),Vt.Oj;if((0,Vt.cy)(a))for(let e=0;e<a.length;e++){const t=(0,Vt.PT)(a[e]);ps(t)&&(r[t]=Vt.MZ)}else if(a)for(const e in a){const t=(0,Vt.PT)(e);if(ps(t)){const n=a[e],s=r[t]=(0,Vt.cy)(n)||(0,Vt.Tn)(n)?{type:n}:(0,Vt.X$)({},n),i=s.type;let l=!1,c=!0;if((0,Vt.cy)(i))for(let e=0;e<i.length;++e){const t=i[e],n=(0,Vt.Tn)(t)&&t.name;if("Boolean"===n){l=!0;break}"String"===n&&(c=!1)}else l=(0,Vt.Tn)(i)&&"Boolean"===i.name;s[0]=l,s[1]=c,(l||(0,Vt.$3)(s,"default"))&&o.push(t)}}const c=[r,o];return(0,Vt.Gv)(e)&&s.set(e,c),c}function ps(e){return"$"!==e[0]&&!(0,Vt.SU)(e)}const ms=e=>"_"===e[0]||"$stable"===e,ds=e=>(0,Vt.cy)(e)?e.map(ci):[ci(e)],gs=(e,t,n)=>{if(t._n)return t;const s=function(e,t=rn){if(!t)return e;if(e._n)return e;const n=(...s)=>{n._d&&Xs(-1);const i=ln(t);let a;try{a=e(...s)}finally{ln(i),n._d&&Xs(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}(((...e)=>ds(t(...e))),n);return s._c=!1,s},fs=(e,t,n)=>{const s=e._ctx;for(const n in e){if(ms(n))continue;const i=e[n];if((0,Vt.Tn)(i))t[n]=gs(0,i,s);else if(null!=i){const e=ds(i);t[n]=()=>e}}},ys=(e,t)=>{const n=ds(t);e.slots.default=()=>n},vs=(e,t,n)=>{for(const s in t)(n||"_"!==s)&&(e[s]=t[s])},bs=function(e,t){t&&t.pendingBranch?(0,Vt.cy)(e)?t.effects.push(...e):t.effects.push(e):(n=e,(0,Vt.cy)(n)?Kt.push(...n):qt&&-1===n.id?qt.splice(Xt+1,0,n):1&n.flags||(Kt.push(n),n.flags|=1),en());var n};function _s(e,t){"boolean"!=typeof __VUE_PROD_HYDRATION_MISMATCH_DETAILS__&&((0,Vt.We)().__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1),(0,Vt.We)().__VUE__=!0;const{insert:n,remove:s,patchProp:i,createElement:a,createText:r,createComment:o,setText:l,setElementText:c,parentNode:u,nextSibling:h,setScopeId:p=Vt.tE,insertStaticContent:m}=e,d=(e,t,n,s=null,i=null,a=null,r=void 0,o=null,l=!!t.dynamicChildren)=>{if(e===t)return;e&&!ei(e,t)&&(s=F(e),R(e,i,a,!0),e=null),-2===t.patchFlag&&(l=!1,t.dynamicChildren=null);const{type:c,ref:u,shapeFlag:h}=t;switch(c){case zs:g(e,t,n,s);break;case Hs:f(e,t,n,s);break;case Bs:null==e&&y(t,n,s,r);break;case Vs:I(e,t,n,s,i,a,r,o,l);break;default:1&h?v(e,t,n,s,i,a,r,o,l):6&h?x(e,t,n,s,i,a,r,o,l):(64&h||128&h)&&c.process(e,t,n,s,i,a,r,o,l,H)}null!=u&&i&&dn(u,e&&e.ref,a,t||e,!t)},g=(e,t,s,i)=>{if(null==e)n(t.el=r(t.children),s,i);else{const n=t.el=e.el;t.children!==e.children&&l(n,t.children)}},f=(e,t,s,i)=>{null==e?n(t.el=o(t.children||""),s,i):t.el=e.el},y=(e,t,n,s)=>{[e.el,e.anchor]=m(e.children,t,n,s,e.el,e.anchor)},v=(e,t,n,s,i,a,r,o,l)=>{"svg"===t.type?r="svg":"math"===t.type&&(r="mathml"),null==e?b(t,n,s,i,a,r,o,l):S(e,t,i,a,r,o,l)},b=(e,t,s,r,o,l,u,h)=>{let p,m;const{props:d,shapeFlag:g,transition:f,dirs:y}=e;if(p=e.el=a(e.type,l,d&&d.is,d),8&g?c(p,e.children):16&g&&w(e.children,p,null,r,o,ws(e,l),u,h),y&&un(e,null,r,"created"),_(p,e,e.scopeId,u,r),d){for(const e in d)"value"===e||(0,Vt.SU)(e)||i(p,e,null,d[e],l,r);"value"in d&&i(p,"value",null,d.value,l),(m=d.onVnodeBeforeMount)&&pi(m,r,e)}y&&un(e,null,r,"beforeMount");const v=function(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}(o,f);v&&f.beforeEnter(p),n(p,t,s),((m=d&&d.onVnodeMounted)||v||y)&&bs((()=>{m&&pi(m,r,e),v&&f.enter(p),y&&un(e,null,r,"mounted")}),o)},_=(e,t,n,s,i)=>{if(n&&p(e,n),s)for(let t=0;t<s.length;t++)p(e,s[t]);if(i){let n=i.subTree;if(t===n||Fs(n.type)&&(n.ssContent===t||n.ssFallback===t)){const t=i.vnode;_(e,t,t.scopeId,t.slotScopeIds,i.parent)}}},w=(e,t,n,s,i,a,r,o,l=0)=>{for(let c=l;c<e.length;c++){const l=e[c]=o?ui(e[c]):ci(e[c]);d(null,l,t,n,s,i,a,r,o)}},S=(e,t,n,s,a,r,o)=>{const l=t.el=e.el;let{patchFlag:u,dynamicChildren:h,dirs:p}=t;u|=16&e.patchFlag;const m=e.props||Vt.MZ,d=t.props||Vt.MZ;let g;if(n&&Ss(n,!1),(g=d.onVnodeBeforeUpdate)&&pi(g,n,t,e),p&&un(t,e,n,"beforeUpdate"),n&&Ss(n,!0),(m.innerHTML&&null==d.innerHTML||m.textContent&&null==d.textContent)&&c(l,""),h?E(e.dynamicChildren,h,l,n,s,ws(t,a),r):o||C(e,t,l,null,n,s,ws(t,a),r,!1),u>0){if(16&u)k(l,m,d,n,a);else if(2&u&&m.class!==d.class&&i(l,"class",null,d.class,a),4&u&&i(l,"style",m.style,d.style,a),8&u){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const s=e[t],r=m[s],o=d[s];o===r&&"value"!==s||i(l,s,r,o,a,n)}}1&u&&e.children!==t.children&&c(l,t.children)}else o||null!=h||k(l,m,d,n,a);((g=d.onVnodeUpdated)||p)&&bs((()=>{g&&pi(g,n,t,e),p&&un(t,e,n,"updated")}),s)},E=(e,t,n,s,i,a,r)=>{for(let o=0;o<t.length;o++){const l=e[o],c=t[o],h=l.el&&(l.type===Vs||!ei(l,c)||70&l.shapeFlag)?u(l.el):n;d(l,c,h,null,s,i,a,r,!0)}},k=(e,t,n,s,a)=>{if(t!==n){if(t!==Vt.MZ)for(const r in t)(0,Vt.SU)(r)||r in n||i(e,r,t[r],null,a,s);for(const r in n){if((0,Vt.SU)(r))continue;const o=n[r],l=t[r];o!==l&&"value"!==r&&i(e,r,l,o,a,s)}"value"in n&&i(e,"value",t.value,n.value,a)}},I=(e,t,s,i,a,o,l,c,u)=>{const h=t.el=e?e.el:r(""),p=t.anchor=e?e.anchor:r("");let{patchFlag:m,dynamicChildren:d,slotScopeIds:g}=t;g&&(c=c?c.concat(g):g),null==e?(n(h,s,i),n(p,s,i),w(t.children||[],s,p,a,o,l,c,u)):m>0&&64&m&&d&&e.dynamicChildren?(E(e.dynamicChildren,d,s,a,o,l,c),(null!=t.key||a&&t===a.subTree)&&Es(e,t,!0)):C(e,t,s,p,a,o,l,c,u)},x=(e,t,n,s,i,a,r,o,l)=>{t.slotScopeIds=o,null==e?512&t.shapeFlag?i.ctx.activate(t,n,s,r,l):T(t,n,s,i,a,r,l):$(e,t,l)},T=(e,t,n,s,i,a,r)=>{const o=e.component=function(e,t,n){const s=e.type,i=(t?t.appContext:e.appContext)||mi,a={uid:di++,vnode:e,type:s,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new Ft.yC(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:hs(s,i),emitsOptions:Ps(s,i),emit:null,emitted:null,propsDefaults:Vt.MZ,inheritAttrs:s.inheritAttrs,ctx:Vt.MZ,data:Vt.MZ,props:Vt.MZ,attrs:Vt.MZ,slots:Vt.MZ,refs:Vt.MZ,setupState:Vt.MZ,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=As.bind(null,a),e.ce&&e.ce(a),a}(e,s,i);if(fn(e)&&(o.ctx.renderer=H),function(e,t=!1,n=!1){t&&yi(t);const{props:s,children:i}=e.vnode,a=_i(e);!function(e,t,n,s=!1){const i={},a=rs();e.propsDefaults=Object.create(null),ls(e,t,i,a);for(const t in e.propsOptions[0])t in i||(i[t]=void 0);n?e.props=s?i:(0,Ft.Gc)(i):e.type.props?e.props=i:e.props=a,e.attrs=a}(e,s,a,t),((e,t,n)=>{const s=e.slots=rs();if(32&e.vnode.shapeFlag){const e=t._;e?(vs(s,t,n),n&&(0,Vt.yQ)(s,"_",e,!0)):fs(t,s)}else t&&ys(e,t)})(e,i,n);const r=a?function(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Vn);const{setup:s}=n;if(s){(0,Ft.C4)();const n=e.setupContext=s.length>1?function(e){const t=t=>{e.exposed=t||{}};return{attrs:new Proxy(e.attrs,xi),slots:e.slots,emit:e.emit,expose:t}}(e):null,i=vi(e),a=zt(s,e,0,[e.props,n]),r=(0,Vt.yL)(a);if((0,Ft.bl)(),i(),!r&&!e.sp||gn(e)||mn(e),r){if(a.then(bi,bi),t)return a.then((n=>{ki(e,n,t)})).catch((t=>{Bt(t,e,0)}));e.asyncDep=a}else ki(e,a,t)}else Ii(e,t)}(e,t):void 0;t&&yi(!1)}(o,!1,r),o.asyncDep){if(i&&i.registerDep(o,N,r),!e.el){const e=o.subTree=ii(Hs);f(null,e,t,n)}}else N(o,e,t,n,i,a,r)},$=(e,t,n)=>{const s=t.component=e.component;if(function(e,t,n){const{props:s,children:i,component:a}=e,{props:r,children:o,patchFlag:l}=t,c=a.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&l>=0))return!(!i&&!o||o&&o.$stable)||s!==r&&(s?!r||js(s,r,c):!!r);if(1024&l)return!0;if(16&l)return s?js(s,r,c):!!r;if(8&l){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(r[n]!==s[n]&&!Rs(c,n))return!0}}return!1}(e,t,n)){if(s.asyncDep&&!s.asyncResolved)return void O(s,t,n);s.next=t,s.update()}else t.el=e.el,s.vnode=t},N=(e,t,n,s,i,a,r)=>{const o=()=>{if(e.isMounted){let{next:t,bu:n,u:s,parent:l,vnode:c}=e;{const n=ks(e);if(n)return t&&(t.el=c.el,O(e,t,r)),void n.asyncDep.then((()=>{e.isUnmounted||o()}))}let h,p=t;Ss(e,!1),t?(t.el=c.el,O(e,t,r)):t=c,n&&(0,Vt.DY)(n),(h=t.props&&t.props.onVnodeBeforeUpdate)&&pi(h,l,t,c),Ss(e,!0);const m=Ms(e),g=e.subTree;e.subTree=m,d(g,m,u(g.el),F(g),e,i,a),t.el=m.el,null===p&&function({vnode:e,parent:t},n){for(;t;){const s=t.subTree;if(s.suspense&&s.suspense.activeBranch===e&&(s.el=e.el),s!==e)break;(e=t.vnode).el=n,t=t.parent}}(e,m.el),s&&bs(s,i),(h=t.props&&t.props.onVnodeUpdated)&&bs((()=>pi(h,l,t,c)),i)}else{let r;const{el:o,props:l}=t,{bm:c,m:u,parent:h,root:p,type:m}=e,g=gn(t);if(Ss(e,!1),c&&(0,Vt.DY)(c),!g&&(r=l&&l.onVnodeBeforeMount)&&pi(r,h,t),Ss(e,!0),o&&W){const t=()=>{e.subTree=Ms(e),W(o,e.subTree,e,i,null)};g&&m.__asyncHydrate?m.__asyncHydrate(o,e,t):t()}else{p.ce&&p.ce._injectChildStyle(m);const r=e.subTree=Ms(e);d(null,r,n,s,e,i,a),t.el=r.el}if(u&&bs(u,i),!g&&(r=l&&l.onVnodeMounted)){const e=t;bs((()=>pi(r,h,e)),i)}(256&t.shapeFlag||h&&gn(h.vnode)&&256&h.vnode.shapeFlag)&&e.a&&bs(e.a,i),e.isMounted=!0,t=n=s=null}};e.scope.on();const l=e.effect=new Ft.X2(o);e.scope.off();const c=e.update=l.run.bind(l),h=e.job=l.runIfDirty.bind(l);h.i=e,h.id=e.uid,l.scheduler=()=>Qt(h),Ss(e,!0),c()},O=(e,t,n)=>{t.component=e;const s=e.vnode.props;e.vnode=t,e.next=null,function(e,t,n,s){const{props:i,attrs:a,vnode:{patchFlag:r}}=e,o=(0,Ft.ux)(i),[l]=e.propsOptions;let c=!1;if(!(s||r>0)||16&r){let s;ls(e,t,i,a)&&(c=!0);for(const a in o)t&&((0,Vt.$3)(t,a)||(s=(0,Vt.Tg)(a))!==a&&(0,Vt.$3)(t,s))||(l?!n||void 0===n[a]&&void 0===n[s]||(i[a]=cs(l,o,a,void 0,e,!0)):delete i[a]);if(a!==o)for(const e in a)t&&(0,Vt.$3)(t,e)||(delete a[e],c=!0)}else if(8&r){const n=e.vnode.dynamicProps;for(let s=0;s<n.length;s++){let r=n[s];if(Rs(e.emitsOptions,r))continue;const u=t[r];if(l)if((0,Vt.$3)(a,r))u!==a[r]&&(a[r]=u,c=!0);else{const t=(0,Vt.PT)(r);i[t]=cs(l,o,t,u,e,!1)}else u!==a[r]&&(a[r]=u,c=!0)}}c&&(0,Ft.hZ)(e.attrs,"set","")}(e,t.props,s,n),((e,t,n)=>{const{vnode:s,slots:i}=e;let a=!0,r=Vt.MZ;if(32&s.shapeFlag){const e=t._;e?n&&1===e?a=!1:vs(i,t,n):(a=!t.$stable,fs(t,i)),r=t}else t&&(ys(e,t),r={default:1});if(a)for(const e in i)ms(e)||null!=r[e]||delete i[e]})(e,t.children,n),(0,Ft.C4)(),tn(e),(0,Ft.bl)()},C=(e,t,n,s,i,a,r,o,l=!1)=>{const u=e&&e.children,h=e?e.shapeFlag:0,p=t.children,{patchFlag:m,shapeFlag:d}=t;if(m>0){if(128&m)return void A(u,p,n,s,i,a,r,o,l);if(256&m)return void L(u,p,n,s,i,a,r,o,l)}8&d?(16&h&&j(u,i,a),p!==u&&c(n,p)):16&h?16&d?A(u,p,n,s,i,a,r,o,l):j(u,i,a,!0):(8&h&&c(n,""),16&d&&w(p,n,s,i,a,r,o,l))},L=(e,t,n,s,i,a,r,o,l)=>{e=e||Vt.Oj,t=t||Vt.Oj;const c=e.length,u=t.length,h=Math.min(c,u);let p;for(p=0;p<h;p++){const s=t[p]=l?ui(t[p]):ci(t[p]);d(e[p],s,n,null,i,a,r,o,l)}c>u?j(e,i,a,!0,!1,h):w(t,n,s,i,a,r,o,l,h)},A=(e,t,n,s,i,a,r,o,l)=>{let c=0;const u=t.length;let h=e.length-1,p=u-1;for(;c<=h&&c<=p;){const s=e[c],u=t[c]=l?ui(t[c]):ci(t[c]);if(!ei(s,u))break;d(s,u,n,null,i,a,r,o,l),c++}for(;c<=h&&c<=p;){const s=e[h],c=t[p]=l?ui(t[p]):ci(t[p]);if(!ei(s,c))break;d(s,c,n,null,i,a,r,o,l),h--,p--}if(c>h){if(c<=p){const e=p+1,h=e<u?t[e].el:s;for(;c<=p;)d(null,t[c]=l?ui(t[c]):ci(t[c]),n,h,i,a,r,o,l),c++}}else if(c>p)for(;c<=h;)R(e[c],i,a,!0),c++;else{const m=c,g=c,f=new Map;for(c=g;c<=p;c++){const e=t[c]=l?ui(t[c]):ci(t[c]);null!=e.key&&f.set(e.key,c)}let y,v=0;const b=p-g+1;let _=!1,w=0;const S=new Array(b);for(c=0;c<b;c++)S[c]=0;for(c=m;c<=h;c++){const s=e[c];if(v>=b){R(s,i,a,!0);continue}let u;if(null!=s.key)u=f.get(s.key);else for(y=g;y<=p;y++)if(0===S[y-g]&&ei(s,t[y])){u=y;break}void 0===u?R(s,i,a,!0):(S[u-g]=c+1,u>=w?w=u:_=!0,d(s,t[u],n,null,i,a,r,o,l),v++)}const E=_?function(e){const t=e.slice(),n=[0];let s,i,a,r,o;const l=e.length;for(s=0;s<l;s++){const l=e[s];if(0!==l){if(i=n[n.length-1],e[i]<l){t[s]=i,n.push(s);continue}for(a=0,r=n.length-1;a<r;)o=a+r>>1,e[n[o]]<l?a=o+1:r=o;l<e[n[a]]&&(a>0&&(t[s]=n[a-1]),n[a]=s)}}for(a=n.length,r=n[a-1];a-- >0;)n[a]=r,r=t[r];return n}(S):Vt.Oj;for(y=E.length-1,c=b-1;c>=0;c--){const e=g+c,h=t[e],p=e+1<u?t[e+1].el:s;0===S[c]?d(null,h,n,p,i,a,r,o,l):_&&(y<0||c!==E[y]?P(h,n,p,2):y--)}}},P=(e,t,s,i,a=null)=>{const{el:r,type:o,transition:l,children:c,shapeFlag:u}=e;if(6&u)P(e.component.subTree,t,s,i);else if(128&u)e.suspense.move(t,s,i);else if(64&u)o.move(e,t,s,H);else if(o!==Vs)if(o!==Bs)if(2!==i&&1&u&&l)if(0===i)l.beforeEnter(r),n(r,t,s),bs((()=>l.enter(r)),a);else{const{leave:e,delayLeave:i,afterLeave:a}=l,o=()=>n(r,t,s),c=()=>{e(r,(()=>{o(),a&&a()}))};i?i(r,o,c):c()}else n(r,t,s);else(({el:e,anchor:t},s,i)=>{let a;for(;e&&e!==t;)a=h(e),n(e,s,i),e=a;n(t,s,i)})(e,t,s);else{n(r,t,s);for(let e=0;e<c.length;e++)P(c[e],t,s,i);n(e.anchor,t,s)}},R=(e,t,n,s=!1,i=!1)=>{const{type:a,props:r,ref:o,children:l,dynamicChildren:c,shapeFlag:u,patchFlag:h,dirs:p,cacheIndex:m}=e;if(-2===h&&(i=!1),null!=o&&dn(o,null,n,e,!0),null!=m&&(t.renderCache[m]=void 0),256&u)return void t.ctx.deactivate(e);const d=1&u&&p,g=!gn(e);let f;if(g&&(f=r&&r.onVnodeBeforeUnmount)&&pi(f,t,e),6&u)U(e.component,n,s);else{if(128&u)return void e.suspense.unmount(n,s);d&&un(e,null,t,"beforeUnmount"),64&u?e.type.remove(e,t,n,H,s):c&&!c.hasOnce&&(a!==Vs||h>0&&64&h)?j(c,t,n,!1,!0):(a===Vs&&384&h||!i&&16&u)&&j(l,t,n),s&&M(e)}(g&&(f=r&&r.onVnodeUnmounted)||d)&&bs((()=>{f&&pi(f,t,e),d&&un(e,null,t,"unmounted")}),n)},M=e=>{const{type:t,el:n,anchor:i,transition:a}=e;if(t===Vs)return void D(n,i);if(t===Bs)return void(({el:e,anchor:t})=>{let n;for(;e&&e!==t;)n=h(e),s(e),e=n;s(t)})(e);const r=()=>{s(n),a&&!a.persisted&&a.afterLeave&&a.afterLeave()};if(1&e.shapeFlag&&a&&!a.persisted){const{leave:t,delayLeave:s}=a,i=()=>t(n,r);s?s(e.el,r,i):i()}else r()},D=(e,t)=>{let n;for(;e!==t;)n=h(e),s(e),e=n;s(t)},U=(e,t,n)=>{const{bum:s,scope:i,job:a,subTree:r,um:o,m:l,a:c}=e;Is(l),Is(c),s&&(0,Vt.DY)(s),i.stop(),a&&(a.flags|=8,R(r,e,t,n)),o&&bs(o,t),bs((()=>{e.isUnmounted=!0}),t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve())},j=(e,t,n,s=!1,i=!1,a=0)=>{for(let r=a;r<e.length;r++)R(e[r],t,n,s,i)},F=e=>{if(6&e.shapeFlag)return F(e.component.subTree);if(128&e.shapeFlag)return e.suspense.next();const t=h(e.anchor||e.el),n=t&&t[hn];return n?h(n):t};let V=!1;const z=(e,t,n)=>{null==e?t._vnode&&R(t._vnode,null,null,!0):d(t._vnode||null,e,t,null,null,null,n),t._vnode=e,V||(V=!0,tn(),nn(),V=!1)},H={p:d,um:R,m:P,r:M,mt:T,mc:w,pc:C,pbc:E,n:F,o:e};let B,W;return t&&([B,W]=t(H)),{render:z,hydrate:B,createApp:ns(z,B)}}function ws({type:e,props:t},n){return"svg"===n&&"foreignObject"===e||"mathml"===n&&"annotation-xml"===e&&t&&t.encoding&&t.encoding.includes("html")?void 0:n}function Ss({effect:e,job:t},n){n?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function Es(e,t,n=!1){const s=e.children,i=t.children;if((0,Vt.cy)(s)&&(0,Vt.cy)(i))for(let e=0;e<s.length;e++){const t=s[e];let a=i[e];1&a.shapeFlag&&!a.dynamicChildren&&((a.patchFlag<=0||32===a.patchFlag)&&(a=i[e]=ui(i[e]),a.el=t.el),n||-2===a.patchFlag||Es(t,a)),a.type===zs&&(a.el=t.el)}}function ks(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:ks(t)}function Is(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const xs=Symbol.for("v-scx"),Ts=()=>is(xs);function $s(e,t,n){return Ns(e,t,n)}function Ns(e,t,n=Vt.MZ){const{immediate:s,deep:i,flush:a,once:r}=n,o=(0,Vt.X$)({},n),l=t&&s||!t&&"post"!==a;let c;if(Ei)if("sync"===a){const e=Ts();c=e.__watcherHandles||(e.__watcherHandles=[])}else if(!l){const e=()=>{};return e.stop=Vt.tE,e.resume=Vt.tE,e.pause=Vt.tE,e}const u=gi;o.call=(e,t,n)=>Ht(e,u,t,n);let h=!1;"post"===a?o.scheduler=e=>{bs(e,u&&u.suspense)}:"sync"!==a&&(h=!0,o.scheduler=(e,t)=>{t?e():Qt(e)}),o.augmentJob=e=>{t&&(e.flags|=4),h&&(e.flags|=2,u&&(e.id=u.uid,e.i=u))};const p=(0,Ft.wB)(e,t,o);return Ei&&(c?c.push(p):l&&p()),p}function Os(e,t,n){const s=this.proxy,i=(0,Vt.Kg)(e)?e.includes(".")?Cs(s,e):()=>s[e]:e.bind(s,s);let a;(0,Vt.Tn)(t)?a=t:(a=t.handler,n=t);const r=vi(this),o=Ns(i,a.bind(s),n);return r(),o}function Cs(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}const Ls=(e,t)=>"modelValue"===t||"model-value"===t?e.modelModifiers:e[`${t}Modifiers`]||e[`${(0,Vt.PT)(t)}Modifiers`]||e[`${(0,Vt.Tg)(t)}Modifiers`];function As(e,t,...n){if(e.isUnmounted)return;const s=e.vnode.props||Vt.MZ;let i=n;const a=t.startsWith("update:"),r=a&&Ls(s,t.slice(7));let o;r&&(r.trim&&(i=n.map((e=>(0,Vt.Kg)(e)?e.trim():e))),r.number&&(i=n.map(Vt.bB)));let l=s[o=(0,Vt.rU)(t)]||s[o=(0,Vt.rU)((0,Vt.PT)(t))];!l&&a&&(l=s[o=(0,Vt.rU)((0,Vt.Tg)(t))]),l&&Ht(l,e,6,i);const c=s[o+"Once"];if(c){if(e.emitted){if(e.emitted[o])return}else e.emitted={};e.emitted[o]=!0,Ht(c,e,6,i)}}function Ps(e,t,n=!1){const s=t.emitsCache,i=s.get(e);if(void 0!==i)return i;const a=e.emits;let r={},o=!1;if(!(0,Vt.Tn)(e)){const s=e=>{const n=Ps(e,t,!0);n&&(o=!0,(0,Vt.X$)(r,n))};!n&&t.mixins.length&&t.mixins.forEach(s),e.extends&&s(e.extends),e.mixins&&e.mixins.forEach(s)}return a||o?((0,Vt.cy)(a)?a.forEach((e=>r[e]=null)):(0,Vt.X$)(r,a),(0,Vt.Gv)(e)&&s.set(e,r),r):((0,Vt.Gv)(e)&&s.set(e,null),null)}function Rs(e,t){return!(!e||!(0,Vt.Mp)(t))&&(t=t.slice(2).replace(/Once$/,""),(0,Vt.$3)(e,t[0].toLowerCase()+t.slice(1))||(0,Vt.$3)(e,(0,Vt.Tg)(t))||(0,Vt.$3)(e,t))}function Ms(e){const{type:t,vnode:n,proxy:s,withProxy:i,propsOptions:[a],slots:r,attrs:o,emit:l,render:c,renderCache:u,props:h,data:p,setupState:m,ctx:d,inheritAttrs:g}=e,f=ln(e);let y,v;try{if(4&n.shapeFlag){const e=i||s,t=e;y=ci(c.call(t,e,u,h,m,p,d)),v=o}else{const e=t;y=ci(e.length>1?e(h,{attrs:o,slots:r,emit:l}):e(h,null)),v=t.props?o:Ds(o)}}catch(t){Ws.length=0,Bt(t,e,1),y=ii(Hs)}let b=y;if(v&&!1!==g){const e=Object.keys(v),{shapeFlag:t}=b;e.length&&7&t&&(a&&e.some(Vt.CP)&&(v=Us(v,a)),b=ai(b,v,!1,!0))}return n.dirs&&(b=ai(b,null,!1,!0),b.dirs=b.dirs?b.dirs.concat(n.dirs):n.dirs),n.transition&&pn(b,n.transition),y=b,ln(f),y}const Ds=e=>{let t;for(const n in e)("class"===n||"style"===n||(0,Vt.Mp)(n))&&((t||(t={}))[n]=e[n]);return t},Us=(e,t)=>{const n={};for(const s in e)(0,Vt.CP)(s)&&s.slice(9)in t||(n[s]=e[s]);return n};function js(e,t,n){const s=Object.keys(t);if(s.length!==Object.keys(e).length)return!0;for(let i=0;i<s.length;i++){const a=s[i];if(t[a]!==e[a]&&!Rs(n,a))return!0}return!1}const Fs=e=>e.__isSuspense;const Vs=Symbol.for("v-fgt"),zs=Symbol.for("v-txt"),Hs=Symbol.for("v-cmt"),Bs=Symbol.for("v-stc"),Ws=[];let Gs=null;function Ks(e=!1){Ws.push(Gs=e?null:[])}let qs=1;function Xs(e,t=!1){qs+=e,e<0&&Gs&&t&&(Gs.hasOnce=!0)}function Ys(e){return e.dynamicChildren=qs>0?Gs||Vt.Oj:null,Ws.pop(),Gs=Ws[Ws.length-1]||null,qs>0&&Gs&&Gs.push(e),e}function Js(e,t,n,s,i,a){return Ys(si(e,t,n,s,i,a,!0))}function Zs(e,t,n,s,i){return Ys(ii(e,t,n,s,i,!0))}function Qs(e){return!!e&&!0===e.__v_isVNode}function ei(e,t){return e.type===t.type&&e.key===t.key}const ti=({key:e})=>null!=e?e:null,ni=({ref:e,ref_key:t,ref_for:n})=>("number"==typeof e&&(e=""+e),null!=e?(0,Vt.Kg)(e)||(0,Ft.i9)(e)||(0,Vt.Tn)(e)?{i:rn,r:e,k:t,f:!!n}:e:null);function si(e,t=null,n=null,s=0,i=null,a=(e===Vs?0:1),r=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&ti(t),ref:t&&ni(t),scopeId:on,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:s,dynamicProps:i,dynamicChildren:null,appContext:null,ctx:rn};return o?(hi(l,n),128&a&&e.normalize(l)):n&&(l.shapeFlag|=(0,Vt.Kg)(n)?8:16),qs>0&&!r&&Gs&&(l.patchFlag>0||6&a)&&32!==l.patchFlag&&Gs.push(l),l}const ii=function(e,t=null,n=null,s=0,i=null,a=!1){if(e&&e!==Rn||(e=Hs),Qs(e)){const s=ai(e,t,!0);return n&&hi(s,n),qs>0&&!a&&Gs&&(6&s.shapeFlag?Gs[Gs.indexOf(e)]=s:Gs.push(s)),s.patchFlag=-2,s}if(function(e){return(0,Vt.Tn)(e)&&"__vccOpts"in e}(e)&&(e=e.__vccOpts),t){t=function(e){return e?(0,Ft.ju)(e)||os(e)?(0,Vt.X$)({},e):e:null}(t);let{class:e,style:n}=t;e&&!(0,Vt.Kg)(e)&&(t.class=(0,Vt.C4)(e)),(0,Vt.Gv)(n)&&((0,Ft.ju)(n)&&!(0,Vt.cy)(n)&&(n=(0,Vt.X$)({},n)),t.style=(0,Vt.Tr)(n))}return si(e,t,n,s,i,(0,Vt.Kg)(e)?1:Fs(e)?128:(e=>e.__isTeleport)(e)?64:(0,Vt.Gv)(e)?4:(0,Vt.Tn)(e)?2:0,a,!0)};function ai(e,t,n=!1,s=!1){const{props:i,ref:a,patchFlag:r,children:o,transition:l}=e,c=t?function(...e){const t={};for(let n=0;n<e.length;n++){const s=e[n];for(const e in s)if("class"===e)t.class!==s.class&&(t.class=(0,Vt.C4)([t.class,s.class]));else if("style"===e)t.style=(0,Vt.Tr)([t.style,s.style]);else if((0,Vt.Mp)(e)){const n=t[e],i=s[e];!i||n===i||(0,Vt.cy)(n)&&n.includes(i)||(t[e]=n?[].concat(n,i):i)}else""!==e&&(t[e]=s[e])}return t}(i||{},t):i,u={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&ti(c),ref:t&&t.ref?n&&a?(0,Vt.cy)(a)?a.concat(ni(t)):[a,ni(t)]:ni(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:o,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Vs?-1===r?16:16|r:r,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:l,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ai(e.ssContent),ssFallback:e.ssFallback&&ai(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return l&&s&&pn(u,l.clone(u)),u}function ri(e=" ",t=0){return ii(zs,null,e,t)}function oi(e,t){const n=ii(Bs,null,e);return n.staticCount=t,n}function li(e="",t=!1){return t?(Ks(),Zs(Hs,null,e)):ii(Hs,null,e)}function ci(e){return null==e||"boolean"==typeof e?ii(Hs):(0,Vt.cy)(e)?ii(Vs,null,e.slice()):Qs(e)?ui(e):ii(zs,null,String(e))}function ui(e){return null===e.el&&-1!==e.patchFlag||e.memo?e:ai(e)}function hi(e,t){let n=0;const{shapeFlag:s}=e;if(null==t)t=null;else if((0,Vt.cy)(t))n=16;else if("object"==typeof t){if(65&s){const n=t.default;return void(n&&(n._c&&(n._d=!1),hi(e,n()),n._c&&(n._d=!0)))}{n=32;const s=t._;s||os(t)?3===s&&rn&&(1===rn.slots._?t._=1:(t._=2,e.patchFlag|=1024)):t._ctx=rn}}else(0,Vt.Tn)(t)?(t={default:t,_ctx:rn},n=32):(t=String(t),64&s?(n=16,t=[ri(t)]):n=8);e.children=t,e.shapeFlag|=n}function pi(e,t,n,s=null){Ht(e,t,7,[n,s])}const mi=es();let di=0;let gi=null;let fi,yi;{const e=(0,Vt.We)(),t=(t,n)=>{let s;return(s=e[t])||(s=e[t]=[]),s.push(n),e=>{s.length>1?s.forEach((t=>t(e))):s[0](e)}};fi=t("__VUE_INSTANCE_SETTERS__",(e=>gi=e)),yi=t("__VUE_SSR_SETTERS__",(e=>Ei=e))}const vi=e=>{const t=gi;return fi(e),e.scope.on(),()=>{e.scope.off(),fi(t)}},bi=()=>{gi&&gi.scope.off(),fi(null)};function _i(e){return 4&e.vnode.shapeFlag}let wi,Si,Ei=!1;function ki(e,t,n){(0,Vt.Tn)(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:(0,Vt.Gv)(t)&&(e.setupState=(0,Ft.Pr)(t)),Ii(e,n)}function Ii(e,t,n){const s=e.type;if(!e.render){if(!t&&wi&&!s.render){const t=s.template||Gn(e).template;if(t){const{isCustomElement:n,compilerOptions:i}=e.appContext.config,{delimiters:a,compilerOptions:r}=s,o=(0,Vt.X$)((0,Vt.X$)({isCustomElement:n,delimiters:a},i),r);s.render=wi(t,o)}}e.render=s.render||Vt.tE,Si&&Si(e)}{const t=vi(e);(0,Ft.C4)();try{!function(e){const t=Gn(e),n=e.proxy,s=e.ctx;Hn=!1,t.beforeCreate&&Bn(t.beforeCreate,e,"bc");const{data:i,computed:a,methods:r,watch:o,provide:l,inject:c,created:u,beforeMount:h,mounted:p,beforeUpdate:m,updated:d,activated:g,deactivated:f,beforeDestroy:y,beforeUnmount:v,destroyed:b,unmounted:_,render:w,renderTracked:S,renderTriggered:E,errorCaptured:k,serverPrefetch:I,expose:x,inheritAttrs:T,components:$,directives:N,filters:O}=t;if(c&&function(e,t){(0,Vt.cy)(e)&&(e=Yn(e));for(const n in e){const s=e[n];let i;i=(0,Vt.Gv)(s)?"default"in s?is(s.from||n,s.default,!0):is(s.from||n):is(s),(0,Ft.i9)(i)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:e=>i.value=e}):t[n]=i}}(c,s),r)for(const e in r){const t=r[e];(0,Vt.Tn)(t)&&(s[e]=t.bind(n))}if(i){const t=i.call(n,n);(0,Vt.Gv)(t)&&(e.data=(0,Ft.Kh)(t))}if(Hn=!0,a)for(const e in a){const t=a[e],i=(0,Vt.Tn)(t)?t.bind(n,n):(0,Vt.Tn)(t.get)?t.get.bind(n,n):Vt.tE,r=!(0,Vt.Tn)(t)&&(0,Vt.Tn)(t.set)?t.set.bind(n):Vt.tE,o=$i({get:i,set:r});Object.defineProperty(s,e,{enumerable:!0,configurable:!0,get:()=>o.value,set:e=>o.value=e})}if(o)for(const e in o)Wn(o[e],s,n,e);if(l){const e=(0,Vt.Tn)(l)?l.call(n):l;Reflect.ownKeys(e).forEach((t=>{!function(e,t){if(gi){let n=gi.provides;const s=gi.parent&&gi.parent.provides;s===n&&(n=gi.provides=Object.create(s)),n[e]=t}}(t,e[t])}))}function C(e,t){(0,Vt.cy)(t)?t.forEach((t=>e(t.bind(n)))):t&&e(t.bind(n))}if(u&&Bn(u,e,"c"),C(En,h),C(kn,p),C(In,m),C(xn,d),C(yn,g),C(vn,f),C(Ln,k),C(Cn,S),C(On,E),C(Tn,v),C($n,_),C(Nn,I),(0,Vt.cy)(x))if(x.length){const t=e.exposed||(e.exposed={});x.forEach((e=>{Object.defineProperty(t,e,{get:()=>n[e],set:t=>n[e]=t})}))}else e.exposed||(e.exposed={});w&&e.render===Vt.tE&&(e.render=w),null!=T&&(e.inheritAttrs=T),$&&(e.components=$),N&&(e.directives=N),I&&mn(e)}(e)}finally{(0,Ft.bl)(),t()}}}const xi={get:(e,t)=>((0,Ft.u4)(e,"get",""),e[t])};function Ti(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy((0,Ft.Pr)((0,Ft.IG)(e.exposed)),{get:(t,n)=>n in t?t[n]:n in jn?jn[n](e):void 0,has:(e,t)=>t in e||t in jn})):e.proxy}const $i=(e,t)=>(0,Ft.EW)(e,t,Ei),Ni="3.5.13";let Oi;const Ci="undefined"!=typeof window&&window.trustedTypes;if(Ci)try{Oi=Ci.createPolicy("vue",{createHTML:e=>e})}catch(e){}const Li=Oi?e=>Oi.createHTML(e):e=>e,Ai="undefined"!=typeof document?document:null,Pi=Ai&&Ai.createElement("template"),Ri={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,s)=>{const i="svg"===t?Ai.createElementNS("http://www.w3.org/2000/svg",e):"mathml"===t?Ai.createElementNS("http://www.w3.org/1998/Math/MathML",e):n?Ai.createElement(e,{is:n}):Ai.createElement(e);return"select"===e&&s&&null!=s.multiple&&i.setAttribute("multiple",s.multiple),i},createText:e=>Ai.createTextNode(e),createComment:e=>Ai.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ai.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,s,i,a){const r=n?n.previousSibling:t.lastChild;if(i&&(i===a||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),n),i!==a&&(i=i.nextSibling););else{Pi.innerHTML=Li("svg"===s?`<svg>${e}</svg>`:"mathml"===s?`<math>${e}</math>`:e);const i=Pi.content;if("svg"===s||"mathml"===s){const e=i.firstChild;for(;e.firstChild;)i.appendChild(e.firstChild);i.removeChild(e)}t.insertBefore(i,n)}return[r?r.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}},Mi=Symbol("_vtc");Boolean;const Di=Symbol("_vod"),Ui=Symbol("_vsh"),ji={beforeMount(e,{value:t},{transition:n}){e[Di]="none"===e.style.display?"":e.style.display,n&&t?n.beforeEnter(e):Fi(e,t)},mounted(e,{value:t},{transition:n}){n&&t&&n.enter(e)},updated(e,{value:t,oldValue:n},{transition:s}){!t!=!n&&(s?t?(s.beforeEnter(e),Fi(e,!0),s.enter(e)):s.leave(e,(()=>{Fi(e,!1)})):Fi(e,t))},beforeUnmount(e,{value:t}){Fi(e,t)}};function Fi(e,t){e.style.display=t?e[Di]:"none",e[Ui]=!t}const Vi=Symbol(""),zi=/(^|;)\s*display\s*:/,Hi=/\s*!important$/;function Bi(e,t,n){if((0,Vt.cy)(n))n.forEach((n=>Bi(e,t,n)));else if(null==n&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const s=function(e,t){const n=Gi[t];if(n)return n;let s=(0,Vt.PT)(t);if("filter"!==s&&s in e)return Gi[t]=s;s=(0,Vt.ZH)(s);for(let n=0;n<Wi.length;n++){const i=Wi[n]+s;if(i in e)return Gi[t]=i}return t}(e,t);Hi.test(n)?e.setProperty((0,Vt.Tg)(s),n.replace(Hi,""),"important"):e[s]=n}}const Wi=["Webkit","Moz","ms"],Gi={},Ki="http://www.w3.org/1999/xlink";function qi(e,t,n,s,i,a=(0,Vt.J$)(t)){s&&t.startsWith("xlink:")?null==n?e.removeAttributeNS(Ki,t.slice(6,t.length)):e.setAttributeNS(Ki,t,n):null==n||a&&!(0,Vt.Y2)(n)?e.removeAttribute(t):e.setAttribute(t,a?"":(0,Vt.Bm)(n)?String(n):n)}function Xi(e,t,n,s,i){if("innerHTML"===t||"textContent"===t)return void(null!=n&&(e[t]="innerHTML"===t?Li(n):n));const a=e.tagName;if("value"===t&&"PROGRESS"!==a&&!a.includes("-")){const s="OPTION"===a?e.getAttribute("value")||"":e.value,i=null==n?"checkbox"===e.type?"on":"":String(n);return s===i&&"_value"in e||(e.value=i),null==n&&e.removeAttribute(t),void(e._value=n)}let r=!1;if(""===n||null==n){const s=typeof e[t];"boolean"===s?n=(0,Vt.Y2)(n):null==n&&"string"===s?(n="",r=!0):"number"===s&&(n=0,r=!0)}try{e[t]=n}catch(e){}r&&e.removeAttribute(i||t)}function Yi(e,t,n,s){e.addEventListener(t,n,s)}const Ji=Symbol("_vei");const Zi=/(?:Once|Passive|Capture)$/;let Qi=0;const ea=Promise.resolve(),ta=()=>Qi||(ea.then((()=>Qi=0)),Qi=Date.now()),na=e=>111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123;"undefined"!=typeof HTMLElement&&HTMLElement,Symbol("_moveCb"),Symbol("_enterCb");const sa=e=>{const t=e.props["onUpdate:modelValue"]||!1;return(0,Vt.cy)(t)?e=>(0,Vt.DY)(t,e):t};function ia(e){e.target.composing=!0}function aa(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const ra=Symbol("_assign"),oa={created(e,{modifiers:{lazy:t,trim:n,number:s}},i){e[ra]=sa(i);const a=s||i.props&&"number"===i.props.type;Yi(e,t?"change":"input",(t=>{if(t.target.composing)return;let s=e.value;n&&(s=s.trim()),a&&(s=(0,Vt.bB)(s)),e[ra](s)})),n&&Yi(e,"change",(()=>{e.value=e.value.trim()})),t||(Yi(e,"compositionstart",ia),Yi(e,"compositionend",aa),Yi(e,"change",aa))},mounted(e,{value:t}){e.value=null==t?"":t},beforeUpdate(e,{value:t,oldValue:n,modifiers:{lazy:s,trim:i,number:a}},r){if(e[ra]=sa(r),e.composing)return;const o=null==t?"":t;if((!a&&"number"!==e.type||/^0\d/.test(e.value)?e.value:(0,Vt.bB)(e.value))!==o){if(document.activeElement===e&&"range"!==e.type){if(s&&t===n)return;if(i&&e.value.trim()===o)return}e.value=o}}},la={deep:!0,created(e,t,n){e[ra]=sa(n),Yi(e,"change",(()=>{const t=e._modelValue,n=ma(e),s=e.checked,i=e[ra];if((0,Vt.cy)(t)){const e=(0,Vt.u3)(t,n),a=-1!==e;if(s&&!a)i(t.concat(n));else if(!s&&a){const n=[...t];n.splice(e,1),i(n)}}else if((0,Vt.vM)(t)){const e=new Set(t);s?e.add(n):e.delete(n),i(e)}else i(da(e,s))}))},mounted:ca,beforeUpdate(e,t,n){e[ra]=sa(n),ca(e,t,n)}};function ca(e,{value:t,oldValue:n},s){let i;if(e._modelValue=t,(0,Vt.cy)(t))i=(0,Vt.u3)(t,s.props.value)>-1;else if((0,Vt.vM)(t))i=t.has(s.props.value);else{if(t===n)return;i=(0,Vt.BX)(t,da(e,!0))}e.checked!==i&&(e.checked=i)}const ua={created(e,{value:t},n){e.checked=(0,Vt.BX)(t,n.props.value),e[ra]=sa(n),Yi(e,"change",(()=>{e[ra](ma(e))}))},beforeUpdate(e,{value:t,oldValue:n},s){e[ra]=sa(s),t!==n&&(e.checked=(0,Vt.BX)(t,s.props.value))}},ha={deep:!0,created(e,{value:t,modifiers:{number:n}},s){const i=(0,Vt.vM)(t);Yi(e,"change",(()=>{const t=Array.prototype.filter.call(e.options,(e=>e.selected)).map((e=>n?(0,Vt.bB)(ma(e)):ma(e)));e[ra](e.multiple?i?new Set(t):t:t[0]),e._assigning=!0,Zt((()=>{e._assigning=!1}))})),e[ra]=sa(s)},mounted(e,{value:t}){pa(e,t)},beforeUpdate(e,t,n){e[ra]=sa(n)},updated(e,{value:t}){e._assigning||pa(e,t)}};function pa(e,t){const n=e.multiple,s=(0,Vt.cy)(t);if(!n||s||(0,Vt.vM)(t)){for(let i=0,a=e.options.length;i<a;i++){const a=e.options[i],r=ma(a);if(n)if(s){const e=typeof r;a.selected="string"===e||"number"===e?t.some((e=>String(e)===String(r))):(0,Vt.u3)(t,r)>-1}else a.selected=t.has(r);else if((0,Vt.BX)(ma(a),t))return void(e.selectedIndex!==i&&(e.selectedIndex=i))}n||-1===e.selectedIndex||(e.selectedIndex=-1)}}function ma(e){return"_value"in e?e._value:e.value}function da(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const ga={created(e,t,n){fa(e,t,n,null,"created")},mounted(e,t,n){fa(e,t,n,null,"mounted")},beforeUpdate(e,t,n,s){fa(e,t,n,s,"beforeUpdate")},updated(e,t,n,s){fa(e,t,n,s,"updated")}};function fa(e,t,n,s,i){const a=function(e,t){switch(e){case"SELECT":return ha;case"TEXTAREA":return oa;default:switch(t){case"checkbox":return la;case"radio":return ua;default:return oa}}}(e.tagName,n.props&&n.props.type)[i];a&&a(e,t,n,s)}const ya=(0,Vt.X$)({patchProp:(e,t,n,s,i,a)=>{const r="svg"===i;"class"===t?function(e,t,n){const s=e[Mi];s&&(t=(t?[t,...s]:[...s]).join(" ")),null==t?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}(e,s,r):"style"===t?function(e,t,n){const s=e.style,i=(0,Vt.Kg)(n);let a=!1;if(n&&!i){if(t)if((0,Vt.Kg)(t))for(const e of t.split(";")){const t=e.slice(0,e.indexOf(":")).trim();null==n[t]&&Bi(s,t,"")}else for(const e in t)null==n[e]&&Bi(s,e,"");for(const e in n)"display"===e&&(a=!0),Bi(s,e,n[e])}else if(i){if(t!==n){const e=s[Vi];e&&(n+=";"+e),s.cssText=n,a=zi.test(n)}}else t&&e.removeAttribute("style");Di in e&&(e[Di]=a?s.display:"",e[Ui]&&(s.display="none"))}(e,n,s):(0,Vt.Mp)(t)?(0,Vt.CP)(t)||function(e,t,n,s,i=null){const a=e[Ji]||(e[Ji]={}),r=a[t];if(s&&r)r.value=s;else{const[n,o]=function(e){let t;if(Zi.test(e)){let n;for(t={};n=e.match(Zi);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[":"===e[2]?e.slice(3):(0,Vt.Tg)(e.slice(2)),t]}(t);if(s){const r=a[t]=function(e,t){const n=e=>{if(e._vts){if(e._vts<=n.attached)return}else e._vts=Date.now();Ht(function(e,t){if((0,Vt.cy)(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map((e=>t=>!t._stopped&&e&&e(t)))}return t}(e,n.value),t,5,[e])};return n.value=e,n.attached=ta(),n}(s,i);Yi(e,n,r,o)}else r&&(function(e,t,n,s){e.removeEventListener(t,n,s)}(e,n,r,o),a[t]=void 0)}}(e,t,0,s,a):("."===t[0]?(t=t.slice(1),1):"^"===t[0]?(t=t.slice(1),0):function(e,t,n,s){if(s)return"innerHTML"===t||"textContent"===t||!!(t in e&&na(t)&&(0,Vt.Tn)(n));if("spellcheck"===t||"draggable"===t||"translate"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if("width"===t||"height"===t){const t=e.tagName;if("IMG"===t||"VIDEO"===t||"CANVAS"===t||"SOURCE"===t)return!1}return(!na(t)||!(0,Vt.Kg)(n))&&t in e}(e,t,s,r))?(Xi(e,t,s),e.tagName.includes("-")||"value"!==t&&"checked"!==t&&"selected"!==t||qi(e,t,s,r,0,"value"!==t)):!e._isVueCE||!/[A-Z]/.test(t)&&(0,Vt.Kg)(s)?("true-value"===t?e._trueValue=s:"false-value"===t&&(e._falseValue=s),qi(e,t,s,r)):Xi(e,(0,Vt.PT)(t),s,0,t)}},Ri);let va;const ba=(...e)=>{const t=(va||(va=_s(ya))).createApp(...e),{mount:n}=t;return t.mount=e=>{const s=function(e){if((0,Vt.Kg)(e))return document.querySelector(e);return e}(e);if(!s)return;const i=t._component;(0,Vt.Tn)(i)||i.render||i.template||(i.template=s.innerHTML),1===s.nodeType&&(s.textContent="");const a=n(s,!1,function(e){return e instanceof SVGElement?"svg":"function"==typeof MathMLElement&&e instanceof MathMLElement?"mathml":void 0}(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},t};var _a=n(99418);function wa(){return(0,_a.A)()}const Sa={install(e,t={},n=wa){e.directive("dompurify-html",function(e={},t=wa){const n=t();!function(e,t){const n=e.hooks??{};let s;for(s in n){const e=n[s];void 0!==e&&t.addHook(s,e)}}(e,n);const s=function(t){const s=t.value;if(t.oldValue===s)return;const i=`${s}`,a=t.arg,r=e.namedConfigurations,o=e.default??{};return r&&void 0!==a?n.sanitize(i,r[a]??o):n.sanitize(i,o)},i=function(e,t){const n=s(t);void 0!==n&&(e.innerHTML=n)},a={mounted:i,updated:i};return e.enableSSRPropsSupport?{...a,getSSRProps:e=>({innerHTML:s(e)})}:a}(t,n))}};var Ea=n(13647);var ka=n(25721);const Ia={apiCall:Y,logger:n(78584).m("MAL Search"),type:"anime"},xa=async function(e,t,n={},s=!1){if(Ia.type=t,(e=e.trim()).length>64&&(e=e.substr(0,64)),!e)return[];if(e.length<3)throw new Error("Search term must be at least 3 characters long");return Ia.apiCall({type:"GET",path:`${t}?q=${e}&limit=15&nsfw=true`,fields:["start_date","mean","alternative_titles","media_type","num_episodes","num_chapters"]}).then((e=>{const n=[];return e.data.forEach((function(e){let s=[e.node.title];e.node.alternative_titles&&(e.node.alternative_titles.en&&s.push(e.node.alternative_titles.en),e.node.alternative_titles.ja&&s.push(e.node.alternative_titles.ja),e.node.alternative_titles.synonyms&&(s=s.concat(e.node.alternative_titles.synonyms))),n.push({id:e.node.id,name:e.node.title,altNames:s,url:`https://myanimelist.net/${t}/${e.node.id}`,malUrl:()=>`https://myanimelist.net/${t}/${e.node.id}`,image:e.node.main_picture?.medium??"",imageLarge:e.node.main_picture?.large||e.node.main_picture?.medium||"",media_type:e.node.media_type?(e.node.media_type.charAt(0)+e.node.media_type.slice(1).toLowerCase()).replace("_"," "):"",isNovel:e.node.media_type.toLowerCase().includes("novel"),score:e.node.mean,year:e.node.start_date,totalEp:e.node.num_episodes||e.node.num_chapters||0})})),Ia.logger.log(n),n}))},Ta=xa;var $a=n(78584),Na=n(7263),Oa=n(78584);var Ca=n(78584),La=n(7263),Aa=n(13647),Pa=n(26017);async function Ra(e,t={},n=!1,s="GET",i=!0){n&&(e+=`?${La.$.param(t)}`),Ca.log("call",s,e,t);const a={Authorization:i?`Bearer ${Aa.settings.get("simklToken")}`:void 0,"simkl-api-key":He,Accept:"application/vnd.api+json","Content-Type":"application/json"};return i||Ca.log("No login"),"GET"===s&&(t=void 0),Aa.request.xhr(s,{url:e,headers:a,data:t}).then((async a=>{switch(a.status){case 200:case 201:case 204:case 302:break;case 401:if(i)return Ra(e,t,n,s,!1);throw Pa.flashm(`Please Authenticate <a target="_blank" href="${Be()}">Here</a>`,{error:!0,type:"error"}),o();default:throw Pa.flashm(`Simkl: ${r()}`,{error:!0,type:"error"}),o()}try{return j(a.responseText)}catch(e){throw Ca.error(a),e}function r(){return j(a.responseText).error}function o(){return new Error(r())}}))}function Ma(e,n,s={},i=!1,a=""){return a||(a=t(n)),"KITSU"===a?async function(e,t){return Oe("GET",`https://kitsu.app/api/edge/${t}?filter[text]=${e}&page[limit]=20&page[offset]=0&fields[${t}]=id,slug,titles,averageRating,startDate,posterImage,coverImage,subtype,${"anime"===t?"episodeCount":"chapterCount"}`,{}).then((e=>{Oa.log("search",e);const n=[];return e.data.forEach((function(e){n.push({id:Number(e.id),name:Ne(e.attributes.titles,e.attributes.canonicalTitle),altNames:Object.values(e.attributes.titles),url:`https://kitsu.app/${t}/${e.attributes.slug}`,malUrl:async()=>{const n=await function(e,t){return ke.request.xhr("GET",{url:`https://kitsu.app/api/edge/${t}/${e}/mappings?filter[externalSite]=myanimelist/${t}`,headers:{"Content-Type":"application/vnd.api+json",Accept:"application/vnd.api+json"}}).then((e=>{const t=JSON.parse(e.responseText);return Ee.log("[KtoM]",t),void 0!==t.data&&t.data.length?Number(t.data[0].attributes.externalId):null}))}(e.id,t);return n?`https://myanimelist.net/${t}/${n}`:null},image:e.attributes.posterImage&&e.attributes.posterImage.small?e.attributes.posterImage.small:"",imageLarge:e.attributes.posterImage&&e.attributes.posterImage.original?e.attributes.posterImage.original:"",imageBanner:e.attributes.coverImage&&e.attributes.coverImage.large?e.attributes.coverImage.large:"",media_type:e.attributes.subtype,isNovel:"novel"===e.attributes.subtype,score:e.attributes.averageRating,year:e.attributes.startDate,totalEp:e.attributes.episodeCount||e.attributes.chapterCount||0})})),n}))}(e,n,s,i):"ANILIST"===a?async function(e,t){const n=`\n    query ($search: String) {\n      ${t}: Page (perPage: 25) {\n        pageInfo {\n          total\n        }\n        results: media (type: ${t.toUpperCase()}, search: $search) {\n          id\n          siteUrl\n          idMal\n          episodes\n          chapters\n          title {\n            userPreferred\n            romaji\n            english\n            native\n          }\n          coverImage {\n            large\n            extraLarge\n          }\n          bannerImage\n          type\n          format\n          averageScore\n          startDate {\n            year\n          }\n          synonyms\n        }\n      }\n    }\n  `,s={search:e},i=await ae(n,s,!1);$a.log(i);const a=[];return Na.$.each(i.data[t].results,(function(e,n){a.push({id:n.id,name:n.title.userPreferred,altNames:Object.values(n.title).concat(n.synonyms),url:n.siteUrl,malUrl:()=>n.idMal?`https://myanimelist.net/${t}/${n.idMal}`:null,image:re(n.coverImage.large),imageLarge:re(n.coverImage.extraLarge),imageBanner:re(n.bannerImage),media_type:n.format?(n.format.charAt(0)+n.format.slice(1).toLowerCase()).replace("_"," "):"",isNovel:"NOVEL"===n.format,score:n.averageScore,year:n.startDate.year,totalEp:n.episodes||n.chapters||0})})),a}(e,n):"SIMKL"===a?async function(e,t){return Ra(`https://api.simkl.com/search/${t}`,{q:e},!0).then((e=>{const n=[];return Ca.log("search",e),La.$.each(e,(function(e,s){n.push({id:s.ids.simkl_id,name:s.title,altNames:[],url:`https://simkl.com/${t}/${s.ids.simkl_id}/${s.ids.slug}`,malUrl:async()=>{const e=await(n=s.ids.simkl_id,Ra(`https://api.simkl.com/anime/${n}`,{extended:"full"},!0).then((e=>void 0===e.ids.mal?null:e.ids.mal)));var n;return e?`https://myanimelist.net/${t}/${e}`:null},image:`https://simkl.in/posters/${s.poster}_ca.jpg`,imageLarge:`https://simkl.in/posters/${s.poster}_m.jpg`,imageBanner:`https://simkl.in/posters/${s.poster}_w.jpg`,media_type:s.type,isNovel:!1,score:null,year:s.year})})),n}))}(e,n,s,i):"SHIKI"===a?async function(e,t){return(await at({path:`${t}s`,parameter:{limit:25,search:e},type:"GET"})).map((e=>({id:e.id,name:ot(e.russian,e.name),altNames:[e.name,e.russian].filter((e=>e)),url:it+e.url,malUrl:()=>Promise.resolve(e.id?`https://myanimelist.net/${t}/${e.id}`:null),image:it+e.image.preview,imageLarge:it+e.image.original,media_type:e.kind,isNovel:"light_novel"===e.kind,score:Number(e.score)?e.score:"",year:e.aired_on,totalEp:e.episodes||e.chapters||0})))}(e,n):"MALAPI"===a?xa(e,n,s,i):Ta(e,n,s,i)}var Da=n(78584),Ua=n(13647),ja=n(26017);class Fa{constructor(e,t){return this.cacheKey=e,this.type=t,this.logger=Da.m("Rules"),this}async init(){if(this.state=await this.getCache(),!this.state||"firebase"===this.state.provider&&this.state.updated&&this.state.updated+6048e5<(new Date).getTime()){const e=await this.api();e&&(this.state=e)}return this.logger.m("Result").log(this.state),this.state&&await this.setCache(this.state),this}getRules(){return this.state&&this.state.rules&&this.state.rules.length?this.state.rules:[]}async api(){const e=this.logger.m("API");try{if("anime"!==this.type)return void e.info("Only supports anime");if(String(this.cacheKey).startsWith("simkl:"))return void e.info("Simkl is not supported");const t=`https://api.malsync.moe/rules/${this.cacheKey}`;e.log(t);const n=await Ua.request.xhr("GET",t);e.log("Response",n);const s=JSON.parse(n.responseText);return{provider:"firebase",updated:(new Date).getTime(),last_modified:s.last_modified,rules:s.rules.map((e=>({from:{title:e.from.title,url:ja.pageUrl(s.page,this.type,e.from.id),start:e.from.start,end:e.from.end},to:{title:e.to.title,url:ja.pageUrl(s.page,this.type,e.to.id),start:e.to.start,end:e.to.end}})))}}catch(t){return void e.error(t)}}async getCache(){return Ua.storage.get(`${this.type}/${this.cacheKey}/Rules`).then((e=>(e&&(e.cache=!0),e)))}setCache(e){return e=JSON.parse(JSON.stringify(e)),Ua.storage.set(`${this.type}/${this.cacheKey}/Rules`,e)}applyRules(e,t){this.activeRule=void 0,t||(t=this.getRules());const n=t.find((t=>t.from.start<=e&&t.from.end>=e));if(n)return this.activeRule=n,{url:n.to.url,offset:n.to.start-n.from.start};if(t.length>1){const n=t.find((t=>t.from.url===t.to.url&&e>t.from.end));if(n){const s=n.to.start-n.from.start,i=e+s,a=this.applyRules(i,t.filter((e=>e.from.url!==e.to.url)));if(a)return a.offset+=s,a}}}}var Va=n(78584),za=n(13647),Ha=n(26017);class Ba{constructor(e,t,n){this.title=e,this.type=t,this.identifier=n,this.localUrl="",this.state=!1,this.changed=!1,this.identifier+="",this.sanitizedTitle=this.sanitizeTitle(this.title),this.logger=Va.m("search","red")}setPage(e){this.page=e}setLocalUrl(e){this.localUrl=e}setSyncPage(e){this.syncPage=e}getSyncPage(){return this.syncPage}getUrl(){return this.state?this.state.url:null}setUrl(e,t=0){this.state?(this.state.url!==e&&(this.changed=!0),this.state.provider="user",this.state.url=e,this.state.id=t,this.state.cache=!1,this.state.similarity={same:!0,value:1}):(this.changed=!0,this.state={id:t,url:e,offset:0,provider:"user",similarity:{same:!0,value:1}}),this.setCache(this.state)}getOffset(){return this.state&&this.state.offset?this.state.offset:0}setOffset(e){this.state&&(this.state.offset!==e&&(this.changed=!0),this.state.offset=e),this.setCache(this.state)}async getCachedOffset(){return this.state=await this.getCache(),this.state?this.state.offset:0}getId(){return this.state&&this.state.id?this.state.id:0}getSanitizedTitle(){return this.sanitizedTitle}getNormalizedType(){return"anime"===this.type?"anime":"manga"}sanitizeTitle(e){let t=e.replace(/ *(\(dub\)|\(sub\)|\(uncensored\)|\(uncut\)|\(subbed\)|\(dubbed\)|\(novel\)|\(wn\)|\(ln\))/i,"");return t=t.replace(/ *\([^)]+audio\)/i,""),t=t.replace(/ BD( |$)/i,""),t=t.trim(),t=t.substring(0,99),t}async search(){if(this.state=await this.getCache(),this.state||(this.state=await this.searchLocal()),this.state||(this.state=await this.searchForIt()),!this.state||this.state&&!["user","firebase","sync","local"].includes(this.state.provider)){const e=await this.onsiteSearch();e&&(this.state=e)}return this.state&&await this.setCache(this.state),this.logger.log("Result",this.state),this.state}async getCache(){return za.storage.get(`${this.page.name}/${this.identifier}/Search`).then((e=>(e&&(e.cache=!0),e)))}setCache(e){return e=JSON.parse(JSON.stringify(e)),setTimeout((()=>{this.databaseRequest()}),200),za.storage.set(`${this.page.name}/${this.identifier}/Search`,e)}static similarity(e,t,n=[]){let s=(0,ka.compareTwoStrings)(t.toLowerCase(),e.toLowerCase());n.forEach((e=>{if(e){const n=(0,ka.compareTwoStrings)(t.toLowerCase(),e.toLowerCase());n>s&&(s=n)}}));let i=!1;return s>.6&&(i=!0),{same:i,value:s}}async searchLocal(){if(!this.localUrl)return!1;const e=new gt(this.localUrl);return await e.update(),!!e.isOnList()&&(this.logger.m("Local").log("On List"),{url:"",offset:0,provider:"local",similarity:{same:!0,value:1}})}async searchForIt(){let e=!1;try{e=t(e,await this.malSync())}catch(e){this.page&&this.page.database&&this.logger.error("MALSync api error or not supported",e)}if(e&&"firebase"!==e.provider||!e)try{e=t(e,await this.malSearch())}catch(e){this.logger.m(e)}if(e&&"firebase"!==e.provider||!e)try{e=t(e,await this.pageSearch(),.5)}catch(e){this.logger.m(e)}if(e&&"firebase"===e.provider&&"MAL"!==za.settings.get("syncMode")&&!e.url)try{const t=await this.pageSearch();t&&!Ha.isDomainMatching(t.url,"myanimelist.net")&&t.similarity.same&&(this.logger.log("Ignore Firebase",e),e=t)}catch(e){this.logger.m(e)}return e;function t(e,t,n=0){return!1!==e&&!1!==t&&t.similarity.value>n?e.similarity.value>=t.similarity.value?e:t:!1!==e?e:t}}async firebase(){if(!this.page||!this.page.database)return!1;const e=this.logger.m("Firebase"),t=`https://kissanimelist.firebaseio.com/Data2/${this.page.database}/${encodeURIComponent(this.identifierToDbKey(this.identifier)).toLowerCase()}/Mal.json`;e.log(t);const n=await za.request.xhr("GET",t);if(e.log("response",n.responseText),!n.responseText||"null"===n.responseText||n.responseText.includes("error"))return!1;let s;try{s=JSON.parse(n.responseText)}catch(t){return e.info("Parse failed"),!1}if(!s||0===Object.keys(s).length)return!1;const i=Object.keys(s)[0];let a="";return"Not-Found"!==i&&(a=`https://myanimelist.net/${this.page.type}/${i}`),{url:a,offset:0,provider:"firebase",similarity:{same:!0,value:1}}}async malSync(){const e=this.logger.m("API");if(!this.page)return!1;const n=this.page.database;if(!n)return!1;const s=`https://api.malsync.moe/page/${n}/${encodeURIComponent(this.identifierToDbKey(this.identifier)).toLowerCase()}`;e.log(s);const i=await za.request.xhr("GET",s);if(e.log("Response",i),400!==i.status&&200!==i.status)throw new Error("malsync offline");if(400===i.status&&i.responseText?.includes("error"))return!1;const a=JSON.parse(i.responseText);let r=a.malUrl;return!r&&a.aniUrl&&"ANILIST"===t(this.getNormalizedType())&&(r=a.aniUrl),{url:r,offset:0,provider:"firebase",similarity:{same:!0,value:1}}}async malSearch(){const e=this.logger.m("MAL"),t=`https://myanimelist.net/${this.getNormalizedType()}.php?q=${encodeURI(this.sanitizedTitle)}`;e.log(t);const n=await za.request.xhr("GET",t);return!(!n||n.responseText?.includes("  error "))&&!(!n||n.responseText?.includes("No titles that matched"))&&function t(n,s,i){const a=function(t,n){try{return t.responseText.split('<a class="hoverinfo_trigger" href="')[n].split('"')[0]}catch(s){e.error(s);try{return t.responseText.split('class="picSurround')[n].split("<a")[1].split('href="')[1].split('"')[0]}catch(t){return e.error(t),!1}}}(n,s);let r=0,o={same:!1,value:0};if(!1!==a)try{if("manga"===i.type||"novel"===i.type){const r=-1!==n.responseText.split(`href="${a}" id="si`)[1].split("</tr>")[0].indexOf("Novel");if("manga"===i.type&&r||"novel"===i.type&&!r)return e.log((r?"Novel Found":"Novel Not found")+" check next entry"),t(n,s+1,i)}const l=function(t,n){try{const e=n.split("/")[4];return t.responseText.split(`rel="#sinfo${e}"><strong>`)[1].split("<")[0]}catch(t){return e.error(t),""}}(n,a);o=Ba.similarity(l,i.sanitizedTitle),r=parseInt(a.split("/")[4])}catch(t){e.error(t)}return{id:r,url:a,offset:0,provider:"mal",similarity:o}}(n,1,this)}async pageSearch(){const e=await Ma(this.sanitizedTitle,this.getNormalizedType());let t=null;for(let n=0;n<e.length&&n<5;n++){const s=e[n],i=Ba.similarity(s.name,this.sanitizedTitle,s.altNames),a={index:n,similarity:i};("manga"===this.type&&!s.isNovel||"novel"===this.type&&s.isNovel||"anime"===this.type)&&(!t||i.value>t.similarity.value)&&(t=a)}if(t){const n=e[t.index],s=await n.malUrl();return{id:n.id,url:s||n.url,offset:0,provider:"page",similarity:t.similarity}}return!1}async databaseRequest(){const e=this.logger.m("DB Request");if(this.page&&this.page.database&&this.syncPage&&this.state){if(this.state.cache)return;if("user"===this.state.provider&&!this.changed)return;if("firebase"===this.state.provider)return;if("local"===this.state.provider)return;let t;if(!t)if(this.page.isSyncPage(this.syncPage.url))t=this.page.sync.getOverviewUrl(this.syncPage.url),"Crunchyroll"===this.page.database&&(t=`${this.syncPage.url}`);else{if("Crunchyroll"===this.page.database)return void e.log("CR block");t=this.syncPage.url}const n={pageUrl:t,malUrl:this.state.url,correction:!1,page:this.page.database};if("user"===this.state.provider){if(!await Ha.flashConfirm(za.storage.lang("correction_DBRequest"),"dbrequest",(()=>{}),(()=>{}),!0))return;n.correction=!0}const s="https://api.malsync.moe/corrections";za.request.xhr("POST",{url:s,data:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then((t=>{try{const n=JSON.parse(t.responseText);if(n.error)throw n;e.log("Send to database:",n)}catch(t){e.error("Send to database:",t)}}))}}async onsiteSearch(){if(this.page&&this.syncPage&&this.syncPage.curState&&this.syncPage.curState.on){let e=!1;if("OVERVIEW"===this.syncPage.curState.on?this.page.overview&&this.page.overview.getMalUrl&&(e=await this.page.overview.getMalUrl(za.settings.get("syncMode"))):this.page.sync&&this.page.sync.getMalUrl&&(e=await this.page.sync.getMalUrl(za.settings.get("syncMode"))),e)return this.logger.m("Onsite").log("[SEARCH]","Overwrite by onsite url",e),{url:e,offset:0,provider:"sync",similarity:{same:!0,value:1}}}return!1}openCorrection(){}identifierToDbKey(e){return"Crunchyroll"===this.page.database?encodeURIComponent(e.toLowerCase().split("#")[0]).replace(/\./g,"%2E"):"MangaFire"===this.page.database?encodeURIComponent(e.toLowerCase().split("#")[0]):e.toLowerCase().split("#")[0].replace(/\./g,"%2E")}async initRules(){const e=Va.m("Rules"),t=this.getUrl();if(e.log("Url",t),t){const n=await async function(e){const t=new u(`rulesCacheKey/${e}`,6048e5);if(await t.hasValue())return t.getValue().then((e=>({rulesCacheKey:e})));const n=ft(e);return await n.update(),t.setValue(n.getRulesCacheKey()),{rulesCacheKey:n.getRulesCacheKey(),singleObj:n}}(t);return e.log("Cachekey",n),this.rules=await new Fa(n.rulesCacheKey,this.getNormalizedType()).init(),n.singleObj}}applyRules(e){if(this.rules){const t=this.getOffset()||0,n=this.rules.applyRules(Number(e)+Number(t));return n&&(n.offset=Number(n.offset)+Number(t)),n}}getRuledOffset(e){const t=this.applyRules(e);return t?t.offset:this.getOffset()}getRuledUrl(e){const t=this.applyRules(e);return t?t.url:this.getUrl()}}const Wa={key:0,id:"material"},Ga={class:"m-s-pill-section"},Ka={class:"m-s-pill"},qa={href:"https://malsync.moe/pwa/#/settings",target:"_blank"},Xa={key:0},Ya={key:1,class:"scroll"},Ja={key:3,id:"offsetUi"},Za={class:"mdl-color--primary top"},Qa={class:"search"},er={class:"input"},tr={class:"group"},nr={class:"loadingBar"},sr={class:"mdl-progress mdl-js-progress mdl-progress__indeterminate",style:{width:"100%"}},ir={key:0,class:"results"},ar={class:"right"},rr={class:"title"},or=["href","onClick"],lr={class:"image"},cr=["src"],ur={class:"right"},hr={class:"title"},pr={key:0},mr={key:1},dr={key:0},gr={key:1},fr={key:2};var yr=n(13647),vr=n(13647),br=n(26017);let _r;const wr={components:{},props:{type:{type:String,default:"anime"},keyword:{type:String,default:""},syncMode:{type:Boolean,default:!1},currentId:{type:Number,default:0}},data:()=>({items:[],loading:!1,searchKeyword:""}),watch:{keyword(){this.searchKeyword=this.keyword,this.load()},searchKeyword(){clearTimeout(_r),_r=setTimeout((()=>{this.load()}),200)},type(){this.load()}},mounted(){this.syncMode&&(this.searchKeyword=this.keyword,this.load())},methods:{lang:vr.storage.lang,getStatusText:br.getStatusText,episodeText:br.episode,providerTemplates:Nt,load(){this.searchKeyword&&(this.loading=!0,async function(e,t){return Ma(e,t).then((e=>Promise.all(e.map((async e=>{const n=await yr.request.database("entry",{id:e.id,type:t});return n&&(e.list={status:n.status,score:n.score,episode:n.watchedEp}),e})))))}(this.searchKeyword,this.type).then((e=>{this.loading=!1,this.items=e,this.$nextTick((()=>{this.$el.scrollIntoView({behavior:"smooth"})}))})))},inputFocus(){this.searchKeyword||(this.searchKeyword=this.keyword)},async clickItem(e,t){if(e.preventDefault(),!t)return void this.$emit("clicked",{url:"",id:0});const n=await t.malUrl();n?this.$emit("clicked",{url:n,id:t.id}):this.$emit("clicked",{url:t.url,id:t.id})}}};var Sr=n(66262);const Er=(0,Sr.A)(wr,[["render",function(e,t,n,s,i,a){return Ks(),Js("div",Qa,[si("div",er,[si("div",tr,[cn(si("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.searchKeyword=e),type:"text",required:"",onFocus:t[1]||(t[1]=e=>a.inputFocus())},null,544),[[oa,i.searchKeyword]]),t[3]||(t[3]=si("span",{class:"bar"},null,-1)),si("label",null,(0,Vt.v_)(a.lang("correction_Search")),1)])]),si("div",nr,[cn(si("div",sr,t[4]||(t[4]=[si("div",{class:"progressbar bar bar1",style:{width:"0%"}},null,-1),si("div",{class:"bufferbar bar bar2",style:{width:"100%"}},null,-1),si("div",{class:"auxbar bar bar3",style:{width:"0%"}},null,-1)]),512),[[ji,i.loading]])]),i.searchKeyword?(Ks(),Js("div",ir,[si("a",{class:"result",href:"",style:{cursor:"pointer"},onClick:t[2]||(t[2]=e=>a.clickItem(e,""))},[t[5]||(t[5]=si("div",{class:"image"},null,-1)),si("div",ar,[si("span",rr,(0,Vt.v_)(a.lang("correction_NoEntry",[a.providerTemplates("").shortName])),1),si("p",null,(0,Vt.v_)(a.lang("correction_NoMal",[a.providerTemplates("").shortName])),1)])]),(Ks(!0),Js(Vs,null,Dn(i.items,(e=>(Ks(),Js("a",{key:e.id,class:(0,Vt.C4)(["result",{active:n.currentId===e.id,onList:e.list}]),href:e.url,onClick:t=>a.clickItem(t,e)},[si("div",lr,[si("img",{src:e.image},null,8,cr)]),si("div",ur,[si("span",hr,(0,Vt.v_)(e.name),1),e.list?(Ks(),Js(Vs,{key:0},[si("p",null,(0,Vt.v_)(a.lang("UI_Status"))+" "+(0,Vt.v_)(a.getStatusText(n.type,e.list.status)),1),e.list.score?(Ks(),Js("p",pr,(0,Vt.v_)(a.lang("UI_Score"))+" "+(0,Vt.v_)(e.list.score),1)):1===e.list.status?(Ks(),Js("p",mr,(0,Vt.v_)(a.episodeText(n.type))+" "+(0,Vt.v_)(e.list.episode),1)):li("v-if",!0)],64)):(Ks(),Js(Vs,{key:1},[e.media_type?(Ks(),Js("p",dr,(0,Vt.v_)(a.lang("search_Type"))+" "+(0,Vt.v_)(e.media_type),1)):li("v-if",!0),e.score?(Ks(),Js("p",gr,(0,Vt.v_)(a.lang("search_Score"))+" "+(0,Vt.v_)(e.score),1)):li("v-if",!0),e.year?(Ks(),Js("p",fr,(0,Vt.v_)(a.lang("search_Year"))+" "+(0,Vt.v_)(e.year),1)):li("v-if",!0)],64))])],10,or)))),128))])):li("v-if",!0)])}],["__file","search.vue"]]),kr={class:"inputButton"},Ir={class:"group"},xr=["type"];var Tr=n(13647);const $r={props:{state:{type:[String,Number],default:""},type:{type:String,default:""},label:{type:String,default:""}},data:()=>({inputString:""}),watch:{state(){this.inputString=this.state},inputString(){this.$emit("changed",this.inputString)}},mounted(){this.inputString=this.state},methods:{lang:Tr.storage.lang,click(){this.$emit("clicked",this.inputString)}}},Nr=(0,Sr.A)($r,[["render",function(e,t,n,s,i,a){return Ks(),Js("div",kr,[si("div",Ir,[cn(si("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.inputString=e),type:n.type,required:""},null,8,xr),[[ga,i.inputString]]),t[2]||(t[2]=si("span",{class:"bar"},null,-1)),si("label",null,(0,Vt.v_)(n.label),1)]),i.inputString!==n.state?(Ks(),Js("button",{key:0,onClick:t[1]||(t[1]=(...e)=>a.click&&a.click(...e))},"Update")):li("v-if",!0)])}],["__file","inputButton.vue"]]),Or={key:0,class:"entry"},Cr=["href"],Lr={class:"image"},Ar=["src"],Pr={class:"right"},Rr={class:"title"},Mr={key:0},Dr={key:1},Ur={key:2},jr={key:0,id:"curEps"},Fr={key:1};var Vr=n(13647),zr=n(26017);const Hr={props:{obj:{type:Object,default:void 0}},data:()=>({}),computed:{status:{get(){return this.obj&&this.obj.isAuthenticated()?this.obj.getStatus():null},set(e){this.obj&&this.obj.isAuthenticated()&&this.obj.setStatus(e)}},episode:{get(){return this.obj&&this.obj.isAuthenticated()&&this.obj.isOnList()?this.obj.getEpisode():null},set(e){this.obj&&this.obj.isAuthenticated()&&this.obj.setEpisode(e)}},volume:{get(){return this.obj&&this.obj.isAuthenticated()&&this.obj.isOnList()?this.obj.getVolume():null},set(e){this.obj&&this.obj.isAuthenticated()&&this.obj.setVolume(e)}},score:{get(){return this.obj&&this.obj.isAuthenticated()?this.obj.getDisplayScoreCheckbox():null},set(e){this.obj&&this.obj.isAuthenticated()&&this.obj.setScore(e)}}},methods:{lang:Vr.storage.lang,utilsepisode:zr.episode,statusText(e){switch(e){case 1:return Vr.storage.lang(`UI_Status_watching_${this.obj.getType()}`);case 2:return Vr.storage.lang("UI_Status_Completed");case 3:return Vr.storage.lang("UI_Status_OnHold");case 4:return Vr.storage.lang("UI_Status_Dropped");case 6:return Vr.storage.lang(`UI_Status_planTo_${this.obj.getType()}`);case 23:return Vr.storage.lang(`UI_Status_Rewatching_${this.obj.getType()}`);default:return""}}}},Br=(0,Sr.A)(Hr,[["render",function(e,t,n,s,i,a){return n.obj?(Ks(),Js("div",Or,[si("a",{class:"result",href:n.obj.getDisplayUrl(),target:"_blank",style:{cursor:"pointer"}},[si("div",Lr,[n.obj.getImage()?(Ks(),Js("img",{key:0,src:n.obj.getImage()},null,8,Ar)):li("v-if",!0)]),si("div",Pr,[si("span",Rr,(0,Vt.v_)(n.obj.getTitle()),1),n.obj.isOnList()?(Ks(),Js("p",Mr,(0,Vt.v_)(a.lang("UI_Status"))+" "+(0,Vt.v_)(a.statusText(a.status)),1)):li("v-if",!0),n.obj.isOnList()?(Ks(),Js("p",Dr,(0,Vt.v_)(a.lang("UI_Score"))+" "+(0,Vt.v_)(a.score),1)):li("v-if",!0),n.obj.isOnList()?(Ks(),Js("p",Ur,[ri((0,Vt.v_)(a.utilsepisode(n.obj.getType()))+" "+(0,Vt.v_)(a.episode),1),n.obj.getTotalEpisodes()?(Ks(),Js("span",jr,"/"+(0,Vt.v_)(n.obj.getTotalEpisodes()),1)):(Ks(),Js("span",Fr,"/?"))])):li("v-if",!0)])],8,Cr)])):li("v-if",!0)}],["__file","entry.vue"]]),Wr={key:0,class:"rules"},Gr={class:"title"},Kr={class:"header"},qr={class:"noHover"},Xr={class:"hover"},Yr={class:"content"};var Jr=n(13647);const Zr={props:{obj:{type:Object,default:void 0}},data:()=>({}),computed:{rules(){return this.obj&&this.obj.getRules()?this.obj.getRules().sort(((e,t)=>e.from.start-t.from.start)):[]}},methods:{lang:Jr.storage.lang,activeRule(e){return{active:!!this.obj&&e===this.obj.activeRule}}}},Qr=(0,Sr.A)(Zr,[["render",function(e,t,n,s,i,a){return a.rules&&a.rules.length?(Ks(),Js("div",Wr,[si("div",Gr,(0,Vt.v_)(a.lang("UI_Rules")),1),(Ks(!0),Js(Vs,null,Dn(a.rules,((e,t)=>(Ks(),Js("div",{key:t,class:(0,Vt.C4)(["rule",a.activeRule(e)])},[si("div",Kr,[e.to.title?(Ks(),Js(Vs,{key:0},[si("span",qr,(0,Vt.v_)(e.to.title),1),si("span",Xr,(0,Vt.v_)(e.to.url),1)],64)):(Ks(),Js(Vs,{key:1},[ri((0,Vt.v_)(e.to.url),1)],64))]),si("div",Yr,[ri((0,Vt.v_)(a.lang("UI_Episode"))+" "+(0,Vt.v_)(e.from.start)+" ",1),e.from.start!==e.from.end?(Ks(),Js(Vs,{key:0},[ri(" - "+(0,Vt.v_)(Number.MAX_SAFE_INTEGER===e.from.end?"∞":e.from.end),1)],64)):li("v-if",!0),ri(" ➞ "+(0,Vt.v_)(Number.MAX_SAFE_INTEGER===e.to.start?"∞":e.to.start)+" ",1),e.to.start!==e.to.end?(Ks(),Js(Vs,{key:1},[ri(" - "+(0,Vt.v_)(Number.MAX_SAFE_INTEGER===e.to.end?"∞":e.to.end),1)],64)):li("v-if",!0)])],2)))),128))])):li("v-if",!0)}],["__file","rules.vue"]]);var eo=n(13647),to=n(26017);const no={components:{entry:Br,inputButton:Nr,search:Er,rules:Qr},data:()=>({inputOffset:0,minimized:!1,syncMode:null,searchClass:null,unmountFnc:()=>{}}),computed:{syncPage(){return this.searchClass?this.searchClass.getSyncPage():null},rulesClass(){return this.searchClass.rules},currentStateEp(){return this.syncPage&&this.syncPage.curState&&this.syncPage.curState.detectedEpisode?this.syncPage.curState.detectedEpisode:1},offset(){return this.searchClass.getOffset()},episodeWindow(){let e=this.currentStateEp+parseInt(this.inputOffset)-2;return e<1&&(e=1),Array.from({length:5},((t,n)=>n+e))}},created(){this.minimized=eo.settings.get("minimizeBigPopup"),eo.settings.get("floatButtonCorrection")&&wt(!0)},unmounted(){this.unmountFnc(),_t()},methods:{lang:eo.storage.lang,setPage(e,t=0){this.searchClass.setUrl(e,t),to.flashm(eo.storage.lang("correction_NewUrl",[e])),this.close()},setOffset(e){this.searchClass.setOffset(e)},close(){this.$.appContext.app.unmount()},calcEpOffset(e){return parseInt(e)-parseInt(this.inputOffset)}}},so=(0,Sr.A)(no,[["render",function(e,t,n,s,i,a){const r=Pn("entry"),o=Pn("rules"),l=Pn("input-button"),c=Pn("search");return a.syncPage?(Ks(),Js("div",Wa,[si("div",Ga,[si("div",Ka,[si("a",qa,(0,Vt.v_)(a.lang("minimalApp_Settings"))+"→ ",1)])]),e.syncMode&&e.minimized?(Ks(),Js("div",Xa,[si("a",{style:{cursor:"pointer"},onClick:t[0]||(t[0]=t=>e.minimized=!1)}," Action required ")])):(Ks(),Js("div",Ya,[e.syncMode?li("v-if",!0):(Ks(),Zs(r,{key:0,obj:a.syncPage.singleObj},null,8,["obj"])),ii(o,{obj:a.rulesClass},null,8,["obj"]),e.syncMode?li("v-if",!0):(Ks(),Zs(l,{key:1,label:"URL",state:e.searchClass.getUrl(),onClicked:a.setPage},null,8,["state","onClicked"])),e.syncMode?li("v-if",!0):(Ks(),Zs(l,{key:2,label:a.lang("correction_Offset"),state:a.offset,type:"number",onClicked:a.setOffset,onChanged:t[1]||(t[1]=t=>e.inputOffset=t)},null,8,["label","state","onClicked"])),e.inputOffset&&"0"!==e.inputOffset?(Ks(),Js("div",Ja,[(Ks(!0),Js(Vs,null,Dn(a.episodeWindow,(e=>(Ks(),Js("div",{key:e,class:"offsetBox"},[si("div",Za,(0,Vt.v_)(e),1),si("div",{class:(0,Vt.C4)(["bottom",{active:parseInt(a.currentStateEp)===a.calcEpOffset(e)}])},(0,Vt.v_)(a.calcEpOffset(e)),3)])))),128)),t[4]||(t[4]=oi('<div class="offsetBox"><div class="mdl-color--primary top">...</div><div class="bottom">...</div></div><div class="offsetBox"><div class="mdl-color--primary top">∞</div><div class="bottom">∞</div></div>',2))])):li("v-if",!0),ii(c,{keyword:e.searchClass.getSanitizedTitle(),type:e.searchClass.getNormalizedType(),"sync-mode":Boolean(e.syncMode),"current-id":e.searchClass.getId(),onClicked:t[2]||(t[2]=e=>a.setPage(e.url,e.id))},null,8,["keyword","type","sync-mode","current-id"])])),e.syncMode&&e.minimized?li("v-if",!0):(Ks(),Js("a",{key:2,class:"close",onClick:t[3]||(t[3]=e=>a.close())},(0,Vt.v_)(a.lang("close")),1))])):li("v-if",!0)}],["styles",["::-webkit-scrollbar {\n  display: none;\n}\n#material {\n  all: initial;\n  color: white;\n  font-family: Helvetica, Arial, sans-serif;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n#material * {\n  box-sizing: border-box;\n}\n#material .scroll {\n  overflow-y: auto;\n  max-height: 80vh;\n  scrollbar-width: none;\n}\n#material .close {\n  display: block;\n  margin-top: 15px;\n  text-align: center;\n  cursor: pointer;\n}\n#material .mdl-color--primary {\n  background-color: #3f51b5;\n}\n#material p {\n  font-weight: 400;\n  line-height: 24px;\n  font-size: 14px;\n  letter-spacing: 0;\n  margin: 0 0 16px;\n}\n#material a {\n  color: #f43b7a;\n  text-decoration: none !important;\n}\n#material .search .input {\n  width: 100%;\n}\n#material .result {\n  cursor: pointer;\n  display: flex;\n  position: relative;\n  margin-bottom: 15px;\n  background-color: #484848;\n  max-width: 400px;\n}\n#material .result.active {\n  border: 1px solid #f43b7a;\n  border-style: dashed;\n}\n#material .result.onList::before {\n  content: '';\n  top: 0;\n  right: 0;\n  position: absolute;\n  width: 0;\n  height: 0;\n  border-style: solid;\n  border-width: 0 20px 20px 0;\n  border-color: transparent #f43b7a transparent transparent;\n}\n#material .result .image {\n  height: 100px;\n  width: 64px;\n  min-width: 64px;\n  background-color: grey;\n}\n#material .result .image img {\n  height: 100%;\n  width: 100%;\n  object-fit: cover;\n}\n#material .result .right {\n  flex-grow: 100;\n  cursor: pointer;\n  margin-top: 0;\n  margin-bottom: 0;\n  padding: 5px 10px;\n  display: flex;\n  flex-direction: column;\n}\n#material .result .right .title {\n  font-size: 20px;\n  font-weight: 400;\n  line-height: 1;\n  margin-bottom: 3px;\n}\n#material .result .right p {\n  margin-bottom: 0;\n  line-height: 20px;\n  color: white;\n}\n#material .rules .title {\n  color: #f43b7a;\n}\n#material .rules .rule {\n  margin-bottom: 15px;\n  background-color: #484848;\n  max-width: 400px;\n}\n#material .rules .rule .header {\n  padding: 5px 10px;\n  border-bottom: 1px solid white;\n}\n#material .rules .rule.active {\n  border: 1px solid #f43b7a;\n}\n#material .rules .rule .content {\n  padding: 5px 10px;\n}\n#material .rules .rule .hover {\n  display: none;\n}\n#material .rules .rule:hover .hover {\n  display: block;\n}\n#material .rules .rule:hover .noHover {\n  display: none;\n}\n#material .inputButton {\n  display: flex;\n  align-items: center;\n}\n#material .inputButton .group {\n  width: 100%;\n}\n#material .group {\n  position: relative;\n  margin-bottom: 15px;\n  margin-top: 25px;\n}\n#material .group input {\n  font-size: 18px;\n  padding: 10px 10px 10px 5px;\n  display: block;\n  color: white;\n  width: 100%;\n  border: none;\n  background-color: #484848;\n  border-bottom: 1px solid white;\n}\n#material .group input:focus {\n  outline: none;\n}\n#material .group label {\n  color: #999;\n  font-size: 18px;\n  font-weight: normal;\n  position: absolute;\n  pointer-events: none;\n  left: 5px;\n  top: 10px;\n  transition: 0.2s ease all;\n}\n#material .group input:focus ~ label,\n#material .group input:valid ~ label {\n  left: 0;\n  top: -20px;\n  font-size: 14px;\n  color: #f43b7a;\n}\n#material .group .bar {\n  position: relative;\n  display: block;\n}\n#material .group .bar::before,\n#material .group .bar::after {\n  content: '';\n  height: 2px;\n  width: 0;\n  bottom: 0;\n  position: absolute;\n  background: #f43b7a;\n  transition: 0.2s ease all;\n}\n#material .group .bar::before {\n  left: 50%;\n}\n#material .group .bar::after {\n  right: 50%;\n}\n#material .group input:focus ~ .bar::before,\n#material .group input:focus ~ .bar::after {\n  width: 50%;\n}\n#material .mdl-progress {\n  display: block;\n  position: relative;\n  height: 3px;\n  width: 500px;\n  max-width: 100%;\n}\n#material .mdl-progress > .bar {\n  display: block;\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  width: 0%;\n  transition: width 0.2s linear;\n}\n#material .mdl-progress > .bar1 {\n  background-color: #3f51b5;\n  animation-name: indeterminate1;\n  animation-duration: 2s;\n  animation-iteration-count: infinite;\n  animation-timing-function: linear;\n}\n@keyframes indeterminate1 {\n0% {\n    left: 0%;\n    width: 0%;\n}\n50% {\n    left: 25%;\n    width: 75%;\n}\n75% {\n    left: 100%;\n    width: 0%;\n}\n}\n#material .loadingBar {\n  position: relative;\n}\n#material .loadingBar .mdl-progress {\n  position: absolute;\n  top: -9px;\n}\n#material button {\n  margin-top: 10px;\n  margin-left: 10px;\n  background-color: #3f51b5;\n  color: white;\n  border: none;\n  border-radius: 2px;\n  position: relative;\n  height: 42px;\n  padding: 0 16px;\n  display: inline-block;\n  font-size: 14px;\n  font-weight: 500;\n  text-transform: uppercase;\n  letter-spacing: 0;\n  cursor: pointer;\n  text-decoration: none;\n  text-align: center;\n  line-height: 36px;\n  vertical-align: middle;\n}\n#material #offsetUi {\n  display: flex;\n  justify-content: space-around;\n}\n#material #offsetUi .offsetBox {\n  text-align: center;\n  min-width: 40px;\n  margin-left: 5px;\n  margin-right: 5px;\n}\n#material #offsetUi .offsetBox .top {\n  padding: 5px 10px;\n}\n#material #offsetUi .offsetBox .bottom {\n  padding: 5px 10px;\n}\n#material #offsetUi .offsetBox .bottom.active {\n  border: 1px solid #f43b7a;\n  border-top: 0;\n}\n#material .m-s-pill-section {\n  display: flex;\n  justify-content: flex-end;\n  margin-bottom: 15px;\n}\n#material .m-s-pill-section .m-s-pill {\n  border-radius: 5px;\n  padding: 2px 10px;\n  background: #484848;\n  display: inline-block;\n}\n"]],["__file","correctionApp.vue"]]);var io=n(78584),ao=n(26017),ro=n(7263);class oo extends Ba{constructor(){super(...arguments),this.reloadSync=!1,this.keyInterruptRunning=!1}openCorrectionCheck(){return this.state&&this.state.similarity&&this.state.similarity.same?(io.log("similarity",this.state.similarity.value),!1):this.openCorrection(!0).then((()=>this.changed))}openCorrection(e=!1){return new Promise(((t,n)=>{if(this.vueInstance&&(this.vueInstance.$.appContext.app.unmount(),!e))return void t(!1);const s=ao.flashm('<div class="ms-shadow"></div>',{permanent:!0,position:"top",type:"correction"});this.vueInstance=function(e,t,n){const s=ba(e);s.use(Sa,{default:{ADD_ATTR:["target"]},namedConfigurations:{noMedia:{FORBID_TAGS:["img","svg","picture","video","audio"]}}}),n&&n.use&&n.use(s);let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error("Can't find root element");if(n&&n.shadowDom){let e;i.shadowRoot?(e=i.shadowRoot,e.innerHTML=""):e=i.attachShadow({mode:"open"}),i=e.appendChild(document.createElement("div"))}const a={};return s.mixin({beforeCreate(){this.$options.styles&&!a[this.$options.__file]&&(i.appendChild(function(e,t=""){const n=document.createElement("style");n.type="text/css",n.setAttribute("data-name",t);const s=document.createTextNode(e);return n.appendChild(s),n}(this.$options.styles.join("\n"),this.$options.__file)),a[this.$options.__file]=!0)},methods:{lang:Ea.storage.lang,getOption:e=>Ea.settings.get(e)}}),s.directive("visible",((e,t)=>{e.style.visibility=t.value?"visible":"hidden"})),s.mount(i)}(so,s.find(".ms-shadow").get(0),{shadowDom:!0}),this.vueInstance.searchClass=this,this.vueInstance.syncMode=e,this.vueInstance.unmountFnc=()=>{t(this.changed),s.remove(),this.vueInstance=void 0},this.keyInterrupt()}))}isCorrectionMenuOpen(){return ro.$(".type-correction").length>0}keyInterrupt(){this.keyInterruptRunning||(this.keyInterruptRunning=!0,document.addEventListener("keydown",(e=>{this.isCorrectionMenuOpen()&&(e.stopImmediatePropagation(),io.info("Correction menu is open, stopped keydown event"))})))}}const lo=/^(https?|wss?|file|ftp|\*):\/\/(\*|\*\.[^*/]+|[^*/]+)\/.*$|^file:\/\/\/.*$|^resource:\/\/(\*|\*\.[^*/]+|[^*/]+)\/.*$|^about:/,co=globalThis.navigator?.userAgent.includes("Firefox/"),uo=co?/^(https?|wss?):[/][/][^/]+([/].*)?$/:/^https?:[/][/][^/]+([/].*)?$/,ho=/^(https?|file|ftp):[/]+/;function po(...e){return 0===e.length?/$./:e.includes("<all_urls>")?ho:e.includes("*://*/*")?uo:new RegExp(e.map((e=>function(e){!function(e){if(!function(e){return"<all_urls>"===e||lo.test(e)}(e))throw new Error(e+" is an invalid pattern, it must match "+String(lo))}(e);let[,t,n="",s]=e.split(/(^[^:]+:[/][/])([^/]+)?/);return t=t.replace("*",co?"(https?|wss?)":"https?").replaceAll(/[/]/g,"[/]"),"*"===n?n="[^/]+":n&&(n=n.replace(/^[*][.]/,"([^/]+.)*").replaceAll(/[.]/g,"[.]").replace(/[*]$/,"[^.]+")),s=s.replaceAll(/[/]/g,"[/]").replaceAll(/[.]/g,"[.]").replaceAll(/[*]/g,".*"),"^"+t+n+"("+s+")?$"}(e))).join("|"))}var mo=n(96789);n(13647),n(78584);const go=n(52163);var fo=n(26017),yo=n(13647),vo=n(78584);class bo{constructor(){this.missingPermissions={},this.options=function(){const e=[{key:"iframe",title:"Video Iframe"},{key:"hostpermission",title:"Host Permission"},{key:"spacer1",title:"-_-_-"}];return go.sort(((e,t)=>fo.sortAlphabetically(e.name,t.name))).forEach((t=>{e.push({key:t.key,title:t.name})})),e}()}async init(){return yo.request.xhr("GET","https://api.malsync.moe/general/permissions").then((e=>{const t=JSON.parse(e.responseText),n=Object.keys(t).filter((e=>"ttl"!==e)).filter((e=>(0,mo.Lu)(e))).reduce(((e,n)=>{for(const s in t[n])this.options.some((e=>e.key===s))&&(e[s]?e[s]=e[s].concat(t[n][s]):e[s]=t[n][s]);return e}),{});this.missingPermissions=n}))}getMissingPermissions(e){const t=this.getFormatedPermissions();return console.log(e),t.filter((t=>!e.some((e=>e.page===t.page&&e.domain===t.domain)))).filter((e=>!function(e){try{return chrome.runtime.getManifest().content_scripts.some((t=>t.matches&&t.matches.some((t=>po(t).test(e)))))}catch(e){return!1}}(e.domain)))}getFormatedPermissions(){const e=[];for(const t in this.missingPermissions)this.missingPermissions[t].forEach((n=>{e.push({page:t,domain:n,auto:!0})}));return e}}class _o{getProgress(e){return Number(this.execute(e))}}var wo=n(7263),So=n(7263),Eo=n(7263),ko=n(7263),Io=n(7263);const xo={text:class extends _o{execute(e){let t=wo.$(e.selector).first().text().trim();if(e.regex){const n=new RegExp(e.regex),s=t.match(n);s&&(t=s[e.group||0])}const n=Number(t);if(Number.isNaN(n)||0===n)throw new Error(`No number found in text '${t}' (${n})`);return n}},count:class extends _o{execute(e){const t=So.$(e.selector).length;if(0===t)throw new Error(`No element found for '${e.selector}'`);return t}},countAbove:class extends _o{execute(e){const t=Eo.$(e.selector);if(0===t.length)throw new Error(`No element found for '${e.selector}'`);const n=this.getElementInViewport(t);return n?this.countElementsAbove(t,n):0}getElementInViewport(e){const t=[],n=window.innerHeight||document.documentElement.clientHeight,s=window.innerWidth||document.documentElement.clientWidth;for(let i=0;i<e.length;i++){const a=e[i],r=a.getBoundingClientRect();r.bottom<=n&&r.left<=s&&r.width&&r.height&&t.push(a)}return t.length?t[t.length-1]:null}countElementsAbove(e,t){let n=0;for(let s=0;s<e.length&&(n++,e[s]!==t);s++);return n}},prop:class extends _o{execute(e){let t=ko.$(e.selector).first().prop(e.property).trim();if(e.regex){const n=new RegExp(e.regex),s=t.match(n);s&&(t=s[e.group||0])}const n=Number(t);if(Number.isNaN(n)||0===n)throw new Error(`No number found in property '${e.property}' for '${t}' (${n})`);return n}},url:class extends _o{execute(e){let t=window.location.href.trim();if(e.regex){const n=new RegExp(e.regex),s=t.match(n);s&&(t=s[e.group||0])}const n=Number(t);if(Number.isNaN(n)||0===n)throw new Error(`No number found in text '${t}' (${n})`);return n}},attr:class extends _o{execute(e){let t=Io.$(e.selector).first().attr(e.attribute).trim();if(e.regex){const n=new RegExp(e.regex),s=t.match(n);s&&(t=s[e.group||0])}const n=Number(t);if(Number.isNaN(n)||0===n)throw new Error(`No number found in attribute '${e.attribute}' for '${t}' (${n})`);return n}},callback:class extends _o{execute(e){const t=e.callback(),n=Number(t);if(Number.isNaN(n)||0===n)throw new Error(`No number found in text '${t}' (${n})`);return n}}};function To(e){return(new xo[e.mode]).getProgress(e)}var $o=n(78584),No=n(7263),Oo=n(13647);const Co=$o.m("MangaProgress"),Lo=[{condition:"#amrapp",current:{mode:"text",selector:".amr-pages-nav .text-h6",regex:"(\\d+) /",group:1},total:{mode:"text",selector:".amr-pages-nav .text-h6",regex:"/ (\\d+)",group:1}}];class Ao{constructor(e,t){this.result=null,this.stopPromise=()=>{},this.configs=[...Lo,...e],this.page=t,Co.log("config",this.configs)}getProgressFromCollectors(e){return{current:To(e.current),total:To(e.total)}}applyConfig(){for(const e in this.configs){const t=this.configs[e];if(void 0!==t.condition){if("function"==typeof t.condition&&!1===t.condition())continue;if("string"==typeof t.condition&&!No.$(t.condition).length)continue}try{return this.getProgressFromCollectors(t)}catch(n){Co.m(`skip ${e}`).debug(n.message,t)}}return null}getProgress(){return this.result}isSuccessful(){return null!==this.result}getLimit(){const e=Oo.settings.get("mangaCompletionPercentage"),t=this.getProgress();return null===t?0:Math.floor(t.total/100*e)}progressPercentage(){const e=this.getProgress();if(null===e)return null;if(0===e.total)return 0;const t=e.current/this.getLimit();return t>1?1:t<0?0:t}finished(){const e=this.getProgress();if(null===e)return!1;const t=this.getLimit();return t<1||e.current>=t}execute(){this.result=this.applyConfig()}async start(){return clearInterval(this.interval),new Promise(((e,t)=>{this.stopPromise=()=>e(!1);let n=!1;this.interval=setInterval((()=>{if(this.execute(),!this.isSuccessful())return clearInterval(this.interval),void t(new Error("MangaProgress: Progress not found"));n||(n=!0,e(!0)),this.setProgress(),Co.debug(this.finished(),this.getProgress())}),1e3)}))}stop(){clearInterval(this.interval)}setProgress(){No.$(".ms-progress").css("width",100*this.progressPercentage()+"%"),No.$("#malSyncProgress").removeClass("ms-loading").removeClass("ms-done"),this.finished()&&No.$("#malSyncProgress").length&&(No.$("#malSyncProgress").addClass("ms-done"),No.$(".flash.type-update .sync").trigger("click"),clearInterval(this.interval))}}var Po=n(7263),Ro=n(26017);function Mo(e,t){const n=Ro.urlPart(t,2).replace(".com.br",".br").split(".").slice(-2,-1)[0];return new RegExp(`(\\.|^|\\/)${n}\\.`).test(e)}var Do=n(78584),Uo=n(13647),jo=n(7263),Fo=n(26017);let Vo="agnaejlkbiiggajjmnpmeheigkflbnoo";"undefined"!=typeof browser&&"undefined"!=typeof chrome&&(Vo="{57081fef-67b4-482f-bcb0-69296e63ec4f}");const zo=Do.m("Sync","#348fff");let Ho,Bo;class Wo{constructor(e,t,n=()=>{throw"No click handling found"}){if(this.url=e,this.pages=t,this.floatClick=n,this.novel=!1,this.strongVolumes=!1,this.videoSyncOffset=!0,this.autoNextEpRun=!1,this.curState=void 0,this.tempPlayer=void 0,this.UILoaded=!1,this.browsingtime=Date.now(),this.page=this.getPage(e),null===this.page)throw new Error("Page could not be recognized");if(this.domainSet(),zo.log("Page",this.page.name),void 0!==Uo.settings.get("enablePages")[this.page.name]&&!Uo.settings.get("enablePages")[this.page.name])throw zo.info("Sync is disabled for this page",this.page.name),"Stop Script";"manga"===this.page.type&&Uo.settings.get("readerTracking")&&(this.mangaProgress=new Ao(this.page.sync.readerConfig||[],this.page.name)),N.on("syncPage_fillUi",(()=>this.fillUI()))}init(){const e=this;if(jo.$(document).ready((function(){!function(e,t){const n=yt.settings.get("posLeft"),s=yt.settings.get("miniMalWidth"),i=yt.settings.get("miniMalHeight");if(!vt.$("#info-popup").length){yt.storage.addStyle(`.modal-content-kal.fullscreen{width: 100% !important;height: 100% !important; bottom: 0 !important;${n}: 0 !important;}      .modal-content-kal{-webkit-transition: all 0.5s ease; -moz-transition: all 0.5s ease; -o-transition: all 0.5s ease; transition: all 0.5s ease;}      .floatbutton:hover {background-color:rgb(63,81,181) !important;}      .floatbutton:hover div {background-color:white;border-color:white;}      .floatbutton div {background-color:black;border-color:black;-webkit-transition: all 0.5s ease;-moz-transition: all 0.5s ease;-o-transition: all 0.5s ease;transition: all 0.5s ease;}      .floatbutton {       z-index: 9999;display: none; position:fixed; bottom:40px; right:40px; border-radius: 50%; font-size: 24px; height: 56px; margin: auto; min-width: 56px; width: 56px; padding: 0; overflow: hidden; background: rgba(158,158,158,.2); box-shadow: 0 1px 1.5px 0 rgba(0,0,0,.12), 0 1px 1px 0 rgba(0,0,0,.24); line-height: normal; border: none;       font-weight: 500; text-transform: uppercase; letter-spacing: 0; will-change: box-shadow; transition: box-shadow .2s cubic-bezier(.4,0,1,1),background-color .2s cubic-bezier(.4,0,.2,1),color .2s cubic-bezier(.4,0,.2,1); outline: none; cursor: pointer; text-decoration: none; text-align: center; vertical-align: middle; padding: 16px !important;      }      .floatbutton.stealth {        background: rgba(158,158,158,.03);      }      .floatbutton.stealth .open-info-popup{        visibility: hidden;      }      .floatbutton.floatHide{        visibility: hidden !important;      }`);let a=`max-width: 100%; max-height: 100%; min-width: 500px; min-height: 300px; width: ${s}; height: ${i}; position: absolute; bottom: 0%; ${n}: 0%`;vt.$(window).width()<500&&(a=`width: 100vw; height: 100%; position: absolute; top: 0%; ${n}: 0%`);let r='<div class="modal-kal" id="info-popup" style="pointer-events: none;display: none; position: fixed;z-index: 9999;left: 0;top: 0;bottom: 0;width: 100%; height: 100%; background-color: transparent; padding: 0; margin: 0; border: 0;">';r+=`<div id="modal-content" class="modal-content-kal" Style="pointer-events: all; background-color: #f9f9f9; margin: 0; ${a}">`,r+="</div>",r+="</div>",vt.$("body").after(vt.html(r));let o="";yt.settings.get("floatButtonStealth")&&(o+="stealth "),yt.settings.get("floatButtonHide")&&(o+="floatHide ");let l=`<button dir="ltr" class="open-info-popup floatbutton ${o}" style="">`;yt.settings.get("floatButtonCorrection")?l+='\n        <i\n          class="my-float open-info-popup"\n          style="display: flex; height: 8px; transform: rotate(-45deg); margin-left: -7px; margin-right: -5px; pointer-events: none;"\n        >\n          <div\n            style="\n              width: 1px;\n              margin-left: 2px;\n              border-top: 4px solid transparent;\n              border-bottom: 4px solid transparent;\n              border-right-width: 4px;\n              border-right-style: solid;\n              background-color: transparent;\n            "\n          ></div>\n          <div style="flex-grow: 1; border-top-left-radius: 2px; border-bottom-left-radius: 2px; margin-left: -1px;"></div>\n          <div style="width: 5px; margin-left: 2px; border-top-right-radius: 2px; border-bottom-right-radius: 2px;"></div>\n        </i>\n      ':l+='<i class="my-float open-info-popup" style="margin-top:22px; pointer-events: none;"><div class="open-info-popup" style="width: 100%; height: 4px; margin-bottom: 15%;"></div><div class="open-info-popup" style="width: 100%; height: 4px; margin-bottom: 15%;"></div><div class="open-info-popup" style="width: 100%; height: 4px"></div></i>',l+="</button>",vt.$("#info-popup").after(vt.html(l)),yt.settings.get("floatButtonCorrection")||_t(),yt.settings.get("autoCloseMinimal")&&vt.$(".modal-kal").css("pointer-events","initial"),document.addEventListener("click",(function(n){n&&n.target&&(vt.$(n.target).hasClass("open-info-popup")&&t(e),vt.$(n.target).hasClass("modal-kal")&&(document.getElementById("info-popup").style.display="none",_t()))}))}}(e,e.floatClick)})),this.testForCloudflare())return zo.log("loading"),void this.cdn();if(this.page.init(this),"webextension"===Uo.type)try{chrome.runtime.onMessage.addListener(((e,t,n)=>{this.presence(e,t,n)}))}catch(e){zo.error(e)}}getPage(e){return this.pages.type?this.pages:function(e,t){for(const n in t){const s=t[n];if(Po.$.isArray(s.domain)){let t;if(s.domain.forEach((n=>{Mo(e,n)&&(s.domain=n,t=s)})),t)return t}else if(Mo(e,s.domain))return s}return null}(e,this.pages)}domainSet(){this.page.domain=new URL(window.location.href).origin}openNextEp(){if(void 0===this.page.sync.nextEpUrl)Fo.flashm(Uo.storage.lang("nextEpShort_no_support"),{error:!0,type:"EpError"});else{if(this.page.isSyncPage(this.url)){const e=this.page.sync.nextEpUrl(this.url);if(e)return void(window.location.href=e)}Fo.flashm(Uo.storage.lang("nextEpShort_no_nextEp"),{error:!0,type:"EpError"})}}setVideoTime(e,t){this.resetPlayerError();const n=Uo.settings.get("videoDuration"),s=e.current/(e.duration*(n/100))*100;jo.$("#malSyncProgress").length&&(s<100?(jo.$(".ms-progress").css("width",`${s}%`),jo.$("#malSyncProgress").removeClass("ms-loading").removeClass("ms-done")):this.videoSyncOffset?(jo.$("#malSyncProgress").addClass("ms-done"),jo.$(".flash.type-update .sync").click()):Do.log("videoSyncOffset",s)),this.handleVideoResume(e,t),this.autoNextEp(e)}autoNextEp(e){Uo.settings.get("autoNextEp")&&!this.autoNextEpRun&&e.current+1>e.duration&&(this.autoNextEpRun=!0,this.openNextEp())}handleVideoResume(e,t){if(void 0===this.curState||void 0===this.curState.identifier||void 0===this.curState.episode)return;const n=this,s=`${this.curState.identifier}/${this.curState.episode}`;if(this.curState.lastVideoTime=e,void 0!==this.curState.videoChecked&&this.curState.videoChecked)this.curState.videoChecked>1&&e.current>10&&(zo.debug("Set Resume",e.current),a.setItem(s,e.current),this.curState.videoChecked=!0,setTimeout((()=>{this.curState&&(this.curState.videoChecked=2)}),1e4));else{const i=a.getItem(s);if(zo.info("Resume",i),null!==i&&parseInt(i)-30>e.current&&parseInt(i)>30){jo.$("#MALSyncResume").length||jo.$("#MALSyncResume").parent().parent().remove();const s=Math.round(parseInt(i));let a="";if(Uo.settings.get("autoresume")&&e.duration-s>.1*e.duration)return t(s),void(n.curState.videoChecked=2);let r=s;const o=Math.floor(r/60);r-=60*o;let l=`${r}`;for(;l.length<2;)l=`0${l}`;a=`${o}:${l}`;const c=Fo.flashm(`<button id="MALSyncResume" class="sync" style="margin-bottom: 2px; background-color: transparent; border: none; color: rgb(255,64,129);cursor: pointer;">${Uo.storage.lang("syncPage_flashm_resumeMsg",[a])}</button><br><button class="resumeClose" style="background-color: transparent; border: none; color: white;margin-top: 10px;cursor: pointer;">Close</button>`,{permanent:!0,error:!1,type:"resume",minimized:!1,position:"top"});c.find(".sync").on("click",(function(){t(s),n.curState.videoChecked=2,jo.$(this).parent().parent().remove()})),c.find(".resumeClose").on("click",(function(){n.curState.videoChecked=2,jo.$(this).parent().parent().remove()}))}else setTimeout((()=>{this.curState.videoChecked=2}),15e3);this.curState.videoChecked=!0}}reset(){this.url=window.location.href,this.UILoaded=!1,this.curState=void 0,this.setSearchObj(void 0),this.mangaProgress&&this.mangaProgress.stop(),$("#flashinfo-div, #flash-div-bottom, #flash-div-top, #malp").remove()}setSearchObj(e){e?_t():Uo.settings.get("floatButtonCorrection")&&wt(),this.searchObj=e}async handlePage(e=window.location.href){let t,n;if(this.resetPlayerError(),this.curState=void 0,this.setSearchObj(void 0),this.url=e,this.browsingtime=Date.now(),this.videoSyncOffset=!1,clearTimeout(this.videoSyncInterval),this.videoSyncInterval=setTimeout((()=>{this.videoSyncOffset=!0}),1e4),this.page.isSyncPage(this.url)){this.loadUI(),t={on:"SYNC",title:this.page.sync.getTitle(this.url),identifier:this.page.sync.getIdentifier(this.url),detectedEpisode:parseInt(`${this.page.sync.getEpisode(this.url)}`)},this.setSearchObj(new oo(t.title,this.novel?"novel":this.page.type,t.identifier)),this.searchObj.setPage(this.page),this.searchObj.setSyncPage(this),this.searchObj.setLocalUrl(this.generateLocalUrl(this.page,t)),this.curState=t,await this.searchObj.search();try{n=await this.searchObj.initRules()}catch(e){throw e instanceof R&&this.incorrectUrl(),e}t.detectedEpisode||0===t.detectedEpisode?t.episode=t.detectedEpisode+parseInt(this.searchObj.getRuledOffset(t.detectedEpisode)):"anime"===this.page.type?t.episode=1:t.episode=0,void 0!==this.page.sync.getVolume&&(t.volume=this.page.sync.getVolume(this.url)),"anime"===this.page.type&&(s=(e,t)=>{this.tempPlayer=t,this.setVideoTime(e,(e=>{void 0!==t?void 0!==e&&(t.play(),t.currentTime=e):zo.error("No player Found")}))},clearInterval(At),At=setInterval((function(){const e=document.getElementsByTagName("video");for(let t=0;t<e.length;t++){const n=e[t],{duration:i}=n,a=n.currentTime,{paused:r}=n;if(i&&i>60){const e={current:a,duration:i,paused:r};Pt.debug(window.location.href,e),s(e,n),Mt(e,n);break}}}),1e3)),zo.m("Sync","green").log(t)}else{if(void 0===this.page.overview)return void zo.log("No overview definition");if(void 0!==this.page.isOverviewPage&&!this.page.isOverviewPage(this.url))return void zo.info("Not an overview/sync page");this.loadUI(),t={on:"OVERVIEW",title:this.page.overview.getTitle(this.url),identifier:this.page.overview.getIdentifier(this.url)},this.setSearchObj(new oo(t.title,this.novel?"novel":this.page.type,t.identifier)),this.searchObj.setPage(this.page),this.searchObj.setSyncPage(this),this.searchObj.setLocalUrl(this.generateLocalUrl(this.page,t)),this.curState=t,await this.searchObj.search();try{n=await this.searchObj.initRules()}catch(e){throw e instanceof R&&this.incorrectUrl(),e}zo.m("Overview","green").log(t)}var s;this.curState=t;let i=this.searchObj.getRuledUrl(t.detectedEpisode);const a=this.generateLocalUrl(this.page,t);if(null!==i&&i||!Uo.settings.get("localSync")||(zo.log("Local Fallback"),i=a),null===i)jo.$("#MalInfo").text(Uo.storage.lang("Not_Found")),jo.$("#MalData").css("display","none"),zo.log("Not on mal");else if(i){zo.log("MyAnimeList",i);try{n||(n=ft(i),await n.update()),this.singleObj=n}catch(e){if(e instanceof R)throw this.incorrectUrl(),e;if(!(e instanceof D&&Uo.settings.get("localSync")))throw n&&(this.singleObj=n),this.singleObj.flashmError(e),this.fillUI(),e;zo.log("Local Fallback"),n=ft(a),await n.update(),this.singleObj=n}if("webextension"===Uo.type&&Uo.settings.get("rpc"))try{chrome.runtime.sendMessage(Vo,{mode:"active"},(function(e){zo.log("Presence registred",e)}))}catch(e){zo.error(e)}if(this.fillUI(),this.page.isSyncPage(this.url)){if(await this.searchObj.openCorrectionCheck())return void this.handlePage(e);await this.singleObj.checkSync(t.episode,t.volume)?(await this.singleObj.lifeCycleHook("afterCheckSync"),this.strongVolumes&&!t.episode||this.singleObj.setEpisode(t.episode),this.singleObj.setStreamingUrl(this.page.sync.getOverviewUrl(this.url)),void 0!==t.volume&&t.volume>this.singleObj.getVolume()&&this.singleObj.setVolume(t.volume),zo.log(`Start Sync (${Uo.settings.get("delay")} Seconds)`),this.singleObj.getMalId()&&"anime"===this.singleObj.getType()&&Uo.settings.get("checkForFiller")&&this.checkForFiller(this.singleObj.getMalId(),this.singleObj.getEpisode()),await this.startSyncHandling(t,i)):zo.log("Nothing to Sync")}await this.imageFallback()}else jo.$("#MalInfo").text(Uo.storage.lang("NothingFound")),jo.$("#MalData").css("display","none"),zo.log("Nothing found")}async startSyncHandling(e,t){let n=!1;if(this.mangaProgress)try{if(n=await this.mangaProgress.start(),!n)return}catch(e){zo.error(e)}if(n||"instant"!==Uo.settings.get(`autoTrackingMode${this.page.type}`)){const s={key:`syncPage_flashm_sync_${this.page.type}`,value:String(e.episode)};"manga"===this.page.type&&!e.episode&&e.volume&&(s.key="syncPage_flashm_sync_manga_volume",s.value=String(e.volume));let i=`<button class="sync" style="margin-bottom: 8px; background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;">${Uo.storage.lang(s.key,[Nt(t).shortName,s.value])}</button>`,a={hoverInfo:!0,error:!0,type:"update",minimized:!1};"video"===Uo.settings.get(`autoTrackingMode${this.page.type}`)&&"anime"===this.page.type&&(i=`\n          <div id="malSyncProgress" class="ms-loading" style="background-color: transparent; position: absolute; top: 0; left: 0; right: 0; height: 4px;">\n            <div class="ms-progress" style="background-color: #2980b9; width: 0%; height: 100%; transition: width 1s;"></div>\n          </div>\n          <div class="player-error" style="display: none; position: absolute; left: 0; right: 0; padding: 5px; bottom: 100%; color: rgb(255,64,129); background-color: #323232;">\n            <span class="player-error-default">${Uo.storage.lang("syncPage_flash_player_error")}</span>\n            <span class="player-error-missing-permissions" style="display: none; padding-top: 10px">\n              ${Uo.storage.lang("settings_custom_domains_missing_permissions_header")}\n            </span>\n            <div style="display: flex; justify-content: space-evenly">\n              <a class="player-error-missing-permissions" href="https://malsync.moe/pwa/#/settings/customDomains" style="display: none; margin: 10px; border-bottom: 2px solid #e13f7b;">\n                ${Uo.storage.lang("Add")}\n              </a>\n              <a href="https://discord.com/invite/cTH4yaw" style="display: block; margin: 10px">Help</a>\n            </div>\n\n          </div>\n        ${i}`,a={hoverInfo:!0,error:!1,type:"update",minimized:!0}),n&&(i=`\n          <div id="malSyncProgress" style="background-color: transparent; position: absolute; top: 0; left: 0; right: 0; height: 4px;">\n            <div class="ms-progress" style="background-color: #2980b9; width: 0%; height: 100%; transition: width 1s;"></div>\n          </div>\n        ${i}`,a={hoverInfo:!0,error:!1,type:"update",minimized:!0}),Fo.flashm(i,a).find(".sync").on("click",(()=>{jo.$(".flashinfo").remove(),this.sync(e),this.resetPlayerError()})),"anime"===this.singleObj.getType()&&(Bo=setTimeout((async()=>{jo.$("#flashinfo-div").addClass("player-error"),await async function(){if("webextension"!==yo.type)return!1;const e=new bo;await e.init();const t=e.getMissingPermissions(yo.settings.get("customDomains"));return vo.m("Missing Permissions").log(t),Boolean(t.length)}()&&jo.$("#flashinfo-div").addClass("player-error-missing-permissions");const e=$("iframe").toArray().map((e=>Fo.absoluteLink($(e).attr("src"),window.location.origin))).filter((e=>e)).filter((e=>!function(e){try{const t=chrome.runtime.getManifest().content_scripts.find((e=>e.js&&e.js.includes("content/iframe.js")));return!(!t||!t.matches)&&po(...t.matches).test(e)}catch(e){return!1}}(e)));Do.log("No Player found",e)}),3e5)),zo.log("overviewUrl",this.page.sync.getOverviewUrl(this.url)),void 0!==this.page.sync.nextEpUrl&&zo.log("nextEp",this.page.sync.nextEpUrl(this.url))}else setTimeout((()=>{this.sync(e)}),1e3*Uo.settings.get("delay"))}async sync(e){if(await this.singleObj.lifeCycleHook("beforeSync"),this.singleObj.setResumeWatching(this.url,e.episode),void 0!==this.page.sync.nextEpUrl){const t=this.page.sync.nextEpUrl(this.url);t&&-1===t.indexOf("undefined")&&this.singleObj.setContinueWatching(t,e.episode+1)}this.syncHandling(!0)}resetPlayerError(){Bo&&(clearTimeout(Bo),Bo=void 0,jo.$("#flashinfo-div").removeClass("player-error"),jo.$("#flashinfo-div").removeClass("player-error-missing-permissions"))}generateLocalUrl(e,t){return`local://${e.name}/${e.type}/${t.identifier}/${encodeURIComponent(t.title)}`}openCorrectionUi(){if(this.searchObj)return this.searchObj.openCorrection().then((e=>{e&&this.handlePage()}))}syncHandling(e=!1,t=!1){let n;return n=t?this.singleObj.undo():this.singleObj.sync(),n.then((()=>{let t=this.singleObj.getTitle(),n="<br>",s=this.singleObj.getTotalVolumes();0===s&&(s="?");let i=this.singleObj.getTotalEpisodes();0===i&&(i="?");let a=this.singleObj.getStateDiff();if(a||(a={onList:this.singleObj.isOnList(),episode:this.singleObj.getEpisode(),volume:this.singleObj.getVolume(),status:this.singleObj.getStatus(),score:this.singleObj.getScore()}),void 0===a.onList&&(a.onList=!0),a.onList&&a.status){let e="";switch(parseInt(a.status)){case 1:e=Uo.storage.lang(`UI_Status_watching_${this.page.type}`);break;case 2:e=Uo.storage.lang("UI_Status_Completed");break;case 3:e=Uo.storage.lang("UI_Status_OnHold");break;case 4:e=Uo.storage.lang("UI_Status_Dropped");break;case 6:e=Uo.storage.lang(`UI_Status_planTo_${this.page.type}`);break;case 23:e=Uo.storage.lang(`UI_Status_Rewatching_${this.page.type}`)}t+=n+e,n=" | "}if(a.onList||(t+=n+Uo.storage.lang("removed"),n=" | "),a.onList&&"manga"===this.page.type&&a.volume&&(t+=`${n+Uo.storage.lang("UI_Volume")} ${a.volume}/${s}`,n=" | "),a.onList&&a.episode&&(t+=`${n+Fo.episode(this.page.type)} ${a.episode}/${i}`,n=" | "),a.onList&&a.score&&(t+=`${n+Uo.storage.lang("UI_Score")} ${a.score}`,n=" | "),e){this.fullNotification(t),t+=`\n            <br>\n            <button class="undoButton" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;">\n              ${Uo.storage.lang("syncPage_flashm_sync_undefined_undo")}\n            </button>\n            <button class="wrongButton" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;">\n              ${Uo.storage.lang("syncPage_flashm_sync_undefined_wrong")}\n            </button>`;const e=Fo.flashm(t,{hoverInfo:!0,type:"update"});e.find(".undoButton").on("click",(e=>{const t=e.target.closest(".flash");t&&t.remove(),this.syncHandling(!1,!0)})),e.find(".wrongButton").on("click",(e=>{this.openCorrectionUi();const t=e.target.closest(".flash");t&&t.remove(),this.syncHandling(!1,!0)}))}else Fo.flashm(t);this.fillUI()})).catch((e=>{throw this.singleObj.flashmError(e),e}))}fullNotification(e){try{!function(e){if(Ct.settings.get("floatButtonStealth"))return;const t=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;if(t){const n=Lt.$(Lt.html(`\n        <div style="\n          all: initial;\n          position: absolute;\n          bottom: 0;\n          left: 0;\n          right: 0;\n          color: white;\n          display: none;\n          z-index: 20000;\n        ">\n          <div style="\n            background: rgba(50, 50, 50, 0.6);\n            color: white;\n            padding: 10px 15px 10px;\n            margin-left: auto;\n            margin-right: auto;\n            max-width: 60%;\n            display: table;\n            font-family: Helvetica,Arial,sans-serif;\n            text-align: center;\n          ">${e}</div>\n        </div>\n        `)).appendTo(Lt.$(t));n.slideDown(400).delay(2e3).slideUp(400,(()=>{n.remove()}))}}(e),"webextension"===Uo.type&&chrome.runtime.sendMessage({name:"content",item:{action:"fullscreenNotification",text:e}})}catch(e){zo.error(e)}}fillUI(){if(jo.$(".MalLogin").css("display",""),jo.$("#AddMalDiv, .malp-group-mal-add, #LoginMalDiv").remove(),jo.$("#malRating").attr("href",this.singleObj.getDisplayUrl()),this.singleObj.getLastError())return jo.$(".MalLogin").css("display","none"),jo.$("#MalData").css("display","flex"),jo.$("#MalInfo").text(""),void jo.$("#malRating").after(jo.html(`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id='LoginMalDiv'>${this.singleObj.getLastErrorMessage()}</span>`));let e="";this.singleObj.getScoreCheckbox().forEach((t=>{e+=`<option value="${t.value}" >${t.label}</option>`})),jo.$("#malUserRating").html(jo.html(e));let t="";if(this.singleObj.getStatusCheckbox().forEach((e=>{t+=`<option value="${e.value}" >${e.label}</option>`})),jo.$("#malStatus").html(jo.html(t)),this.singleObj.getRating().then((e=>{jo.$("#malRating").text(e)})),this.singleObj.isOnList())jo.$("#malTotal, #malTotalCha").text(this.singleObj.getTotalEpisodes()),0===this.singleObj.getTotalEpisodes()&&jo.$("#malTotal, #malTotalCha").text("?"),jo.$("#malTotalVol").text(this.singleObj.getTotalVolumes()),0===this.singleObj.getTotalVolumes()&&jo.$("#malTotalVol").text("?"),jo.$("#malEpisodes").val(this.singleObj.getEpisode()),jo.$("#malVolumes").val(this.singleObj.getVolume()),jo.$("#malStatus").val(this.singleObj.getStatusCheckboxValue()),jo.$("#malUserRating").val(this.singleObj.getScoreCheckboxValue());else{jo.$(".MalLogin").css("display","none"),jo.$("#malRating").after(jo.html(`<span id='AddMalDiv'><a href='#' id='AddMal' class="malp-mal-add" onclick='return false;'>${Uo.storage.lang("syncPage_malObj_addAnime",[this.singleObj.shortName])}</a></span>`)),jo.$(".malp-group-rating").after(jo.html(`<span class="malp-group malp-group-mal-add" style="display: none;"><span class="add malp-group-label">_</span><a href='#' id='AddMal' class="malp-group-field malp-mal-add" onclick='return false;'>${Uo.storage.lang("syncPage_malObj_addAnime",[this.singleObj.shortName])}</a></span>`));const e=this;jo.$(".malp-mal-add").click((async function(t){t.preventDefault(),e.page.isSyncPage(e.url)||e.singleObj.setStreamingUrl(e.url),await e.searchObj.openCorrectionCheck()?e.handlePage():e.syncHandling().then((()=>e.singleObj.update())).then((()=>{e.fillUI()}))}))}jo.$("#MalData").css("display","flex"),jo.$("#MalInfo").text(""),this.calcSelectWidth(jo.$("#malEpisodes, #malVolumes, #malUserRating, #malStatus")),jo.$("#malEpisodes, #malVolumes").trigger("input");try{this.handleList(!0)}catch(e){zo.error(e)}}handleList(e=!1,t=0){if(this.singleObj&&(jo.$(".mal-sync-active").removeClass("mal-sync-active"),jo.$("[data-mal-sync-episode]").removeAttr("data-mal-sync-episode"),jo.$("[data-mal-sync-episode-detected]").removeAttr("data-mal-sync-episode-detected"),jo.$("[data-mal-sync-entry]").removeAttr("data-mal-sync-entry"),void 0!==this.page.overview&&void 0!==this.page.overview.list)){const n=this.getEpList();if(void 0!==n&&n.length>0&&(this.offsetHandler(n),this.page.overview.list.elementUrl)){const{elementUrl:s}=this.page.overview.list;zo.log("Episode List",jo.$.map(n,(function(e,t){return void 0!==e?s(e):"-"}))),void 0!==this.page.overview.list.handleListHook&&this.page.overview.list.handleListHook(this.singleObj.getEpisode(),n);const i=n[parseInt(this.singleObj.getEpisode()||1)];if(void 0===i&&!i&&e&&t<10&&void 0!==this.page.overview.list.paginationNext){zo.log("Pagination next");const e=this;this.page.overview.list.paginationNext(!1)&&setTimeout((function(){t++,e.handleList(!0,t)}),500)}const a=n[this.singleObj.getEpisode()+1];if(void 0!==a&&a&&!this.page.isSyncPage(this.url)){const e=`<a href="${s(a)}">${Uo.storage.lang(`syncPage_malObj_nextEp_${this.page.type}`,[this.singleObj.getEpisode()+1])}</a>`;Fo.flashm(e,{hoverInfo:!0,type:"nextEp",minimized:!0})}}}}getEpList(){const e=this,t=[];if(void 0!==this.page.overview&&void 0!==this.page.overview.list){const{elementEp:n}=this.page.overview.list;let s=0;this.singleObj&&(s=parseInt(this.singleObj.getEpisode())),this.page.overview.list.elementsSelector().each((function(i,a){try{const i=parseInt(`${n(jo.$(a))}`);let r=0;if(e.searchObj&&e.searchObj.getRuledOffset(i)){r=Number(e.searchObj.getRuledOffset(i));const t=e.searchObj.getUrl(),n=e.searchObj.getRuledUrl(i);if(t!==n)return void jo.$(a).attr("data-mal-sync-entry",n)}const o=i+r;t[o]=jo.$(a),jo.$(a).attr("data-mal-sync-episode",o),o!==i&&jo.$(a).attr("data-mal-sync-episode-detected",i),(Uo.settings.get("highlightAllEp")&&o<=s||o===s)&&jo.$(a).addClass("mal-sync-active")}catch(e){zo.info(e)}}))}return t}offsetHandler(e){if(this.page.overview.list.offsetHandler&&!this.getOffset()&&this.searchObj&&"user"!==this.searchObj.provider)for(let t=0;t<e.length;++t)if(void 0!==e[t]){if(zo.log("Offset",t),t>1){const e=1-t;Fo.flashConfirm(Uo.storage.lang("syncPage_flashConfirm_offsetHandler_1",[String(e)]),"offset",(()=>{this.setOffset(e)}),(()=>{this.setOffset(0)}),!0)}return}}async imageFallback(){if(this.singleObj&&void 0!==this.singleObj.setImage&&this.page.getImage){const e=await this.page.getImage();e&&this.singleObj.setImage(e)}}incorrectUrl(){Fo.flashm("Incorrect url provided",{error:!0,type:"error"}),this.openCorrectionUi()}testForCloudflare(){return"Just a moment..."===document.title||-1!==document.title.indexOf("Cloudflare")}cdn(e="default"){Uo.storage.addStyle("\n      .bubbles {\n        display: none !important;\n      }\n      div#cf-content:before {\n        content: '';\n        background-image: url(https://raw.githubusercontent.com/MALSync/MALSync/master/assets/icons/icon128.png);\n        height: 64px;\n        width: 64px;\n        display: block;\n        background-size: cover;\n        animation: rotate 3s linear infinite;\n        background-color: #251e2b;\n        border-radius: 50%;\n      }\n      @keyframes rotate{ to{ transform: rotate(360deg); } }\n    ")}getOffset(){return this.searchObj&&this.searchObj.getOffset()?this.searchObj.getOffset():0}async setOffset(e){this.searchObj&&this.searchObj.setOffset(e),void 0!==this.singleObj&&Uo.storage.remove(`updateCheck/${this.singleObj.getType()}/${this.singleObj.getCacheKey()}`)}loadUI(){const e=this;if(this.UILoaded)return;this.UILoaded=!0;const t="</span>";let n=`<p id="malp" dir="${Uo.storage.langDirection()}">`;n+=`<span id="MalInfo">${Uo.storage.lang("Loading")}</span>`,n+='<span id="MalData" style="display: none; justify-content: space-between; flex-wrap: wrap;">',n+='<span style="display: inline-block;" class="malp-group malp-group-rating">',n+=`<span class="info malp-group-label">${Uo.storage.lang("search_Score")} </span>`,n+='<a id="malRating" class="malp-group-field" style="min-width: 30px;display: inline-block;" target="_blank" href="">____</a>',n+=t;const s=e=>`<span style="display: inline-block; display: none;" class="MalLogin malp-group malp-group-${e}">`;n+=s("status"),n+=`<span class="info malp-group-label">${Uo.storage.lang("UI_Status")} </span>`,n+='<select id="malStatus" class="malp-group-field malp-group-select">',n+="</select>",n+=t;let i="";"anime"===this.page.type?(i+=s("episode"),i+=`<span class="info malp-group-label">${Uo.storage.lang("UI_Episode")} </span>`,i+='<span style=" text-decoration: none; outline: medium none;" class="malp-group-value-section">',i+='<input id="malEpisodes" class="malp-group-field malp-group-input" value="0" type="text" size="1" maxlength="4">',i+='/<span id="malTotal" class="malp-group-value">0</span>',i+="</span>",i+=t):(i+=s("volume"),i+=`<span class="info malp-group-label">${Uo.storage.lang("UI_Volume")} </span>`,i+='<span style=" text-decoration: none; outline: medium none;" class="malp-group-value-section">',i+='<input id="malVolumes" class="malp-group-field malp-group-input" value="0" type="text" size="1" maxlength="4">',i+='/<span id="malTotalVol" class="malp-group-value">0</span>',i+="</span>",i+=t,i+=s("chapter"),i+=`<span class="info malp-group-label">${Uo.storage.lang("UI_Chapter")} </span>`,i+='<span style=" text-decoration: none; outline: medium none;" class="malp-group-value-section">',i+='<input id="malEpisodes" class="malp-group-field malp-group-input" value="0" type="text" size="1" maxlength="4">',i+='/<span id="malTotalCha" class="malp-group-value">0</span>',i+="</span>",i+=t),n+=i,n+=s("score"),n+=`<span class="info malp-group-label">${Uo.storage.lang("UI_Score")}</span>`,n+='<select id="malUserRating" class="malp-group-field malp-group-select">',n+="</select>",n+=t,n+="</span>",n+="</p>",this.page.isSyncPage(this.url)?void 0!==this.page.sync.uiSelector&&this.page.sync.uiSelector(n):void 0!==this.page.overview&&this.page.overview.uiSelector(n),jo.$("#malEpisodes, #malVolumes, #malUserRating, #malStatus").change((function(){e.buttonclick();const t=jo.$(this);e.calcSelectWidth(t)})),jo.$("#malEpisodes, #malVolumes").on("input",(function(){const e=jo.$(this);let t=e.val().toString().length;t<1&&(t=1);const n=7.7*t+3;e.css("width",`${n}px`)})).trigger("input")}calcSelectWidth(e){e.each((function(e,t){const n=jo.$(t).find("option:selected").text(),s=jo.$('<select style="width: auto;"/>').append(jo.html(`<option>${n}</option>`)),i=s.width()||0;i&&(jo.$("#malp").append(jo.html(s)),jo.$(t).width(i+5),s.remove())}))}async buttonclick(){this.singleObj.setEpisode(jo.$("#malEpisodes").val()),jo.$("#malVolumes").length&&this.singleObj.setVolume(jo.$("#malVolumes").val()),this.singleObj.handleScoreCheckbox(jo.$("#malUserRating").val()),this.singleObj.handleStatusCheckbox(jo.$("#malStatus").val()),this.page.isSyncPage(this.url)||this.singleObj.setStreamingUrl(this.url),await this.searchObj.openCorrectionCheck()?this.handlePage():this.syncHandling().then((()=>this.singleObj.update())).then((()=>{this.fillUI()}))}presence(e,t,n){try{if("presence"===e.action){console.log("Presence requested",e,this.curState),clearTimeout(Ho),Ho=setTimeout((()=>{this.browsingtime=void 0}),3e5),this.browsingtime||(this.browsingtime=Date.now());let t=!0,s=!0;switch(Uo.settings.get("presenceLargeImage")){case"website":t=!1,s=!1;break;case"malsync":t=!1,s=!0}let i,a,r="606504719212478504";if(Uo.settings.get("presenceShowMalsync")||(r="anime"!==this.page.type?"823563138669608980":"823563096747802695"),s?(i="malsync",a="MAL-Sync"):(i=this.page.name.toLowerCase(),a=`${this.page.name} • MAL-Sync`),t&&this.singleObj.getImage()&&(i=this.singleObj.getImage()),this.curState){const e={clientId:r,presence:{details:this.singleObj.getTitle(!0)||this.curState.title,largeImageKey:i,largeImageText:a,instance:!0,type:3}};if(Uo.settings.get("presenceShowButtons")){let t=null;"Local"!==this.singleObj.shortName&&(t=this.singleObj.getDisplayUrl()),t||(t=this.singleObj.getMalUrl()),t||s||(t=this.singleObj.getStreamingUrl()),t&&(e.presence.buttons=[{label:Uo.storage.lang(`discord_rpc_view_${this.singleObj.getType()}`),url:t}])}if(void 0!==this.curState.episode){const t=[];if(this.curState.episode>0){let e=this.singleObj.getTotalEpisodes();e=e?`/${e}`:"",t.push(`${Fo.episode(this.page.type)} ${this.curState.episode}${e}`)}if(this.curState.volume>0){const e=this.curState.volume;let n=this.singleObj.getTotalVolumes();n=n?`/${n}`:"",t.push(`${Uo.storage.lang("UI_Volume")} ${e}${n}`)}if(e.presence.state=t.join(" | "),void 0!==this.curState.lastVideoTime)if(this.curState.lastVideoTime.paused)e.presence.smallImageKey="pause",e.presence.smallImageText="Paused";else{const t=this.curState.lastVideoTime.duration-this.curState.lastVideoTime.current;e.presence.endTimestamp=Date.now()+1e3*t,e.presence.startTimestamp=this.browsingtime,e.presence.smallImageKey="play",e.presence.smallImageText="Playing"}else e.presence.startTimestamp=this.browsingtime,"anime"!==this.page.type&&(e.presence.smallImageKey="reading",e.presence.smallImageText="Reading")}else{let t;t=s?this.page.type.toString():this.page.name,e.presence.startTimestamp=this.browsingtime,e.presence.state=Uo.storage.lang("Discord_rpc_browsing",[t])}return void n(e)}}}catch(e){zo.error(e)}n({})}async checkForFiller(e,t){const n=Math.ceil(t/100),s=new u(`fillers/${e}/${n}`,6048e5);if(!await s.hasValueAndIsNotEmpty()){const t=`https://api.jikan.moe/v4/anime/${e}/episodes?page=${n}`,i=await Uo.request.xhr("GET",t).then((async e=>{try{if(200===e.status&&e.responseText){const t=JSON.parse(e.responseText);if(t.data&&t.data.length)return t.data.map((e=>({filler:e.filler,recap:e.recap,episode_id:e.mal_id}))).filter((e=>e.filler||e.recap))}}catch(e){}return[]}));await s.setValue(i)}const i=await s.getValue();if(i&&i.length){const e=i.find((e=>e.episode_id===t));if(e&&(e.filler||e.recap)){const t=e.filler?"filler":"recap";Fo.flashConfirm(Uo.storage.lang(`filler_${t}_confirm`),"filler",(()=>{this.openNextEp()}),(()=>{}),!0)}}}}var Go=n(13647),Ko=n(7263),qo=n(78584),Xo=n(26017);async function Yo(){const e=await Go.storage.get("timestampUpdate/firebaseNotification");(void 0===e||Ko.$.now()-e>6e5)&&(await Jo(),Go.storage.set("timestampUpdate/firebaseNotification",Ko.$.now()))}async function Jo(){qo.log("checkNotifications");const e=await Go.request.xhr("GET","https://kissanimelist.firebaseio.com/Data2/Notification/Current.json"),t=parseInt(JSON.parse(e.responseText));Number.isNaN(t)&&qo.error("Could not read current Notification number"),qo.log("Current Notification",t);const n=parseInt(await Go.storage.get("firebaseNotification")),s=n+1;if(void 0===n||Number.isNaN(n))return void Go.storage.set("firebaseNotification",t);if(t<s)return void qo.log("No new notifications");const i=`https://kissanimelist.firebaseio.com/Data2/Notification/list/N${s}.json`,a=await Go.request.xhr("GET",i);if(!a)return;const r=JSON.parse(a.responseText);if(!r)return qo.info("Notification empty",a.responseText),void Go.storage.set("firebaseNotification",s).then((function(){Jo()}));Ko.$(document).ready((function(){const e=Xo.flashm(`<div style="text-align: left;">${r}</div><button class="okChangelog" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px;cursor: pointer;">Close</button>`,{permanent:!0,position:"top"});e.find(".okChangelog").click((function(){e.remove(),Go.storage.set("firebaseNotification",s).then((function(){Jo()}))}))}))}var Zo=n(13647),Qo=n(78584);function el(e){Zo.settings.get("floatButtonCorrection")?(Qo.log("Open correction"),e.openCorrectionUi()):(Qo.log("Open miniMAL"),function(){const e=tl(Zo.settings.get("miniMalWidth"),window.screen.width),t=tl(Zo.settings.get("miniMalHeight"),window.screen.height);let n;n="right"===Zo.settings.get("posLeft")?window.screen.width-e:"left"===Zo.settings.get("posLeft")?1:0,chrome.runtime.sendMessage({name:"minimalWindow",height:t,width:e,left:n},(function(e){Qo.log("Opened")}))}())}function tl(e,t){if(/^\d+px$/i.test(e))return parseInt(e.replace(/px/i,""));if(/^\d+%$/i.test(e)){const n=parseInt(e.replace(/%/i,""));return parseInt(""+t*(n/100))}return NaN}var nl=n(78584),sl=n(13647),il=n(7263);let al,rl;if(void 0!==n.g.doubleLoad&&n.g.doubleLoad)throw nl.error("Double Execution"),"Double Execution";n.g.doubleLoad=!0,console.log("%cMAL-Sync","font-size: 40px; padding-bottom: 3px; color: white; text-shadow: -1px -1px #2e51a2, 1px -1px #2e51a2, -1px 1px #2e51a2, 1px 1px #2e51a2, 2px 2px #2e51a2, 3px 3px #2e51a2;",`Version: ${sl.storage.version()}`),sl.settings.init().then((()=>{!async function(){if(sl.settings.get("userscriptModeButton"))throw"Userscript mode";let e="undefined"!=typeof _PageChibi?_PageChibi:_Page;"function"==typeof e&&(e=await e());const t=new Wo(window.location.href,e,el);!function(e){var t;chrome.runtime.onMessage.addListener((function(t,n,s){if("TabMalUrl"===t.action&&Date.now()-al<3e3&&(nl.log("TabMalUrl Message",e.singleObj.url),s({url:e.singleObj.url,title:e.singleObj.getTitle(),image:e.singleObj.getImage()})),"videoTime"===t.action&&(e.setVideoTime(t.item,(function(e){chrome.runtime.sendMessage({name:"videoTimeSet",time:e,sender:t.sender})})),rl=async function(e){chrome.runtime.sendMessage({name:"videoTimeSet",timeAdd:e,sender:t.sender})}),"videoTimeSet"===t.action){if(nl.log("[Iframe] Set Time",t),void 0===e.tempPlayer)return void nl.error("[Iframe] No player Found");if(void 0!==t.time)return e.tempPlayer.play(),void(e.tempPlayer.currentTime=t.time);if(void 0!==t.timeAdd)return e.tempPlayer.play(),void(e.tempPlayer.currentTime+=t.timeAdd)}if("content"===t.action)switch(t.item.action){case"nextEpShort":e.openNextEp();break;case"correctionShort":e.openCorrectionUi();break;case"syncShort":il.$("#malSyncProgress").addClass("ms-done"),il.$(".flash.type-update .sync").click()}})),Dt=t=t=>{switch(nl.log("[content] Shortcut",t),t.shortcut){case"introSkipFwd":n(!0);break;case"introSkipBwd":n(!1);break;case"nextEpShort":e.openNextEp();break;case"correctionShort":e.openCorrectionUi();break;case"syncShort":il.$("#malSyncProgress").addClass("ms-done"),il.$(".flash.type-update .sync").click()}async function n(t){if(void 0===e.tempPlayer)return rl?void rl(t):void nl.error("[content] No iframe and onsite player found");let n=parseInt(await sl.settings.getAsync("introSkip"));t||(n=0-n);const s=e.tempPlayer.currentTime+n;e.tempPlayer.duration&&e.tempPlayer.duration>15&&s>e.tempPlayer.duration-3?e.tempPlayer.currentTime=e.tempPlayer.duration-3:e.tempPlayer.currentTime=s}},Ut||function(){Ut=!0;let e={};function n(n){const i=(n=n||event).which||n.keyCode;e[i]="keydown"===n.type;for(let e=0;e<jt.length;e++){const t=jt[e];s(t)&&(n.target instanceof Node&&(/textarea|input|select/i.test(n.target.nodeName)||n.target instanceof Element&&n.target.shadowRoot)?Ot.info("Input field. Shortcut suppressed."):a(t))}function a(n){return e={},t({shortcut:n}),!1}}function s(t){const n=Ct.settings.get(t);if(!n.length)return!1;let s=!0;return n.forEach((function(t){e[t]||(s=!1)})),s&&Object.values(e).filter((e=>e)).length!==n.length&&(s=!1),s}document.addEventListener("keydown",n),document.addEventListener("keyup",n),window.addEventListener("focus",(function(){e={}}),!1)}()}(t),t.init(),Yo(),$(window).blur((function(){al=Date.now()}))}()}))})()})();
//# sourceMappingURL=content-script.js.map