/*! For license information please see chibi.js.LICENSE.txt */
(()=>{var e={50953:(e,t,n)=>{"use strict";n.d(t,{KR:()=>ee,Kh:()=>W});var r=n(90033);let i,o,s=0;function a(){s++}function l(){if(--s>0)return;if(o){let e=o;for(o=void 0;e;){const t=e.next;e.next=void 0,e.flags&=-9,e=t}}let e;for(;i;){let t=i;for(i=void 0;t;){const n=t.next;if(t.next=void 0,t.flags&=-9,1&t.flags)try{t.trigger()}catch(t){e||(e=t)}t=n}}if(e)throw e}let c=!0;const u=[];class p{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){}trigger(e){this.version++,this.notify(e)}notify(e){a();try{for(let e=this.subs;e;e=e.prevSub)e.sub.notify()&&e.sub.dep.notify()}finally{l()}}}const d=new WeakMap,h=Symbol(""),f=Symbol(""),g=Symbol("");function m(e,t,n){0}function y(e,t,n,i,o,s){const c=d.get(e);if(!c)return;const u=e=>{e&&e.trigger()};if(a(),"clear"===t)c.forEach(u);else{const o=(0,r.cy)(e),s=o&&(0,r.yI)(n);if(o&&"length"===n){const e=Number(i);c.forEach(((t,n)=>{("length"===n||n===g||!(0,r.Bm)(n)&&n>=e)&&u(t)}))}else switch((void 0!==n||c.has(void 0))&&u(c.get(n)),s&&u(c.get(g)),t){case"add":o?s&&u(c.get("length")):(u(c.get(h)),(0,r.CE)(e)&&u(c.get(f)));break;case"delete":o||(u(c.get(h)),(0,r.CE)(e)&&u(c.get(f)));break;case"set":(0,r.CE)(e)&&u(c.get(h))}}l()}function E(e){const t=K(e);return t===e?t:(m(),q(e)?t:t.map(J))}function v(e){return m(e=K(e)),e}const w={__proto__:null,[Symbol.iterator](){return b(this,Symbol.iterator,J)},concat(...e){return E(this).concat(...e.map((e=>(0,r.cy)(e)?E(e):e)))},entries(){return b(this,"entries",(e=>(e[1]=J(e[1]),e)))},every(e,t){return T(this,"every",e,t,void 0,arguments)},filter(e,t){return T(this,"filter",e,t,(e=>e.map(J)),arguments)},find(e,t){return T(this,"find",e,t,J,arguments)},findIndex(e,t){return T(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return T(this,"findLast",e,t,J,arguments)},findLastIndex(e,t){return T(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return T(this,"forEach",e,t,void 0,arguments)},includes(...e){return R(this,"includes",e)},indexOf(...e){return R(this,"indexOf",e)},join(e){return E(this).join(e)},lastIndexOf(...e){return R(this,"lastIndexOf",e)},map(e,t){return T(this,"map",e,t,void 0,arguments)},pop(){return _(this,"pop")},push(...e){return _(this,"push",e)},reduce(e,...t){return S(this,"reduce",e,t)},reduceRight(e,...t){return S(this,"reduceRight",e,t)},shift(){return _(this,"shift")},some(e,t){return T(this,"some",e,t,void 0,arguments)},splice(...e){return _(this,"splice",e)},toReversed(){return E(this).toReversed()},toSorted(e){return E(this).toSorted(e)},toSpliced(...e){return E(this).toSpliced(...e)},unshift(...e){return _(this,"unshift",e)},values(){return b(this,"values",J)}};function b(e,t,n){const r=v(e),i=r[t]();return r===e||q(e)||(i._next=i.next,i.next=()=>{const e=i._next();return e.value&&(e.value=n(e.value)),e}),i}const I=Array.prototype;function T(e,t,n,r,i,o){const s=v(e),a=s!==e&&!q(e),l=s[t];if(l!==I[t]){const t=l.apply(e,o);return a?J(t):t}let c=n;s!==e&&(a?c=function(t,r){return n.call(this,J(t),r,e)}:n.length>2&&(c=function(t,r){return n.call(this,t,r,e)}));const u=l.call(s,c,r);return a&&i?i(u):u}function S(e,t,n,r){const i=v(e);let o=n;return i!==e&&(q(e)?n.length>3&&(o=function(t,r,i){return n.call(this,t,r,i,e)}):o=function(t,r,i){return n.call(this,t,J(r),i,e)}),i[t](o,...r)}function R(e,t,n){const r=K(e);m();const i=r[t](...n);return(-1===i||!1===i)&&(o=n[0])&&o.__v_raw?(n[0]=K(n[0]),r[t](...n)):i;var o}function _(e,t,n=[]){u.push(c),c=!1,a();const r=K(e)[t].apply(e,n);return l(),function(){const e=u.pop();c=void 0===e||e}(),r}const A=(0,r.pD)("__proto__,__v_isRef,__isVue"),x=new Set(Object.getOwnPropertyNames(Symbol).filter((e=>"arguments"!==e&&"caller"!==e)).map((e=>Symbol[e])).filter(r.Bm));function N(e){(0,r.Bm)(e)||(e=String(e));const t=K(this);return m(),t.hasOwnProperty(e)}class O{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,n){if("__v_skip"===t)return e.__v_skip;const i=this._isReadonly,o=this._isShallow;if("__v_isReactive"===t)return!i;if("__v_isReadonly"===t)return i;if("__v_isShallow"===t)return o;if("__v_raw"===t)return n===(i?o?B:H:o?z:G).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const s=(0,r.cy)(e);if(!i){let e;if(s&&(e=w[t]))return e;if("hasOwnProperty"===t)return N}const a=Reflect.get(e,t,Q(e)?e:n);return((0,r.Bm)(t)?x.has(t):A(t))?a:(i||m(),o?a:Q(a)?s&&(0,r.yI)(t)?a:a.value:(0,r.Gv)(a)?i?V(a):W(a):a)}}class $ extends O{constructor(e=!1){super(!1,e)}set(e,t,n,i){let o=e[t];if(!this._isShallow){const t=Y(o);if(q(n)||Y(n)||(o=K(o),n=K(n)),!(0,r.cy)(e)&&Q(o)&&!Q(n))return!t&&(o.value=n,!0)}const s=(0,r.cy)(e)&&(0,r.yI)(t)?Number(t)<e.length:(0,r.$3)(e,t),a=Reflect.set(e,t,n,Q(e)?e:i);return e===K(i)&&(s?(0,r.$H)(n,o)&&y(e,"set",t,n):y(e,"add",t,n)),a}deleteProperty(e,t){const n=(0,r.$3)(e,t),i=(e[t],Reflect.deleteProperty(e,t));return i&&n&&y(e,"delete",t,void 0),i}has(e,t){const n=Reflect.has(e,t);return(0,r.Bm)(t)&&x.has(t)||m(),n}ownKeys(e){return m(0,0,(0,r.cy)(e)),Reflect.ownKeys(e)}}class L extends O{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const C=new $,M=new L,P=e=>e,k=e=>Reflect.getPrototypeOf(e);function D(e){return function(...t){return"delete"!==e&&("clear"===e?void 0:this)}}function U(e,t){const n=function(e,t){const n={get(n){const i=this.__v_raw,o=K(i),s=K(n);e||((0,r.$H)(n,s)&&m(),m());const{has:a}=k(o),l=t?P:e?Z:J;return a.call(o,n)?l(i.get(n)):a.call(o,s)?l(i.get(s)):void(i!==o&&i.get(n))},get size(){const t=this.__v_raw;return!e&&m(K(t)),Reflect.get(t,"size",t)},has(t){const n=this.__v_raw,i=(K(n),K(t));return e||((0,r.$H)(t,i)&&m(),m()),t===i?n.has(t):n.has(t)||n.has(i)},forEach(n,r){const i=this,o=i.__v_raw,s=(K(o),t?P:e?Z:J);return!e&&m(),o.forEach(((e,t)=>n.call(r,s(e),s(t),i)))}};return(0,r.X$)(n,e?{add:D("add"),set:D("set"),delete:D("delete"),clear:D("clear")}:{add(e){t||q(e)||Y(e)||(e=K(e));const n=K(this);return k(n).has.call(n,e)||(n.add(e),y(n,"add",e,e)),this},set(e,n){t||q(n)||Y(n)||(n=K(n));const i=K(this),{has:o,get:s}=k(i);let a=o.call(i,e);a||(e=K(e),a=o.call(i,e));const l=s.call(i,e);return i.set(e,n),a?(0,r.$H)(n,l)&&y(i,"set",e,n):y(i,"add",e,n),this},delete(e){const t=K(this),{has:n,get:r}=k(t);let i=n.call(t,e);i||(e=K(e),i=n.call(t,e)),r&&r.call(t,e);const o=t.delete(e);return i&&y(t,"delete",e,void 0),o},clear(){const e=K(this),t=0!==e.size,n=e.clear();return t&&y(e,"clear",void 0,void 0),n}}),["keys","values","entries",Symbol.iterator].forEach((i=>{n[i]=function(e,t,n){return function(...i){const o=this.__v_raw,s=K(o),a=(0,r.CE)(s),l="entries"===e||e===Symbol.iterator&&a,c=o[e](...i),u=n?P:t?Z:J;return!t&&m(),{next(){const{value:e,done:t}=c.next();return t?{value:e,done:t}:{value:l?[u(e[0]),u(e[1])]:u(e),done:t}},[Symbol.iterator](){return this}}}}(i,e,t)})),n}(e,t);return(t,i,o)=>"__v_isReactive"===i?!e:"__v_isReadonly"===i?e:"__v_raw"===i?t:Reflect.get((0,r.$3)(n,i)&&i in t?n:t,i,o)}const F={get:U(!1,!1)},j={get:U(!0,!1)},G=new WeakMap,z=new WeakMap,H=new WeakMap,B=new WeakMap;function W(e){return Y(e)?e:X(e,!1,C,F,G)}function V(e){return X(e,!0,M,j,H)}function X(e,t,n,i,o){if(!(0,r.Gv)(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const s=o.get(e);if(s)return s;const a=(l=e).__v_skip||!Object.isExtensible(l)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}((0,r.Zf)(l));var l;if(0===a)return e;const c=new Proxy(e,2===a?i:n);return o.set(e,c),c}function Y(e){return!(!e||!e.__v_isReadonly)}function q(e){return!(!e||!e.__v_isShallow)}function K(e){const t=e&&e.__v_raw;return t?K(t):e}const J=e=>(0,r.Gv)(e)?W(e):e,Z=e=>(0,r.Gv)(e)?V(e):e;function Q(e){return!!e&&!0===e.__v_isRef}function ee(e){return n=!1,Q(t=e)?t:new te(t,n);var t,n}class te{constructor(e,t){this.dep=new p,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=t?e:K(e),this._value=t?e:J(e),this.__v_isShallow=t}get value(){return this.dep.track(),this._value}set value(e){const t=this._rawValue,n=this.__v_isShallow||q(e)||Y(e);e=n?e:K(e),(0,r.$H)(e,t)&&(this._rawValue=e,this._value=n?e:J(e),this.dep.trigger())}}},90033:(e,t,n)=>{"use strict";function r(e){const t=Object.create(null);for(const n of e.split(","))t[n]=1;return e=>e in t}n.d(t,{$3:()=>s,$H:()=>v,Bm:()=>c,CE:()=>l,Gv:()=>u,X$:()=>i,Zf:()=>h,cy:()=>a,pD:()=>r,yI:()=>f});const i=Object.assign,o=Object.prototype.hasOwnProperty,s=(e,t)=>o.call(e,t),a=Array.isArray,l=e=>"[object Map]"===d(e),c=e=>"symbol"==typeof e,u=e=>null!==e&&"object"==typeof e,p=Object.prototype.toString,d=e=>p.call(e),h=e=>d(e).slice(8,-1),f=e=>"string"==typeof e&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,g=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},m=/-(\w)/g,y=(g((e=>e.replace(m,((e,t)=>t?t.toUpperCase():"")))),/\B([A-Z])/g),E=(g((e=>e.replace(y,"-$1").toLowerCase())),g((e=>e.charAt(0).toUpperCase()+e.slice(1)))),v=(g((e=>e?`on${E(e)}`:"")),(e,t)=>!Object.is(e,t))},55002:(e,t,n)=>{var r=n(89489),i=n(34160),o=r.Chibi;void 0===i._PageChibi&&(i._PageChibi=o),e.exports=r},34160:(e,t,n)=>{"use strict";e.exports=function(){if("object"==typeof globalThis)return globalThis;var e;try{e=this||new Function("return this")()}catch(e){if("object"==typeof window)return window;if("object"==typeof self)return self;if(void 0!==n.g)return n.g}return e}()},53908:(e,t,n)=>{const r=n(57272),{MAX_LENGTH:i,MAX_SAFE_INTEGER:o}=n(16874),{safeRe:s,safeSrc:a,t:l}=n(99718),c=n(98587),{compareIdentifiers:u}=n(61123);class p{constructor(e,t){if(t=c(t),e instanceof p){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?s[l.LOOSE]:s[l.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>o||this.major<0)throw new TypeError("Invalid major version");if(this.minor>o||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>o||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<o)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof p)){if("string"==typeof e&&e===this.version)return 0;e=new p(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof p||(e=new p(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof p||(e=new p(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(r("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}compareBuild(e){e instanceof p||(e=new p(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(r("build compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(t){const e=new RegExp(`^${this.options.loose?a[l.PRERELEASELOOSE]:a[l.PRERELEASE]}$`),n=`-${t}`.match(e);if(!n||n[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(0===this.prerelease.length)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(0===this.prerelease.length)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];!1===n&&(r=[t]),0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=p},50560:(e,t,n)=>{const r=n(53908);e.exports=(e,t,n)=>new r(e,n).compare(new r(t,n))},35580:(e,t,n)=>{const r=n(50560);e.exports=(e,t,n)=>r(e,t,n)>0},54089:(e,t,n)=>{const r=n(50560);e.exports=(e,t,n)=>r(e,t,n)>=0},16874:e=>{const t=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},57272:e=>{const t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=t},61123:e=>{const t=/^[0-9]+$/,n=(e,n)=>{const r=t.test(e),i=t.test(n);return r&&i&&(e=+e,n=+n),e===n?0:r&&!i?-1:i&&!r?1:e<n?-1:1};e.exports={compareIdentifiers:n,rcompareIdentifiers:(e,t)=>n(t,e)}},98587:e=>{const t=Object.freeze({loose:!0}),n=Object.freeze({});e.exports=e=>e?"object"!=typeof e?t:e:n},99718:(e,t,n)=>{const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:o}=n(16874),s=n(57272),a=(t=e.exports={}).re=[],l=t.safeRe=[],c=t.src=[],u=t.safeSrc=[],p=t.t={};let d=0;const h="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",o],[h,i]],g=(e,t,n)=>{const r=(e=>{for(const[t,n]of f)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=d++;s(e,i,t),p[e]=i,c[i]=t,u[i]=r,a[i]=new RegExp(t,n?"g":void 0),l[i]=new RegExp(r,n?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),g("MAINVERSION",`(${c[p.NUMERICIDENTIFIER]})\\.(${c[p.NUMERICIDENTIFIER]})\\.(${c[p.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${c[p.NUMERICIDENTIFIERLOOSE]})\\.(${c[p.NUMERICIDENTIFIERLOOSE]})\\.(${c[p.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${c[p.NUMERICIDENTIFIER]}|${c[p.NONNUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${c[p.NUMERICIDENTIFIERLOOSE]}|${c[p.NONNUMERICIDENTIFIER]})`),g("PRERELEASE",`(?:-(${c[p.PRERELEASEIDENTIFIER]}(?:\\.${c[p.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${c[p.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[p.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${h}+`),g("BUILD",`(?:\\+(${c[p.BUILDIDENTIFIER]}(?:\\.${c[p.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${c[p.MAINVERSION]}${c[p.PRERELEASE]}?${c[p.BUILD]}?`),g("FULL",`^${c[p.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${c[p.MAINVERSIONLOOSE]}${c[p.PRERELEASELOOSE]}?${c[p.BUILD]}?`),g("LOOSE",`^${c[p.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${c[p.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${c[p.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${c[p.XRANGEIDENTIFIER]})(?:\\.(${c[p.XRANGEIDENTIFIER]})(?:\\.(${c[p.XRANGEIDENTIFIER]})(?:${c[p.PRERELEASE]})?${c[p.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${c[p.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[p.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[p.XRANGEIDENTIFIERLOOSE]})(?:${c[p.PRERELEASELOOSE]})?${c[p.BUILD]}?)?)?`),g("XRANGE",`^${c[p.GTLT]}\\s*${c[p.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${c[p.GTLT]}\\s*${c[p.XRANGEPLAINLOOSE]}$`),g("COERCEPLAIN",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?`),g("COERCE",`${c[p.COERCEPLAIN]}(?:$|[^\\d])`),g("COERCEFULL",c[p.COERCEPLAIN]+`(?:${c[p.PRERELEASE]})?`+`(?:${c[p.BUILD]})?(?:$|[^\\d])`),g("COERCERTL",c[p.COERCE],!0),g("COERCERTLFULL",c[p.COERCEFULL],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${c[p.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",g("TILDE",`^${c[p.LONETILDE]}${c[p.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${c[p.LONETILDE]}${c[p.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${c[p.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",g("CARET",`^${c[p.LONECARET]}${c[p.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${c[p.LONECARET]}${c[p.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${c[p.GTLT]}\\s*(${c[p.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${c[p.GTLT]}\\s*(${c[p.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${c[p.GTLT]}\\s*(${c[p.LOOSEPLAIN]}|${c[p.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${c[p.XRANGEPLAIN]})\\s+-\\s+(${c[p.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${c[p.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[p.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},13647:(e,t,n)=>{"use strict";n.r(t),n.d(t,{request:()=>m,settings:()=>y,storage:()=>g,type:()=>E});var r=n(13647),i=n(78584),o=n(26017);const s={async set(e,t){const n={};return n[e]=t,new Promise(((t,r)=>{a(e).set(n,(function(){chrome.runtime.lastError?r(chrome.runtime.lastError):t()}))}))},get:async e=>new Promise(((t,n)=>{a(e).get(e,(function(r){chrome.runtime.lastError?n(chrome.runtime.lastError):t(r[e])}))})),remove:async e=>new Promise(((t,n)=>{a(e).remove(e,(function(){chrome.runtime.lastError?n(chrome.runtime.lastError):t()}))})),list:async(e="local")=>new Promise(((t,n)=>{"local"===e?chrome.storage.local.get(null,(function(e){t(e)})):chrome.storage.sync.get(null,(function(e){t(e)}))})),async addStyle(e){try{const t=document.createElement("style");t.textContent=e,(document.head||document.body||document.documentElement||document).appendChild(t)}catch(e){console.log(`Could not add css:${e}`)}},version:()=>chrome.runtime.getManifest().version,lang(e,t){if(r.settings.get("forceEn")&&"undefined"!=typeof i18n){let n=i18n[e];if(void 0!==t)for(let e=0;e<t.length;e++)n=n.replace(`$${e+1}`,t[e]);return n}return chrome.i18n.getMessage(e,t)},langDirection(){try{const e=chrome.i18n.getUILanguage();if(/^(ar)(-|$)/i.test(e)&&!r.settings.get("forceEn"))return"rtl"}catch(e){i.error(e)}return"ltr"},assetUrl:e=>chrome.runtime.getURL(`assets/${e}`),injectCssResource(e,t){alert("injectCssResource not supported in webextension")},injectjsResource(e,t){const n=document.createElement("script");n.src=chrome.runtime.getURL(`vendor/${e}`),n.onload=function(){this.remove()},t.get(0).appendChild(n)},addProxyScriptToTag:(e,t)=>(e.src=chrome.runtime.getURL(`/content/proxy/proxy_${t}.js`),e),updateDom(e){const t=document.createElement("script");t.text="\n        document.getElementsByTagName('head')[0].onclick = function(e){\n          try{\n            componentHandler.upgradeDom();\n          }catch(e){\n            console.log(e);\n            setTimeout(function(){\n              componentHandler.upgradeDom();\n            },500);\n          }\n        }",t.onload=function(){this.remove()},e.get(0).appendChild(t)},storageOnChanged(e){chrome.storage.onChanged.addListener(e)}};function a(e){return o.syncRegex.test(e)?chrome.storage.sync:chrome.storage.local}const l={async xhr(e,t){if(void 0!==l.sendMessage)return l.sendMessage({name:"xhr",method:e,url:t}).then((e=>{if(429===e.status)throw"Rate limit Timeout";if(0===e.status)throw e.responseText;return e}));throw"Could not send xhr"},sendMessage:async e=>new Promise(((t,n)=>{chrome.runtime.sendMessage(e,(function(e){t(e)}))})),notification(e){this.sendMessage({name:"notification",options:e})},database(e,t){return this.sendMessage({name:"database",options:{call:e,param:t}})}};var c=n(50953),u=n(40111),p=n(13647),d=n(78584),h=n(26017);const f={options:(0,c.Kh)({autoTrackingModeanime:"video",readerTracking:!0,askBefore:!0,autoTrackingModemanga:"instant",enablePages:{},forceEn:!1,forceEnglishTitles:!1,rpc:!0,presenceLargeImage:"cover",presenceShowButtons:!0,presenceShowMalsync:!1,userscriptModeButton:!1,syncMode:"MAL",syncModeSimkl:"MAL",localSync:!0,delay:0,videoDuration:85,malTags:!1,malContinue:!0,malResume:!0,usedPage:!0,epPredictions:!0,mangaCompletionPercentage:90,theme:"auto",themeSidebars:!0,themeColor:"#000000",themeOpacity:100,themeImage:"",minimalWindow:!1,posLeft:"left",miniMALonMal:!1,floatButtonStealth:!1,minimizeBigPopup:!1,floatButtonCorrection:!0,floatButtonHide:!1,autoCloseMinimal:!1,outWay:!0,miniMalWidth:"550px",miniMalHeight:"90%",malThumbnail:100,friendScore:!0,loadPTWForProgress:!1,quicklinks:["Crunchyroll","Gogoanime","Mangadex","MangaNato","MangaFox","MangaSee","MangaFire","HiAnime","Hulu","Netflix","Hidive","VIZ","MangaPlus","MangaReader","ComicK","WeebCentral","KickAssAnime","animepahe"],quicklinksPosition:"default",autofull:!1,autoresume:!1,autoNextEp:!1,highlightAllEp:!1,checkForFiller:!0,crashReport:!0,introSkip:85,introSkipFwd:[17,39],introSkipBwd:[17,37],nextEpShort:[],correctionShort:[67],syncShort:[],progressInterval:120,progressIntervalDefaultAnime:"en/sub",progressIntervalDefaultManga:"en/sub",progressNotificationsAnime:!0,progressNotificationsManga:!0,notificationsSticky:!0,bookMarksList:!1,bookMarksListManga:!1,customDomains:[],anilistUpdateUi:!0,anilistToken:"",anilistOptions:{displayAdultContent:!0,scoreFormat:"POINT_10"},kitsuToken:"",kitsuOptions:{titleLanguagePreference:"canonical",sfwFilter:!1,ratingSystem:"regular"},simklToken:"",malToken:"",malRefresh:"",shikiToken:"",shikiOptions:{locale:"ru"}}),debounceArray:{},chibiList:{},isInit:(0,c.KR)(!1),async init(){const e=[];for(const t in this.options){const n=await p.storage.get(`settings/${t}`);void 0!==n&&(this.options[t]=n,e[t]=/(token|refresh)/i.test(t)&&n?"********":n)}try{const e=await u.I.getInstance(!0).init();this.chibiList=e.getList()}catch(e){d.error("Error loading chibi repo",e)}let t;return d.log("Settings",e),p.storage.storageOnChanged(((e,n)=>{if("sync"===n)for(const t in e){const n=e[t];/^settings\//i.test(t)&&(this.options[t.replace("settings/","")]=n.newValue,d.info(`Update ${t} option to ${JSON.stringify(n.newValue,null,2)}`))}if("local"===n&&e.rateLimit)try{clearTimeout(t),e.rateLimit.newValue?(d.log("Rate limited"),$(".type-rate").length||h.flashm("Rate limited. Retrying in a moment",{error:!0,type:"rate",permanent:!0})):t=setTimeout((()=>{d.log("No Rate limited"),$(".type-rate").remove()}),5e3)}catch(e){d.error(e)}})),this.isInit.value=!0,this},get(e){if(!this.isInit.value)throw"Settings not initialized";return this.options[e]},set(e,t){if(!Object.prototype.hasOwnProperty.call(this.options,e)){const t=Error(`${e} is not a defined option`);throw d.error(t),t}return this.options[e]=t,p.storage.set(`settings/${e}`,t)},setDebounce(e,t){this.options[e]=t,clearTimeout(this.debounceArray[e]),this.debounceArray[e]=setTimeout((()=>{this.set(e,t),delete this.debounceArray[e]}),1e3)},async getAsync(e){const t=await p.storage.get(`settings/${e}`);return void 0===t&&void 0!==this.options[e]?this.options[e]:t},getStaticChibi(){if(!this.isInit.value)throw"Settings not initialized";return this.chibiList}},g=s,m=l,y=f,E="webextension"},89489:(e,t,n)=>{"use strict";n.r(t),n.d(t,{Chibi:()=>D});const r=/^(https?|wss?|file|ftp|\*):\/\/(\*|\*\.[^*/]+|[^*/]+)\/.*$|^file:\/\/\/.*$|^resource:\/\/(\*|\*\.[^*/]+|[^*/]+)\/.*$|^about:/,i=globalThis.navigator?.userAgent.includes("Firefox/"),o=i?/^(https?|wss?):[/][/][^/]+([/].*)?$/:/^https?:[/][/][^/]+([/].*)?$/,s=/^(https?|file|ftp):[/]+/;function a(...e){return 0===e.length?/$./:e.includes("<all_urls>")?s:e.includes("*://*/*")?o:new RegExp(e.map((e=>function(e){!function(e){if(!function(e){return"<all_urls>"===e||r.test(e)}(e))throw new Error(e+" is an invalid pattern, it must match "+String(r))}(e);let[,t,n="",o]=e.split(/(^[^:]+:[/][/])([^/]+)?/);return t=t.replace("*",i?"(https?|wss?)":"https?").replaceAll(/[/]/g,"[/]"),"*"===n?n="[^/]+":n&&(n=n.replace(/^[*][.]/,"([^/]+.)*").replaceAll(/[.]/g,"[.]").replace(/[*]$/,"[^.]+")),o=o.replaceAll(/[/]/g,"[/]").replaceAll(/[.]/g,"[.]").replaceAll(/[*]/g,".*"),"^"+t+n+"("+o+")?$"}(e))).join("|"))}n(13647),Error,Error,Error;class l extends Error{constructor(e){super(e),this.name="NotFoundError"}}Error;class c{constructor(e){this.value=e}getValue(){return this.value}}const u=["url","ui","provider","trigger","pageObject","element"];function p(e){return u.includes(e)}class d{constructor(){this.store=new Map}set(e,t){this.store.set(e,t)}get(e){return this.store.get(e)}has(e){return this.store.has(e)}delete(e){return this.store.delete(e)}clear(){this.store.clear()}keys(){return Array.from(this.store.keys())}}const h=new d;class f{constructor(e){this.globalRegistry=h,this.intervalRegistry={},this.consumer=e,this.registry=new d}run(e,t=null){return this.getConsumer()._subroutine(e,t)}set(e,t){this.registry.set(e,t)}get(e){return this.registry.get(e)}globalSet(e,t){this.globalRegistry.set(e,t)}globalGet(e){return this.globalRegistry.get(e)}getConsumer(){return this.consumer}return(e){return new c(e)}setInterval(e,t){this.intervalRegistry[e]=t}getInterval(e){return this.intervalRegistry[e]}clearIntervals(){Object.values(this.intervalRegistry).forEach((e=>{clearInterval(e)})),this.intervalRegistry={}}}class g extends Error{}class m extends g{constructor(e){super(`Unknown function: ${e}`)}}const y={string:(e,t,n)=>void 0!==n?n:String(t),boolean:(e,t,n)=>void 0!==n?n:Boolean(t),number:(e,t,n)=>void 0!==n?n:Number(t),array:(e,t,n)=>n,object:(e,t,n)=>n},E={split:(e,t,n)=>t.split(n),join:(e,t,n)=>t.join(n),replace:(e,t,n,r)=>{const i="string"==typeof r?r:e.run(r);return t.replace(n,i)},replaceAll:(e,t,n,r)=>{const i="string"==typeof r?r:e.run(r);return t.replaceAll(n,i)},replaceRegex:(e,t,n,r,i="gi")=>{const o="string"==typeof r?r:e.run(r),s=new RegExp(n,i);return t.replace(s,o)},substring:(e,t,n,r)=>t.substring(n,r),regex:(e,t,n,r=0,i="i")=>{const o=new RegExp(n,i),s=t.match(o);if(!s)throw new Error(`No match found for regex '${n}' in input '${t}'`);return s[r]},toLowerCase:(e,t)=>t.toLowerCase(),toUpperCase:(e,t)=>t.toUpperCase(),trim:(e,t)=>t.trim(),includes:(e,t,n,r)=>t.includes(n,r),concat:(e,t,n)=>{const r="string"==typeof n?n:e.run(n);return t.concat(r)},jsonParse:(e,t)=>JSON.parse(t)},v={querySelector:(e,t,n)=>{const r="string"==typeof n?n:e.run(n);return document.querySelector(r)},querySelectorAll:(e,t,n)=>{const r="string"==typeof n?n:e.run(n);return Array.from(document.querySelectorAll(r))},find:(e,t,n)=>{const r="string"==typeof n?n:e.run(n);return t.querySelector(r)},findAll:(e,t,n)=>{const r="string"==typeof n?n:e.run(n);return Array.from(t.querySelectorAll(r))},text:(e,t)=>t.textContent,html:(e,t)=>t.innerHTML,getAttribute:(e,t,n)=>t.getAttribute(n),getComputedStyle:(e,t,n)=>window.getComputedStyle(t).getPropertyValue(n),closest:(e,t,n)=>{const r="string"==typeof n?n:e.run(n);return t.closest(r)},parent:(e,t)=>t.parentElement,next:(e,t)=>t.nextElementSibling,prev:(e,t)=>t.previousElementSibling,elementMatches:(e,t,n)=>t.matches(n),title:(e,t)=>document.title};var w=n(13647),b=n(78584);const I={url:(e,t)=>{const n=e.get("url");return n&&"string"==typeof n?n:"undefined"!=typeof window?window.location.href:""},provider:(e,t)=>{const n=e.get("provider");if(!n)throw new g("Provider not set");return n},target:(e,t)=>{const n=e.get("element");if(!n)throw new g("target element not set");return n},return:(e,t)=>e.return(t),trigger:(e,t)=>{const n=e.get("trigger");if(!n)throw new g("Trigger not set");n()},this:(e,t,n)=>{const r=e.get("pageObject");let i=n;switch(n){case"sync.isSyncPage":i="isSyncPage";break;case"overview.isOverviewPage":i="isOverviewPage";break;case"sync.uiInjection":i="sync.uiSelector";break;case"overview.uiInjection":i="overview.uiSelector";break;case"list.elementsSelector":i="overview.list.elementsSelector";break;case"list.elementUrl":i="overview.list.elementUrl";break;case"list.elementEp":i="overview.list.elementEp"}const o=i.split(".");let s=r;for(const e of o){if(void 0===s[e])throw new Error(`Property ${n} not found`);s=s[e]}return"function"==typeof s?s(t):s},getVariable:(e,t,n,r)=>{const i=e.get(n);return void 0!==i?i:r},setVariable:(e,t,n,r)=>{if(p(n))throw new g(`Cannot set reserved key: ${n}`);if(void 0!==r){const t=e.run(r);e.set(n,t)}else e.set(n,t);return t},getGlobalVariable:(e,t,n,r)=>{const i=e.globalGet(n);return void 0!==i?i:r},setGlobalVariable:(e,t,n,r)=>{if(p(n))throw new g(`Cannot set reserved global key: ${n}`);if(void 0!==r){const t=e.run(r);e.globalSet(n,t)}else e.globalSet(n,t);return t},fn:(e,t,n)=>{const r=e.run(n);return r&&r instanceof c?r.getValue():r},addStyle:(e,t,n)=>{w.storage.addStyle(n)},log:(e,t,n="ChibiScript")=>(b.m(n).log(t),t),error:(e,t,n)=>{throw new g(n)}};var T=n(26017);const S={urlPart:(e,t,n)=>T.urlPart(t,n),urlStrip:(e,t)=>T.urlStrip(t),urlParam:(e,t,n)=>T.urlParam(t,n),urlAbsolute:(e,t,n)=>(n||(n=`${window.location.protocol}//${window.location.host}`),T.absoluteLink(t,n)),getBaseText:(e,t)=>T.getBaseText(t)};var R=n(7263);const _={uiPrepend:(e,t)=>{const n=e.get("ui");if("string"!=typeof n)throw new g("UI html not found");R.$(t).prepend(R.html(n))},uiAppend:(e,t)=>{const n=e.get("ui");if("string"!=typeof n)throw new g("UI html not found");R.$(t).append(R.html(n))},uiAfter:(e,t)=>{const n=e.get("ui");if("string"!=typeof n)throw new g("UI html not found");R.$(t).after(R.html(n))},uiBefore:(e,t)=>{const n=e.get("ui");if("string"!=typeof n)throw new g("UI html not found");R.$(t).before(R.html(n))}};var A=n(26017);const x={...y,if:(e,t,n,r,i)=>e.run(n)?e.run(r):e.run(i),ifThen:(e,t,n)=>t?e.run(n,t):t,ifNotReturn:(e,t,n)=>t||e.return(n?e.run(n):null),...E,...v,...{...I,...S,..._,domReady:(e,t)=>new Promise((e=>{$((()=>{e()}))})),waitUntilTrue:(e,t,n,r)=>new Promise((t=>{clearInterval(e.getInterval(r)),e.setInterval(r,A.waitUntilTrue((()=>e.run(n)),(()=>t())))})),detectChanges:(e,t,n,r,i)=>{clearInterval(e.getInterval(i));let o=e.run(n);e.setInterval(i,setInterval((()=>{const t=e.run(n);void 0!==t&&o!==t&&(o=t,e.run(r))}),500))},detectURLChanges:(e,t,n,r=null,i)=>{const o=r?.ignoreQuery??!1,s=r?.ignoreAnchor??!0,a=e=>{let t=e;return o&&(t=t.split("?")[0]),s&&(t=t.split("#")[0]),t};clearInterval(e.getInterval(i));let l=a(window.location.href);e.setInterval(i,setInterval((()=>{const t=a(window.location.href);l!==t&&(l=t,e.run(n))}),500))}},equals:(e,t,n)=>t===n,greaterThan:(e,t,n)=>t>n,greaterThanOrEqual:(e,t,n)=>t>=n,lessThan:(e,t,n)=>t<n,lessThanOrEqual:(e,t,n)=>t<=n,contains:(e,t,n)=>t.includes(n),matches:(e,t,n,r="i")=>new RegExp(n,r).test(t),and:(e,t,...n)=>n.reduce(((t,n)=>t&&e.run(n)),!0),or:(e,t,...n)=>n.reduce(((t,n)=>t||e.run(n)),!1),not:(e,t)=>!t,isNil:(e,t)=>null==t,isEmpty:(e,t)=>null==t||("string"==typeof t?""===t:Array.isArray(t)?0===t.length:"object"==typeof t&&0===Object.keys(t).length),coalesce:(e,t,...n)=>{for(const t of n){const n=e.run(t);if(null!=n)return n}},first:(e,t)=>t[0],last:(e,t)=>t[t.length-1],at:(e,t,n)=>t[n],length:(e,t)=>t.length,slice:(e,t,n,r)=>t.slice(n,r),reverse:(e,t)=>t.reverse(),arrayIncludes:(e,t,n)=>t.includes(n),map:(e,t,n)=>t.map((t=>e.run(n,t))),arrayFind:(e,t,n)=>{for(let r=0;r<t.length;r++)if(e.run(n,t[r]))return t[r]},filter:(e,t,n)=>t.filter((t=>e.run(n,t))),get:(e,t,n)=>{if(t&&"object"==typeof t)return t[n]},keys:(e,t)=>t&&"object"==typeof t?Object.keys(t):[],values:(e,t)=>t&&"object"==typeof t?Object.values(t):[]};class N{constructor(e,t="Unknown"){this.hasRun=!1,this.script=e,this.name=t,this.ctx=new f(this)}run(e=null){if(this.hasRun)throw new g("Run method can only be executed once");this.hasRun=!0;const t=this._subroutine(this.script,e);return t&&t instanceof c?t.getValue():t}_subroutine(e,t=null){let n=t;for(const[t,...r]of e){if(!x[t])throw new m(t);const e=x[t];try{n=e(this.ctx,n,...r)}catch(e){if(e instanceof g)throw e;this.logError(e,t,n,r),n=null}if(n&&n instanceof Promise)throw new g("Async functions are not supported in this context");if(n&&n instanceof c)return n}return n}async runAsync(){if(this.hasRun)throw new g("Run method can only be executed once");this.hasRun=!0;const e=await this._subroutineAsync(this.script);return e&&e instanceof c?e.getValue():e}async _subroutineAsync(e,t=null){let n=t;for(const[t,...r]of e){if(!x[t])throw new m(t);const e=x[t];try{n=e(this.ctx,n,...r),n&&n instanceof Promise&&(n=await n)}catch(e){if(e instanceof g)throw e;this.logError(e,t,n,r),n=null}if(n&&n instanceof c)return n}return n}addVariable(e,t){this.ctx.set(e,t)}clearIntervals(){return this.ctx.clearIntervals()}logError(e,t,n,r){console.log("%cMAL-Sync","background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;",e.message,{name:this.name,functionName:t,input:n,args:r})}}var O=n(40111),L=n(78584),C=n(7263),M=n(26017);function P(e,t,n){const r=new N(e,n);return r.addVariable("pageObject",t),r}function k(e,t,n,r){const i=P(e,n,r);return i.addVariable("url",t),i}const D=async()=>{const e=await O.I.getInstance().init(),t=e.getList(),n=window.location.href,r=Object.values(t).filter((e=>!(!e.urls.match||!e.urls.match.length)&&function(e,...t){if(t.includes("<all_urls>")&&s.test(e))return!0;if(t.includes("*://*/*")&&o.test(e))return!0;for(const n of t)if(a(n).test(e))return!0;return!1}(n,...e.urls.match)));if(0===r.length)throw new l("No matching page found");r.length>1&&L.error("Multiple matching pages found",r);const i=await e.getPage(r[0].key),c={name:i.name,database:i.database||void 0,domain:i.domain,languages:i.languages,type:i.type,isSyncPage:e=>k(i.sync.isSyncPage,e,c,"sync.isSyncPage").run(),isOverviewPage:i.overview?e=>k(i.overview.isOverviewPage,e,c,"overview.isOverviewPage").run():void 0,sync:{getTitle:e=>k(i.sync.getTitle,e,c,"sync.getTitle").run()||"",getIdentifier:e=>k(i.sync.getIdentifier,e,c,"sync.getIdentifier").run(),getOverviewUrl:e=>k(i.sync.getOverviewUrl,e,c,"sync.getOverviewUrl").run(),getEpisode:e=>k(i.sync.getEpisode,e,c,"sync.getEpisode").run(),getVolume:i.sync.getVolume?e=>k(i.sync.getVolume,e,c,"sync.getVolume").run():void 0,nextEpUrl:i.sync.nextEpUrl?e=>k(i.sync.nextEpUrl,e,c,"sync.nextEpUrl").run():void 0,uiSelector:i.sync.uiInjection?e=>{const t=P(i.sync.uiInjection,c,"sync.uiInjection");return t.addVariable("ui",e),t.run()}:void 0,getMalUrl:i.sync.getMalUrl?e=>{const t=P(i.sync.getMalUrl,c,"sync.getMalUrl");return t.addVariable("provider",e),t.run()}:void 0,readerConfig:i.sync.readerConfig?i.sync.readerConfig:void 0},overview:i.overview||i.list?{getTitle:e=>k(i.overview.getTitle,e,c,"overview.getTitle").run()||"",getIdentifier:e=>k(i.overview.getIdentifier,e,c,"overview.getIdentifier").run(),uiSelector(e){const t=P(i.overview.uiInjection,c,"overview.uiInjection");return t.addVariable("ui",e),t.run()},getMalUrl:i.overview&&i.overview.getMalUrl?e=>{const t=P(i.overview.getMalUrl,c,"overview.getMalUrl");return t.addVariable("provider",e),t.run()}:void 0,list:i.list?{offsetHandler:!1,elementsSelector(){const e=P(i.list.elementsSelector,c,"list.elementsSelector");return C.$(e.run())},elementUrl:i.list.elementUrl?e=>{e instanceof C.$&&(e=e.get(0));const t=P(i.list.elementUrl,c,"list.elementUrl");return t.addVariable("element",e),t.run(e)}:void 0,elementEp(e){e instanceof C.$&&(e=e.get(0));const t=P(i.list.elementEp,c,"list.elementEp");return t.addVariable("element",e),t.run(e)}}:void 0}:void 0,init(e){const t=L.m("Chibi");let n=null,r=null;P(i.lifecycle.setup,c,"setup").run();const o=P(i.lifecycle.ready,c,"ready");if(o.addVariable("trigger",(()=>{t.info("Ready Trigger"),n&&(n.clearIntervals(),n=null),clearInterval(r),e.reset();const o=()=>{t.info("Handle page"),e.handlePage()};c.isSyncPage(window.location.href)?(t.info("Is Sync Page"),i.lifecycle.syncIsReady?(n=P(i.lifecycle.syncIsReady,c,"syncIsReady"),n.addVariable("trigger",o),n.runAsync()):r=M.waitUntilTrue((()=>c.sync.getTitle(window.location.href)&&c.sync.getIdentifier(window.location.href)),o)):c.isOverviewPage&&c.isOverviewPage(window.location.href)?(t.info("Is Overview Page"),i.lifecycle.overviewIsReady?(n=P(i.lifecycle.overviewIsReady,c,"overviewIsReady"),n.addVariable("trigger",o),n.runAsync()):r=M.waitUntilTrue((()=>c.overview.getTitle(window.location.href)&&c.overview.getIdentifier(window.location.href)),o)):t.info("Not a sync or overview page")})),o.runAsync(),i.lifecycle.listChange){const n=P(i.lifecycle.listChange,c,"listChange");n.addVariable("trigger",(()=>{t.info("List Trigger"),e.handleList()})),n.runAsync()}}};return c}},40111:(e,t,n)=>{"use strict";n.d(t,{I:()=>o});var r=n(96789),i=n(13647);class o{static getInstance(e=!1){let t;return t="userscript"===i.type?["https://chibi.malsync.moe/config"]:[chrome.runtime.getURL("chibi"),"https://chibi.malsync.moe/config"],new o(t,e)}constructor(e,t=!1){this.pages=null,this.collections=e,this.useCache=t}async init(){const e=`chibiPages-${i.storage.version()}`,t=await i.storage.get(e)||{chibiPages:{},errors:{}};if(this.useCache&&t.chibiPages&&Object.keys(t.chibiPages).length>0)return this.pages=t.chibiPages,this;const n={},o=(await Promise.all(this.collections.map((e=>this.retrieveCollection(e).catch((t=>(n[e]=t,null))))))).filter((e=>e));return t.errors=n,o.forEach((e=>{Object.keys(e.pages).forEach((n=>{if(e.pages[n].minimumVersion&&(0,r.GT)(e.pages[n].minimumVersion))return;const i=t.chibiPages[n]&&t.chibiPages[n].version.hash!==e.pages[n].version.hash&&Number(t.chibiPages[n].version.timestamp)<Number(e.pages[n].version.timestamp);t.chibiPages[n]&&!i||(t.chibiPages[n]=e.pages[n])}))})),await i.storage.set(e,t),this.pages=t.chibiPages,this}async retrieveCollection(e){const t=await i.request.xhr("GET",`${e}/list.json`),n=JSON.parse(t.responseText);return Object.keys(n.pages).forEach((t=>{n.pages[t].root=e})),n}getList(){if(!this.pages)throw new Error("Pages not loaded");return this.pages}async getPage(e){if(!this.pages)throw new Error("Pages not loaded");const t=this.pages[e];if(!t)throw new Error(`Page ${e} not found`);const n=await i.request.xhr("GET",`${t.root}/pages/${e}.json?version=${t.version.hash}`);return JSON.parse(n.responseText)}getPermissions(){const e=this.getList();return Object.values(e).map((e=>e.urls.match.map((t=>({page:`${e.name} (chibi)`,domain:t,auto:!0,chibi:!0}))))).flat()}getPermissionsElements(){const e=this.getList();return Object.values(e).map((e=>({name:`${e.name} (chibi)`,match:e.urls.match})))}}},78584:(e,t,n)=>{"use strict";n.r(t),n.d(t,{debug:()=>s,error:()=>i,info:()=>o,log:()=>r,m:()=>a});const r=Function.prototype.bind.call(console.log,console,"%cMAL-Sync","background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;"),i=Function.prototype.bind.call(console.error,console,"%cMAL-Sync","background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;"),o=Function.prototype.bind.call(console.info,console,"%cMAL-Sync","background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;"),s=Function.prototype.bind.call(console.debug,console,"%cMAL-Sync","background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;"),a=(e,t="",n=[])=>{let r="white";t||(t=function(e){if(!e)return"#ffffff";e=String(e);let t=0;for(let n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);let n="#";for(let e=0;e<3;e++)n+=`00${(t>>8*e&255).toString(16)}`.substr(-2);return n}(e)),"#"===t[0]&&(r=parseInt(t.replace("#",""),16)>8388607.5?"#000":"#fff");const i=`background-color: ${t}; color: ${r}; padding: 2px 10px; border-radius: 3px; margin-left: -5px; border-left: 1px solid white;`;n.push({name:e,style:i});const o={m:(e,t="")=>a(e,t,[...n])},s=n.reduce(((e,t)=>`${e}%c${t.name}`),""),l=n.map((e=>e.style));return o.log=Function.prototype.bind.call(console.log,console,`%cM ${s}`,"background-color: #2e51a2; color: white; padding: 2px 10px; border-radius: 3px;",...l),o.error=Function.prototype.bind.call(console.error,console,`%cM ${s}`,"background-color: #8f0000; color: white; padding: 2px 10px; border-radius: 3px;",...l),o.info=Function.prototype.bind.call(console.info,console,`%cM ${s}`,"background-color: wheat; color: black; padding: 2px 10px; border-radius: 3px;",...l),o.debug=Function.prototype.bind.call(console.debug,console,`%cM ${s}`,"background-color: steelblue; color: black; padding: 2px 10px; border-radius: 3px;",...l),o}},26017:(e,t,n)=>{"use strict";n.r(t),n.d(t,{absoluteLink:()=>v,canHideTabs:()=>j,changeDetect:()=>T,checkDoubleExecution:()=>A,clearCache:()=>re,elementInViewport:()=>K,episode:()=>f,favicon:()=>p,flashConfirm:()=>V,flashm:()=>W,fullUrlChangeDetect:()=>I,getAsyncWaitUntilTrue:()=>R,getBaseText:()=>u,getContinueWaching:()=>M,getEntrySettings:()=>k,getResumeWaching:()=>L,getStatusText:()=>z,getTooltip:()=>U,getUrlFromTags:()=>x,getselect:()=>E,handleMalImages:()=>D,htmlDecode:()=>ee,isDomainMatching:()=>oe,isFirefox:()=>te,lazyload:()=>q,notifications:()=>H,pageUrl:()=>Z,parseHtml:()=>w,planTo:()=>h,rateLimitExclude:()=>m,returnYYYYMMDD:()=>Q,setContinueWaching:()=>C,setEntrySettings:()=>P,setResumeWaching:()=>O,setUrlInTags:()=>N,sortAlphabetically:()=>ie,status:()=>y,statusTag:()=>G,syncRegex:()=>g,timeCache:()=>B,timeDiffToText:()=>F,upperCaseFirstLetter:()=>se,urlChangeDetect:()=>b,urlParam:()=>c,urlPart:()=>a,urlStrip:()=>l,wait:()=>J,waitForPageToBeVisible:()=>ne,waitUntilTrue:()=>S,watching:()=>d});var r=n(7263),i=n(13647),o=n(78584),s=n(26017);function a(e,t){if(!e)return"";const n=e.split("/");return n[t]?n[t].replace(/[#?].*/,""):""}function l(e){return e.replace(/[#?].*/,"")}function c(e,t){const n=new RegExp(`[?&]${t}=([^&#]*)`).exec(e);return null===n?null:decodeURI(n[1])||0}function u(e){let t=e.text();return e.children().each((function(){t=t.replace(r.$(this).text(),"")})),t}function p(e){if(!e)return"";const t=e.match(/^(https?:\/\/)?[^/]+/);return t&&(e=t[0]),`https://favicon.malsync.moe/?domain=${e}`}function d(e){return"manga"===e?"Reading":"Watching"}function h(e){return"manga"===e?"Plan to Read":"Plan to Watch"}function f(e){return"manga"===e?i.storage.lang("UI_Chapter"):i.storage.lang("UI_Episode")}const g=/(^settings\/.*|^updateCheckTime$|^tempVersion$|^local:\/\/|^list-tagSettings$)/,m=/^https:\/\/api.malsync.moe\/(shark|mal\/|nc\/mal\/.*\/progress$)/i;var y;function E(e,t){let n=e.split(`name="${t}"`)[1].split("</select>")[0];if(n.indexOf('selected="selected"')>-1){n=n.split("<option");for(let e=0;e<n.length;++e)if(n[e].indexOf('selected="selected"')>-1)return n[e].split('value="')[1].split('"')[0]}return""}function v(e,t){return void 0===e||e.startsWith("http")||("/"!==e.charAt(0)&&(e=`/${e}`),e=t+e),e}function w(e){return(new DOMParser).parseFromString(`<!doctype html><body>${e}`,"text/html").body.textContent}function b(e){let t=window.location.href;return setInterval((function(){t!==window.location.href&&(t=window.location.href,e())}),100)}function I(e,t=!1){let n="";const r=setInterval((function(){const r=t?l(window.location.href):window.location.href;n!==r&&(n=r,e())}),100);return Number(r)}function T(e,t,n=!1){let r=t();const i=setInterval((function(){const n=t();void 0!==n&&r!==n&&(r=t(),e())}),500);return n&&e(),Number(i)}function S(e,t,n=100){let r=0;const i=setInterval((function(){r++;let s=!1;try{s=e()}catch(e){o.info("Error in waitUntilTrue",e)}if(s&&(clearInterval(i),t()),r>10){clearInterval(i);const r=Math.max(Math.min(2*n,15e3),500);S(e,t,r)}}),n);return i}function R(e,t=100){let n,r;const i=()=>{clearTimeout(n),r&&r("AsyncWait stopped")};return{asyncWaitUntilTrue:()=>(i(),new Promise(((i,o)=>{r=o,n=S(e,(()=>i()),t)}))),reset:i}}!function(e){e[e.watching=1]="watching",e[e.completed=2]="completed",e[e.onhold=3]="onhold",e[e.dropped=4]="dropped",e[e.planToWatch=6]="planToWatch"}(y||(y={}));const _=Math.random();function A(){$(".mal-sync-double-detect").length&&$(".mal-sync-double-detect").each((function(e){$(this).text()!==_.toString()&&alert("Double execution detected! Please run MAL-Sync once only.")})),$("body").after(r.html(`<div class="mal-sync-double-detect" style="display: none;">${_.toString()}</div>`))}function x(e){return/malSync::[\d\D]+::/.test(e)?t(e.split("malSync::")[1].split("::")[0]):/last::[\d\D]+::/.test(e)?t(e.split("last::")[1].split("::")[0]):void 0;function t(e){try{return atob(e)}catch(t){return e}}}function N(e,t){if(""===e)return t.replace(/,?(malSync|last)::[^ \n]+?::/,"");if(!i.settings.get("malTags"))return t;const n=`malSync::${btoa(e)}::`;return/(last|malSync)::[\d\D]+::/.test(t)?t.replace(/(last|malSync)::[^^]*?::/,n):`${t},${n}`}async function O(e,t,n,r){return i.storage.set(`resume/${n}/${r}`,{url:e,ep:t})}async function L(e,t){if(i.settings.get("malResume"))return i.storage.get(`resume/${e}/${t}`)}async function C(e,t,n,r){return i.storage.set(`continue/${n}/${r}`,{url:e,ep:t})}async function M(e,t){if(i.settings.get("malContinue"))return i.storage.get(`continue/${e}/${t}`)}async function P(e,t,n,r=""){const o={};if(n){for(const e in n)switch(e){case"u":case"p":o[e]=n[e]}i.settings.get("malTags")?r=N(JSON.stringify(o),r):await i.storage.set(`tagSettings/${e}/${t}`,JSON.stringify(o))}return Object.values(o).find((e=>Boolean(e)))||(r=N("",r),i.settings.get("malTags")||await i.storage.remove(`tagSettings/${e}/${t}`)),r}async function k(e,t,n=""){const r={u:null,c:null,r:null,p:""};if(i.settings.get("malTags")){const e=x(n);if(e)if("{"===e[0])try{const t=JSON.parse(e);for(const e in r)t[e]&&(r[e]=t[e])}catch(e){o.error(e)}else r.u=e}else{let n=await i.storage.get(`tagSettings/${e}/${t}`);if(n){n=JSON.parse(n);for(const e in r)n[e]&&(r[e]=n[e])}}const s=await M(e,t);s&&(r.c=s);const a=await L(e,t);return a&&(r.r=a),i.settings.get("usedPage")||(r.u=null),r}function D(e){return-1!==e.indexOf("questionmark")?i.storage.assetUrl("questionmark.gif"):e}function U(e,t="",n="top"){const r=Math.floor(1e3*Math.random()+1);return`<div id="tt${r}" class="icon material-icons" style="font-size:16px; line-height: 0; color: #7f7f7f; padding-bottom: 20px; padding-left: 3px; ${t}">contact_support</div>  <div class="mdl-tooltip mdl-tooltip--${n} mdl-tooltip--large" for="tt${r}">${e}</div>`}function F(e){let t="";e/=1e3;const n=Math.floor(e/31536e3);e-=31536e3*n,n&&(t+=`${n}y `);const r=Math.floor(e/86400);e-=86400*r,r&&(t+=`${r}d `);const i=Math.floor(e/3600)%24;e-=3600*i,i&&r<2&&(t+=`${i}h `);const o=Math.floor(e/60)%60;return e-=60*o,o&&!r&&i<3&&(t+=`${o}min `),t}function j(){return"undefined"!=typeof browser&&void 0!==browser.tabs.hide}function G(e,t,n){const r={anime:{1:{class:"watching",text:"CW",title:i.storage.lang(`UI_Status_watching_${t}`)},2:{class:"completed",text:"CMPL",title:i.storage.lang("UI_Status_Completed")},3:{class:"on-hold",text:"HOLD",title:i.storage.lang("UI_Status_OnHold")},4:{class:"dropped",text:"DROP",title:i.storage.lang("UI_Status_Dropped")},6:{class:"plantowatch",text:"PTW",title:i.storage.lang(`UI_Status_planTo_${t}`)},23:{class:"rewatching",text:"RE",title:i.storage.lang(`UI_Status_Rewatching_${t}`)}},manga:{1:{class:"reading",text:"CR",title:i.storage.lang(`UI_Status_watching_${t}`)},2:{class:"completed",text:"CMPL",title:i.storage.lang("UI_Status_Completed")},3:{class:"on-hold",text:"HOLD",title:i.storage.lang("UI_Status_OnHold")},4:{class:"dropped",text:"DROP",title:i.storage.lang("UI_Status_Dropped")},6:{class:"plantoread",text:"PTR",title:i.storage.lang(`UI_Status_planTo_${t}`)},23:{class:"rewatching",text:"RE",title:i.storage.lang(`UI_Status_Rewatching_${t}`)}}};if($.each([1,2,3,4,6,23],(function(e,t){r.anime[r.anime[t].title]=r.anime[t],r.manga[r.manga[t].title]=r.manga[t]})),e&&r[t][e]){const i=r[t][e];return` <a href="https://myanimelist.net/ownlist/${t}/${n}/edit?hideLayout=1" title="${i.title}" class="Lightbox_AddEdit button_edit ${i.class}">${i.text}</a>`}return!1}function z(e,t){switch(t){case 1:return i.storage.lang(`UI_Status_watching_${e}`);case 2:return i.storage.lang("UI_Status_Completed");case 3:return i.storage.lang("UI_Status_OnHold");case 4:return i.storage.lang("UI_Status_Dropped");case 6:return i.storage.lang(`UI_Status_planTo_${e}`);case 7:return i.storage.lang("UI_Status_All");case 23:return i.storage.lang(`UI_Status_Rewatching_${e}`);default:return""}}function H(e,t,n,r=""){const s={type:"basic",title:t,message:n,iconUrl:r};o.log("Notification",e,s),i.storage.get("notificationHistory").then((t=>{void 0===t&&(t=[]),"object"==typeof t&&(t.length>=10&&t.shift(),t.push({url:e,title:s.title,message:s.message,iconUrl:s.iconUrl,timestamp:Date.now()}),i.storage.set("notificationHistory",t))}));try{return chrome.notifications.create(e,s)}catch(e){o.error(e)}}async function B(e,t,n){const r=await i.storage.get(e);if("object"==typeof r&&(new Date).getTime()<r.timestamp)return r.data;const o=await t();return i.storage.set(e,{data:o,timestamp:(new Date).getTime()+n}).then((()=>o))}function W(e,t){r.$("#flash-div-top").length||function(){i.storage.addStyle('.flashinfo{\n                    transition: max-height 2s, opacity 2s 2s;\n                 }\n                 .mini-stealth .flashinfo{\n                    opacity: 0;\n                 }\n                  #flashinfo-div.hover.mini-stealth .flashinfo.type-update{\n                    opacity: 0.7;\n                 }\n                 #flashinfo-div.hover .flashinfo{\n                    opacity: 1;\n                 }\n                 .flashinfo:hover{\n                    max-height:5000px !important;\n                    z-index: 2147483647;\n                    opacity: 1;\n                    transition: max-height 2s;\n                 }\n                 .flashinfo .synopsis{\n                    transition: max-height 2s, max-width 2s ease 2s;\n                 }\n                 .flashinfo:hover .synopsis{\n                    max-height:9999px !important;\n                    max-width: 500px !important;\n                    transition: max-height 2s;\n                 }\n                 #flashinfo-div{\n                  z-index: 2;\n                  transition: 2s;\n                 }\n                 #flashinfo-div:hover, #flashinfo-div.hover{\n                  z-index: 2147483647;\n                 }\n                 #flashinfo-div.player-error {\n                   z-index: 2147483647;\n                 }\n                 #flashinfo-div.player-error .type-update{\n                  overflow: visible !important;\n                  opacity: 1 !important;\n                 }\n                 #flashinfo-div.player-error .player-error{\n                  display: block !important\n                 }\n                 #flashinfo-div.player-error-missing-permissions .player-error-missing-permissions{\n                  display: block !important\n                 }\n                 #flashinfo-div.player-error-missing-permissions .player-error-default{\n                  display: none !important\n                 }\n\n                 #flash-div-top, #flash-div-bottom, #flashinfo-div{\n                    font-family: "Helvetica","Arial",sans-serif;\n                    color: white;\n                    font-size: 14px;\n                    font-weight: 400;\n                    line-height: 17px;\n                 }\n                 #flash-div-top h2, #flash-div-bottom h2, #flashinfo-div h2{\n                    font-family: "Helvetica","Arial",sans-serif;\n                    color: white;\n                    font-size: 14px;\n                    font-weight: 700;\n                    line-height: 17px;\n                    padding: 0;\n                    margin: 0;\n                 }\n                 #flash-div-top a, #flash-div-bottom a, #flashinfo-div a{\n                    color: #DF6300;\n                 }');let e="";i.settings.get("floatButtonStealth")&&(e="mini-stealth"),r.$("body").after(r.html(`<div id="flash-div-top" dir="${i.storage.langDirection()}" style="text-align: center;pointer-events: none;position: fixed;top:-5px;width:100%;z-index: 2147483647;left: 0;"></div>        <div id="flash-div-bottom" dir="${i.storage.langDirection()}" style="text-align: center;pointer-events: none;position: fixed;bottom:0px;width:100%;z-index: 2147483647;left: 0;"><div id="flash" style="display:none;  background-color: red;padding: 20px; margin: 0 auto;max-width: 60%;          -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 20px;background:rgba(227,0,0,0.6);"></div></div>        <div id="flashinfo-div" dir="${i.storage.langDirection()}" class="${e}" style="text-align: center;pointer-events: none;position: fixed;bottom:0px;width:100%;left: 0;">`))}(),o.log("[Flash] Message:",e);let n="#323232";void 0!==t&&void 0!==t.error&&t.error&&(n="#3e0808");let s="#flash-div-bottom";void 0!==t&&void 0!==t.position&&t.position&&(s=`#flash-div-${t.position}`);let a="flash";if(void 0!==t&&void 0!==t.type&&t.type){const e=`type-${t.type}`;r.$(`${s} .${e}, #flashinfo-div .${e}`).removeClass(e).fadeOut({duration:1e3,queue:!1,complete(){r.$(this).remove()}}),a+=` ${e}`}let l,c=`<div class="${a}" style="display:none;">        <div style="display:table; pointer-events: all; padding: 14px 24px 14px 24px; margin: 0 auto; margin-top: 5px; max-width: 60%; -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 2px;color: white;background:${n}; ">          ${e}        </div>      </div>`;return void 0!==t&&void 0!==t.hoverInfo&&t.hoverInfo?(a+=" flashinfo",c=`<div class="${a}" style="display:none; max-height: 5000px; overflow: hidden;"><div style="display:table; pointer-events: all; margin: 0 auto; margin-top: -2px; max-width: 60%; -webkit-border-radius: 20px;-moz-border-radius: 20px;border-radius: 2px;color: white;background:${n}; position: relative;"><div style="max-height: 60vh; overflow-y: auto; padding: 14px 24px 14px 24px;">${e}</div></div></div>`,r.$("#flashinfo-div").addClass("hover"),l=r.$(r.html(c)).appendTo("#flashinfo-div"),void 0!==t&&void 0!==t.minimized&&t.minimized&&l.css("max-height","8px")):l=r.$(r.html(c)).appendTo(s),void 0!==t&&void 0!==t.permanent&&t.permanent?l.slideDown(800):void 0!==t&&void 0!==t.hoverInfo&&t.hoverInfo?l.slideDown(800).delay(4e3).queue((function(){r.$("#flashinfo-div").removeClass("hover"),l.css("max-height","8px")})):l.slideDown(800).delay(4e3).slideUp(800,(()=>{r.$(this).remove()})),l}async function V(e,t,n=()=>{},o=()=>{},s=!1){return new Promise((function(a,l){let c=i.storage.lang("Ok"),u=i.storage.lang("Cancel");s&&(c=i.storage.lang("Yes"),u=i.storage.lang("No"));const p=W(e=`<div style="text-align: center;">${e}</div><div style="display: flex; justify-content: space-around;"><button class="Yes" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px; cursor:pointer;">${c}</button><button class="Cancel" style="background-color: transparent; border: none; color: rgb(255,64,129);margin-top: 10px; cursor:pointer;">${u}</button></div>`,{permanent:!0,position:"top",type:t});p.find(".Yes").click((function(e){a(!0),r.$(e.target).parentsUntil(".flash").fadeOut(300,(function(){r.$(this).remove()})),n()})),p.find(".Cancel").click((function(e){a(!1),r.$(e.target).parentsUntil(".flash").fadeOut(300,(function(){r.$(this).remove()})),o()}))}))}let X=!1,Y=[];function q(e,t=".mdl-layout__content"){function n(e,t){if(!r.$(e).is(":visible"))return!1;if(r.$(e).hasClass("lazyBack"))r.$(e).css("background-image",`url(${e.getAttribute("data-src")})`).removeClass("lazyBack");else{const n=new Image,r=e.getAttribute("data-src");n.onload=function(){e.parent?e.parent.replaceChild(n,e):e.src=r,t&&t()},n.src=r}}for(let e=0;e<Y.length;e++)$(Y[e]).addClass("init");Y=[];const i=e.find("img.lazy.init, .lazyBack.init"),o=function(){for(let e=0;e<Y.length;e++)s.elementInViewport(Y[e],600)&&n(Y[e],(function(){Y.splice(e,e)})),$(Y[e]).length||Y.splice(e,e)};for(let e=0;e<i.length;e++)Y.push(i[e]),$(i[e]).removeClass("init");o(),X||(X=!0,e.find(t).scroll((function(){o()})))}function K(e,t=0){const n=e.getBoundingClientRect();return n.top>=0&&n.left>=0&&n.top-t<=(window.innerHeight||document.documentElement.clientHeight)}function J(e){return new Promise((t=>{setTimeout(t,e)}))}function Z(e,t,n){switch(e){case"mal":return`https://myanimelist.net/${t}/${n}`;case"anilist":return`https://anilist.co/${t}/${n}`;case"kitsu":return`https://kitsu.app/${t}/${n}`;case"simkl":return`https://simkl.com/${t}/${n}`;default:throw`${e} not a valid page`}}function Q(e=0){const t=new Date;t.setDate(t.getDate()+e);const n=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0");return`${t.getFullYear()}-${n}-${r}`}function ee(e){return $("<textarea/>").html(r.html(e)).text()}function te(){return Boolean("undefined"!=typeof browser&&"undefined"!=typeof chrome)}function ne(){const e=()=>Boolean(!document.visibilityState||"visible"===document.visibilityState);if(e())return Promise.resolve();o.log("Page in background");const{asyncWaitUntilTrue:t}=R((()=>e()));return t().then((()=>{o.log("Page is visible")}))}async function re(){const e=await i.storage.list();let t=0;for(const n in e)s.syncRegex.test(n)||/(^tagSettings\/.*)/.test(n)||(i.storage.remove(n),t++);s.flashm(`Cache Cleared [${t}]`)}function ie(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0}function oe(e,t){const n=new URL(e),{host:r}=n;return r===t||r.endsWith(`.${t}`)}function se(e){return!e||e.length<2?e:e.charAt(0).toUpperCase()+e.slice(1)}},7263:(e,t,n)=>{"use strict";n.r(t),n.d(t,{$:()=>i,html:()=>o});var r=n(99418);const i=jQuery;function o(e){return r.A.sanitize(e,{ALLOW_UNKNOWN_PROTOCOLS:!0,ADD_ATTR:["target"]})}},96789:(e,t,n)=>{"use strict";n.d(t,{GT:()=>a}),n(54089);var r=n(35580),i=n.n(r),o=n(13647);function s(){return o.storage.version()}function a(e){return i()(e,s())&&e!==s()}},99418:(e,t,n)=>{"use strict";n.d(t,{A:()=>ne});const{entries:r,setPrototypeOf:i,isFrozen:o,getPrototypeOf:s,getOwnPropertyDescriptor:a}=Object;let{freeze:l,seal:c,create:u}=Object,{apply:p,construct:d}="undefined"!=typeof Reflect&&Reflect;l||(l=function(e){return e}),c||(c=function(e){return e}),p||(p=function(e,t,n){return e.apply(t,n)}),d||(d=function(e,t){return new e(...t)});const h=x(Array.prototype.forEach),f=x(Array.prototype.lastIndexOf),g=x(Array.prototype.pop),m=x(Array.prototype.push),y=x(Array.prototype.splice),E=x(String.prototype.toLowerCase),v=x(String.prototype.toString),w=x(String.prototype.match),b=x(String.prototype.replace),I=x(String.prototype.indexOf),T=x(String.prototype.trim),S=x(Object.prototype.hasOwnProperty),R=x(RegExp.prototype.test),_=(A=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d(A,t)});var A;function x(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return p(e,t,r)}}function N(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:E;i&&i(e,null);let r=t.length;for(;r--;){let i=t[r];if("string"==typeof i){const e=n(i);e!==i&&(o(t)||(t[r]=e),i=e)}e[i]=!0}return e}function O(e){for(let t=0;t<e.length;t++)S(e,t)||(e[t]=null);return e}function $(e){const t=u(null);for(const[n,i]of r(e))S(e,n)&&(Array.isArray(i)?t[n]=O(i):i&&"object"==typeof i&&i.constructor===Object?t[n]=$(i):t[n]=i);return t}function L(e,t){for(;null!==e;){const n=a(e,t);if(n){if(n.get)return x(n.get);if("function"==typeof n.value)return x(n.value)}e=s(e)}return function(){return null}}const C=l(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),M=l(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),P=l(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),k=l(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),D=l(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),U=l(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),F=l(["#text"]),j=l(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),G=l(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),z=l(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),H=l(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),B=c(/\{\{[\w\W]*|[\w\W]*\}\}/gm),W=c(/<%[\w\W]*|[\w\W]*%>/gm),V=c(/\$\{[\w\W]*/gm),X=c(/^data-[\-\w.\u00B7-\uFFFF]+$/),Y=c(/^aria-[\-\w]+$/),q=c(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),K=c(/^(?:\w+script|data):/i),J=c(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Z=c(/^html$/i),Q=c(/^[a-z][.\w]*(-[.\w]+)+$/i);var ee=Object.freeze({__proto__:null,ARIA_ATTR:Y,ATTR_WHITESPACE:J,CUSTOM_ELEMENT:Q,DATA_ATTR:X,DOCTYPE_NAME:Z,ERB_EXPR:W,IS_ALLOWED_URI:q,IS_SCRIPT_OR_DATA:K,MUSTACHE_EXPR:B,TMPLIT_EXPR:V});const te=function(){return"undefined"==typeof window?null:window};var ne=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te();const n=t=>e(t);if(n.version="3.2.5",n.removed=[],!t||!t.document||9!==t.document.nodeType||!t.Element)return n.isSupported=!1,n;let{document:i}=t;const o=i,s=o.currentScript,{DocumentFragment:a,HTMLTemplateElement:c,Node:p,Element:d,NodeFilter:A,NamedNodeMap:x=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:O,DOMParser:B,trustedTypes:W}=t,V=d.prototype,X=L(V,"cloneNode"),Y=L(V,"remove"),K=L(V,"nextSibling"),J=L(V,"childNodes"),Q=L(V,"parentNode");if("function"==typeof c){const e=i.createElement("template");e.content&&e.content.ownerDocument&&(i=e.content.ownerDocument)}let ne,re="";const{implementation:ie,createNodeIterator:oe,createDocumentFragment:se,getElementsByTagName:ae}=i,{importNode:le}=o;let ce={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof r&&"function"==typeof Q&&ie&&void 0!==ie.createHTMLDocument;const{MUSTACHE_EXPR:ue,ERB_EXPR:pe,TMPLIT_EXPR:de,DATA_ATTR:he,ARIA_ATTR:fe,IS_SCRIPT_OR_DATA:ge,ATTR_WHITESPACE:me,CUSTOM_ELEMENT:ye}=ee;let{IS_ALLOWED_URI:Ee}=ee,ve=null;const we=N({},[...C,...M,...P,...D,...F]);let be=null;const Ie=N({},[...j,...G,...z,...H]);let Te=Object.seal(u(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Se=null,Re=null,_e=!0,Ae=!0,xe=!1,Ne=!0,Oe=!1,$e=!0,Le=!1,Ce=!1,Me=!1,Pe=!1,ke=!1,De=!1,Ue=!0,Fe=!1,je=!0,Ge=!1,ze={},He=null;const Be=N({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let We=null;const Ve=N({},["audio","video","img","source","image","track"]);let Xe=null;const Ye=N({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),qe="http://www.w3.org/1998/Math/MathML",Ke="http://www.w3.org/2000/svg",Je="http://www.w3.org/1999/xhtml";let Ze=Je,Qe=!1,et=null;const tt=N({},[qe,Ke,Je],v);let nt=N({},["mi","mo","mn","ms","mtext"]),rt=N({},["annotation-xml"]);const it=N({},["title","style","font","a","script"]);let ot=null;const st=["application/xhtml+xml","text/html"];let at=null,lt=null;const ct=i.createElement("form"),ut=function(e){return e instanceof RegExp||e instanceof Function},pt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!lt||lt!==e){if(e&&"object"==typeof e||(e={}),e=$(e),ot=-1===st.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,at="application/xhtml+xml"===ot?v:E,ve=S(e,"ALLOWED_TAGS")?N({},e.ALLOWED_TAGS,at):we,be=S(e,"ALLOWED_ATTR")?N({},e.ALLOWED_ATTR,at):Ie,et=S(e,"ALLOWED_NAMESPACES")?N({},e.ALLOWED_NAMESPACES,v):tt,Xe=S(e,"ADD_URI_SAFE_ATTR")?N($(Ye),e.ADD_URI_SAFE_ATTR,at):Ye,We=S(e,"ADD_DATA_URI_TAGS")?N($(Ve),e.ADD_DATA_URI_TAGS,at):Ve,He=S(e,"FORBID_CONTENTS")?N({},e.FORBID_CONTENTS,at):Be,Se=S(e,"FORBID_TAGS")?N({},e.FORBID_TAGS,at):{},Re=S(e,"FORBID_ATTR")?N({},e.FORBID_ATTR,at):{},ze=!!S(e,"USE_PROFILES")&&e.USE_PROFILES,_e=!1!==e.ALLOW_ARIA_ATTR,Ae=!1!==e.ALLOW_DATA_ATTR,xe=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ne=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Oe=e.SAFE_FOR_TEMPLATES||!1,$e=!1!==e.SAFE_FOR_XML,Le=e.WHOLE_DOCUMENT||!1,Pe=e.RETURN_DOM||!1,ke=e.RETURN_DOM_FRAGMENT||!1,De=e.RETURN_TRUSTED_TYPE||!1,Me=e.FORCE_BODY||!1,Ue=!1!==e.SANITIZE_DOM,Fe=e.SANITIZE_NAMED_PROPS||!1,je=!1!==e.KEEP_CONTENT,Ge=e.IN_PLACE||!1,Ee=e.ALLOWED_URI_REGEXP||q,Ze=e.NAMESPACE||Je,nt=e.MATHML_TEXT_INTEGRATION_POINTS||nt,rt=e.HTML_INTEGRATION_POINTS||rt,Te=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&ut(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Te.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&ut(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Te.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Te.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Oe&&(Ae=!1),ke&&(Pe=!0),ze&&(ve=N({},F),be=[],!0===ze.html&&(N(ve,C),N(be,j)),!0===ze.svg&&(N(ve,M),N(be,G),N(be,H)),!0===ze.svgFilters&&(N(ve,P),N(be,G),N(be,H)),!0===ze.mathMl&&(N(ve,D),N(be,z),N(be,H))),e.ADD_TAGS&&(ve===we&&(ve=$(ve)),N(ve,e.ADD_TAGS,at)),e.ADD_ATTR&&(be===Ie&&(be=$(be)),N(be,e.ADD_ATTR,at)),e.ADD_URI_SAFE_ATTR&&N(Xe,e.ADD_URI_SAFE_ATTR,at),e.FORBID_CONTENTS&&(He===Be&&(He=$(He)),N(He,e.FORBID_CONTENTS,at)),je&&(ve["#text"]=!0),Le&&N(ve,["html","head","body"]),ve.table&&(N(ve,["tbody"]),delete Se.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw _('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw _('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');ne=e.TRUSTED_TYPES_POLICY,re=ne.createHTML("")}else void 0===ne&&(ne=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(n=t.getAttribute(r));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}}(W,s)),null!==ne&&"string"==typeof re&&(re=ne.createHTML(""));l&&l(e),lt=e}},dt=N({},[...M,...P,...k]),ht=N({},[...D,...U]),ft=function(e){m(n.removed,{element:e});try{Q(e).removeChild(e)}catch(t){Y(e)}},gt=function(e,t){try{m(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){m(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(Pe||ke)try{ft(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},mt=function(e){let t=null,n=null;if(Me)e="<remove></remove>"+e;else{const t=w(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===ot&&Ze===Je&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const r=ne?ne.createHTML(e):e;if(Ze===Je)try{t=(new B).parseFromString(r,ot)}catch(e){}if(!t||!t.documentElement){t=ie.createDocument(Ze,"template",null);try{t.documentElement.innerHTML=Qe?re:r}catch(e){}}const o=t.body||t.documentElement;return e&&n&&o.insertBefore(i.createTextNode(n),o.childNodes[0]||null),Ze===Je?ae.call(t,Le?"html":"body")[0]:Le?t.documentElement:o},yt=function(e){return oe.call(e.ownerDocument||e,e,A.SHOW_ELEMENT|A.SHOW_COMMENT|A.SHOW_TEXT|A.SHOW_PROCESSING_INSTRUCTION|A.SHOW_CDATA_SECTION,null)},Et=function(e){return e instanceof O&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof x)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},vt=function(e){return"function"==typeof p&&e instanceof p};function wt(e,t,r){h(e,(e=>{e.call(n,t,r,lt)}))}const bt=function(e){let t=null;if(wt(ce.beforeSanitizeElements,e,null),Et(e))return ft(e),!0;const r=at(e.nodeName);if(wt(ce.uponSanitizeElement,e,{tagName:r,allowedTags:ve}),e.hasChildNodes()&&!vt(e.firstElementChild)&&R(/<[/\w!]/g,e.innerHTML)&&R(/<[/\w!]/g,e.textContent))return ft(e),!0;if(7===e.nodeType)return ft(e),!0;if($e&&8===e.nodeType&&R(/<[/\w]/g,e.data))return ft(e),!0;if(!ve[r]||Se[r]){if(!Se[r]&&Tt(r)){if(Te.tagNameCheck instanceof RegExp&&R(Te.tagNameCheck,r))return!1;if(Te.tagNameCheck instanceof Function&&Te.tagNameCheck(r))return!1}if(je&&!He[r]){const t=Q(e)||e.parentNode,n=J(e)||e.childNodes;if(n&&t)for(let r=n.length-1;r>=0;--r){const i=X(n[r],!0);i.__removalCount=(e.__removalCount||0)+1,t.insertBefore(i,K(e))}}return ft(e),!0}return e instanceof d&&!function(e){let t=Q(e);t&&t.tagName||(t={namespaceURI:Ze,tagName:"template"});const n=E(e.tagName),r=E(t.tagName);return!!et[e.namespaceURI]&&(e.namespaceURI===Ke?t.namespaceURI===Je?"svg"===n:t.namespaceURI===qe?"svg"===n&&("annotation-xml"===r||nt[r]):Boolean(dt[n]):e.namespaceURI===qe?t.namespaceURI===Je?"math"===n:t.namespaceURI===Ke?"math"===n&&rt[r]:Boolean(ht[n]):e.namespaceURI===Je?!(t.namespaceURI===Ke&&!rt[r])&&!(t.namespaceURI===qe&&!nt[r])&&!ht[n]&&(it[n]||!dt[n]):!("application/xhtml+xml"!==ot||!et[e.namespaceURI]))}(e)?(ft(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!R(/<\/no(script|embed|frames)/i,e.innerHTML)?(Oe&&3===e.nodeType&&(t=e.textContent,h([ue,pe,de],(e=>{t=b(t,e," ")})),e.textContent!==t&&(m(n.removed,{element:e.cloneNode()}),e.textContent=t)),wt(ce.afterSanitizeElements,e,null),!1):(ft(e),!0)},It=function(e,t,n){if(Ue&&("id"===t||"name"===t)&&(n in i||n in ct))return!1;if(Ae&&!Re[t]&&R(he,t));else if(_e&&R(fe,t));else if(!be[t]||Re[t]){if(!(Tt(e)&&(Te.tagNameCheck instanceof RegExp&&R(Te.tagNameCheck,e)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(e))&&(Te.attributeNameCheck instanceof RegExp&&R(Te.attributeNameCheck,t)||Te.attributeNameCheck instanceof Function&&Te.attributeNameCheck(t))||"is"===t&&Te.allowCustomizedBuiltInElements&&(Te.tagNameCheck instanceof RegExp&&R(Te.tagNameCheck,n)||Te.tagNameCheck instanceof Function&&Te.tagNameCheck(n))))return!1}else if(Xe[t]);else if(R(Ee,b(n,me,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==I(n,"data:")||!We[e])if(xe&&!R(ge,b(n,me,"")));else if(n)return!1;return!0},Tt=function(e){return"annotation-xml"!==e&&w(e,ye)},St=function(e){wt(ce.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||Et(e))return;const r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:be,forceKeepAttr:void 0};let i=t.length;for(;i--;){const o=t[i],{name:s,namespaceURI:a,value:l}=o,c=at(s);let u="value"===s?l:T(l);if(r.attrName=c,r.attrValue=u,r.keepAttr=!0,r.forceKeepAttr=void 0,wt(ce.uponSanitizeAttribute,e,r),u=r.attrValue,!Fe||"id"!==c&&"name"!==c||(gt(s,e),u="user-content-"+u),$e&&R(/((--!?|])>)|<\/(style|title)/i,u)){gt(s,e);continue}if(r.forceKeepAttr)continue;if(gt(s,e),!r.keepAttr)continue;if(!Ne&&R(/\/>/i,u)){gt(s,e);continue}Oe&&h([ue,pe,de],(e=>{u=b(u,e," ")}));const p=at(e.nodeName);if(It(p,c,u)){if(ne&&"object"==typeof W&&"function"==typeof W.getAttributeType)if(a);else switch(W.getAttributeType(p,c)){case"TrustedHTML":u=ne.createHTML(u);break;case"TrustedScriptURL":u=ne.createScriptURL(u)}try{a?e.setAttributeNS(a,s,u):e.setAttribute(s,u),Et(e)?ft(e):g(n.removed)}catch(e){}}}wt(ce.afterSanitizeAttributes,e,null)},Rt=function e(t){let n=null;const r=yt(t);for(wt(ce.beforeSanitizeShadowDOM,t,null);n=r.nextNode();)wt(ce.uponSanitizeShadowNode,n,null),bt(n),St(n),n.content instanceof a&&e(n.content);wt(ce.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,i=null,s=null,l=null;if(Qe=!e,Qe&&(e="\x3c!--\x3e"),"string"!=typeof e&&!vt(e)){if("function"!=typeof e.toString)throw _("toString is not a function");if("string"!=typeof(e=e.toString()))throw _("dirty is not a string, aborting")}if(!n.isSupported)return e;if(Ce||pt(t),n.removed=[],"string"==typeof e&&(Ge=!1),Ge){if(e.nodeName){const t=at(e.nodeName);if(!ve[t]||Se[t])throw _("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof p)r=mt("\x3c!----\x3e"),i=r.ownerDocument.importNode(e,!0),1===i.nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?r=i:r.appendChild(i);else{if(!Pe&&!Oe&&!Le&&-1===e.indexOf("<"))return ne&&De?ne.createHTML(e):e;if(r=mt(e),!r)return Pe?null:De?re:""}r&&Me&&ft(r.firstChild);const c=yt(Ge?e:r);for(;s=c.nextNode();)bt(s),St(s),s.content instanceof a&&Rt(s.content);if(Ge)return e;if(Pe){if(ke)for(l=se.call(r.ownerDocument);r.firstChild;)l.appendChild(r.firstChild);else l=r;return(be.shadowroot||be.shadowrootmode)&&(l=le.call(o,l,!0)),l}let u=Le?r.outerHTML:r.innerHTML;return Le&&ve["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&R(Z,r.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+u),Oe&&h([ue,pe,de],(e=>{u=b(u,e," ")})),ne&&De?ne.createHTML(u):u},n.setConfig=function(){pt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Ce=!0},n.clearConfig=function(){lt=null,Ce=!1},n.isValidAttribute=function(e,t,n){lt||pt({});const r=at(e),i=at(t);return It(r,i,n)},n.addHook=function(e,t){"function"==typeof t&&m(ce[e],t)},n.removeHook=function(e,t){if(void 0!==t){const n=f(ce[e],t);return-1===n?void 0:y(ce[e],n,1)[0]}return g(ce[e])},n.removeHooks=function(e){ce[e]=[]},n.removeAllHooks=function(){ce={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}()}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(55002)})();
//# sourceMappingURL=chibi.js.map