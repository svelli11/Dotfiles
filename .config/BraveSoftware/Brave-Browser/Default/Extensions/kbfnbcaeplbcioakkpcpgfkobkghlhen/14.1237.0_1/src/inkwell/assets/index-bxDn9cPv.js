import{p as d,h as j,j as y,E as F,m as O,i as S,al as M,z as D,a3 as P,s as h,U as V,x as z,l as m,y as G,G as N,r as W,o as q,d as B,as as Y,at as $}from"./index-uVYElzgq.js";import{g as R}from"./getDecorationStrategy-D8c5vEyH.js";import{d as w}from"./distinctUntilChanged-JrE1RNy_.js";import{s as U}from"./switchMap-BWSw-lA5.js";import{E as k}from"./mergeAll-CSDR5lBs.js";import{t as H}from"./tap-BL_zgIju.js";import{d as I}from"./debounceTime-XokiU2Af.js";import{s as J}from"./startWith-DFLDsqXv.js";import"./async-dh0JxqdS.js";import"./concat-DqL665aX.js";var K=(r,e)=>(e=Symbol[r])?e:Symbol.for("Symbol."+r),_=r=>{throw TypeError(r)},E=(r,e,o)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&_("Object expected");var t;t===void 0&&(t=e[K("dispose")]),typeof t!="function"&&_("Object not disposable"),r.push([o,t,e])}return e},T=(r,e,o)=>{var t=typeof SuppressedError=="function"?SuppressedError:function(s,n,i,l){return l=Error(i),l.name="SuppressedError",l.error=s,l.suppressed=n,l},u=s=>e=o?new t(s,e,"An error was suppressed during disposal"):(o=!0,s),c=s=>{for(;s=r.pop();)try{var n=s[1]&&s[1].call(s[2]);if(s[0])return Promise.resolve(n).then(c,i=>(u(i),c()))}catch(i){u(i)}if(o)throw e};return c()};const de=r=>d(y([S(r.getExecutionScopeDefinition("document-session")),S(r.getExecutionScopeDefinition("document-group")),r.getPlugin("ui"),r.getPlugin("text-decoration"),r.getPlugin("document-session"),r.getPlugin("window-management")]),j(([e,o,t,u,c,s])=>{var n=[];try{const p=E(n,new DisposableStack);return p.use(e.onStart(async a=>d(y([a.resolve(t.provides.MainViewContainer),a.resolve(u.provides.TextDecorationsView),a.resolve(c.provides.TextDocumentInfo),a.resolve(s.provides.CurrentWindow),a.resolve(F)]),O(([f,b,g,x,C])=>L(f,b,g,x,C))))),p.use(o.onStart(async a=>d(y([a.resolve(c.provides.DocumentSessionManager),a.resolve(s.provides.CurrentWindow),a.resolve(F)]),O(([f,b,g])=>Q(f,b,g))))),S(p.move())}catch(p){var i=p,l=!0}finally{T(n,i,l)}}));function L(r,e,o,t,u){var c=[];try{const i=E(c,new DisposableStack),l=R(u.client),p=a=>r.add(()=>M.createElement(e,{width:"100%",height:"100%",hideDecorationsOnScroll:a.hideDecorationsOnScroll}),{slot:"default"});if(l==="showAllDocuments")i.use(p({hideDecorationsOnScroll:!0})),i.use(X(o,t));else if(l==="showActiveDocumentOnly")i.use(d(D(o.hasFocus),w(),U(a=>a?new P(()=>{const f=p({hideDecorationsOnScroll:!0});return()=>f[Symbol.dispose]()}):k),h())),i.use(Z(o,t));else throw new V(l);return i.move()}catch(i){var s=i,n=!0}finally{T(c,s,n)}}function Q(r,e,o){var t=[];try{const s=E(t,new DisposableStack);return R(o.client)==="showActiveDocumentOnly"&&s.use(d(z(r.activeDocumentId),w(),H(n=>{n&&(m.verbose("Active document focused - showing current window"),v(e.show(),i=>m.error("Unexpected error calling appWindow.show()",i)))}),I(500),G(n=>n===null),h(()=>{m.verbose("No active document focused - hiding current window"),v(e.hide(),n=>m.error("Unexpected error calling appWindow.hide()",n))}))),s.move()}catch(s){var u=s,c=!0}finally{T(t,u,c)}}function X(r,e){return d(A(r.geometry),h(o=>{o?v(e.setRect(o),t=>m.error("Unexpected error calling appWindow.setRect()",t)):v(e.setRect(N()),t=>m.error("Unexpected error calling appWindow.hide()",t))}))}function Z(r,e){return d(D(r.hasFocus),w(),U(o=>o?A(r.geometry):k),h(o=>{o?v(e.setRect(o),t=>m.error("Unexpected error calling appWindow.setRect()",t)):v(e.hide(),t=>m.error("Unexpected error calling appWindow.hide()",t))}))}function A(r){return d(D(r),W(e=>e.geometry),W(e=>e?$({x:e.windowFrame.x+e.viewportFrame.x+e.documentFrame.x,y:e.windowFrame.y+e.viewportFrame.y+e.documentFrame.y,width:e.documentFrame.width,height:e.documentFrame.height}):null),J(null),w((e,o)=>e&&o?Y(e,o):!e&&!o))}function v(r,e){return d(r,q(B(e)))}export{de as activate};
//# sourceMappingURL=index-bxDn9cPv.js.map
