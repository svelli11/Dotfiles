(self.webpackChunk=self.webpackChunk||[]).push([[7725],{68340:(e,t,i)=>{i.d(t,{cp:()=>o,oA:()=>a});var n=i(58303),s=i(20161),r=i(24666),l=i(36344);function o(e){return(0,s.w)(n.g_((()=>l.E),e))}const a=o(i(84714).of);(0,r.x)(((e,t)=>n.Wi(e)&&n.Wi(t)||n.pC(e)&&n.pC(t)))},86267:(e,t,i)=>{i.r(t),i.d(t,{ToneAIFeature:()=>g});var n=i(39953),s=i(44755),r=i(9273),l=i(68340),o=i(70188),a=i(92516),u=i(13107),d=i(66337),A=i(84358),c=i(58303),p=i(20128),b=i(88305);class g{constructor(e,t,i){this._alertStateService=e,this._getSessionUuid=t,this._gnar=i}initSingleCardAssistantActionsProcessing(e,t){return new r.Observable((()=>{const i=new r.Subscription;return this._subscribeToCommonActions(e,t,i),()=>i.unsubscribe()}))}initAssistantCardActionsProcessing(e,t,i,s,l){return new r.Observable((()=>{const o=new r.Subscription;this._subscribeToCommonActions(t,l,o),o.add(g._getToneAIAlertObservable(s.pipe(r.filter(u.i.isToneAIItem),r.map((e=>e.activeAlert.id))),t).subscribe((e=>{this._gnar.toneAIAssistantMiniCardShow(this._getSessionUuidValue(),g._getToneRewriteType(e))}))),o.add(g._getToneAIAlertObservable(e.pipe(r.filter(a.lY.isAlertCardShow),r.map((e=>e.alertId))),t).pipe(r.debounceTime(300)).subscribe((e=>{this._gnar.toneAIAssistantFullCardShow(this._getSessionUuidValue(),g._getToneRewriteType(e))}))),o.add(g._getToneAIAlertObservable(e.pipe(r.filter(a.lY.isAlertApplyAction),r.map((e=>e.alertId))),t).subscribe((e=>{this._gnar.toneAIAssistantFullCardReplacementApply(this._getSessionUuidValue(),g._getToneRewriteType(e))}))),g._subscribeToMuteOrUndoMuteButtonClick(o,e,i,t,a.lY.isMuteCategoryAction,(e=>{this._gnar.toneAIAssistantFullCardMuteButtonClick(this._getSessionUuidValue(),g._getToneRewriteType(e))})),g._subscribeToMuteOrUndoMuteButtonClick(o,e,i,t,a.lY.isUndoMuteCategoryAction,(e=>{this._gnar.toneAIAssistantFullCardUndoMuteButtonClick(this._getSessionUuidValue(),g._getToneRewriteType(e))}));const d=e.pipe(r.filter(a.lY.isToneAIChangeToneAlternativeAction));return o.add(d.pipe(r.startWith(null),r.pairwise(),r.filter((([e,t])=>(null==e?void 0:e.selectedToneAlternativeIdx)!==(null==t?void 0:t.selectedToneAlternativeIdx))),r.map((([e,t])=>{var i,n;return{oldToneAlternativeIdx:null!==(i=null==e?void 0:e.selectedToneAlternativeIdx)&&void 0!==i?i:null,newToneAlternativeIdx:null!==(n=null==t?void 0:t.selectedToneAlternativeIdx)&&void 0!==n?n:null}})),r.withLatestFrom(g._getToneAIAlertObservable(d.pipe(r.map((e=>e.alertId))),t))).subscribe((([{oldToneAlternativeIdx:e,newToneAlternativeIdx:t},i])=>(0,n.zG)(i.extraProperties.toneAI,A.bw((n=>{this._gnar.toneAIAssistantFullCardSliderMove(null!==t?n.toneAlternatives[t].name:"",null!==e?n.toneAlternatives[e].name:"",this._getSessionUuidValue(),g._getToneRewriteType(i))})))))),o.add(g._getToneAIAlertObservable(e.pipe(r.filter(a.lY.isAlertIgnoreAction),r.map((e=>e.alertId))),t).subscribe((e=>{this._gnar.toneAIAssistantFullCardDismissButtonClick(this._getSessionUuidValue(),g._getToneRewriteType(e))}))),()=>o.unsubscribe()}))}_subscribeToCommonActions(e,t,i){i.add(this._alertStateService.newlyHighlightedAlerts.pipe(r.filter(p.S.isToneAIAlert)).subscribe((e=>{this._gnar.toneAIAlertUnderlineShow(this._getSessionUuidValue(),g._getToneRewriteType(e))}))),i.add(g._getToneAIAlertObservable(t.pipe(r.filter(o.$.isToneAI),r.map((e=>e.id))),e).subscribe((e=>{this._gnar.toneAIAlertUnderlineClick(this._getSessionUuidValue(),g._getToneRewriteType(e))})))}_getSessionUuidValue(){return(0,n.zG)(this._getSessionUuid(),c.fS((()=>"")))}static _getToneRewriteType(e){return`${e.patternName.split("/").slice(2).join("/")}${e.patternNameQualifier?`_${e.patternNameQualifier}`:""}`}static _subscribeToMuteOrUndoMuteButtonClick(e,t,i,s,l,o){e.add(g._getToneAIAlertObservable(t.pipe(r.filter(l),r.withLatestFrom(i),r.map((([e,t])=>d.nL.hasItems(t)?(0,n.zG)(t.currentLens.items.get(e.id),c.g_((()=>null),(e=>e.value))):null)),r.filter(b.fQ),r.filter(u.i.isToneAIItem),r.map((e=>e.activeAlert.id))),s).subscribe(o))}static _getToneAIAlertObservable(e,t){return e.pipe(r.map(t.getById),l.oA,r.filter(s.bZ.isToneAI))}}}}]);