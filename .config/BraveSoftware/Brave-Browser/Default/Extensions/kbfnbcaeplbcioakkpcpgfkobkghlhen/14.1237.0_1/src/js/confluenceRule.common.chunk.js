(self.webpackChunk=self.webpackChunk||[]).push([[370],{66533:(e,t,n)=>{n.d(t,{v:()=>F});var a=n(88657),i=n(41169),r=n(90023),o=n(12518),c=n(67649),l=n(31491),s=n(29196),d=n(10140),u=n(13255),p=n(2816),g=n(66914);var m=n(13391),v=n(58303),f=n(3601),h=n(16582),x=n(45030);const C=e=>e.createDocument?e.createDocument:t=>x._A.create((e=>e.getDocumentId?e.getDocumentId:()=>{})(e)(t));var y=n(51837),S=n(32504),E=n(28422);const I={ruleName:"isKnowledgeHubEnabled",match:(e,t)=>"test"===t.experimentClient.getTreatment(a.p.KnowledgeHubAtlassian)},b=".ak-renderer-document",F=(M="Jira",T=e=>({createLayout:()=>new i.A7(e.field),validationRules:[I,{ruleName:"isReadonlyContentField",match:(e,t)=>e.matches(b)}],textMap:{createFieldTextMap:e=>new p.Z(e,((e,t)=>p.Z.defaultFilterNode(e,t)&&(e=>!e.classList.contains("expand-content-wrapper"))(e)))}}),w=b,{kind:E.A.readonly,name:`readonlyContent.${M}`,contentSelector:w,match:e=>{const t=((e,t,n,a)=>{const i=n(e),o=i.target||e.field,c=i.textMap||{createFieldTextMap:p.Z.create},m=(i.createSelectionSource||(()=>(0,u.B)(o)))();return{target:o,initialState:e.state,integrationName:`contentEditable.${t}`,validationRules:[{ruleName:"notABody",match:(0,l.ff)(d.XD)},{ruleName:"isReadonlyContentField",match:(e,t)=>e.matches(a)}],textMap:c,expiration:d.Jj,createSelectionSource:()=>(0,u.B)(o),mapChange:r.yR,...i,selectionSource:m,createTextObserver:()=>new g.j(o,s.k.fromDiff,m,void 0,c.createFieldTextMap)}})(e,M,T,w);return(0,r.zG)((0,y.O)(t.target,e,t.integrationName,t.validationRules),o.UI((()=>({targetField:t.target,matchExpires:t.expiration(t.target),execute:e=>{var n;const a=S.Y.decorate((0,r.zG)(((e,t)=>{var n;const a=t.createTextObserver(),i=t.createHighlightsFilterFactory?t.createHighlightsFilterFactory(a):h.u,r=t.createLayout(t.target);return{doc:C(e)(t.target),textField:t.target,domain:e.pageContext.domain,url:e.pageContext.url,layout:r,createCheckingService:t=>e.createCheckingService(t),mapChange:t.mapChange,state:m.h.create(t.initialState),actions:e.actions,fieldSettings:e.fieldSettings,notifications:(0,f.Cq)(e.app.notifications,"ctx.app.notifications"),gnar:e.gnar,productMetricsCSClient:e.productMetricsCSClient,felog:e.felog,config:e.pageContext.config,experimentClient:e.experimentClient,isCurrentFieldFocused:m.h.create(!1),selectionSource:t.selectionSource,textObserver:a,createAlertProcessor:t.createAlertProcessor,createTextRevisionManager:t.createTextRevisionManager,geometryProvider:t.highlightGeometryProvider,customizations:{...t.customizations,getDocEvents:(null===(n=t.customizations)||void 0===n?void 0:n.getDocEvents)||e.getDocEvents,isGbuttonVisible:m.h.create(!1)},highlightsFilterFactory:i,iframeConnectionId:e.iframeConnectionId,eventPropagationHandler:e.eventPropagationHandler,forceIntegrationEntirelyInsideIframe:e.forceIntegrationEntirelyInsideIframe,pageIntegrationId:e.pageContext.id,integrationName:t.integrationName,fieldIntegrationStore:e.pageContext.fieldIntegrationStore,vBarsIntegrationInfo:v.YP}})(e,t),c.kC,r.a9),t.integrationName,t.target);return null===(n=t.onCreate)||void 0===n||n.call(t),{update(e){a.update(e)},dispose(){var e;a.dispose(),null===(e=t.onDispose)||void 0===e||e.call(t)}}},desiredCustomizations:{capiStartSessionOptions:{...e.capiStartSessionOptions,mode:"READ_ONLY"}}}))))}});var M,T,w},62721:(e,t,n)=>{n.r(t),n.d(t,{Confluence:()=>w});var a,i=n(91089),r=n(84308),o=n(44071),c=n(14969),l=n(29479),s=n(954),d=n(59179),u=n(10883),p=n(24666),g=n(32734),m=n(89408),v=n(58303),f=n(3601),h=n(45013),x=n(41169),C=n(71497),y=n(36251),S=n(10140),E=n(33148),I=n(80908),b=n(51425),F=n(38759),M=n(66533),T=n(2816);!function(e){e.createEditorTextMap=e=>new T.Z(e,void 0,void 0,((e,t)=>t.isEditable))}(a||(a={}));var w,N=n(93995),R=n(14027),A=n(98961),k=n(76979),D=n(95804);!function(e){const t=(0,I.q)("Confluence.confluenceEditor",(e=>({validationRules:[{ruleName:"TinyMCECustomRule",match:e=>{var t;const n=null===(t=null==e?void 0:e.contentDocument)||void 0===t?void 0:t.body;return!!n&&((0,S.Ne)(n)||(0,S.w5)(n))}},...F.c],expiration:(e,t)=>{const n=e.parentElement&&e.parentElement.parentElement;return n&&"wysiwyg"===n.id?A.x.observeAttribute(n,"class").pipe((0,c.P)((e=>!!e&&e.includes("hidden"))),(0,l.h)(void 0)):(0,i.F)()},textMap:{createFieldTextMap:a.createEditorTextMap}}))),n=b.M.generic((e=>({overwriteGenericOpts:{validationRules:F.u,textMap:{createFieldTextMap:(e,t={})=>b.M.createFieldTextMap(e,{...t,andFilterNode:e=>{const t=e.getAttribute("data-testid");return!t||!t.includes("placeholder")}})},getVBarsIntegrationInfo:t=>v.G({kind:"confluenceEditor",integrationName:t,domain:e.pageContext.domain,isInsideIFrame:!1}),createLayout:e=>{const t=(0,C.bp)(e),n=k.N.observeSizeChanges([e,t]),a=(0,f.Cq)(e.parentElement),i=A.x.create(a,{attributes:!1,childList:!0,subtree:!1,characterData:!1}).pipe((0,s.O)([]),(0,d.U)((()=>{const e=t.querySelector("#editor-scroll-gutter");return e?e.clientHeight:0})));return new x.A7(e,{createGbuttonShiftBehavior:e=>(0,r.a)(n.pipe((0,u.M)(i),(0,d.U)((([e,n])=>{const a=t.getBoundingClientRect(),i=t.scrollHeight-a.height-n-(self.innerHeight-a.bottom);if(0===i)return 0;return i+36})),(0,p.x)()),(0,o.R)(t,"scroll").pipe((0,d.U)((()=>t.scrollTop)),(0,s.O)(t.scrollTop),(0,p.x)(),(0,g.B)())).pipe((0,d.U)((([e,t])=>({top:Math.min(0,t-e),left:0}))),(0,m.d)()),injectIntegrationRoot:({editorElement:e,isPositioned:t,editorElementStyle:n,integrationRoot:a,positionedAncestor:i})=>{t?(a.style.zIndex=n.zIndex,e.insertAdjacentElement("afterend",a)):(a.style.zIndex="1",i.insertAdjacentElement("beforeend",a))}})}}})));e.page=(0,N.$W)({name:"confluence",domain:R.fI,url:/^https?:\/\/\S+\.atlassian\.net\/wiki\/.*$/,eventPropagationHandler:e=>{(0,h.OB)().experimentClient.isGateEnabled(D.K.CentralizeStopEventPropagation)||e.addEventListener("keypress",(e=>{e.stopPropagation()}))}},[n,E.T.contentEditable("Confluence",(()=>({createLayout:e=>new y.K(e)}))),t,(0,I.q)("Confluence"),E.T.textarea("Confluence",(()=>({createLayout:e=>new y.K(e)}))),M.v])}(w||(w={}))}}]);