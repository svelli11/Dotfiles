import{B as E,S as h,p,q as F,ac as j,o as m,d as S,ad as C,l as x,K as f,N as D,ae as v,u as U}from"./index-uVYElzgq.js";function B(r,t){return R(r,t,{kind:"none"})}function L(r,t,a){return R(r,t,{kind:"some",value:a})}function T(r,t){return w(r,t)}function q(r,t){return w(r,t,()=>r.getValue())}function R(r,t,a){const e=a.kind==="some"?new E(a.value):new h;return p(r.resolveEntity(t,{entity:{next:i=>f(e.next(i)),error:i=>f(e.error(i)),complete:()=>f(e.complete())}}),F(({entity:i,connection:c})=>({...e instanceof E?{getValue:()=>e.value}:void 0,subscribe:d=>{const n=new DisposableStack,o=e.subscribe(d),s=j(),b=new AbortController;return n.defer(()=>b.abort()),c.addEventListener("abort",()=>e.complete(),{once:!0,signal:b.signal}),n.defer(()=>{o.unsubscribe(),c.aborted||p(i.unsubscribe(s),m(S(u=>{u instanceof C||x.error("Error unsubscribing entity",u)})))}),p(i.subscribe(s),m(S(u=>e.error(u)))),n}})))}function w(r,t,a){const{entity:e,connection:i}=t,c=new DisposableStack,d=new AbortController;c.defer(()=>d.abort());const n=new Map;return c.defer(()=>{n.forEach(o=>o[Symbol.dispose]()),n.clear()}),i.addEventListener("abort",()=>c.dispose(),{signal:d.signal}),{entity:{subscribe:o=>{if(c.disposed)return D(new v("The subscription is disposed"));const s=n.get(o);s&&s[Symbol.dispose]();const b=(l,k)=>void p(k,m(S(g=>{var y;if(g instanceof v){(y=n.get(o))==null||y[Symbol.dispose]();return}x.error("'Unexpected error calling client.".concat(l,"()'"),g)}))),u=r.subscribe({next:l=>b("next",e.next(l)),error:l=>b("error",e.error(l)),complete:()=>b("complete",e.complete())});return a&&b("next",e.next(a())),n.set(o,u),f()},unsubscribe:o=>U(async()=>{const s=n.get(o);s==null||s[Symbol.dispose](),n.delete(o)})},disposable:c}}export{q as a,L as b,T as c,B as d};
//# sourceMappingURL=RemoteSubscribable-CanKOUL4-C6cenfHh.js.map
