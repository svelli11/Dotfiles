import{p as l,h as j,j as y,E as F,m as O,i as S,z as D,Z as M,s as v,U as P,l as m,x as V,r as W,o as z,g as N}from"./start-BFd-djfI.js";import{r as q}from"./index-Bm4tEXCw.js";import{g as R}from"./getDecorationStrategy-ByPikn4k.js";import{t as B}from"./subscribableState-Y8YW7N9Z-L1DO2Tta.js";import{d as w}from"./distinctUntilChanged-GMQNSCXg.js";import{s as U}from"./switchMap-BkKtxKb2.js";import{E as k}from"./mergeAll-D275NTmK.js";import{t as G}from"./tap-BNGPOE-c.js";import{d as Y}from"./debounceTime-DnL_PUPV.js";import{s as Z}from"./startWith-PVWOuAJK.js";import{a as $,e as H}from"./RectFns-ndpeBtT0-CdOd3O5S.js";import"./async-BZW1XXsj.js";import"./AsyncScheduler-BhBy18pz.js";import"./dateTimestampProvider-CV0dHcg-.js";import"./concat-Bl9EyBSW.js";function I(r){return{x:r.x,y:r.y,width:r.width,height:r.height}}var J=(r,e)=>(e=Symbol[r])?e:Symbol.for("Symbol."+r),_=r=>{throw TypeError(r)},E=(r,e,o)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&_("Object expected");var t;t===void 0&&(t=e[J("dispose")]),typeof t!="function"&&_("Object not disposable"),r.push([o,t,e])}return e},T=(r,e,o)=>{var t=typeof SuppressedError=="function"?SuppressedError:function(i,n,s,d){return d=Error(s),d.name="SuppressedError",d.error=i,d.suppressed=n,d},p=i=>e=o?new t(i,e,"An error was suppressed during disposal"):(o=!0,i),c=i=>{for(;i=r.pop();)try{var n=i[1]&&i[1].call(i[2]);if(i[0])return Promise.resolve(n).then(c,s=>(p(s),c()))}catch(s){p(s)}if(o)throw e};return c()};const he=r=>l(y([S(r.getExecutionScopeDefinition("document-session")),S(r.getExecutionScopeDefinition("document-group")),r.getPlugin("ui"),r.getPlugin("text-decoration"),r.getPlugin("document-session"),r.getPlugin("window-management")]),j(([e,o,t,p,c,i])=>{var n=[];try{const u=E(n,new DisposableStack);return u.use(e.onStart(async a=>l(y([a.resolve(t.provides.MainViewContainer),a.resolve(p.provides.TextDecorationsView),a.resolve(c.provides.TextDocumentInfo),a.resolve(i.provides.CurrentWindow),a.resolve(F)]),O(([h,g,b,A,C])=>K(h,g,b,A,C))))),u.use(o.onStart(async a=>l(y([a.resolve(c.provides.DocumentSessionManager),a.resolve(i.provides.CurrentWindow),a.resolve(F)]),O(([h,g,b])=>L(h,g,b))))),S(u.move())}catch(u){var s=u,d=!0}finally{T(n,s,d)}}));function K(r,e,o,t,p){var c=[];try{const s=E(c,new DisposableStack),d=R(p.client),u=a=>r.add(()=>q.createElement(e,{width:"100%",height:"100%",hideDecorationsOnScroll:a.hideDecorationsOnScroll}),{slot:"default"});if(d==="showAllDocuments")s.use(u({hideDecorationsOnScroll:!0})),s.use(Q(o,t));else if(d==="showActiveDocumentOnly")s.use(l(D(o.hasFocus),w(),U(a=>a?new M(()=>{const h=u({hideDecorationsOnScroll:!0});return()=>h[Symbol.dispose]()}):k),v())),s.use(X(o,t));else throw new P(d);return s.move()}catch(s){var i=s,n=!0}finally{T(c,i,n)}}function L(r,e,o){var t=[];try{const i=E(t,new DisposableStack);return R(o.client)==="showActiveDocumentOnly"&&i.use(l(B(r.activeDocumentId),w(),G(n=>{n&&(m.verbose("Active document focused - showing current window"),f(e.show(),s=>m.error("Unexpected error calling appWindow.show()",s)))}),Y(500),V(n=>n===null),v(()=>{m.verbose("No active document focused - hiding current window"),f(e.hide(),n=>m.error("Unexpected error calling appWindow.hide()",n))}))),i.move()}catch(i){var p=i,c=!0}finally{T(t,p,c)}}function Q(r,e){return l(x(r.geometry),v(o=>{o?f(e.setRect(o),t=>m.error("Unexpected error calling appWindow.setRect()",t)):f(e.setRect($()),t=>m.error("Unexpected error calling appWindow.hide()",t))}))}function X(r,e){return l(D(r.hasFocus),w(),U(o=>o?x(r.geometry):k),v(o=>{o?f(e.setRect(o),t=>m.error("Unexpected error calling appWindow.setRect()",t)):f(e.hide(),t=>m.error("Unexpected error calling appWindow.hide()",t))}))}function x(r){return l(D(r),W(e=>e.geometry),W(e=>e?I({x:e.windowFrame.x+e.viewportFrame.x+e.documentFrame.x,y:e.windowFrame.y+e.viewportFrame.y+e.documentFrame.y,width:e.documentFrame.width,height:e.documentFrame.height}):null),Z(null),w((e,o)=>e&&o?H(e,o):!e&&!o))}function f(r,e){return l(r,z(N(e)))}export{he as activate};
//# sourceMappingURL=index-BUGw0CJ-.js.map
