(self.webpackChunk=self.webpackChunk||[]).push([[8105],{63872:(t,e,i)=>{i.r(e),i.d(e,{Outlook:()=>M,getInjectionLayoutForGButtonInSendContainer:()=>P,getInjectionLayoutForStickyGButtonOnTheBottom:()=>U,getVBarsIntegrationInfo:()=>T});var o=i(59179),n=i(954),r=i(58303),s=i(5913),l=i(26547),a=i(30821),u=i(95714),c=i(57702),d=i(41169),g=i(71497),p=i(33148),m=i(81327),h=i(20161),y=i(84308),f=i(84766),_=i(14969),S=i(91089),b=i(31603),v=i(90572),E=i(24666),x=i(32073),B=i(98961),k=i(32082);class C{constructor(){this._logger=k.Y.create("NativeSuggestionsToggler"),this._elementsSubs=null,this._squigglers=[]}set ctx(t){this._ctx=t}static getInstance(t){return this._instance||(this._instance=new C),this._instance.ctx=t,this._instance}static _isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}_waitForSquigglers(){return this._ctx.field.parentElement?B.x.create(this._ctx.field.parentElement,{childList:!0}).pipe(n.O([{target:this._ctx.field.parentElement,type:"childList"}]),h.w((t=>{for(const e of t)if("childList"===e.type&&C._isElementNode(e.target)){const t=Array.from(e.target.querySelectorAll("div.ms-editor-squiggler"));return y.a(t.map((t=>f.F(100).pipe(o.U((()=>t.shadowRoot)),_.P((t=>Boolean(t)))))))}return S.C})),h.w((t=>y.a(t.map((t=>{const e=t.querySelector("div");return e?B.x.create(e,{childList:!0}).pipe(n.O([{target:e,type:"childList"}])):S.C}))).pipe(b.J()))),o.U((t=>{for(const e of t)if("childList"===e.type&&C._isElementNode(e.target)){const t=e.target.querySelectorAll('span[role="status"]');return t?Array.from(t):null}return null})),v.h((t=>Boolean(t))),o.U((t=>t.filter((t=>"none"!==t.style.display)))),v.h((t=>t.length>0)),E.x(((t,e)=>t.reduce(((t,e)=>t+e.style.display),"")===e.reduce(((t,e)=>t+e.style.display),"")))):S.C}_waitForEditorCard(){return B.x.create(this._ctx.field.ownerDocument.documentElement,{childList:!0}).pipe(o.U((t=>{var e;for(const i of t)if("childList"===i.type&&C._isElementNode(i.target))return null!==(e=i.target.querySelector("editor-card"))&&void 0!==e?e:null;return null})),_.P((t=>Boolean(t))))}_waitForPremiumBadge(){return this._ctx.field.parentElement?B.x.create(this._ctx.field.parentElement,{childList:!0}).pipe(o.U((t=>{var e,i,o,n;for(const r of t)if("childList"===r.type&&C._isElementNode(r.target)){const t=r.target.querySelector('button[type="button"] > span > i[data-icon-name="Diamond"]');return null!==(n=null===(o=null===(i=null===(e=null==t?void 0:t.parentElement)||void 0===e?void 0:e.parentElement)||void 0===i?void 0:i.parentElement)||void 0===o?void 0:o.parentElement)&&void 0!==n?n:null}return null})),v.h((t=>Boolean(t))),v.h((t=>"none"!==t.style.display)),E.x(((t,e)=>t.style.display===e.style.display))):S.C}hideSuggestions(){this._elementsSubs=new x.w0,this._elementsSubs.add(this._waitForSquigglers().subscribe((t=>{t&&(this._logger.trace("Hiding Outlook's native suggestions underlines.",t),this._squigglers=this._squigglers.concat(t),this._originalSquigglerDisplayStyle||(this._originalSquigglerDisplayStyle=t[0].style.display),this._squigglers.forEach((t=>{t.style.display="none"})))}))),this._elementsSubs.add(this._waitForEditorCard().subscribe((t=>{t&&(this._logger.trace("Hiding Outlook's native suggestions cards."),this._editorCard=t,this._originalEditorCardDisplayStyle=this._editorCard.style.display,this._editorCard.style.display="none")}))),this._elementsSubs.add(this._waitForPremiumBadge().subscribe((t=>{t&&(this._logger.trace("Hiding Outlook's native suggestions premium badge."),this._premiumBadge=t,this._originalPremiumBadgeDisplayStyle=this._premiumBadge.style.display,this._premiumBadge.style.display="none")})))}showSuggestions(){var t;this._squigglers.length>0&&(this._logger.trace("Restoring Outlook's native suggestions underlines."),this._squigglers.forEach((t=>{t.style.display=this._originalSquigglerDisplayStyle}))),this._editorCard&&(this._logger.trace("Restoring Outlook's native suggestions cards."),this._editorCard.style.display=this._originalEditorCardDisplayStyle),this._premiumBadge&&(this._logger.trace("Restoring Outlook's native suggestions premium badge."),this._premiumBadge.style.display=this._originalPremiumBadgeDisplayStyle),null===(t=this._elementsSubs)||void 0===t||t.unsubscribe(),this._elementsSubs=null}}var q,w=i(2816),F=i(45246);!function(t){const e=t=>"BLOCKQUOTE"===t.tagName&&(0,F.Re)(t)&&""!==t.style.borderLeft;t.createEditorTextMap=t=>w.Z.create(t,{andNodeFormatting:(t,i)=>"BLOCKQUOTE"===t.tagName?e(t)?{...i,blockquote:!0}:{...i}:"Signature"===t.id?{...i,signature:!0}:w.Z.defaultNodeFormatting(t,i),overrideFilterNode:(t,i)=>w.Z.defaultFilterNodeAllowingBlockquote(t,i)&&!e(t)})}(q||(q={}));var L,O=i(89877);!function(t){t.getAuthorDomain=function(){const t=document.querySelector('[href*="https://outlook.com?login_hint"]');if(t){const e=O.X.getDomainFromEmail(decodeURIComponent(t.href));if(e)return e}const e=document.querySelector("[id*=primaryMailboxRoot_]");if(e){const t=O.X.getDomainFromEmail(e.id);if(t)return t}return null}}(L||(L={}));var D=i(14027),I=i(3601),N=i(93995);const T=(t,e)=>r.G({kind:"outlook",integrationName:t,domain:e.pageContext.domain,isInsideIFrame:!1});var M;!function(t){t.page=(0,N.$W)({name:"outlook",domain:D.ph},[p.T.contentEditable("Outlook",(t=>({createLayout:t=>{var e;const i=(0,I.Cq)((0,g.wr)(t,(t=>t.classList.contains("customScrollBar")))),o=i.querySelector("[data-testid=ComposeSendButton]")||i.querySelector("div[aria-label='Send'][role='button']")||(null===(e=i.querySelector('button[type="button"].ms-Button.ms-Button--primary.ms-Button--hasMenu'))||void 0===e?void 0:e.closest('div[role="button"]')),n=(0,g.bp)((0,I.Cq)(o)),r=A(n),s=R(r,n);return new d.A7(t,{scroller:(0,c.z)(i)||t,...s,transformElement:{getValue:(t,e)=>(0,g.f0)(i,e),getIndicator:()=>i}})},customizations:{richText:l.kn.isAvailable(t),applyFormatting:!0},textMap:{createFieldTextMap:q.createEditorTextMap},onCreate:()=>C.getInstance(t).hideSuggestions(),onDispose:()=>C.getInstance(t).showSuggestions(),getFromEmailDomainAndSignature:t=>function(t){const e=L.getAuthorDomain(),i=O.X.getSignature(t);return{fromEmailDomain:e,emailSignature:i}}(t),getVBarsIntegrationInfo:e=>T(e,t)}))),p.T.textarea("Outlook",(t=>({createLayout:()=>new d.A7(t.field,{gbuttonMinPadding:m.rR}),textMap:{createFieldTextMap:q.createEditorTextMap}})))])}(M||(M={}));const A=t=>{const e=getComputedStyle(t);return"sticky"===e.position&&"0px"===e.top?"topSticky":"sticky"===e.position&&"0px"===e.bottom?"bottomSticky":"unknown"},U=()=>({highlightsLayoutOptions:{fixUIGlitchesByForcingStackingContext:!0}}),P=t=>({customGbuttonPositioning:{injectionElement:t,injectionStyle:{top:"0",right:"0"},createPositionStyleBehavior:t=>t.pipe(o.U((t=>({position:"absolute",transform:"translate(0, -100%)",width:"auto",height:"auto",pointerEvents:"all",right:-t.left+"px",top:`${t.top}px`})))),calculateMetrics:(t,e,i)=>{const o=u.p8.create({top:i.top,left:t.size.width+i.left});return{offset:o,page:u.Cv.fromOffset(o,u.Cv.fromClient(t.client,{top:e.scrollY,left:e.scrollX}),{top:0,left:0}),client:u.Ir.create(u.E9.plus(t.client,o)),effectivePadding:{top:0,right:14,bottom:14,left:0},size:a.V.gButtonMaxSize}},createShiftBehavior:()=>s.S.sec1.pipe(o.U((()=>document.querySelector('button[aria-label*="Microsoft Editor"]')?{top:-11,left:-50}:{top:-14,left:-14})),n.O({top:-14,left:-14}))}}),R=(t,e)=>"unknown"===t?{}:"topSticky"===t?U():P(e)},89877:(t,e,i)=>{i.d(e,{X:()=>o});var o,n=i(33632);!function(t){t.getSignature=function(t){const e=[];t.getRichText().eachLine(((t,i)=>(!0===i.signature&&e.push(t),!0)));const i=e.map((t=>t.ops.reduce(((t,e)=>n.s.isInsertString(e)&&e.insert?t+e.insert:t),"")));return i.length?i.join(";"):null},t.getDomainFromEmail=function(t){const e=t.indexOf("@");return e>=0?t.substring(e+1):null}}(o||(o={}))}}]);