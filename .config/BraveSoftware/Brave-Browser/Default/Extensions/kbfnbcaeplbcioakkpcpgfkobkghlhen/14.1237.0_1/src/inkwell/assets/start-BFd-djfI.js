var CS=Object.defineProperty;var Xl=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),vs=t=>{throw TypeError(t)};var AS=(t,e,r)=>e in t?CS(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var S=(t,e,r)=>AS(t,typeof e!="symbol"?e+"":e,r),ya=(t,e,r)=>e.has(t)||vs("Cannot "+r);var a=(t,e,r)=>(ya(t,e,"read from private field"),r?r.call(t):e.get(t)),g=(t,e,r)=>e.has(t)?vs("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),v=(t,e,r,n)=>(ya(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),m=(t,e,r)=>(ya(t,e,"access private method"),r);var Sa=(t,e,r,n)=>({set _(i){v(t,e,i,r)},get _(){return a(t,e,n)}});var ue=(t,e,r)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&vs("Object expected");var n;r&&(n=e[Xl("asyncDispose")]),n===void 0&&(n=e[Xl("dispose")]),typeof n!="function"&&vs("Object not disposable"),t.push([r,n,e])}else r&&t.push([r]);return e},le=(t,e,r)=>{var n=typeof SuppressedError=="function"?SuppressedError:function(o,c,u,l){return l=Error(u),l.name="SuppressedError",l.error=o,l.suppressed=c,l},i=o=>e=r?new n(o,e,"An error was suppressed during disposal"):(r=!0,o),s=o=>{for(;o=t.pop();)try{var c=o[1]&&o[1].call(o[2]);if(o[0])return Promise.resolve(c).then(s,u=>(i(u),s()))}catch(u){i(u)}if(r)throw e};return s()};var ms=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dj(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Yn=function(t){return t&&t.Math===Math&&t},z=Yn(typeof globalThis=="object"&&globalThis)||Yn(typeof window=="object"&&window)||Yn(typeof self=="object"&&self)||Yn(typeof ms=="object"&&ms)||Yn(typeof ms=="object"&&ms)||function(){return this}()||Function("return this")(),Zi={},Y=function(t){try{return!!t()}catch{return!0}},NS=Y,me=!NS(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),jS=Y,zo=!jS(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),MS=zo,ys=Function.prototype.call,ye=MS?ys.bind(ys):function(){return ys.apply(ys,arguments)},dh={},ph={}.propertyIsEnumerable,hh=Object.getOwnPropertyDescriptor,FS=hh&&!ph.call({1:2},1);dh.f=FS?function(e){var r=hh(this,e);return!!r&&r.enumerable}:ph;var Qi=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},gh=zo,vh=Function.prototype,kc=vh.call,LS=gh&&vh.bind.bind(kc,kc),K=gh?LS:function(t){return function(){return kc.apply(t,arguments)}},mh=K,US=mh({}.toString),BS=mh("".slice),Hn=function(t){return BS(US(t),8,-1)},zS=K,GS=Y,WS=Hn,ba=Object,HS=zS("".split),KS=GS(function(){return!ba("z").propertyIsEnumerable(0)})?function(t){return WS(t)==="String"?HS(t,""):ba(t)}:ba,Mr=function(t){return t==null},JS=Mr,VS=TypeError,Mu=function(t){if(JS(t))throw new VS("Can't call method on "+t);return t},YS=KS,qS=Mu,es=function(t){return YS(qS(t))},_a=typeof document=="object"&&document.all,G=typeof _a>"u"&&_a!==void 0?function(t){return typeof t=="function"||t===_a}:function(t){return typeof t=="function"},XS=G,Se=function(t){return typeof t=="object"?t!==null:XS(t)},Ea=z,ZS=G,QS=function(t){return ZS(t)?t:void 0},Ke=function(t,e){return arguments.length<2?QS(Ea[t]):Ea[t]&&Ea[t][e]},eb=K,ts=eb({}.isPrototypeOf),tb=z,Zl=tb.navigator,Ql=Zl&&Zl.userAgent,rs=Ql?String(Ql):"",yh=z,wa=rs,ef=yh.process,tf=yh.Deno,rf=ef&&ef.versions||tf&&tf.version,nf=rf&&rf.v8,et,co;nf&&(et=nf.split("."),co=et[0]>0&&et[0]<4?1:+(et[0]+et[1]));!co&&wa&&(et=wa.match(/Edge\/(\d+)/),(!et||et[1]>=74)&&(et=wa.match(/Chrome\/(\d+)/),et&&(co=+et[1])));var Sh=co,sf=Sh,rb=Y,nb=z,ib=nb.String,bh=!!Object.getOwnPropertySymbols&&!rb(function(){var t=Symbol("symbol detection");return!ib(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&sf&&sf<41}),sb=bh,_h=sb&&!Symbol.sham&&typeof Symbol.iterator=="symbol",ob=Ke,ab=G,cb=ts,ub=_h,lb=Object,Eh=ub?function(t){return typeof t=="symbol"}:function(t){var e=ob("Symbol");return ab(e)&&cb(e.prototype,lb(t))},fb=String,Go=function(t){try{return fb(t)}catch{return"Object"}},db=G,pb=Go,hb=TypeError,Je=function(t){if(db(t))return t;throw new hb(pb(t)+" is not a function")},gb=Je,vb=Mr,Kn=function(t,e){var r=t[e];return vb(r)?void 0:gb(r)},$a=ye,ka=G,Ta=Se,mb=TypeError,yb=function(t,e){var r,n;if(e==="string"&&ka(r=t.toString)&&!Ta(n=$a(r,t))||ka(r=t.valueOf)&&!Ta(n=$a(r,t))||e!=="string"&&ka(r=t.toString)&&!Ta(n=$a(r,t)))return n;throw new mb("Can't convert object to primitive value")},wh={exports:{}},Sb=!1,of=z,bb=Object.defineProperty,Fu=function(t,e){try{bb(of,t,{value:e,configurable:!0,writable:!0})}catch{of[t]=e}return e},_b=z,Eb=Fu,af="__core-js_shared__",cf=wh.exports=_b[af]||Eb(af,{});(cf.versions||(cf.versions=[])).push({version:"3.38.0",mode:"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.38.0/LICENSE",source:"https://github.com/zloirock/core-js"});var Wo=wh.exports,uf=Wo,$h=function(t,e){return uf[t]||(uf[t]=e||{})},wb=Mu,$b=Object,kh=function(t){return $b(wb(t))},kb=K,Tb=kh,Ib=kb({}.hasOwnProperty),be=Object.hasOwn||function(e,r){return Ib(Tb(e),r)},Ob=K,xb=0,Pb=Math.random(),Rb=Ob(1 .toString),Lu=function(t){return"Symbol("+(t===void 0?"":t)+")_"+Rb(++xb+Pb,36)},Db=z,Cb=$h,lf=be,Ab=Lu,Nb=bh,jb=_h,qr=Db.Symbol,Ia=Cb("wks"),Mb=jb?qr.for||qr:qr&&qr.withoutSetter||Ab,J=function(t){return lf(Ia,t)||(Ia[t]=Nb&&lf(qr,t)?qr[t]:Mb("Symbol."+t)),Ia[t]},Fb=ye,ff=Se,df=Eh,Lb=Kn,Ub=yb,Bb=J,zb=TypeError,Gb=Bb("toPrimitive"),Wb=function(t,e){if(!ff(t)||df(t))return t;var r=Lb(t,Gb),n;if(r){if(e===void 0&&(e="default"),n=Fb(r,t,e),!ff(n)||df(n))return n;throw new zb("Can't convert object to primitive value")}return e===void 0&&(e="number"),Ub(t,e)},Hb=Wb,Kb=Eh,Th=function(t){var e=Hb(t,"string");return Kb(e)?e:e+""},Jb=z,pf=Se,Tc=Jb.document,Vb=pf(Tc)&&pf(Tc.createElement),Uu=function(t){return Vb?Tc.createElement(t):{}},Yb=me,qb=Y,Xb=Uu,Ih=!Yb&&!qb(function(){return Object.defineProperty(Xb("div"),"a",{get:function(){return 7}}).a!==7}),Zb=me,Qb=ye,e_=dh,t_=Qi,r_=es,n_=Th,i_=be,s_=Ih,hf=Object.getOwnPropertyDescriptor;Zi.f=Zb?hf:function(e,r){if(e=r_(e),r=n_(r),s_)try{return hf(e,r)}catch{}if(i_(e,r))return t_(!Qb(e_.f,e,r),e[r])};var Ve={},o_=me,a_=Y,Oh=o_&&a_(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),c_=Se,u_=String,l_=TypeError,Ye=function(t){if(c_(t))return t;throw new l_(u_(t)+" is not an object")},f_=me,d_=Ih,p_=Oh,Ss=Ye,gf=Th,h_=TypeError,Oa=Object.defineProperty,g_=Object.getOwnPropertyDescriptor,xa="enumerable",Pa="configurable",Ra="writable";Ve.f=f_?p_?function(e,r,n){if(Ss(e),r=gf(r),Ss(n),typeof e=="function"&&r==="prototype"&&"value"in n&&Ra in n&&!n[Ra]){var i=g_(e,r);i&&i[Ra]&&(e[r]=n.value,n={configurable:Pa in n?n[Pa]:i[Pa],enumerable:xa in n?n[xa]:i[xa],writable:!1})}return Oa(e,r,n)}:Oa:function(e,r,n){if(Ss(e),r=gf(r),Ss(n),d_)try{return Oa(e,r,n)}catch{}if("get"in n||"set"in n)throw new h_("Accessors not supported");return"value"in n&&(e[r]=n.value),e};var v_=me,m_=Ve,y_=Qi,Fr=v_?function(t,e,r){return m_.f(t,e,y_(1,r))}:function(t,e,r){return t[e]=r,t},xh={exports:{}},Ic=me,S_=be,Ph=Function.prototype,b_=Ic&&Object.getOwnPropertyDescriptor,Bu=S_(Ph,"name"),__=Bu&&(function(){}).name==="something",E_=Bu&&(!Ic||Ic&&b_(Ph,"name").configurable),Rh={EXISTS:Bu,PROPER:__,CONFIGURABLE:E_},w_=K,$_=G,Oc=Wo,k_=w_(Function.toString);$_(Oc.inspectSource)||(Oc.inspectSource=function(t){return k_(t)});var zu=Oc.inspectSource,T_=z,I_=G,vf=T_.WeakMap,O_=I_(vf)&&/native code/.test(String(vf)),x_=$h,P_=Lu,mf=x_("keys"),Gu=function(t){return mf[t]||(mf[t]=P_(t))},Ho={},R_=O_,Dh=z,D_=Se,C_=Fr,Da=be,Ca=Wo,A_=Gu,N_=Ho,yf="Object already initialized",xc=Dh.TypeError,j_=Dh.WeakMap,uo,gi,lo,M_=function(t){return lo(t)?gi(t):uo(t,{})},F_=function(t){return function(e){var r;if(!D_(e)||(r=gi(e)).type!==t)throw new xc("Incompatible receiver, "+t+" required");return r}};if(R_||Ca.state){var nt=Ca.state||(Ca.state=new j_);nt.get=nt.get,nt.has=nt.has,nt.set=nt.set,uo=function(t,e){if(nt.has(t))throw new xc(yf);return e.facade=t,nt.set(t,e),e},gi=function(t){return nt.get(t)||{}},lo=function(t){return nt.has(t)}}else{var Hr=A_("state");N_[Hr]=!0,uo=function(t,e){if(Da(t,Hr))throw new xc(yf);return e.facade=t,C_(t,Hr,e),e},gi=function(t){return Da(t,Hr)?t[Hr]:{}},lo=function(t){return Da(t,Hr)}}var ns={set:uo,get:gi,has:lo,enforce:M_,getterFor:F_},Wu=K,L_=Y,U_=G,bs=be,Pc=me,B_=Rh.CONFIGURABLE,z_=zu,Ch=ns,G_=Ch.enforce,W_=Ch.get,Sf=String,qs=Object.defineProperty,H_=Wu("".slice),K_=Wu("".replace),J_=Wu([].join),V_=Pc&&!L_(function(){return qs(function(){},"length",{value:8}).length!==8}),Y_=String(String).split("String"),q_=xh.exports=function(t,e,r){H_(Sf(e),0,7)==="Symbol("&&(e="["+K_(Sf(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!bs(t,"name")||B_&&t.name!==e)&&(Pc?qs(t,"name",{value:e,configurable:!0}):t.name=e),V_&&r&&bs(r,"arity")&&t.length!==r.arity&&qs(t,"length",{value:r.arity});try{r&&bs(r,"constructor")&&r.constructor?Pc&&qs(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=G_(t);return bs(n,"source")||(n.source=J_(Y_,typeof e=="string"?e:"")),t};Function.prototype.toString=q_(function(){return U_(this)&&W_(this).source||z_(this)},"toString");var Ah=xh.exports,X_=G,Z_=Ve,Q_=Ah,eE=Fu,Oe=function(t,e,r,n){n||(n={});var i=n.enumerable,s=n.name!==void 0?n.name:e;if(X_(r)&&Q_(r,s,n),n.global)i?t[e]=r:eE(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=r:Z_.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},Ko={},tE=Math.ceil,rE=Math.floor,nE=Math.trunc||function(e){var r=+e;return(r>0?rE:tE)(r)},iE=nE,Hu=function(t){var e=+t;return e!==e||e===0?0:iE(e)},sE=Hu,oE=Math.max,aE=Math.min,cE=function(t,e){var r=sE(t);return r<0?oE(r+e,0):aE(r,e)},uE=Hu,lE=Math.min,fE=function(t){var e=uE(t);return e>0?lE(e,9007199254740991):0},dE=fE,Nh=function(t){return dE(t.length)},pE=es,hE=cE,gE=Nh,bf=function(t){return function(e,r,n){var i=pE(e),s=gE(i);if(s===0)return!t&&-1;var o=hE(n,s),c;if(t&&r!==r){for(;s>o;)if(c=i[o++],c!==c)return!0}else for(;s>o;o++)if((t||o in i)&&i[o]===r)return t||o||0;return!t&&-1}},vE={includes:bf(!0),indexOf:bf(!1)},mE=K,Aa=be,yE=es,SE=vE.indexOf,bE=Ho,_f=mE([].push),jh=function(t,e){var r=yE(t),n=0,i=[],s;for(s in r)!Aa(bE,s)&&Aa(r,s)&&_f(i,s);for(;e.length>n;)Aa(r,s=e[n++])&&(~SE(i,s)||_f(i,s));return i},Ku=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],_E=jh,EE=Ku,wE=EE.concat("length","prototype");Ko.f=Object.getOwnPropertyNames||function(e){return _E(e,wE)};var Mh={};Mh.f=Object.getOwnPropertySymbols;var $E=Ke,kE=K,TE=Ko,IE=Mh,OE=Ye,xE=kE([].concat),PE=$E("Reflect","ownKeys")||function(e){var r=TE.f(OE(e)),n=IE.f;return n?xE(r,n(e)):r},Ef=be,RE=PE,DE=Zi,CE=Ve,Ju=function(t,e,r){for(var n=RE(e),i=CE.f,s=DE.f,o=0;o<n.length;o++){var c=n[o];!Ef(t,c)&&!(r&&Ef(r,c))&&i(t,c,s(e,c))}},AE=Y,NE=G,jE=/#|\.prototype\./,is=function(t,e){var r=FE[ME(t)];return r===UE?!0:r===LE?!1:NE(e)?AE(e):!!e},ME=is.normalize=function(t){return String(t).replace(jE,".").toLowerCase()},FE=is.data={},LE=is.NATIVE="N",UE=is.POLYFILL="P",Vu=is,_s=z,BE=Zi.f,zE=Fr,GE=Oe,WE=Fu,HE=Ju,KE=Vu,_e=function(t,e){var r=t.target,n=t.global,i=t.stat,s,o,c,u,l,f;if(n?o=_s:i?o=_s[r]||WE(r,{}):o=_s[r]&&_s[r].prototype,o)for(c in e){if(l=e[c],t.dontCallGetSet?(f=BE(o,c),u=f&&f.value):u=o[c],s=KE(n?c:r+(i?".":"#")+c,t.forced),!s&&u!==void 0){if(typeof l==typeof u)continue;HE(l,u)}(t.sham||u&&u.sham)&&zE(l,"sham",!0),GE(o,c,l,t)}},JE=zo,Fh=Function.prototype,wf=Fh.apply,$f=Fh.call,Lh=typeof Reflect=="object"&&Reflect.apply||(JE?$f.bind(wf):function(){return $f.apply(wf,arguments)}),VE=K,YE=Je,Uh=function(t,e,r){try{return VE(YE(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},qE=Se,XE=function(t){return qE(t)||t===null},ZE=XE,QE=String,ew=TypeError,tw=function(t){if(ZE(t))return t;throw new ew("Can't set "+QE(t)+" as a prototype")},rw=Uh,nw=Se,iw=Mu,sw=tw,ss=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=rw(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(i,s){return iw(i),sw(s),nw(i)&&(t?r(i,s):i.__proto__=s),i}}():void 0),ow=Ve.f,aw=function(t,e,r){r in t||ow(t,r,{configurable:!0,get:function(){return e[r]},set:function(n){e[r]=n}})},cw=G,uw=Se,kf=ss,Bh=function(t,e,r){var n,i;return kf&&cw(n=e.constructor)&&n!==r&&uw(i=n.prototype)&&i!==r.prototype&&kf(t,i),t},lw=J,fw=lw("toStringTag"),zh={};zh[fw]="z";var Yu=String(zh)==="[object z]",dw=Yu,pw=G,Xs=Hn,hw=J,gw=hw("toStringTag"),vw=Object,mw=Xs(function(){return arguments}())==="Arguments",yw=function(t,e){try{return t[e]}catch{}},Jo=dw?Xs:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=yw(e=vw(t),gw))=="string"?r:mw?Xs(e):(n=Xs(e))==="Object"&&pw(e.callee)?"Arguments":n},Sw=Jo,bw=String,_w=function(t){if(Sw(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return bw(t)},Ew=_w,qu=function(t,e){return t===void 0?arguments.length<2?"":e:Ew(t)},ww=Se,$w=Fr,kw=function(t,e){ww(e)&&"cause"in e&&$w(t,"cause",e.cause)},Tw=K,Gh=Error,Iw=Tw("".replace),Ow=function(t){return String(new Gh(t).stack)}("zxcasd"),Wh=/\n\s*at [^:]*:[^\n]*/,xw=Wh.test(Ow),Pw=function(t,e){if(xw&&typeof t=="string"&&!Gh.prepareStackTrace)for(;e--;)t=Iw(t,Wh,"");return t},Rw=Y,Dw=Qi,Cw=!Rw(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",Dw(1,7)),t.stack!==7):!0}),Aw=Fr,Nw=Pw,jw=Cw,Tf=Error.captureStackTrace,Hh=function(t,e,r,n){jw&&(Tf?Tf(t,e):Aw(t,"stack",Nw(r,n)))},If=Ke,Mw=be,Of=Fr,Fw=ts,xf=ss,Pf=Ju,Rf=aw,Lw=Bh,Uw=qu,Bw=kw,zw=Hh,Gw=me,Ww=function(t,e,r,n){var i="stackTraceLimit",s=n?2:1,o=t.split("."),c=o[o.length-1],u=If.apply(null,o);if(u){var l=u.prototype;if(Mw(l,"cause")&&delete l.cause,!r)return u;var f=If("Error"),d=e(function(p,h){var y=Uw(n?h:p,void 0),_=n?new u(p):new u;return y!==void 0&&Of(_,"message",y),zw(_,d,_.stack,2),this&&Fw(l,this)&&Lw(_,this,d),arguments.length>s&&Bw(_,arguments[s]),_});d.prototype=l,c!=="Error"?xf?xf(d,f):Pf(d,f,{name:!0}):Gw&&i in u&&(Rf(d,u,i),Rf(d,u,"prepareStackTrace")),Pf(d,u);try{l.name!==c&&Of(l,"name",c),l.constructor=d}catch{}return d}},Kh=_e,Hw=z,ht=Lh,Jh=Ww,Rc="WebAssembly",Df=Hw[Rc],fo=new Error("e",{cause:7}).cause!==7,Lr=function(t,e){var r={};r[t]=Jh(t,e,fo),Kh({global:!0,constructor:!0,arity:1,forced:fo},r)},Xu=function(t,e){if(Df&&Df[t]){var r={};r[t]=Jh(Rc+"."+t,e,fo),Kh({target:Rc,stat:!0,constructor:!0,arity:1,forced:fo},r)}};Lr("Error",function(t){return function(r){return ht(t,this,arguments)}});Lr("EvalError",function(t){return function(r){return ht(t,this,arguments)}});Lr("RangeError",function(t){return function(r){return ht(t,this,arguments)}});Lr("ReferenceError",function(t){return function(r){return ht(t,this,arguments)}});Lr("SyntaxError",function(t){return function(r){return ht(t,this,arguments)}});Lr("TypeError",function(t){return function(r){return ht(t,this,arguments)}});Lr("URIError",function(t){return function(r){return ht(t,this,arguments)}});Xu("CompileError",function(t){return function(r){return ht(t,this,arguments)}});Xu("LinkError",function(t){return function(r){return ht(t,this,arguments)}});Xu("RuntimeError",function(t){return function(r){return ht(t,this,arguments)}});var Kw=me,Jw=Y,Vw=Ye,Cf=qu,Zs=Error.prototype.toString,Yw=Jw(function(){if(Kw){var t=Object.create(Object.defineProperty({},"name",{get:function(){return this===t}}));if(Zs.call(t)!=="true")return!0}return Zs.call({message:1,name:2})!=="2: 1"||Zs.call({})!=="Error"}),qw=Yw?function(){var e=Vw(this),r=Cf(e.name,"Error"),n=Cf(e.message);return r?n?r+": "+n:r:n}:Zs,Xw=Oe,Af=qw,Nf=Error.prototype;Nf.toString!==Af&&Xw(Nf,"toString",Af);var Zw=Yu,Qw=Jo,e$=Zw?{}.toString:function(){return"[object "+Qw(this)+"]"},t$=Yu,r$=Oe,n$=e$;t$||r$(Object.prototype,"toString",n$,{unsafe:!0});var i$=Y,s$=!i$(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),o$=be,a$=G,c$=kh,u$=Gu,l$=s$,jf=u$("IE_PROTO"),Dc=Object,f$=Dc.prototype,Vo=l$?Dc.getPrototypeOf:function(t){var e=c$(t);if(o$(e,jf))return e[jf];var r=e.constructor;return a$(r)&&e instanceof r?r.prototype:e instanceof Dc?f$:null},Vh={},d$=jh,p$=Ku,h$=Object.keys||function(e){return d$(e,p$)},g$=me,v$=Oh,m$=Ve,y$=Ye,S$=es,b$=h$;Vh.f=g$&&!v$?Object.defineProperties:function(e,r){y$(e);for(var n=S$(r),i=b$(r),s=i.length,o=0,c;s>o;)m$.f(e,c=i[o++],n[c]);return e};var _$=Ke,Yh=_$("document","documentElement"),E$=Ye,w$=Vh,Mf=Ku,$$=Ho,k$=Yh,T$=Uu,I$=Gu,Ff=">",Lf="<",Cc="prototype",Ac="script",qh=I$("IE_PROTO"),Na=function(){},Xh=function(t){return Lf+Ac+Ff+t+Lf+"/"+Ac+Ff},Uf=function(t){t.write(Xh("")),t.close();var e=t.parentWindow.Object;return t=null,e},O$=function(){var t=T$("iframe"),e="java"+Ac+":",r;return t.style.display="none",k$.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(Xh("document.F=Object")),r.close(),r.F},Es,Qs=function(){try{Es=new ActiveXObject("htmlfile")}catch{}Qs=typeof document<"u"?document.domain&&Es?Uf(Es):O$():Uf(Es);for(var t=Mf.length;t--;)delete Qs[Cc][Mf[t]];return Qs()};$$[qh]=!0;var Zu=Object.create||function(e,r){var n;return e!==null?(Na[Cc]=E$(e),n=new Na,Na[Cc]=null,n[qh]=e):n=Qs(),r===void 0?n:w$.f(n,r)},x$=_e,P$=z,R$=ts,Bf=Vo,po=ss,D$=Ju,Zh=Zu,ws=Fr,ja=Qi,C$=Hh,A$=qu,N$=J,j$=Y,M$=Sb,Rn=P$.SuppressedError,F$=N$("toStringTag"),ho=Error,L$=!!Rn&&Rn.length!==3,U$=!!Rn&&j$(function(){return new Rn(1,2,3,{cause:4}).cause===4}),Yo=L$||U$,Or=function(e,r,n){var i=R$(ni,this),s;return po?s=Yo&&(!i||Bf(this)===ni)?new Rn:po(new ho,i?Bf(this):ni):(s=i?this:Zh(ni),ws(s,F$,"Error")),n!==void 0&&ws(s,"message",A$(n)),C$(s,Or,s.stack,1),ws(s,"error",e),ws(s,"suppressed",r),s};po?po(Or,ho):D$(Or,ho,{name:!0});var ni=Or.prototype=Yo?Rn.prototype:Zh(ho.prototype,{constructor:ja(1,Or),message:ja(1,""),name:ja(1,"SuppressedError")});Yo&&!M$&&(ni.constructor=Or);x$({global:!0,constructor:!0,arity:3,forced:Yo},{SuppressedError:Or});var B$=ts,z$=TypeError,os=function(t,e){if(B$(e,t))return t;throw new z$("Incorrect invocation")},G$=Oe,Qu=function(t,e,r){for(var n in e)G$(t,n,e[n],r);return t},zf=Ah,W$=Ve,qo=function(t,e,r){return r.get&&zf(r.get,e,{getter:!0}),r.set&&zf(r.set,e,{setter:!0}),W$.f(t,e,r)},H$=Hn,K$=K,J$=function(t){if(H$(t)==="Function")return K$(t)},Gf=J$,V$=Je,Y$=zo,q$=Gf(Gf.bind),as=function(t,e){return V$(t),e===void 0?t:Y$?q$(t,e):function(){return t.apply(e,arguments)}},X$=ye,Z$=K,Q$=as,ek=Ye,tk=Je,Qh=Mr,Ma=Kn,eg=J,rk=eg("asyncDispose"),Wf=eg("dispose"),nk=Z$([].push),ik=function(t,e){if(e==="async-dispose"){var r=Ma(t,rk);return r!==void 0||(r=Ma(t,Wf),r===void 0)?r:function(){X$(r,this)}}return Ma(t,Wf)},Hf=function(t,e,r){return arguments.length<3&&!Qh(t)&&(r=tk(ik(ek(t),e))),r===void 0?function(){}:Q$(r,t)},tg=function(t,e,r,n){var i;if(arguments.length<4){if(Qh(e)&&r==="sync-dispose")return;i=Hf(e,r)}else i=Hf(void 0,r,n);nk(t.stack,i)},sk=_e,go=me,ok=Ke,Kf=Je,ak=os,rg=Oe,ck=Qu,uk=qo,ng=J,ig=ns,Fa=tg,lk=ok("SuppressedError"),fk=ReferenceError,dk=ng("dispose"),pk=ng("toStringTag"),Xo="DisposableStack",hk=ig.set,vo=ig.getterFor(Xo),La="sync-dispose",ui="disposed",gk="pending",$s=function(t){var e=vo(t);if(e.state===ui)throw new fk(Xo+" already disposed");return e},el=function(){hk(ak(this,Dn),{type:Xo,state:gk,stack:[]}),go||(this.disposed=!1)},Dn=el.prototype;ck(Dn,{dispose:function(){var e=vo(this);if(e.state!==ui){e.state=ui,go||(this.disposed=!0);for(var r=e.stack,n=r.length,i=!1,s;n;){var o=r[--n];r[n]=void 0;try{o()}catch(c){i?s=new lk(c,s):(i=!0,s=c)}}if(e.stack=void 0,i)throw s}},use:function(e){return Fa($s(this),e,La),e},adopt:function(e,r){var n=$s(this);return Kf(r),Fa(n,void 0,La,function(){r(e)}),e},defer:function(e){var r=$s(this);Kf(e),Fa(r,void 0,La,e)},move:function(){var e=$s(this),r=new el;return vo(r).stack=e.stack,e.stack=[],e.state=ui,go||(this.disposed=!0),r}});go&&uk(Dn,"disposed",{configurable:!0,get:function(){return vo(this).state===ui}});rg(Dn,dk,Dn.dispose,{name:"dispose"});rg(Dn,pk,Xo,{nonWritable:!0});sk({global:!0,constructor:!0},{DisposableStack:el});var vk=Y,mk=G,yk=Se,Jf=Vo,Sk=Oe,bk=J,Nc=bk("iterator"),sg=!1,xr,Ua,Ba;[].keys&&(Ba=[].keys(),"next"in Ba?(Ua=Jf(Jf(Ba)),Ua!==Object.prototype&&(xr=Ua)):sg=!0);var _k=!yk(xr)||vk(function(){var t={};return xr[Nc].call(t)!==t});_k&&(xr={});mk(xr[Nc])||Sk(xr,Nc,function(){return this});var tl={IteratorPrototype:xr,BUGGY_SAFARI_ITERATORS:sg},Ek=ye,wk=Oe,$k=Kn,kk=be,Tk=J,Vf=tl.IteratorPrototype,Yf=Tk("dispose");kk(Vf,Yf)||wk(Vf,Yf,function(){var t=$k(this,"return");t&&Ek(t,this)});var Ik=z,Zo=Ik,Ok=Zo;Ok.DisposableStack;var qn=z,xk=rs,Pk=Hn,ks=function(t){return xk.slice(0,t.length)===t},og=function(){return ks("Bun/")?"BUN":ks("Cloudflare-Workers")?"CLOUDFLARE":ks("Deno/")?"DENO":ks("Node.js/")?"NODE":qn.Bun&&typeof Bun.version=="string"?"BUN":qn.Deno&&typeof Deno.version=="object"?"DENO":Pk(qn.process)==="process"?"NODE":qn.window&&qn.document?"BROWSER":"REST"}(),Rk=og,rl=Rk==="NODE",Dk=Ve.f,Ck=be,Ak=J,qf=Ak("toStringTag"),Qo=function(t,e,r){t&&!r&&(t=t.prototype),t&&!Ck(t,qf)&&Dk(t,qf,{configurable:!0,value:e})},Nk=Ke,jk=qo,Mk=J,Fk=me,Xf=Mk("species"),ag=function(t){var e=Nk(t);Fk&&e&&!e[Xf]&&jk(e,Xf,{configurable:!0,get:function(){return this}})},Lk=K,Uk=Y,cg=G,Bk=Jo,zk=Ke,Gk=zu,ug=function(){},lg=zk("Reflect","construct"),nl=/^\s*(?:class|function)\b/,Wk=Lk(nl.exec),Hk=!nl.test(ug),Xn=function(e){if(!cg(e))return!1;try{return lg(ug,[],e),!0}catch{return!1}},fg=function(e){if(!cg(e))return!1;switch(Bk(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Hk||!!Wk(nl,Gk(e))}catch{return!0}};fg.sham=!0;var Kk=!lg||Uk(function(){var t;return Xn(Xn.call)||!Xn(Object)||!Xn(function(){t=!0})||t})?fg:Xn,Jk=Kk,Vk=Go,Yk=TypeError,qk=function(t){if(Jk(t))return t;throw new Yk(Vk(t)+" is not a constructor")},Zf=Ye,Xk=qk,Zk=Mr,Qk=J,eT=Qk("species"),tT=function(t,e){var r=Zf(t).constructor,n;return r===void 0||Zk(n=Zf(r)[eT])?e:Xk(n)},rT=K,dg=rT([].slice),nT=TypeError,iT=function(t,e){if(t<e)throw new nT("Not enough arguments");return t},sT=rs,pg=/(?:ipad|iphone|ipod).*applewebkit/i.test(sT),Ce=z,oT=Lh,aT=as,Qf=G,cT=be,hg=Y,ed=Yh,uT=dg,td=Uu,lT=iT,fT=pg,dT=rl,jc=Ce.setImmediate,Mc=Ce.clearImmediate,pT=Ce.process,za=Ce.Dispatch,hT=Ce.Function,rd=Ce.MessageChannel,gT=Ce.String,Ga=0,li={},nd="onreadystatechange",vi,ar,Wa,Ha;hg(function(){vi=Ce.location});var il=function(t){if(cT(li,t)){var e=li[t];delete li[t],e()}},Ka=function(t){return function(){il(t)}},id=function(t){il(t.data)},sd=function(t){Ce.postMessage(gT(t),vi.protocol+"//"+vi.host)};(!jc||!Mc)&&(jc=function(e){lT(arguments.length,1);var r=Qf(e)?e:hT(e),n=uT(arguments,1);return li[++Ga]=function(){oT(r,void 0,n)},ar(Ga),Ga},Mc=function(e){delete li[e]},dT?ar=function(t){pT.nextTick(Ka(t))}:za&&za.now?ar=function(t){za.now(Ka(t))}:rd&&!fT?(Wa=new rd,Ha=Wa.port2,Wa.port1.onmessage=id,ar=aT(Ha.postMessage,Ha)):Ce.addEventListener&&Qf(Ce.postMessage)&&!Ce.importScripts&&vi&&vi.protocol!=="file:"&&!hg(sd)?(ar=sd,Ce.addEventListener("message",id,!1)):nd in td("script")?ar=function(t){ed.appendChild(td("script"))[nd]=function(){ed.removeChild(this),il(t)}}:ar=function(t){setTimeout(Ka(t),0)});var gg={set:jc,clear:Mc},od=z,vT=me,mT=Object.getOwnPropertyDescriptor,yT=function(t){if(!vT)return od[t];var e=mT(od,t);return e&&e.value},vg=function(){this.head=null,this.tail=null};vg.prototype={add:function(t){var e={item:t,next:null},r=this.tail;r?r.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t){var e=this.head=t.next;return e===null&&(this.tail=null),t.item}}};var mg=vg,ST=rs,bT=/ipad|iphone|ipod/i.test(ST)&&typeof Pebble<"u",_T=rs,ET=/web0s(?!.*chrome)/i.test(_T),Cn=z,wT=yT,ad=as,Ja=gg.set,$T=mg,kT=pg,TT=bT,IT=ET,Va=rl,cd=Cn.MutationObserver||Cn.WebKitMutationObserver,ud=Cn.document,ld=Cn.process,Ts=Cn.Promise,Fc=wT("queueMicrotask"),Kr,Ya,qa,Is,fd;if(!Fc){var Os=new $T,xs=function(){var t,e;for(Va&&(t=ld.domain)&&t.exit();e=Os.get();)try{e()}catch(r){throw Os.head&&Kr(),r}t&&t.enter()};!kT&&!Va&&!IT&&cd&&ud?(Ya=!0,qa=ud.createTextNode(""),new cd(xs).observe(qa,{characterData:!0}),Kr=function(){qa.data=Ya=!Ya}):!TT&&Ts&&Ts.resolve?(Is=Ts.resolve(void 0),Is.constructor=Ts,fd=ad(Is.then,Is),Kr=function(){fd(xs)}):Va?Kr=function(){ld.nextTick(xs)}:(Ja=ad(Ja,Cn),Kr=function(){Ja(xs)}),Fc=function(t){Os.head||Kr(),Os.add(t)}}var OT=Fc,xT=function(t,e){try{arguments.length===1?console.error(t):console.error(t,e)}catch{}},sl=function(t){try{return{error:!1,value:t()}}catch(e){return{error:!0,value:e}}},PT=z,ea=PT.Promise,RT=z,fi=ea,DT=G,CT=Vu,AT=zu,NT=J,dd=og,Xa=Sh;fi&&fi.prototype;var jT=NT("species"),Lc=!1,yg=DT(RT.PromiseRejectionEvent),MT=CT("Promise",function(){var t=AT(fi),e=t!==String(fi);if(!e&&Xa===66)return!0;if(!Xa||Xa<51||!/native code/.test(t)){var r=new fi(function(s){s(1)}),n=function(s){s(function(){},function(){})},i=r.constructor={};if(i[jT]=n,Lc=r.then(function(){})instanceof n,!Lc)return!0}return!e&&(dd==="BROWSER"||dd==="DENO")&&!yg}),cs={CONSTRUCTOR:MT,REJECTION_EVENT:yg,SUBCLASSING:Lc},Ur={},pd=Je,FT=TypeError,LT=function(t){var e,r;this.promise=new t(function(n,i){if(e!==void 0||r!==void 0)throw new FT("Bad Promise constructor");e=n,r=i}),this.resolve=pd(e),this.reject=pd(r)};Ur.f=function(t){return new LT(t)};var UT=_e,mo=rl,nr=z,An=ye,hd=Oe,gd=ss,BT=Qo,zT=ag,GT=Je,eo=G,WT=Se,HT=os,KT=tT,Sg=gg.set,ol=OT,JT=xT,VT=sl,YT=mg,bg=ns,yo=ea,al=cs,_g=Ur,ta="Promise",Eg=al.CONSTRUCTOR,qT=al.REJECTION_EVENT,XT=al.SUBCLASSING,Za=bg.getterFor(ta),ZT=bg.set,Vr=yo&&yo.prototype,ur=yo,Ps=Vr,wg=nr.TypeError,Uc=nr.document,cl=nr.process,Bc=_g.f,QT=Bc,eI=!!(Uc&&Uc.createEvent&&nr.dispatchEvent),$g="unhandledrejection",tI="rejectionhandled",vd=0,kg=1,rI=2,ul=1,Tg=2,Rs,md,nI,yd,Ig=function(t){var e;return WT(t)&&eo(e=t.then)?e:!1},Og=function(t,e){var r=e.value,n=e.state===kg,i=n?t.ok:t.fail,s=t.resolve,o=t.reject,c=t.domain,u,l,f;try{i?(n||(e.rejection===Tg&&sI(e),e.rejection=ul),i===!0?u=r:(c&&c.enter(),u=i(r),c&&(c.exit(),f=!0)),u===t.promise?o(new wg("Promise-chain cycle")):(l=Ig(u))?An(l,u,s,o):s(u)):o(r)}catch(d){c&&!f&&c.exit(),o(d)}},xg=function(t,e){t.notified||(t.notified=!0,ol(function(){for(var r=t.reactions,n;n=r.get();)Og(n,t);t.notified=!1,e&&!t.rejection&&iI(t)}))},Pg=function(t,e,r){var n,i;eI?(n=Uc.createEvent("Event"),n.promise=e,n.reason=r,n.initEvent(t,!1,!0),nr.dispatchEvent(n)):n={promise:e,reason:r},!qT&&(i=nr["on"+t])?i(n):t===$g&&JT("Unhandled promise rejection",r)},iI=function(t){An(Sg,nr,function(){var e=t.facade,r=t.value,n=Sd(t),i;if(n&&(i=VT(function(){mo?cl.emit("unhandledRejection",r,e):Pg($g,e,r)}),t.rejection=mo||Sd(t)?Tg:ul,i.error))throw i.value})},Sd=function(t){return t.rejection!==ul&&!t.parent},sI=function(t){An(Sg,nr,function(){var e=t.facade;mo?cl.emit("rejectionHandled",e):Pg(tI,e,t.value)})},Xr=function(t,e,r){return function(n){t(e,n,r)}},Qr=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=rI,xg(t,!0))},zc=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw new wg("Promise can't be resolved itself");var n=Ig(e);n?ol(function(){var i={done:!1};try{An(n,e,Xr(zc,i,t),Xr(Qr,i,t))}catch(s){Qr(i,s,t)}}):(t.value=e,t.state=kg,xg(t,!1))}catch(i){Qr({done:!1},i,t)}}};if(Eg&&(ur=function(e){HT(this,Ps),GT(e),An(Rs,this);var r=Za(this);try{e(Xr(zc,r),Xr(Qr,r))}catch(n){Qr(r,n)}},Ps=ur.prototype,Rs=function(e){ZT(this,{type:ta,done:!1,notified:!1,parent:!1,reactions:new YT,rejection:!1,state:vd,value:void 0})},Rs.prototype=hd(Ps,"then",function(e,r){var n=Za(this),i=Bc(KT(this,ur));return n.parent=!0,i.ok=eo(e)?e:!0,i.fail=eo(r)&&r,i.domain=mo?cl.domain:void 0,n.state===vd?n.reactions.add(i):ol(function(){Og(i,n)}),i.promise}),md=function(){var t=new Rs,e=Za(t);this.promise=t,this.resolve=Xr(zc,e),this.reject=Xr(Qr,e)},_g.f=Bc=function(t){return t===ur||t===nI?new md(t):QT(t)},eo(yo)&&Vr!==Object.prototype)){yd=Vr.then,XT||hd(Vr,"then",function(e,r){var n=this;return new ur(function(i,s){An(yd,n,i,s)}).then(e,r)},{unsafe:!0});try{delete Vr.constructor}catch{}gd&&gd(Vr,Ps)}UT({global:!0,constructor:!0,wrap:!0,forced:Eg},{Promise:ur});BT(ur,ta,!1);zT(ta);var ra={},oI=J,aI=ra,cI=oI("iterator"),uI=Array.prototype,lI=function(t){return t!==void 0&&(aI.Array===t||uI[cI]===t)},fI=Jo,bd=Kn,dI=Mr,pI=ra,hI=J,gI=hI("iterator"),Rg=function(t){if(!dI(t))return bd(t,gI)||bd(t,"@@iterator")||pI[fI(t)]},vI=ye,mI=Je,yI=Ye,SI=Go,bI=Rg,_I=TypeError,EI=function(t,e){var r=arguments.length<2?bI(t):e;if(mI(r))return yI(vI(r,t));throw new _I(SI(t)+" is not iterable")},wI=ye,_d=Ye,$I=Kn,kI=function(t,e,r){var n,i;_d(t);try{if(n=$I(t,"return"),!n){if(e==="throw")throw r;return r}n=wI(n,t)}catch(s){i=!0,n=s}if(e==="throw")throw r;if(i)throw n;return _d(n),r},TI=as,II=ye,OI=Ye,xI=Go,PI=lI,RI=Nh,Ed=ts,DI=EI,CI=Rg,wd=kI,AI=TypeError,to=function(t,e){this.stopped=t,this.result=e},$d=to.prototype,na=function(t,e,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),s=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),c=!!(r&&r.INTERRUPTED),u=TI(e,n),l,f,d,p,h,y,_,k=function(O){return l&&wd(l,"normal",O),new to(!0,O)},T=function(O){return i?(OI(O),c?u(O[0],O[1],k):u(O[0],O[1])):c?u(O,k):u(O)};if(s)l=t.iterator;else if(o)l=t;else{if(f=CI(t),!f)throw new AI(xI(t)+" is not iterable");if(PI(f)){for(d=0,p=RI(t);p>d;d++)if(h=T(t[d]),h&&Ed($d,h))return h;return new to(!1)}l=DI(t,f)}for(y=s?t.next:l.next;!(_=II(y,l)).done;){try{h=T(_.value)}catch(O){wd(l,"throw",O)}if(typeof h=="object"&&h&&Ed($d,h))return h}return new to(!1)},NI=J,Dg=NI("iterator"),Cg=!1;try{var jI=0,kd={next:function(){return{done:!!jI++}},return:function(){Cg=!0}};kd[Dg]=function(){return this},Array.from(kd,function(){throw 2})}catch{}var Ag=function(t,e){try{if(!e&&!Cg)return!1}catch{return!1}var r=!1;try{var n={};n[Dg]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch{}return r},MI=ea,FI=Ag,LI=cs.CONSTRUCTOR,Ng=LI||!FI(function(t){MI.all(t).then(void 0,function(){})}),UI=_e,BI=ye,zI=Je,GI=Ur,WI=sl,HI=na,KI=Ng;UI({target:"Promise",stat:!0,forced:KI},{all:function(e){var r=this,n=GI.f(r),i=n.resolve,s=n.reject,o=WI(function(){var c=zI(r.resolve),u=[],l=0,f=1;HI(e,function(d){var p=l++,h=!1;f++,BI(c,r,d).then(function(y){h||(h=!0,u[p]=y,--f||i(u))},s)}),--f||i(u)});return o.error&&s(o.value),n.promise}});var JI=_e,VI=cs.CONSTRUCTOR,Gc=ea,YI=Ke,qI=G,XI=Oe,Td=Gc&&Gc.prototype;JI({target:"Promise",proto:!0,forced:VI,real:!0},{catch:function(t){return this.then(void 0,t)}});if(qI(Gc)){var Id=YI("Promise").prototype.catch;Td.catch!==Id&&XI(Td,"catch",Id,{unsafe:!0})}var ZI=_e,QI=ye,eO=Je,tO=Ur,rO=sl,nO=na,iO=Ng;ZI({target:"Promise",stat:!0,forced:iO},{race:function(e){var r=this,n=tO.f(r),i=n.reject,s=rO(function(){var o=eO(r.resolve);nO(e,function(c){QI(o,r,c).then(n.resolve,i)})});return s.error&&i(s.value),n.promise}});var sO=_e,oO=Ur,aO=cs.CONSTRUCTOR;sO({target:"Promise",stat:!0,forced:aO},{reject:function(e){var r=oO.f(this),n=r.reject;return n(e),r.promise}});var cO=Ye,uO=Se,lO=Ur,fO=function(t,e){if(cO(t),uO(e)&&e.constructor===t)return e;var r=lO.f(t),n=r.resolve;return n(e),r.promise},dO=_e,pO=Ke,hO=cs.CONSTRUCTOR,gO=fO;pO("Promise");dO({target:"Promise",stat:!0,forced:hO},{resolve:function(e){return gO(this,e)}});var vO=_e,So=me,jg=Ke,Od=Je,mO=os,Mg=Oe,yO=Qu,SO=qo,Fg=J,Lg=ns,Qa=tg,xd=jg("Promise"),bO=jg("SuppressedError"),_O=ReferenceError,EO=Fg("asyncDispose"),wO=Fg("toStringTag"),ia="AsyncDisposableStack",$O=Lg.set,bo=Lg.getterFor(ia),ec="async-dispose",di="disposed",kO="pending",Ds=function(t){var e=bo(t);if(e.state===di)throw new _O(ia+" already disposed");return e},ll=function(){$O(mO(this,Nn),{type:ia,state:kO,stack:[]}),So||(this.disposed=!1)},Nn=ll.prototype;yO(Nn,{disposeAsync:function(){var e=this;return new xd(function(r,n){var i=bo(e);if(i.state===di)return r(void 0);i.state=di,So||(e.disposed=!0);var s=i.stack,o=s.length,c=!1,u,l=function(d){c?u=new bO(d,u):(c=!0,u=d),f()},f=function(){if(o){var d=s[--o];s[o]=void 0;try{xd.resolve(d()).then(f,l)}catch(p){l(p)}}else i.stack=void 0,c?n(u):r(void 0)};f()})},use:function(e){return Qa(Ds(this),e,ec),e},adopt:function(e,r){var n=Ds(this);return Od(r),Qa(n,void 0,ec,function(){return r(e)}),e},defer:function(e){var r=Ds(this);Od(e),Qa(r,void 0,ec,e)},move:function(){var e=Ds(this),r=new ll;return bo(r).stack=e.stack,e.stack=[],e.state=di,So||(this.disposed=!0),r}});So&&SO(Nn,"disposed",{configurable:!0,get:function(){return bo(this).state===di}});Mg(Nn,EO,Nn.disposeAsync,{name:"disposeAsync"});Mg(Nn,wO,ia,{nonWritable:!0});vO({global:!0,constructor:!0},{AsyncDisposableStack:ll});var Ug=z,Bg=Wo,zg=G,Cs=Vo,TO=Oe,IO=J,Pd="USE_FUNCTION_CONSTRUCTOR",Rd=IO("asyncIterator"),Dd=Ug.AsyncIterator,Cd=Bg.AsyncIteratorPrototype,er,tc;if(Cd)er=Cd;else if(zg(Dd))er=Dd.prototype;else if(Bg[Pd]||Ug[Pd])try{tc=Cs(Cs(Cs(Function("return async function*(){}()")()))),Cs(tc)===Object.prototype&&(er=tc)}catch{}er||(er={});zg(er[Rd])||TO(er,Rd,function(){return this});var OO=er,xO=ye,PO=Oe,RO=Ke,DO=Kn,CO=be,AO=J,Ad=OO,Nd=AO("asyncDispose"),jd=RO("Promise");CO(Ad,Nd)||PO(Ad,Nd,function(){var t=this;return new jd(function(e,r){var n=DO(t,"return");n?jd.resolve(xO(n,t)).then(function(){e(void 0)},r):e(void 0)})});var NO=Zo;NO.AsyncDisposableStack;var sa={},jO=J;sa.f=jO;var Md=Zo,MO=be,FO=sa,LO=Ve.f,Gg=function(t){var e=Md.Symbol||(Md.Symbol={});MO(e,t)||LO(e,t,{value:FO.f(t)})},UO=z,BO=Gg,zO=Ve.f,GO=Zi.f,rc=UO.Symbol;BO("asyncDispose");if(rc){var As=GO(rc,"asyncDispose");As.enumerable&&As.configurable&&As.writable&&zO(rc,"asyncDispose",{value:As.value,enumerable:!1,configurable:!1,writable:!1})}var WO=sa;WO.f("asyncDispose");var HO=z,KO=Gg,JO=Ve.f,VO=Zi.f,nc=HO.Symbol;KO("dispose");if(nc){var Ns=VO(nc,"dispose");Ns.enumerable&&Ns.configurable&&Ns.writable&&JO(nc,"dispose",{value:Ns.value,enumerable:!1,configurable:!1,writable:!1})}var YO=sa;YO.f("dispose");var Wg={exports:{}},Hg={},qO=Hn,XO=es,Kg=Ko.f,ZO=dg,Jg=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],QO=function(t){try{return Kg(t)}catch{return ZO(Jg)}};Hg.f=function(e){return Jg&&qO(e)==="Window"?QO(e):Kg(XO(e))};var ex=Y,tx=ex(function(){if(typeof ArrayBuffer=="function"){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}}),rx=Y,nx=Se,ix=Hn,Fd=tx,ro=Object.isExtensible,sx=rx(function(){ro(1)}),ox=sx||Fd?function(e){return!nx(e)||Fd&&ix(e)==="ArrayBuffer"?!1:ro?ro(e):!0}:ro,ax=Y,cx=!ax(function(){return Object.isExtensible(Object.preventExtensions({}))}),ux=_e,lx=K,fx=Ho,dx=Se,fl=be,px=Ve.f,Ld=Ko,hx=Hg,dl=ox,gx=Lu,vx=cx,Vg=!1,Dt=gx("meta"),mx=0,pl=function(t){px(t,Dt,{value:{objectID:"O"+mx++,weakData:{}}})},yx=function(t,e){if(!dx(t))return typeof t=="symbol"?t:(typeof t=="string"?"S":"P")+t;if(!fl(t,Dt)){if(!dl(t))return"F";if(!e)return"E";pl(t)}return t[Dt].objectID},Sx=function(t,e){if(!fl(t,Dt)){if(!dl(t))return!0;if(!e)return!1;pl(t)}return t[Dt].weakData},bx=function(t){return vx&&Vg&&dl(t)&&!fl(t,Dt)&&pl(t),t},_x=function(){Ex.enable=function(){},Vg=!0;var t=Ld.f,e=lx([].splice),r={};r[Dt]=1,t(r).length&&(Ld.f=function(n){for(var i=t(n),s=0,o=i.length;s<o;s++)if(i[s]===Dt){e(i,s,1);break}return i},ux({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:hx.f}))},Ex=Wg.exports={enable:_x,fastKey:yx,getWeakData:Sx,onFreeze:bx};fx[Dt]=!0;var Yg=Wg.exports,wx=_e,$x=z,kx=K,Ud=Vu,Tx=Oe,Ix=Yg,Ox=na,xx=os,Px=G,Rx=Mr,ic=Se,sc=Y,Dx=Ag,Cx=Qo,Ax=Bh,Nx=function(t,e,r){var n=t.indexOf("Map")!==-1,i=t.indexOf("Weak")!==-1,s=n?"set":"add",o=$x[t],c=o&&o.prototype,u=o,l={},f=function(T){var O=kx(c[T]);Tx(c,T,T==="add"?function(ie){return O(this,ie===0?0:ie),this}:T==="delete"?function(re){return i&&!ic(re)?!1:O(this,re===0?0:re)}:T==="get"?function(ie){return i&&!ic(ie)?void 0:O(this,ie===0?0:ie)}:T==="has"?function(ie){return i&&!ic(ie)?!1:O(this,ie===0?0:ie)}:function(ie,DS){return O(this,ie===0?0:ie,DS),this})},d=Ud(t,!Px(o)||!(i||c.forEach&&!sc(function(){new o().entries().next()})));if(d)u=r.getConstructor(e,t,n,s),Ix.enable();else if(Ud(t,!0)){var p=new u,h=p[s](i?{}:-0,1)!==p,y=sc(function(){p.has(1)}),_=Dx(function(T){new o(T)}),k=!i&&sc(function(){for(var T=new o,O=5;O--;)T[s](O,O);return!T.has(-0)});_||(u=e(function(T,O){xx(T,c);var re=Ax(new o,T,u);return Rx(O)||Ox(O,re[s],{that:re,AS_ENTRIES:n}),re}),u.prototype=c,c.constructor=u),(y||k)&&(f("delete"),f("has"),n&&f("get")),(k||h)&&f(s),i&&c.clear&&delete c.clear}return l[t]=u,wx({global:!0,constructor:!0,forced:u!==o},l),Cx(u,t),i||r.setStrong(u,t,n),u},jx=tl.IteratorPrototype,Mx=Zu,Fx=Qi,Lx=Qo,Ux=ra,Bx=function(){return this},zx=function(t,e,r,n){var i=e+" Iterator";return t.prototype=Mx(jx,{next:Fx(+!n,r)}),Lx(t,i,!1),Ux[i]=Bx,t},Gx=_e,Wx=ye,qg=Rh,Hx=G,Kx=zx,Bd=Vo,zd=ss,Jx=Qo,Vx=Fr,oc=Oe,Yx=J,qx=ra,Xg=tl,Xx=qg.PROPER,Zx=qg.CONFIGURABLE,Gd=Xg.IteratorPrototype,js=Xg.BUGGY_SAFARI_ITERATORS,Zn=Yx("iterator"),Wd="keys",Qn="values",Hd="entries",Qx=function(){return this},eP=function(t,e,r,n,i,s,o){Kx(r,e,n);var c=function(T){if(T===i&&p)return p;if(!js&&T&&T in f)return f[T];switch(T){case Wd:return function(){return new r(this,T)};case Qn:return function(){return new r(this,T)};case Hd:return function(){return new r(this,T)}}return function(){return new r(this)}},u=e+" Iterator",l=!1,f=t.prototype,d=f[Zn]||f["@@iterator"]||i&&f[i],p=!js&&d||c(i),h=e==="Array"&&f.entries||d,y,_,k;if(h&&(y=Bd(h.call(new t)),y!==Object.prototype&&y.next&&(Bd(y)!==Gd&&(zd?zd(y,Gd):Hx(y[Zn])||oc(y,Zn,Qx)),Jx(y,u,!0))),Xx&&i===Qn&&d&&d.name!==Qn&&(Zx?Vx(f,"name",Qn):(l=!0,p=function(){return Wx(d,this)})),i)if(_={values:c(Qn),keys:s?p:c(Wd),entries:c(Hd)},o)for(k in _)(js||l||!(k in f))&&oc(f,k,_[k]);else Gx({target:e,proto:!0,forced:js||l},_);return f[Zn]!==p&&oc(f,Zn,p,{name:i}),qx[e]=p,_},tP=function(t,e){return{value:t,done:e}},Kd=Zu,rP=qo,Jd=Qu,nP=as,iP=os,sP=Mr,oP=na,aP=eP,Ms=tP,cP=ag,ei=me,Vd=Yg.fastKey,Zg=ns,Yd=Zg.set,ac=Zg.getterFor,uP={getConstructor:function(t,e,r,n){var i=t(function(l,f){iP(l,s),Yd(l,{type:e,index:Kd(null),first:void 0,last:void 0,size:0}),ei||(l.size=0),sP(f)||oP(f,l[n],{that:l,AS_ENTRIES:r})}),s=i.prototype,o=ac(e),c=function(l,f,d){var p=o(l),h=u(l,f),y,_;return h?h.value=d:(p.last=h={index:_=Vd(f,!0),key:f,value:d,previous:y=p.last,next:void 0,removed:!1},p.first||(p.first=h),y&&(y.next=h),ei?p.size++:l.size++,_!=="F"&&(p.index[_]=h)),l},u=function(l,f){var d=o(l),p=Vd(f),h;if(p!=="F")return d.index[p];for(h=d.first;h;h=h.next)if(h.key===f)return h};return Jd(s,{clear:function(){for(var f=this,d=o(f),p=d.first;p;)p.removed=!0,p.previous&&(p.previous=p.previous.next=void 0),p=p.next;d.first=d.last=void 0,d.index=Kd(null),ei?d.size=0:f.size=0},delete:function(l){var f=this,d=o(f),p=u(f,l);if(p){var h=p.next,y=p.previous;delete d.index[p.index],p.removed=!0,y&&(y.next=h),h&&(h.previous=y),d.first===p&&(d.first=h),d.last===p&&(d.last=y),ei?d.size--:f.size--}return!!p},forEach:function(f){for(var d=o(this),p=nP(f,arguments.length>1?arguments[1]:void 0),h;h=h?h.next:d.first;)for(p(h.value,h.key,this);h&&h.removed;)h=h.previous},has:function(f){return!!u(this,f)}}),Jd(s,r?{get:function(f){var d=u(this,f);return d&&d.value},set:function(f,d){return c(this,f===0?0:f,d)}}:{add:function(f){return c(this,f=f===0?0:f,f)}}),ei&&rP(s,"size",{configurable:!0,get:function(){return o(this).size}}),i},setStrong:function(t,e,r){var n=e+" Iterator",i=ac(e),s=ac(n);aP(t,e,function(o,c){Yd(this,{type:n,target:o,state:i(o),kind:c,last:void 0})},function(){for(var o=s(this),c=o.kind,u=o.last;u&&u.removed;)u=u.previous;return!o.target||!(o.last=u=u?u.next:o.state.first)?(o.target=void 0,Ms(void 0,!0)):Ms(c==="keys"?u.key:c==="values"?u.value:[u.key,u.value],!1)},r?"entries":"values",!r,!0),cP(e)}},lP=Nx,fP=uP;lP("Set",function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}},fP);var cc=K,Fs=Set.prototype,us={Set,add:cc(Fs.add),has:cc(Fs.has),remove:cc(Fs.delete),proto:Fs},dP=us.has,pP=function(t){return dP(t),t},hP=ye,Qg=function(t,e,r){for(var n=r?t:t.iterator,i=t.next,s,o;!(s=hP(i,n)).done;)if(o=e(s.value),o!==void 0)return o},ev=K,gP=Qg,tv=us,vP=tv.Set,rv=tv.proto,mP=ev(rv.forEach),nv=ev(rv.keys),yP=nv(new vP).next,iv=function(t,e,r){return r?gP({iterator:nv(t),next:yP},e):mP(t,e)},sv=us,SP=iv,bP=sv.Set,_P=sv.add,EP=function(t){var e=new bP;return SP(t,function(r){_P(e,r)}),e},wP=Uh,$P=us,kP=wP($P.proto,"size","get")||function(t){return t.size},TP=function(t){return{iterator:t,next:t.next,done:!1}},qd=Je,ov=Ye,Xd=ye,IP=Hu,OP=TP,Zd="Invalid size",xP=RangeError,PP=TypeError,RP=Math.max,av=function(t,e){this.set=t,this.size=RP(e,0),this.has=qd(t.has),this.keys=qd(t.keys)};av.prototype={getIterator:function(){return OP(ov(Xd(this.keys,this.set)))},includes:function(t){return Xd(this.has,this.set,t)}};var DP=function(t){ov(t);var e=+t.size;if(e!==e)throw new PP(Zd);var r=IP(e);if(r<0)throw new xP(Zd);return new av(t,r)},CP=pP,cv=us,AP=EP,NP=kP,jP=DP,MP=iv,FP=Qg,LP=cv.has,Qd=cv.remove,UP=function(e){var r=CP(this),n=jP(e),i=AP(r);return NP(r)<=n.size?MP(r,function(s){n.includes(s)&&Qd(i,s)}):FP(n.getIterator(),function(s){LP(r,s)&&Qd(i,s)}),i},BP=Ke,ep=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},zP=function(t){var e=BP("Set");try{new e()[t](ep(0));try{return new e()[t](ep(-1)),!1}catch{return!0}}catch{return!1}},GP=_e,WP=UP,HP=zP;GP({target:"Set",proto:!0,real:!0,forced:!HP("difference")},{difference:WP});var KP=z,JP=K,VP=function(t,e){return JP(KP[t].prototype[e])},YP=VP;YP("Set","difference");var qP=_e,XP=Ur;qP({target:"Promise",stat:!0},{withResolvers:function(){var e=XP.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var ZP=Zo,QP=ZP.Promise;QP.withResolvers;const b=(t,...e)=>{let r=t;const n=e.length;for(let i=0;i<n;i++)r=e[i](r);return r};function It(){}function Cj(t){return t}function Ie(t){return e=>(t(e),e)}function Aj(t){return t!=null}const Pr=!1,eR=!1,tR=Symbol("transferable"),rR=new Map;function uv(t,e){return rR.set(e.stableUniqueIdentifier,new WeakRef(t)),Object.defineProperty(t,tR,{value:e,enumerable:!1,writable:!1,configurable:!1}),t}function hl(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function nR(t,e){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(e);const n=hl(r);return(i,s)=>n.then(o=>s(o.transaction(e,i).objectStore(e)))}let uc;function lv(){return uc||(uc=nR("keyval-store","keyval")),uc}function iR(t,e=lv()){return e("readonly",r=>hl(r.get(t)))}function tp(t,e,r=lv()){return r("readwrite",n=>(n.put(e,t),hl(n.transaction)))}class Wc{constructor(){S(this,"writers",new Set)}write(e){for(const r of this.writers)r.write(e)}}var wi,$i,ki,Lt,Ne,fv,ii,lr,dv,No,pv;class rp{constructor(e="",r=()=>null){g(this,Ne);g(this,wi);g(this,$i);g(this,ki,null);g(this,Lt,null);g(this,lr,new Map);g(this,No,Date.now());v(this,wi,e),v(this,$i,r)}write(e){switch(e.level){case"error":console.error(...m(this,Ne,ii).call(this,e),...e.args.flatMap((r,n)=>{const i=Ls(r);return n===0&&typeof i=="string"?np(r)?["\n".concat(i),r]:"\n".concat(i):np(r)?[i,r]:i}));break;case"warn":console.warn(...m(this,Ne,ii).call(this,e),...e.args.map(Ls));break;case"info":console.info(...m(this,Ne,ii).call(this,e),...e.args.map(Ls));break;case"verbose":if(e.logger&&!m(this,Ne,fv).call(this,e.logger))return;console.debug(...m(this,Ne,ii).call(this,e),...e.args.map(Ls));break}}}wi=new WeakMap,$i=new WeakMap,ki=new WeakMap,Lt=new WeakMap,Ne=new WeakSet,fv=function(e){const r=a(this,$i).call(this);if(a(this,ki)!==JSON.stringify(r)){if(r&&r!=="*"){const n=(Array.isArray(r)?r.map(String):[String(r)]).map(u=>u.replace(/[*]/g,".*")),i=n.filter(u=>!u.startsWith("!")),s=n.filter(u=>u.startsWith("!")).map(u=>u.slice(1));s.length===0&&s.push("\0");const o=new RegExp("^(".concat(i.join("|"),")"),"i"),c=new RegExp("^(".concat(s.join("|"),")"),"i");console.info("Inkwell: Logs are filtered using filter:",r,"inclusion:",o.source,"exclusion:",c.source),v(this,Lt,[o,c])}else v(this,Lt,null);v(this,ki,JSON.stringify(r))}return a(this,Lt)?a(this,Lt)[0].test(e)&&!a(this,Lt)[1].test(e):Pr},ii=function(e){var u;const r=a(this,wi),n="background: ".concat(m(this,Ne,pv).call(this),"; color: white; padding: 2px 4px; border-radius: 2px; font-size: 0.6em; margin-right: 0.5em; font-weight: bold"),i="";if(e.logger===null&&e.context===null)return["%c".concat(r,"%c ").concat(new Date(e.timestamp).toISOString()," ").concat(e.text),n,i];const s=m(this,Ne,dv).call(this,(u=e.logger)!=null?u:"",e.context),o=[e.logger,e.context].filter(Boolean).join("|"),c="background: ".concat(s,"; color: white");return["%c".concat(r,"%c ").concat(new Date(e.timestamp).toISOString()," [").concat(o,"]%c ").concat(e.text),n,c,i]},lr=new WeakMap,dv=function(e,r){const n=r!==null?"".concat(e,"|").concat(r):e;if(!a(this,lr).has(n)){const i=a(this,lr).size*137.508;a(this,lr).set(n,"hsl(".concat(i,", 100%, 20%)"))}return a(this,lr).get(n)},No=new WeakMap,pv=function(){const e=a(this,No)%100*137.508;return"hsl(".concat(e,", 100%, 20%)")};function Ls(t){return!t||typeof t!="object"||Array.isArray(t)?t:Symbol.iterator in t?"[Iterable ".concat(aR(t),"]"):sR(t)?oR(t):t}function np(t){return typeof t=="object"&&t!==null&&typeof Reflect.get(t,"message")=="string"}function sR(t){const e=Reflect.get(t,"toString");return!!(typeof e=="function"&&e!==Object.prototype.toString||Reflect.has(t,Symbol.toStringTag))}function oR(t){return String(t)}function aR(t){(Reflect.has(t,Symbol.toStringTag)||Reflect.has(t,"toString"))&&Reflect.get(t,Symbol.toStringTag);const e=Reflect.getPrototypeOf(t);return e!=null&&e.constructor?"".concat(e.constructor.name):"Object"}var Ut,nn;const Kl=class Kl{constructor(){g(this,Ut,[]);g(this,nn,null)}get messages(){return a(this,Ut)}write(e){const r="".concat(new Date(e.timestamp).toISOString()," ").concat(e.level.toUpperCase()," ").concat(e.text," ").concat(e.args.map(cR).join(" "));a(this,nn)?a(this,nn).postMessage(r):a(this,Ut).push(r)}clear(){a(this,Ut).length=0}toTransferable(){const e=new MessageChannel;return e.port1.onmessage=r=>{typeof r.data=="string"&&a(this,Ut).push(r.data)},{kind:"MemoryLogWriter",port:e.port2}}static fromTransferable(e){const r=new Kl;return v(r,nn,e.port),r}async copyToClipboard(){const e=a(this,Ut).join("\n"),r=Reflect.get(globalThis,"copy");typeof r=="function"?r(e):await navigator.clipboard.writeText(e)}};Ut=new WeakMap,nn=new WeakMap;let _o=Kl;function cR(t){if(!t||typeof t!="object"||Array.isArray(t))return t;if(Symbol.iterator in t)return"[Iterable ".concat(ip(t),"]");if(uR(t))return lR(t);try{return JSON.stringify(t,null,2)}catch{return"[Non-Serializable Object ".concat(ip(t),"]")}}function uR(t){const e=Reflect.get(t,"toString");return!!(typeof e=="function"&&e!==Object.prototype.toString||Reflect.has(t,Symbol.toStringTag))}function lR(t){return String(t)}function ip(t){(Reflect.has(t,Symbol.toStringTag)||Reflect.has(t,"toString"))&&Reflect.get(t,Symbol.toStringTag);const e=Reflect.getPrototypeOf(t);return e!=null&&e.constructor?"".concat(e.constructor.name):"Object"}var sn,Ti,Ii;class fR{constructor(e,r,n=null){g(this,sn);g(this,Ti);g(this,Ii);v(this,sn,r),v(this,Ti,n),v(this,Ii,e)}write(e){var r;a(this,Ii).write({...e,context:(r=e.context)!=null?r:a(this,Ti),logger:e.logger?"".concat(e.logger,"/").concat(a(this,sn)):a(this,sn)})}}sn=new WeakMap,Ti=new WeakMap,Ii=new WeakMap;const dR=Math.random();var Oi;class pR{constructor({probability:e}){g(this,Oi);v(this,Oi,Math.max(0,Math.min(1,e)))}shouldSelect(){return dR<a(this,Oi)}}Oi=new WeakMap;var xi,on,Bt,an,jo,hv;class sp{constructor({maximumTokens:e,tokensPerSecond:r}){g(this,jo);g(this,xi);g(this,on);g(this,Bt);g(this,an);v(this,xi,Math.abs(r/1e3)),v(this,on,Math.max(1,e)),v(this,Bt,a(this,on)),v(this,an,performance.now())}take(e=1){return this.canTake(e)?(v(this,Bt,a(this,Bt)-e),!0):!1}canTake(e=1){return m(this,jo,hv).call(this),a(this,Bt)>=e}}xi=new WeakMap,on=new WeakMap,Bt=new WeakMap,an=new WeakMap,jo=new WeakSet,hv=function(){const e=performance.now(),r=Math.floor((e-a(this,an))*a(this,xi));r>0&&(v(this,Bt,Math.min(a(this,on),a(this,Bt)+r)),v(this,an,e))};var cn,Pi;class hR{constructor({eventsPerSecond:e,eventsPerMinute:r}){g(this,cn);g(this,Pi);v(this,cn,new sp({maximumTokens:e,tokensPerSecond:e})),v(this,Pi,new sp({maximumTokens:r,tokensPerSecond:r/60}))}shouldSelect(){return a(this,cn).canTake()&&a(this,Pi).take()&&a(this,cn).take()}}cn=new WeakMap,Pi=new WeakMap;const gv={patterns:{email:{regex:'(([^<>()[\\]\\\\.,;:\\s@"]+(\\.[^<>()[\\]\\\\.,;:\\s@"]+)*)|(".+"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))',prefixes:[],priority:0,description:"Email"},url:{regex:"[-a-zA-Z0-9@:%._\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b((([-a-zA-Z0-9()@%_\\+~#&//=\\[\\]])|([.:?](?!$|\\s)))*)?",prefixes:["http://","https://"],priority:1,description:"URL"},creditCardNumber:{regex:"(\\d{4}\\d{4}\\d{4}\\d{4})|(\\d{4}\\-\\d{4}\\-\\d{4}\\-\\d{4})|(\\d{4}\\s\\d{4}\\s\\d{4}\\s\\d{4})",prefixes:[],priority:2,description:"Credit card number"},phoneNumber:{regex:"[\\+]?[(]?[0-9]{3}[)]?[-\\s\\.]?[0-9]{3}[-\\s\\.]?[0-9]{4,6}",prefixes:[],priority:3,description:"Phone number"},usSSN:{regex:"[0-9]{3}[-]*[0-9]{2}[-]*[0-9]{4}",prefixes:[],priority:4,description:"US SSN"},caSSN:{regex:"[0-9]{3}[\\s\\-]?[0-9]{3}[\\s\\-]?[0-9]{3}",prefixes:[],priority:5,description:"CA SIN"},ukSSN:{regex:"[A-Z]{2}[\\s\\-]?\\d{2}[\\s\\-]?\\d{2}[\\s\\-]?\\d{2}[\\s\\-]?[A-Z]",prefixes:[],priority:6,description:"UK NI NO"},iban:{regex:"[A-Z]{2}(-?|\\ )\\d{2}-?(?:\\ ?[A-Z]{4}-?)?(?:\\d{13,}|(?:\\ \\d{4}){3,5}\\ \\d{1,4})",prefixes:[],priority:7,description:"IBAN number"},variousID:{regex:"[A-Z]{0,2}(?:\\d{3,8}[\\ -])(?:\\d{2,8}[\\ -]){1,4}\\d{2,4}|\\d{7}[A-Z]?|\\d{5,18}",prefixes:[],priority:8,description:"Various ID number"}}};function gR({patterns:t}){return new RegExp(Object.entries(t).sort(([,{priority:e}],[,{priority:r}])=>e-r).map(([e,{regex:r,prefixes:n}])=>(r=n.length?"(".concat(n.join("|"),")").concat(r):r,"(?<".concat(e,">").concat(r,")"))).join("|"),"g")}function vR({prefixes:t,text:e},r){const n=t.find(i=>e.indexOf(i)===0);return n!==void 0?"".concat(n).concat(op(e.slice(n.length),r)):op(e,r)}const vv=97,mR=122,mv=65,yR=90,yv=48,SR=57,bR=t=>t>=vv&&t<=mR,_R=t=>t>=mv&&t<=yR,ER=t=>t>=yv&&t<=SR;function op(t,e){const r=new Array(t.length);let n=e;for(let i=t.length-1;i>=0;i--){const s=t.charCodeAt(i);bR(s)?(r[i]=vv+(i+n)%26,n/=26):_R(s)?(r[i]=mv+(i+n)%26,n/=26):ER(s)?(r[i]=yv+(i+1+n)%10,n/=10):r[i]=s}return String.fromCharCode(...r)}function ap(t,{groups:e,index:r}){const[n,i]=Object.entries(e).find(([,o])=>o!==void 0),s=t.patterns[n];return{id:n,...s,text:i,start:r,end:r+i.length}}class Sv{constructor(e){S(this,"dlpConfiguration");S(this,"dlpRegex");S(this,"seed",0);this.dlpConfiguration=e,this.dlpRegex=gR(this.dlpConfiguration)}matchAll(e){const r=[];for(this.dlpRegex.lastIndex=0;;){const n=this.dlpRegex.exec(e);if(!n)break;const i={groups:n.groups,index:n.index};r.push(ap(this.dlpConfiguration,i))}return this.dlpRegex.lastIndex=0,r}sanitizedReplacement(e){return vR(e,this.seed++)}sanitize(e){return e.replace(this.dlpRegex,(...r)=>{const n={groups:r[r.length-1],index:r[r.length-3]},i=ap(this.dlpConfiguration,n);return this.sanitizedReplacement(i)})}unsanitize(e){return e}}class wR extends Sv{sanitize(e){const r=super.sanitize(e);return this.seed=0,r}}class $R extends Sv{constructor(){super(...arguments);S(this,"_sensitiveToSanitizedMap",new Map);S(this,"_sanitizedToSensitiveMap",new Map)}sanitizedReplacement(r){const{text:n}=r,i=this._sensitiveToSanitizedMap.get(n);if(i!==void 0)return i;const s=super.sanitizedReplacement(r);return this._sensitiveToSanitizedMap.set(n,s),this._sanitizedToSensitiveMap.set(s,n),s}unsanitize(r){return r.replace(this.dlpRegex,n=>{var i;return(i=this._sanitizedToSensitiveMap.get(n))!=null?i:n})}clear(){this.seed=0,this._sensitiveToSanitizedMap.clear(),this._sanitizedToSensitiveMap.clear()}}const cp=new wR(gv),kR=cp.sanitize.bind(cp);class Nj{create(){return new $R(gv)}}const TR={error:"ERROR",warn:"WARN",info:"INFO",verbose:"DEBUG"};var fr,it,Ri,dr,yt,ve,Hc,bv,_v,Kc,Jc;const Jl=class Jl{constructor(e){g(this,ve);g(this,fr,new Map);g(this,it);g(this,Ri);g(this,dr,0);g(this,yt,null);v(this,it,e),v(this,Ri,new hR({eventsPerSecond:e.logsPerSecond,eventsPerMinute:e.logsPerMinute}))}write(e){if(e.level!=="verbose"&&!(e.level==="info"&&e.delivery===void 0)&&e.delivery!==!1){if(!a(this,Ri).shouldSelect()){Sa(this,dr)._++;return}m(this,ve,bv).call(this,e.delivery===!0?{}:e.delivery,m(this,ve,Hc).call(this,e))}}[Symbol.dispose](){a(this,yt)!==null&&(clearTimeout(a(this,yt)),v(this,yt,null)),m(this,ve,Kc).call(this)}toTransferable(){return{kind:"FeLogWriter",options:a(this,it)}}static fromTransferable(e){return new Jl(e.options)}};fr=new WeakMap,it=new WeakMap,Ri=new WeakMap,dr=new WeakMap,yt=new WeakMap,ve=new WeakSet,Hc=function(e){var r;return JSON.stringify({timestamp:e.timestamp,level:TR[e.level],message:e.text,logger:(r=e.logger)!=null?r:"root",application:a(this,it).application,version:a(this,it).version,client:a(this,it).client,env:a(this,it).environment,session:a(this,it).sessionId,extra:e.level==="error"?e.args.slice(1):e.args,exception:e.level==="error"?e.args[0]:void 0},(n,i)=>typeof i=="string"?kR(i):i)},bv=function(e,r){var s,o;const n="".concat((s=e.dataTier)!=null?s:"infrequent",":").concat((o=e.retentionInDays)!=null?o:30),i=a(this,fr).get(n);i?i.messages.push(r):a(this,fr).set(n,{options:e,messages:[r]}),m(this,ve,_v).call(this)},_v=function(){if(a(this,yt)!==null)return;v(this,yt,setTimeout(()=>{v(this,yt,null),m(this,ve,Kc).call(this)},7500))},Kc=function(){for(const e of a(this,fr).values())m(this,ve,Jc).call(this,e.options,e.messages);a(this,dr)>0&&(m(this,ve,Jc).call(this,{retentionInDays:30,dataTier:"infrequent"},[m(this,ve,Hc).call(this,{timestamp:Date.now(),level:"warn",logger:"FeLogWriter",context:null,text:"Dropped log messages due to rate limiting.",delivery:!0,args:[{count:a(this,dr)}]})]),v(this,dr,0)),a(this,fr).clear()},Jc=function({retentionInDays:e=30,dataTier:r="infrequent"},n){if(n.length===0)return;const i="[".concat(n.join(","),"]"),s=new URL("https://f-log-inkwell.grammarly.io/batch/log");s.searchParams.set("retention",String(e)),s.searchParams.set("datatier",r),IR(async()=>{var c;const o=await fetch(s,{body:i,method:"POST",cache:"no-store",headers:{"Content-Type":"application/json"},keepalive:!0});if((c=o.body)==null||c.cancel(),!o.ok)throw new Error("Failed to send logs: ".concat(o.status," ").concat(o.statusText))}).catch(o=>{})};let mi=Jl;function IR(t,e=3){return new Promise((r,n)=>{let i=0;const s=()=>{t().then(r).catch(o=>{i++<e?setTimeout(s,2**i*1e3):n(o)})};s()})}var Di;const Vl=class Vl{constructor(e){S(this,"writer");g(this,Di,new Map);this.writer=e}error(...e){var r,n,i;if(e.length===1){const s=typeof e[0]=="string"?e[0]:"",o=typeof e[0]=="string"?null:e[0];this.writer.write({context:null,timestamp:Date.now(),logger:null,level:"error",text:s,args:o===null?[]:[o],delivery:!1})}else if(e.length===2&&typeof e[0]=="string"){const s=e[0],o=typeof e[1]=="object"&&e[1]&&"message"in e[1]?e[1]:null,c=o===null?e[1]:void 0;this.writer.write({context:null,...c,timestamp:Date.now(),logger:null,level:"error",text:s,args:o===null?[]:[o],delivery:(r=c==null?void 0:c.delivery)!=null?r:!1})}else if(e.length===2){const s=e[0],o=e[1];this.writer.write({context:null,...o,timestamp:Date.now(),logger:null,level:"error",text:s.message,args:[s],delivery:(n=o==null?void 0:o.delivery)!=null?n:!1})}else{const s=e[0],o=e[1],c=e[2];this.writer.write({context:null,...c,timestamp:Date.now(),logger:null,level:"error",text:s,args:[o],delivery:(i=c==null?void 0:c.delivery)!=null?i:!1})}}warn(e,r){var n;this.writer.write({context:null,...r,timestamp:Date.now(),logger:null,level:"warn",text:e,args:[],delivery:(n=r==null?void 0:r.delivery)!=null?n:!1})}info(e,r){var n;this.writer.write({context:null,...r,timestamp:Date.now(),logger:null,level:"info",text:e,args:[],delivery:(n=r==null?void 0:r.delivery)!=null?n:!1})}verbose(e,r,...n){var c;const i=typeof e=="string"?{}:e,s=typeof e=="string"?e:r,o=typeof e=="string"?r===void 0?n:[r,...n]:n;this.writer.write({context:null,...i,logger:null,timestamp:Date.now(),level:"verbose",text:s,args:o,delivery:(c=i==null?void 0:i.delivery)!=null?c:!1})}createLogger(e,r=null){var i;const n=(i=a(this,Di).get(e))!=null?i:0;try{return new Vl(new fR(this.writer,e,r!=null?r:n>0?"".concat(n):null))}finally{a(this,Di).set(e,n+1)}}addWriter(e){const r=this.writer;if(r instanceof Wc)return r.writers.add(e),{[Symbol.dispose]:()=>{r.writers.delete(e)}};throw new Error("This should be unreachable.")}getWriters(){const e=this.writer;if(e instanceof Wc)return Array.from(e.writers);throw new Error("This should be unreachable.")}};Di=new WeakMap;let Vc=Vl;function OR(){let t;try{const e=localStorage.getItem("DEBUG");t=JSON.parse(e!=null?e:"null"),tp("DEBUG",JSON.stringify(t)).catch(()=>{})}catch{}return Reflect.getOwnPropertyDescriptor(globalThis,"DEBUG")||Object.defineProperty(globalThis,"DEBUG",{get:()=>{var e;t===void 0&&iR("DEBUG").then(r=>{try{t=JSON.parse(r!=null?r:"null")}catch{}}).catch(()=>{});try{return JSON.parse((e=localStorage.getItem("DEBUG"))!=null?e:"null")}catch{return t}},set:e=>{{tp("DEBUG",JSON.stringify(e)).catch(()=>{});try{localStorage.setItem("DEBUG",JSON.stringify(e))}catch{}}t=e}}),new Vc(new Wc)}const E=uv(OR(),{stableUniqueIdentifier:"@grammarly/util-logging:DefaultLogger",serialize:t=>{const e=[];return[{writers:t.getWriters().map(r=>{if(r instanceof rp)return{kind:"ConsoleLogWriter"};if(r instanceof _o){const n=r.toTransferable();return e.push(n.port),n}else if(r instanceof mi)return r.toTransferable()}),DEBUG:Reflect.get(globalThis,"DEBUG")},e]},deserialize:({writers:t,DEBUG:e},r)=>{Reflect.set(globalThis,"DEBUG",e);for(const n of t)if(n)switch(n.kind){case"ConsoleLogWriter":r.addWriter(new rp);break;case"MemoryLogWriter":r.addWriter(_o.fromTransferable(n));break;case"FeLogWriter":r.addWriter(mi.fromTransferable(n));break}}}),Zr=class Zr{constructor(e,r){S(this,"name");S(this,"message");S(this,"cause");S(this,"stack");this.name=this.constructor===Zr?"Error":this.constructor.name,this.message=e,this.cause=r,this.stack=Zr.isStackTraceEnabled?DR(new Error(e).stack,{skip:1}):void 0}toString(){return Eo(this,!1)}[Symbol.toStringTag](){return this.toString()}toJSON(){return{name:this.name,message:this.message,stack:this.stack,cause:this.cause instanceof Zr?this.cause:gl(this.cause)}}};S(Zr,"isStackTraceEnabled",!eR);let w=Zr;function gl(t){if(t!==void 0)return t instanceof w?t.toJSON():{name:t.name,message:t.message,stack:t.stack,cause:t.cause instanceof Error?gl(t.cause):t.cause}}function Re(t){if(t instanceof w)return t;if(t instanceof Error){const e=new w(t.message);return Reflect.set(e,"name",t.name),Reflect.set(e,"stack",t.stack),t.cause&&Reflect.set(e,"cause",Re(t.cause)),e}return xR(t)?Ev(t):new PR(t)}function xR(t){return typeof t=="object"&&t!==null&&"message"in t&&typeof t.message=="string"}function Ev(t){const{message:e,name:r,cause:n,stack:i}=t,s=new w(String(e!=null?e:"Unknown error"));return r&&Reflect.set(s,"name",String(r)),i&&Reflect.set(s,"stack",String(i)),n&&Reflect.set(s,"cause",Ev(n)),s}class PR extends w{constructor(r){super("An unknown error occurred: "+String(r));S(this,"thrownError");this.thrownError=r}toJSON(){return{...super.toJSON(),thrownError:this.thrownError}}}let kr=class extends w{constructor(r="Object has been disposed"){super(r);S(this,"kind","ReferenceError")}};class tt extends w{constructor(r){super("Unreachable case: ".concat(String(r)));S(this,"value");this.value=r}}class lt extends w{constructor(r,n=""){super(n);S(this,"errors");this.errors=r.flatMap(i=>i instanceof lt?i.errors:[i])}toString(){if(this.errors.length===1)return Eo(this.errors[0]);const r=String(this.errors.length).length+2;return"AggregateError: "+this.message+"(total ".concat(this.errors.length," errors)")+"\n"+this.errors.map((n,i)=>"".concat(i+1,". ").padStart(r)+wv(Eo(n),r)).join("\n")}toJSON(){return{...super.toJSON(),errors:this.errors.map(gl)}}}function Eo(t,e=!0){var i;if(e&&t instanceof w)return t.toString();const r=t.name==="CustomError"?"Error":(i=Reflect.get(t,"kind"))!=null?i:t.name;let n="".concat(r,": ").concat(t.message);if(t.stack){const s=RR({stack:t.stack,message:t.message});n+="\n".concat(s)}return t.cause&&(n+="\nCaused by ".concat(wv(Eo(Re(t.cause)),2))),n}function RR({stack:t,message:e}){const r=t.indexOf(e);return(r===-1?t:t.slice(r+e.length)).replace(/^\s*\n/,"")}function wv(t,e){const r=" ".repeat(e);return t.replace(/\r?\n/g,n=>n+r).trimStart()}function DR(t,e){if(!t)return;const r=t.split("\n");return r.splice(1,e.skip),r.join("\n")}function vl(t){return typeof t=="object"&&t!==null&&"ok"in t&&typeof t.ok=="boolean"&&(t.ok?"value"in t:"error"in t&&AR(t.error))}function P(t){return Object.freeze({ok:!0,value:t,error:void 0})}function R(t){return Object.freeze({ok:!1,value:void 0,error:t})}function $v(t){return vl(t)&&De(t)?t:R(Re(t))}function wo(t){return t.ok}function De(t){return!t.ok}function ne(t){return e=>e.ok?P(t(e.value)):e}function ml(t){return e=>e.ok?e:R(t(e.error))}function yl(t){return e=>e.ok?t(e.value):e}function $o(t){const e=[],r=[];for(const n of t)n.ok?e.push(n.value):r.push(n.error);return r.length>0?R(new lt(r)):P(e)}function CR(t){const e={},r=[];for(const[n,i]of Object.entries(t))i.ok?e[n]=i.value:r.push(i.error);return r.length>0?R(new lt(r)):P(e)}function Mj(t){let e=null;try{return t(r=>{if(r.ok)return r.value;throw e=r.error,e})}catch(r){if(r===e)return R(e);throw r}}function Sl(t){try{return P(t())}catch(e){return $v(e)}}function Fj(t){return e=>e.ok?t.success(e.value):t.failure(e.error)}function kv(t){const e=[],r=[];for(const n of t)n.ok?e.push(n.value):r.push(n.error);return{success:e,failure:r}}function AR(t){return t instanceof w||t instanceof Error||typeof t=="object"&&t!==null&&"message"in t&&typeof t.message=="string"}async function D(t){return P(t)}async function Q(t){return R(t)}async function tr(t){return t}async function NR(t){let e=null;try{return await t(async r=>{const n=await r;if(n.ok)return n.value;throw e=n.error,e})}catch(r){if(r===e)return Q(e);throw r}}async function xt(t){try{return D(await t())}catch(e){return $v(e)}}function x(t){return async e=>{const r=await e;return r.ok?D(t(r.value)):r}}function dt(t){return async e=>{const r=await e;return r.ok?r:Q(await t(r.error))}}function N(t){return async e=>{const r=await e;return r.ok?t(r.value):r}}function ae(t){return async e=>{const r=await e;return r.ok?r:t(r.error)}}async function yi(t){const e=await Promise.all(Array.from(t)),r=e.filter(wo),n=e.filter(De);return n.length>0?Q(new lt(n.map(({error:i})=>i))):D(r.map(i=>i.value))}function jR(t){return async e=>{const r=await e;return r.ok?t.success(r.value):t.failure(r.error)}}function jn(t){return async e=>t(await e)}function Tv(t){return async e=>t(await e)}function Lj(t,e){return new Promise(r=>{var c,u;let n=0;const i=(c=e==null?void 0:e.maxRetries)!=null?c:3,s=(u=e==null?void 0:e.delayMs)!=null?u:()=>1e3,o=async()=>{const l=await t();l.ok?r(l):n++<i?setTimeout(o,s(n)):r(l)};o()})}const ft={all:MR,use:FR};function MR(t){var i=[];try{const e=ue(i,new DisposableStack);const{success:r,failure:n}=kv(t);r.forEach(u=>e.use(u));if(n.length>0)return R(new lt(n));return P(e.move())}catch(s){var o=s,c=!0}finally{le(i,o,c)}}function FR(t){return e=>{if(!e.ok)return e;if(t.disposed){var r=[];try{const o=ue(r,e.value)}catch(n){var i=n,s=!0}finally{le(r,i,s)}}else t.use(e.value);return e}}const bl={all:LR,use:UR};async function LR(t){var i=[];try{const e=ue(i,new AsyncDisposableStack,!0);const{success:r,failure:n}=kv(t);r.forEach(l=>e.use(l));if(n.length>0)return R(new lt(n));return P(e.move())}catch(s){var o=s,c=!0}finally{var u=le(i,o,c);u&&await u}}function UR(t){return async e=>{if(!e.ok)return e;if(t.disposed){var r=[];try{const c=ue(r,e.value,!0)}catch(n){var i=n,s=!0}finally{var o=le(r,i,s);o&&await o}}else t.use(e.value);return e}}const en=[];function BR(t){en.push(t)}function zR(t){if(Tr()===t){en.pop();return}const e=en.indexOf(t);e!==-1&&en.splice(e,1)}function Tr(){var t;return(t=en[en.length-1])!=null?t:null}function ir(){return crypto.randomUUID()}var Ci,pr;class Iv{constructor(){g(this,Ci,ir());g(this,pr,0)}next(){return a(this,pr)===Number.MAX_SAFE_INTEGER?(v(this,pr,0),v(this,Ci,ir())):Sa(this,pr)._++,"".concat(a(this,Ci),"-").concat(a(this,pr).toString(16))}}Ci=new WeakMap,pr=new WeakMap;const Ov=new Iv;var Ee,zt,Ai,Xe,gt;class _l{constructor(e,r){g(this,Xe);g(this,Ee,!0);S(this,"status");S(this,"message");S(this,"endTime");S(this,"id");S(this,"name");S(this,"startTime");S(this,"links");S(this,"events");S(this,"attributes");g(this,zt);g(this,Ai);var n,i,s;this.id=Ov.next(),this.name=e,this.links=(i=(n=r.links)==null?void 0:n.map(o=>({id:o.id})))!=null?i:[],this.attributes={...r.attributes},this.events=[],this.startTime=(s=r.timestamp)!=null?s:performance.now(),v(this,zt,r.tracer),v(this,Ai,r.parent?{id:r.parent.id}:null)}get isRecording(){return a(this,Ee)}setAttribute(e,r){if(!a(this,Ee))return m(this,Xe,gt).call(this);this.attributes[e]=r}setAttributes(e){if(!a(this,Ee))return m(this,Xe,gt).call(this);Object.assign(this.attributes,e)}setStatus(e,r){if(!a(this,Ee))return m(this,Xe,gt).call(this);this.status=e,this.message=r}recordError(e,r){if(!a(this,Ee))return m(this,Xe,gt).call(this);this.events.push({name:e.name,kind:"error",attributes:{message:e.message,stack:e.stack},timestamp:r!=null?r:performance.now()})}recordEvent(e,r={},n){if(!a(this,Ee))return m(this,Xe,gt).call(this);typeof r=="number"&&(n=r,r={}),this.events.push({name:e,kind:"event",attributes:r,timestamp:n!=null?n:performance.now()})}link(e,r){if(!a(this,Ee))return m(this,Xe,gt).call(this);this.links.push({id:e.id,attributes:r})}startSpan(e,r){a(this,Ee)||m(this,Xe,gt).call(this);const n={...r,parent:this,tracer:a(this,zt)};return a(this,zt).startSpan("".concat(this.name,".").concat(e),n)}runInSpan(e,r,n){return this.run(r,this.startSpan(e,n))}run(e,r=this){const n=()=>{r.setStatus("ok"),r.end()},i=s=>{const o=Re(s);r.recordError(o),r.setStatus("error",o.message),r.end()};try{const s=e(r);return s instanceof Promise?s.then(n,i):n(),s}catch(s){throw i(s),s}}end(e){var r;if(!a(this,Ee))return m(this,Xe,gt).call(this);v(this,Ee,!1),(r=this.status)!=null||(this.status="unset"),this.endTime=e!=null?e:performance.now(),a(this,zt).onSpanDidEnd(this)}[Symbol.dispose](){a(this,Ee)&&this.end()}toJSON(){var e;return{id:this.id,parentId:(e=a(this,Ai))==null?void 0:e.id,traceId:a(this,zt).id,name:this.name,status:this.status,message:this.message,startTime:this.startTime,endTime:this.endTime,links:this.links,events:this.events,attributes:this.attributes}}toString(){const e=[];return e.push(this.name),this.status==="error"&&e.push("(error)"),this.message&&e.push(this.message),Object.keys(this.attributes).length&&e.push("|",El(this.attributes)),e.push("(".concat(this.id,")")),e.join(" ")}}Ee=new WeakMap,zt=new WeakMap,Ai=new WeakMap,Xe=new WeakSet,gt=function(){E.warn("Span ".concat(this.name,"(").concat(this.id,") is not recording."),{delivery:!1})};function GR(t){return typeof t=="string"?t:JSON.stringify(t)}function El(t){const e=Object.entries(t);return e.length===0?"":"attributes: "+e.map(([r,n])=>"".concat(r,"=").concat(GR(n))).join(", ")}var Ni,hr,St,Gt,ji,qc;const Yl=class Yl{constructor(e,r=null){g(this,ji);g(this,Ni,Ov.next());g(this,hr);g(this,St,new Set);g(this,Gt);v(this,hr,e),v(this,Gt,r)}get id(){return a(this,Ni)}get observers(){return Array.from(a(this,St))}get attributes(){var e;return(e=a(this,hr))!=null?e:{}}load(e){v(this,Ni,e.id),v(this,hr,e.attributes)}addObserver(e){return a(this,St).add(e),{[Symbol.dispose]:()=>{a(this,St).delete(e)}}}removeObserver(e){return a(this,St).delete(e)}startSpan(e,r){return m(this,ji,qc).call(this,e,r)}runInSpan(e,r,n){return m(this,ji,qc).call(this,e,n).run(r)}onSpanDidStart(e){BR(e),a(this,Gt)&&a(this,Gt).onSpanDidStart(e),a(this,St).forEach(r=>{if(r.onDidStart)try{r.onDidStart(e)}catch{}})}onSpanDidEnd(e){zR(e),a(this,Gt)&&a(this,Gt).onSpanDidEnd(e),a(this,St).forEach(r=>{if(r.onDidEnd)try{r.onDidEnd(e)}catch{}})}startTrace(e){return new Yl(e,this)}};Ni=new WeakMap,hr=new WeakMap,St=new WeakMap,Gt=new WeakMap,ji=new WeakSet,qc=function(e,r){const n=new _l(e,{tracer:this,parent:null,...r,attributes:{...a(this,hr),...r==null?void 0:r.attributes}});return this.onSpanDidStart(n),n};let Yc=Yl;var un;const Mo=class Mo{constructor(){S(this,"name",Mo.name);g(this,un,E.createLogger("Trace"))}onDidStart(e){a(this,un).verbose("START ".concat(e),e.toJSON())}onDidEnd(e){const r=Number(e.endTime-e.startTime).toFixed(2)+"ms";if(e instanceof _l){const n=i=>!i.attributes||!Object.keys(i.attributes).length?i.name:"".concat(i.name,"(").concat(El(i.attributes),")");for(const i of e.events){const s=i.kind==="error"?"ERROR":"EVENT",o=Number(i.timestamp-e.startTime).toFixed(2)+"ms";a(this,un).verbose("".concat(s," ").concat(n(i)," in ").concat(e," at ").concat(o," of ").concat(r))}}a(this,un).verbose("END ".concat(e," in ").concat(r),e.toJSON())}};un=new WeakMap,S(Mo,"name","ConsoleObserver");let pi=Mo;const Fo=class Fo{constructor(e={}){S(this,"name",Fo.name);S(this,"showDetails");var r;this.showDetails=(r=e.showDetails)!=null?r:!1}onDidStart(e){performance.mark("".concat(e.name," (").concat(e.id,")"),{startTime:e.startTime})}onDidEnd(e){performance.clearMarks("".concat(e.name," (").concat(e.id,")"));try{performance.measure(this.showDetails?e.toString():e.name,{start:e.startTime,end:e.endTime,detail:e.toJSON()})}catch{}e instanceof _l&&e.events.forEach(r=>{var n;performance.mark("".concat(e.name,"#").concat(r.name," ").concat(El((n=r.attributes)!=null?n:{})),{startTime:r.timestamp})})}};S(Fo,"name","PerformanceObserver");let hi=Fo;function ko(t){return function(e){return vl(e)?(e.ok?t.setStatus("ok"):(t.setStatus("error",e.error.message),t.recordError(e.error)),t.end(),e):jR({success:()=>(t.setStatus("ok"),t.end(),e),failure:r=>(t.setStatus("error",r.message),t.recordError(r),t.end(),e)})(e)}}const To=uv(new Yc,{stableUniqueIdentifier:"@grammarly/util-tracing",serialize:t=>[{id:t.id,attributes:t.attributes,observers:t.observers.map(e=>e instanceof pi?{name:e.name}:e instanceof hi?{name:e.name,showDetails:e.showDetails}:null)},[]],deserialize:(t,e)=>{e.load(t);for(const r of t.observers)r&&(r.name===pi.name?e.addObserver(new pi):r.name===hi.name&&e.addObserver(new hi({showDetails:r.showDetails})))}}),oa="0.2.0";function WR(t){return{name:"Inkwell",client:t.client,clientVersion:t.clientVersion,servicesEnvironment:t.servicesEnvironment,version:oa,capiSource:t.capiSource}}var HR=Object.defineProperty,KR=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),up=t=>{throw TypeError(t)},JR=(t,e,r)=>e in t?HR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,VR=(t,e,r)=>JR(t,e+"",r),YR=(t,e,r)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&up("Object expected");var n;n===void 0&&(n=e[KR("dispose")]),typeof n!="function"&&up("Object not disposable"),t.push([r,n,e])}return e},qR=(t,e,r)=>{var n=typeof SuppressedError=="function"?SuppressedError:function(o,c,u,l){return l=Error(u),l.name="SuppressedError",l.error=o,l.suppressed=c,l},i=o=>e=r?new n(o,e,"An error was suppressed during disposal"):(r=!0,o),s=o=>{for(;o=t.pop();)try{var c=o[1]&&o[1].call(o[2]);if(o[0])return Promise.resolve(c).then(s,u=>(i(u),s()))}catch(u){i(u)}if(r)throw e};return s()};function XR(){var t=[];try{w.isStackTraceEnabled=Pr;const n=YR(t,new DisposableStack),i=o=>{const c=new wl(o),u="filename"in o?" at ".concat(o.filename,":").concat(o.lineno,":").concat(o.colno):"";E.error("Uncaught error (".concat(o.type,")").concat(u,":"),c,{delivery:!0}),E.verbose("Details:",{event:o})},s=new AbortController;return n.defer(()=>s.abort()),globalThis.addEventListener("unhandledrejection",i,{signal:s.signal}),globalThis.addEventListener("error",i,{signal:s.signal}),n.move()}catch(n){var e=n,r=!0}finally{qR(t,e,r)}}class wl extends w{constructor(e){super("Unhandled error",Re("error"in e?e.error:e.reason)),VR(this,"event"),this.event=e}toJSON(){return{...super.toJSON(),type:this.event.type,filename:"filename"in this.event?this.event.filename:void 0,lineno:"filename"in this.event?this.event.lineno:void 0,colno:"filename"in this.event?this.event.colno:void 0}}}const F=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,Ir="8.47.0",C=globalThis;function aa(t,e,r){const n=r||C,i=n.__SENTRY__=n.__SENTRY__||{},s=i[Ir]=i[Ir]||{};return s[t]||(s[t]=e())}const Br=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,ZR="Sentry Logger ",Xc=["debug","info","warn","error","log","assert","trace"],Io={};function zr(t){if(!("console"in C))return t();const e=C.console,r={},n=Object.keys(Io);n.forEach(i=>{const s=Io[i];r[i]=e[i],e[i]=s});try{return t()}finally{n.forEach(i=>{e[i]=r[i]})}}function QR(){let t=!1;const e={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return Br?Xc.forEach(r=>{e[r]=(...n)=>{t&&zr(()=>{C.console[r]("".concat(ZR,"[").concat(r,"]:"),...n)})}}):Xc.forEach(r=>{e[r]=()=>{}}),e}const $=aa("logger",QR),xv=50,Rr="?",lp=/\(error: (.*)\)/,fp=/captureMessage|captureException/;function Pv(...t){const e=t.sort((r,n)=>r[0]-n[0]).map(r=>r[1]);return(r,n=0,i=0)=>{const s=[],o=r.split("\n");for(let c=n;c<o.length;c++){const u=o[c];if(u.length>1024)continue;const l=lp.test(u)?u.replace(lp,"$1"):u;if(!l.match(/\S*Error: /)){for(const f of e){const d=f(l);if(d){s.push(d);break}}if(s.length>=xv+i)break}}return t0(s.slice(i))}}function e0(t){return Array.isArray(t)?Pv(...t):t}function t0(t){if(!t.length)return[];const e=Array.from(t);return/sentryWrapped/.test(Us(e).function||"")&&e.pop(),e.reverse(),fp.test(Us(e).function||"")&&(e.pop(),fp.test(Us(e).function||"")&&e.pop()),e.slice(0,xv).map(r=>({...r,filename:r.filename||Us(e).filename,function:r.function||Rr}))}function Us(t){return t[t.length-1]||{}}const lc="<anonymous>";function sr(t){try{return!t||typeof t!="function"?lc:t.name||lc}catch{return lc}}function dp(t){const e=t.exception;if(e){const r=[];try{return e.values.forEach(n=>{n.stacktrace.frames&&r.push(...n.stacktrace.frames)}),r}catch{return}}}const no={},pp={};function Gr(t,e){no[t]=no[t]||[],no[t].push(e)}function Wr(t,e){if(!pp[t]){pp[t]=!0;try{e()}catch(r){Br&&$.error("Error while instrumenting ".concat(t),r)}}}function rt(t,e){const r=t&&no[t];if(r)for(const n of r)try{n(e)}catch(i){Br&&$.error("Error while triggering instrumentation handler.\nType: ".concat(t,"\nName: ").concat(sr(n),"\nError:"),i)}}let fc=null;function r0(t){const e="error";Gr(e,t),Wr(e,n0)}function n0(){fc=C.onerror,C.onerror=function(t,e,r,n,i){return rt("error",{column:n,error:i,line:r,msg:t,url:e}),fc?fc.apply(this,arguments):!1},C.onerror.__SENTRY_INSTRUMENTED__=!0}let dc=null;function i0(t){const e="unhandledrejection";Gr(e,t),Wr(e,s0)}function s0(){dc=C.onunhandledrejection,C.onunhandledrejection=function(t){return rt("unhandledrejection",t),dc?dc.apply(this,arguments):!0},C.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}function ca(){return $l(C),C}function $l(t){const e=t.__SENTRY__=t.__SENTRY__||{};return e.version=e.version||Ir,e[Ir]=e[Ir]||{}}const Rv=Object.prototype.toString;function kl(t){switch(Rv.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":case"[object WebAssembly.Exception]":return!0;default:return Dr(t,Error)}}function Jn(t,e){return Rv.call(t)==="[object ".concat(e,"]")}function Dv(t){return Jn(t,"ErrorEvent")}function hp(t){return Jn(t,"DOMError")}function o0(t){return Jn(t,"DOMException")}function Pt(t){return Jn(t,"String")}function Tl(t){return typeof t=="object"&&t!==null&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function Il(t){return t===null||Tl(t)||typeof t!="object"&&typeof t!="function"}function Mn(t){return Jn(t,"Object")}function ua(t){return typeof Event<"u"&&Dr(t,Event)}function a0(t){return typeof Element<"u"&&Dr(t,Element)}function c0(t){return Jn(t,"RegExp")}function la(t){return!!(t&&t.then&&typeof t.then=="function")}function u0(t){return Mn(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t}function Dr(t,e){try{return t instanceof e}catch{return!1}}function Cv(t){return!!(typeof t=="object"&&t!==null&&(t.__isVue||t._isVue))}const Ol=C,l0=80;function Av(t,e={}){if(!t)return"<unknown>";try{let r=t;const n=5,i=[];let s=0,o=0;const c=" > ",u=c.length;let l;const f=Array.isArray(e)?e:e.keyAttrs,d=!Array.isArray(e)&&e.maxStringLength||l0;for(;r&&s++<n&&(l=f0(r,f),!(l==="html"||s>1&&o+i.length*u+l.length>=d));)i.push(l),o+=l.length,r=r.parentNode;return i.reverse().join(c)}catch{return"<unknown>"}}function f0(t,e){const r=t,n=[];if(!r||!r.tagName)return"";if(Ol.HTMLElement&&r instanceof HTMLElement&&r.dataset){if(r.dataset.sentryComponent)return r.dataset.sentryComponent;if(r.dataset.sentryElement)return r.dataset.sentryElement}n.push(r.tagName.toLowerCase());const i=e&&e.length?e.filter(o=>r.getAttribute(o)).map(o=>[o,r.getAttribute(o)]):null;if(i&&i.length)i.forEach(o=>{n.push("[".concat(o[0],'="').concat(o[1],'"]'))});else{r.id&&n.push("#".concat(r.id));const o=r.className;if(o&&Pt(o)){const c=o.split(/\s+/);for(const u of c)n.push(".".concat(u))}}const s=["aria-label","type","name","title","alt"];for(const o of s){const c=r.getAttribute(o);c&&n.push("[".concat(o,'="').concat(c,'"]'))}return n.join("")}function d0(){try{return Ol.document.location.href}catch{return""}}function p0(t){if(!Ol.HTMLElement)return null;let e=t;const r=5;for(let n=0;n<r;n++){if(!e)return null;if(e instanceof HTMLElement){if(e.dataset.sentryComponent)return e.dataset.sentryComponent;if(e.dataset.sentryElement)return e.dataset.sentryElement}e=e.parentNode}return null}function tn(t,e=0){return typeof t!="string"||e===0||t.length<=e?t:"".concat(t.slice(0,e),"...")}function gp(t,e){if(!Array.isArray(t))return"";const r=[];for(let n=0;n<t.length;n++){const i=t[n];try{Cv(i)?r.push("[VueViewModel]"):r.push(String(i))}catch{r.push("[value cannot be serialized]")}}return r.join(e)}function h0(t,e,r=!1){return Pt(t)?c0(e)?e.test(t):Pt(e)?r?t===e:t.includes(e):!1:!1}function fa(t,e=[],r=!1){return e.some(n=>h0(t,n,r))}function Ae(t,e,r){if(!(e in t))return;const n=t[e],i=r(n);typeof i=="function"&&Nv(i,n);try{t[e]=i}catch{Br&&$.log('Failed to replace method "'.concat(e,'" in object'),t)}}function Cr(t,e,r){try{Object.defineProperty(t,e,{value:r,writable:!0,configurable:!0})}catch{Br&&$.log('Failed to add non-enumerable property "'.concat(e,'" to object'),t)}}function Nv(t,e){try{const r=e.prototype||{};t.prototype=e.prototype=r,Cr(t,"__sentry_original__",e)}catch{}}function xl(t){return t.__sentry_original__}function jv(t){if(kl(t))return{message:t.message,name:t.name,stack:t.stack,...mp(t)};if(ua(t)){const e={type:t.type,target:vp(t.target),currentTarget:vp(t.currentTarget),...mp(t)};return typeof CustomEvent<"u"&&Dr(t,CustomEvent)&&(e.detail=t.detail),e}else return t}function vp(t){try{return a0(t)?Av(t):Object.prototype.toString.call(t)}catch{return"<unknown>"}}function mp(t){if(typeof t=="object"&&t!==null){const e={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}else return{}}function g0(t,e=40){const r=Object.keys(jv(t));r.sort();const n=r[0];if(!n)return"[object has no keys]";if(n.length>=e)return tn(n,e);for(let i=r.length;i>0;i--){const s=r.slice(0,i).join(", ");if(!(s.length>e))return i===r.length?s:tn(s,e)}return""}function Ge(t){return Zc(t,new Map)}function Zc(t,e){if(v0(t)){const r=e.get(t);if(r!==void 0)return r;const n={};e.set(t,n);for(const i of Object.getOwnPropertyNames(t))typeof t[i]<"u"&&(n[i]=Zc(t[i],e));return n}if(Array.isArray(t)){const r=e.get(t);if(r!==void 0)return r;const n=[];return e.set(t,n),t.forEach(i=>{n.push(Zc(i,e))}),n}return t}function v0(t){if(!Mn(t))return!1;try{const e=Object.getPrototypeOf(t).constructor.name;return!e||e==="Object"}catch{return!0}}const Mv=1e3;function ls(){return Date.now()/Mv}function m0(){const{performance:t}=C;if(!t||!t.now)return ls;const e=Date.now()-t.now(),r=t.timeOrigin==null?e:t.timeOrigin;return()=>(r+t.now())/Mv}const Rt=m0();(()=>{const{performance:t}=C;if(!t||!t.now)return;const e=3600*1e3,r=t.now(),n=Date.now(),i=t.timeOrigin?Math.abs(t.timeOrigin+r-n):e,s=i<e,o=t.timing&&t.timing.navigationStart,u=typeof o=="number"?Math.abs(o+r-n):e,l=u<e;return s||l?i<=u?t.timeOrigin:o:n})();function We(){const t=C,e=t.crypto||t.msCrypto;let r=()=>Math.random()*16;try{if(e&&e.randomUUID)return e.randomUUID().replace(/-/g,"");e&&e.getRandomValues&&(r=()=>{const n=new Uint8Array(1);return e.getRandomValues(n),n[0]})}catch{}return("10000000100040008000"+1e11).replace(/[018]/g,n=>(n^(r()&15)>>n/4).toString(16))}function Fv(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}function Ft(t){const{message:e,event_id:r}=t;if(e)return e;const n=Fv(t);return n?n.type&&n.value?"".concat(n.type,": ").concat(n.value):n.type||n.value||r||"<unknown>":r||"<unknown>"}function Qc(t,e,r){const n=t.exception=t.exception||{},i=n.values=n.values||[],s=i[0]=i[0]||{};s.value||(s.value=e||""),s.type||(s.type="Error")}function Fn(t,e){const r=Fv(t);if(!r)return;const n={type:"generic",handled:!0},i=r.mechanism;if(r.mechanism={...n,...i,...e},e&&"data"in e){const s={...i&&i.data,...e.data};r.mechanism.data=s}}function yp(t){if(y0(t))return!0;try{Cr(t,"__sentry_captured__",!0)}catch{}return!1}function y0(t){try{return t.__sentry_captured__}catch{}}var vt;(function(t){t[t.PENDING=0]="PENDING";const r=1;t[t.RESOLVED=r]="RESOLVED";const n=2;t[t.REJECTED=n]="REJECTED"})(vt||(vt={}));function Ar(t){return new ze(e=>{e(t)})}function Oo(t){return new ze((e,r)=>{r(t)})}class ze{constructor(e){ze.prototype.__init.call(this),ze.prototype.__init2.call(this),ze.prototype.__init3.call(this),ze.prototype.__init4.call(this),this._state=vt.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(r){this._reject(r)}}then(e,r){return new ze((n,i)=>{this._handlers.push([!1,s=>{if(!e)n(s);else try{n(e(s))}catch(o){i(o)}},s=>{if(!r)i(s);else try{n(r(s))}catch(o){i(o)}}]),this._executeHandlers()})}catch(e){return this.then(r=>r,e)}finally(e){return new ze((r,n)=>{let i,s;return this.then(o=>{s=!1,i=o,e&&e()},o=>{s=!0,i=o,e&&e()}).then(()=>{if(s){n(i);return}r(i)})})}__init(){this._resolve=e=>{this._setResult(vt.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(vt.REJECTED,e)}}__init3(){this._setResult=(e,r)=>{if(this._state===vt.PENDING){if(la(r)){r.then(this._resolve,this._reject);return}this._state=e,this._value=r,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===vt.PENDING)return;const e=this._handlers.slice();this._handlers=[],e.forEach(r=>{r[0]||(this._state===vt.RESOLVED&&r[1](this._value),this._state===vt.REJECTED&&r[2](this._value),r[0]=!0)})}}}function S0(t){const e=Rt(),r={sid:We(),init:!0,timestamp:e,started:e,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>_0(r)};return t&&Ln(r,t),r}function Ln(t,e={}){if(e.user&&(!t.ipAddress&&e.user.ip_address&&(t.ipAddress=e.user.ip_address),!t.did&&!e.did&&(t.did=e.user.id||e.user.email||e.user.username)),t.timestamp=e.timestamp||Rt(),e.abnormal_mechanism&&(t.abnormal_mechanism=e.abnormal_mechanism),e.ignoreDuration&&(t.ignoreDuration=e.ignoreDuration),e.sid&&(t.sid=e.sid.length===32?e.sid:We()),e.init!==void 0&&(t.init=e.init),!t.did&&e.did&&(t.did="".concat(e.did)),typeof e.started=="number"&&(t.started=e.started),t.ignoreDuration)t.duration=void 0;else if(typeof e.duration=="number")t.duration=e.duration;else{const r=t.timestamp-t.started;t.duration=r>=0?r:0}e.release&&(t.release=e.release),e.environment&&(t.environment=e.environment),!t.ipAddress&&e.ipAddress&&(t.ipAddress=e.ipAddress),!t.userAgent&&e.userAgent&&(t.userAgent=e.userAgent),typeof e.errors=="number"&&(t.errors=e.errors),e.status&&(t.status=e.status)}function b0(t,e){let r={};t.status==="ok"&&(r={status:"exited"}),Ln(t,r)}function _0(t){return Ge({sid:"".concat(t.sid),init:t.init,started:new Date(t.started*1e3).toISOString(),timestamp:new Date(t.timestamp*1e3).toISOString(),status:t.status,errors:t.errors,did:typeof t.did=="number"||typeof t.did=="string"?"".concat(t.did):void 0,duration:t.duration,abnormal_mechanism:t.abnormal_mechanism,attrs:{release:t.release,environment:t.environment,ip_address:t.ipAddress,user_agent:t.userAgent}})}function Sp(){return We()}function eu(){return We().substring(16)}function da(t,e,r=2){if(!e||typeof e!="object"||r<=0)return e;if(t&&e&&Object.keys(e).length===0)return t;const n={...t};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=da(n[i],e[i],r-1));return n}const tu="_sentrySpan";function bp(t,e){e?Cr(t,tu,e):delete t[tu]}function _p(t){return t[tu]}const E0=100;class Pl{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext={traceId:Sp(),spanId:eu()}}clone(){const e=new Pl;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},this._contexts.flags&&(e._contexts.flags={values:[...this._contexts.flags.values]}),e._user=this._user,e._level=this._level,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e._lastEventId=this._lastEventId,bp(e,_p(this)),e}setClient(e){this._client=e}setLastEventId(e){this._lastEventId=e}getClient(){return this._client}lastEventId(){return this._lastEventId}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,username:void 0},this._session&&Ln(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,r){return this._tags={...this._tags,[e]:r},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,r){return this._extra={...this._extra,[e]:r},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,r){return r===null?delete this._contexts[e]:this._contexts[e]=r,this._notifyScopeListeners(),this}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;const r=typeof e=="function"?e(this):e,[n,i]=r instanceof Nr?[r.getScopeData(),r.getRequestSession()]:Mn(r)?[e,e.requestSession]:[],{tags:s,extra:o,user:c,contexts:u,level:l,fingerprint:f=[],propagationContext:d}=n||{};return this._tags={...this._tags,...s},this._extra={...this._extra,...o},this._contexts={...this._contexts,...u},c&&Object.keys(c).length&&(this._user=c),l&&(this._level=l),f.length&&(this._fingerprint=f),d&&(this._propagationContext=d),i&&(this._requestSession=i),this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._session=void 0,bp(this,void 0),this._attachments=[],this.setPropagationContext({traceId:Sp()}),this._notifyScopeListeners(),this}addBreadcrumb(e,r){const n=typeof r=="number"?r:E0;if(n<=0)return this;const i={timestamp:ls(),...e},s=this._breadcrumbs;return s.push(i),this._breadcrumbs=s.length>n?s.slice(-n):s,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}clearAttachments(){return this._attachments=[],this}getScopeData(){return{breadcrumbs:this._breadcrumbs,attachments:this._attachments,contexts:this._contexts,tags:this._tags,extra:this._extra,user:this._user,level:this._level,fingerprint:this._fingerprint||[],eventProcessors:this._eventProcessors,propagationContext:this._propagationContext,sdkProcessingMetadata:this._sdkProcessingMetadata,transactionName:this._transactionName,span:_p(this)}}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata=da(this._sdkProcessingMetadata,e,2),this}setPropagationContext(e){return this._propagationContext={spanId:eu(),...e},this}getPropagationContext(){return this._propagationContext}captureException(e,r){const n=r&&r.event_id?r.event_id:We();if(!this._client)return $.warn("No client configured on scope - will not capture exception!"),n;const i=new Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:i,...r,event_id:n},this),n}captureMessage(e,r,n){const i=n&&n.event_id?n.event_id:We();if(!this._client)return $.warn("No client configured on scope - will not capture message!"),i;const s=new Error(e);return this._client.captureMessage(e,r,{originalException:e,syntheticException:s,...n,event_id:i},this),i}captureEvent(e,r){const n=r&&r.event_id?r.event_id:We();return this._client?(this._client.captureEvent(e,{...r,event_id:n},this),n):($.warn("No client configured on scope - will not capture event!"),n)}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}const Nr=Pl;function w0(){return aa("defaultCurrentScope",()=>new Nr)}function $0(){return aa("defaultIsolationScope",()=>new Nr)}class k0{constructor(e,r){let n;e?n=e:n=new Nr;let i;r?i=r:i=new Nr,this._stack=[{scope:n}],this._isolationScope=i}withScope(e){const r=this._pushScope();let n;try{n=e(r)}catch(i){throw this._popScope(),i}return la(n)?n.then(i=>(this._popScope(),i),i=>{throw this._popScope(),i}):(this._popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStackTop(){return this._stack[this._stack.length-1]}_pushScope(){const e=this.getScope().clone();return this._stack.push({client:this.getClient(),scope:e}),e}_popScope(){return this._stack.length<=1?!1:!!this._stack.pop()}}function Un(){const t=ca(),e=$l(t);return e.stack=e.stack||new k0(w0(),$0())}function T0(t){return Un().withScope(t)}function I0(t,e){const r=Un();return r.withScope(()=>(r.getStackTop().scope=t,e(t)))}function Ep(t){return Un().withScope(()=>t(Un().getIsolationScope()))}function O0(){return{withIsolationScope:Ep,withScope:T0,withSetScope:I0,withSetIsolationScope:(t,e)=>Ep(e),getCurrentScope:()=>Un().getScope(),getIsolationScope:()=>Un().getIsolationScope()}}function Rl(t){const e=$l(t);return e.acs?e.acs:O0()}function At(){const t=ca();return Rl(t).getCurrentScope()}function fs(){const t=ca();return Rl(t).getIsolationScope()}function x0(){return aa("globalScope",()=>new Nr)}function P0(...t){const e=ca(),r=Rl(e);if(t.length===2){const[n,i]=t;return n?r.withSetScope(n,i):r.withScope(i)}return r.withScope(t[0])}function ce(){return At().getClient()}function R0(t){const e=t.getPropagationContext(),{traceId:r,spanId:n,parentSpanId:i}=e;return Ge({trace_id:r,span_id:n,parent_span_id:i})}const D0="_sentryMetrics";function C0(t){const e=t[D0];if(!e)return;const r={};for(const[,[n,i]]of e)(r[n]||(r[n]=[])).push(Ge(i));return r}const A0="sentry.source",N0="sentry.sample_rate",j0="sentry.op",M0="sentry.origin",F0=0,L0=1,U0="sentry-",B0=/^sentry-/;function z0(t){const e=G0(t);if(!e)return;const r=Object.entries(e).reduce((n,[i,s])=>{if(i.match(B0)){const o=i.slice(U0.length);n[o]=s}return n},{});if(Object.keys(r).length>0)return r}function G0(t){if(!(!t||!Pt(t)&&!Array.isArray(t)))return Array.isArray(t)?t.reduce((e,r)=>{const n=wp(r);return Object.entries(n).forEach(([i,s])=>{e[i]=s}),e},{}):wp(t)}function wp(t){return t.split(",").map(e=>e.split("=").map(r=>decodeURIComponent(r.trim()))).reduce((e,[r,n])=>(r&&n&&(e[r]=n),e),{})}const W0=1;let $p=!1;function H0(t){const{spanId:e,traceId:r,isRemote:n}=t.spanContext(),i=n?e:Dl(t).parent_span_id,s=n?eu():e;return Ge({parent_span_id:i,span_id:s,trace_id:r})}function kp(t){return typeof t=="number"?Tp(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?Tp(t.getTime()):Rt()}function Tp(t){return t>9999999999?t/1e3:t}function Dl(t){if(J0(t))return t.getSpanJSON();try{const{spanId:e,traceId:r}=t.spanContext();if(K0(t)){const{attributes:n,startTime:i,name:s,endTime:o,parentSpanId:c,status:u}=t;return Ge({span_id:e,trace_id:r,data:n,description:s,parent_span_id:c,start_timestamp:kp(i),timestamp:kp(o)||void 0,status:Y0(u),op:n[j0],origin:n[M0],_metrics_summary:C0(t)})}return{span_id:e,trace_id:r}}catch{return{}}}function K0(t){const e=t;return!!e.attributes&&!!e.startTime&&!!e.name&&!!e.endTime&&!!e.status}function J0(t){return typeof t.getSpanJSON=="function"}function V0(t){const{traceFlags:e}=t.spanContext();return e===W0}function Y0(t){if(!(!t||t.code===F0))return t.code===L0?"ok":t.message||"unknown_error"}const q0="_sentryRootSpan";function Lv(t){return t[q0]||t}function X0(){$p||(zr(()=>{console.warn("[Sentry] Deprecation warning: Returning null from `beforeSendSpan` will be disallowed from SDK version 9.0.0 onwards. The callback will only support mutating spans. To drop certain spans, configure the respective integrations directly.")}),$p=!0)}function Z0(t){if(typeof __SENTRY_TRACING__=="boolean"&&!__SENTRY_TRACING__)return!1;const e=ce(),r=e&&e.getOptions();return!!r&&(r.enableTracing||"tracesSampleRate"in r||"tracesSampler"in r)}const Cl="production",Q0="_frozenDsc";function Uv(t,e){const r=e.getOptions(),{publicKey:n}=e.getDsn()||{},i=Ge({environment:r.environment||Cl,release:r.release,public_key:n,trace_id:t});return e.emit("createDsc",i),i}function eD(t,e){const r=e.getPropagationContext();return r.dsc||Uv(r.traceId,t)}function tD(t){const e=ce();if(!e)return{};const r=Lv(t),n=r[Q0];if(n)return n;const i=r.spanContext().traceState,s=i&&i.get("sentry.dsc"),o=s&&z0(s);if(o)return o;const c=Uv(t.spanContext().traceId,e),u=Dl(r),l=u.data||{},f=l[N0];f!=null&&(c.sample_rate="".concat(f));const d=l[A0],p=u.description;return d!=="url"&&p&&(c.transaction=p),Z0()&&(c.sampled=String(V0(r))),e.emit("createDsc",c,r),c}function rD(t){if(typeof t=="boolean")return Number(t);const e=typeof t=="string"?parseFloat(t):t;if(typeof e!="number"||isNaN(e)||e<0||e>1){F&&$.warn("[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ".concat(JSON.stringify(t)," of type ").concat(JSON.stringify(typeof t),"."));return}return e}const nD=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function iD(t){return t==="http"||t==="https"}function pa(t,e=!1){const{host:r,path:n,pass:i,port:s,projectId:o,protocol:c,publicKey:u}=t;return"".concat(c,"://").concat(u).concat(e&&i?":".concat(i):"")+"@".concat(r).concat(s?":".concat(s):"","/").concat(n&&"".concat(n,"/")).concat(o)}function sD(t){const e=nD.exec(t);if(!e){zr(()=>{console.error("Invalid Sentry Dsn: ".concat(t))});return}const[r,n,i="",s="",o="",c=""]=e.slice(1);let u="",l=c;const f=l.split("/");if(f.length>1&&(u=f.slice(0,-1).join("/"),l=f.pop()),l){const d=l.match(/^\d+/);d&&(l=d[0])}return Bv({host:s,pass:i,path:u,projectId:l,port:o,protocol:r,publicKey:n})}function Bv(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}function oD(t){if(!Br)return!0;const{port:e,projectId:r,protocol:n}=t;return["protocol","publicKey","host","projectId"].find(o=>t[o]?!1:($.error("Invalid Sentry Dsn: ".concat(o," missing")),!0))?!1:r.match(/^\d+$/)?iD(n)?e&&isNaN(parseInt(e,10))?($.error("Invalid Sentry Dsn: Invalid port ".concat(e)),!1):!0:($.error("Invalid Sentry Dsn: Invalid protocol ".concat(n)),!1):($.error("Invalid Sentry Dsn: Invalid projectId ".concat(r)),!1)}function aD(t){const e=typeof t=="string"?sD(t):Bv(t);if(!(!e||!oD(e)))return e}function cD(){const t=typeof WeakSet=="function",e=t?new WeakSet:[];function r(i){if(t)return e.has(i)?!0:(e.add(i),!1);for(let s=0;s<e.length;s++)if(e[s]===i)return!0;return e.push(i),!1}function n(i){if(t)e.delete(i);else for(let s=0;s<e.length;s++)if(e[s]===i){e.splice(s,1);break}}return[r,n]}function mt(t,e=100,r=1/0){try{return ru("",t,e,r)}catch(n){return{ERROR:"**non-serializable** (".concat(n,")")}}}function zv(t,e=3,r=100*1024){const n=mt(t,e);return dD(n)>r?zv(t,e-1,r):n}function ru(t,e,r=1/0,n=1/0,i=cD()){const[s,o]=i;if(e==null||["boolean","string"].includes(typeof e)||typeof e=="number"&&Number.isFinite(e))return e;const c=uD(t,e);if(!c.startsWith("[object "))return c;if(e.__sentry_skip_normalization__)return e;const u=typeof e.__sentry_override_normalization_depth__=="number"?e.__sentry_override_normalization_depth__:r;if(u===0)return c.replace("object ","");if(s(e))return"[Circular ~]";const l=e;if(l&&typeof l.toJSON=="function")try{const h=l.toJSON();return ru("",h,u-1,n,i)}catch{}const f=Array.isArray(e)?[]:{};let d=0;const p=jv(e);for(const h in p){if(!Object.prototype.hasOwnProperty.call(p,h))continue;if(d>=n){f[h]="[MaxProperties ~]";break}const y=p[h];f[h]=ru(h,y,u-1,n,i),d++}return o(e),f}function uD(t,e){try{if(t==="domain"&&e&&typeof e=="object"&&e._events)return"[Domain]";if(t==="domainEmitter")return"[DomainEmitter]";if(typeof global<"u"&&e===global)return"[Global]";if(typeof window<"u"&&e===window)return"[Window]";if(typeof document<"u"&&e===document)return"[Document]";if(Cv(e))return"[VueViewModel]";if(u0(e))return"[SyntheticEvent]";if(typeof e=="number"&&!Number.isFinite(e))return"[".concat(e,"]");if(typeof e=="function")return"[Function: ".concat(sr(e),"]");if(typeof e=="symbol")return"[".concat(String(e),"]");if(typeof e=="bigint")return"[BigInt: ".concat(String(e),"]");const r=lD(e);return/^HTML(\w*)Element$/.test(r)?"[HTMLElement: ".concat(r,"]"):"[object ".concat(r,"]")}catch(r){return"**non-serializable** (".concat(r,")")}}function lD(t){const e=Object.getPrototypeOf(t);return e?e.constructor.name:"null prototype"}function fD(t){return~-encodeURI(t).split(/%..|./).length}function dD(t){return fD(JSON.stringify(t))}function ds(t,e=[]){return[t,e]}function pD(t,e){const[r,n]=t;return[r,[...n,e]]}function Ip(t,e){const r=t[1];for(const n of r){const i=n[0].type;if(e(n,i))return!0}return!1}function nu(t){return C.__SENTRY__&&C.__SENTRY__.encodePolyfill?C.__SENTRY__.encodePolyfill(t):new TextEncoder().encode(t)}function hD(t){const[e,r]=t;let n=JSON.stringify(e);function i(s){typeof n=="string"?n=typeof s=="string"?n+s:[nu(n),s]:n.push(typeof s=="string"?nu(s):s)}for(const s of r){const[o,c]=s;if(i("\n".concat(JSON.stringify(o),"\n")),typeof c=="string"||c instanceof Uint8Array)i(c);else{let u;try{u=JSON.stringify(c)}catch{u=JSON.stringify(mt(c))}i(u)}}return typeof n=="string"?n:gD(n)}function gD(t){const e=t.reduce((i,s)=>i+s.length,0),r=new Uint8Array(e);let n=0;for(const i of t)r.set(i,n),n+=i.length;return r}function vD(t){const e=typeof t.data=="string"?nu(t.data):t.data;return[Ge({type:"attachment",length:e.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),e]}const mD={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",profile_chunk:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket",raw_security:"security"};function Op(t){return mD[t]}function Gv(t){if(!t||!t.sdk)return;const{name:e,version:r}=t.sdk;return{name:e,version:r}}function yD(t,e,r,n){const i=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...e&&{sdk:e},...!!r&&n&&{dsn:pa(n)},...i&&{trace:Ge({...i})}}}function SD(t,e){return e&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||e.name,t.sdk.version=t.sdk.version||e.version,t.sdk.integrations=[...t.sdk.integrations||[],...e.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...e.packages||[]]),t}function bD(t,e,r,n){const i=Gv(r),s={sent_at:new Date().toISOString(),...i&&{sdk:i},...!!n&&e&&{dsn:pa(e)}},o="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return ds(s,[o])}function _D(t,e,r,n){const i=Gv(r),s=t.type&&t.type!=="replay_event"?t.type:"event";SD(t,r&&r.sdk);const o=yD(t,i,n,e);return delete t.sdkProcessingMetadata,ds(o,[[{type:s},t]])}function iu(t,e,r,n=0){return new ze((i,s)=>{const o=t[n];if(e===null||typeof o!="function")i(e);else{const c=o({...e},r);F&&o.id&&c===null&&$.log('Event processor "'.concat(o.id,'" dropped event')),la(c)?c.then(u=>iu(t,u,r,n+1).then(i)).then(null,s):iu(t,c,r,n+1).then(i).then(null,s)}})}let Bs,xp,zs;function ED(t){const e=C._sentryDebugIds;if(!e)return{};const r=Object.keys(e);return zs&&r.length===xp||(xp=r.length,zs=r.reduce((n,i)=>{Bs||(Bs={});const s=Bs[i];if(s)n[s[0]]=s[1];else{const o=t(i);for(let c=o.length-1;c>=0;c--){const u=o[c],l=u&&u.filename,f=e[i];if(l&&f){n[l]=f,Bs[i]=[l,f];break}}}return n},{})),zs}function wD(t,e){const{fingerprint:r,span:n,breadcrumbs:i,sdkProcessingMetadata:s}=e;$D(t,e),n&&ID(t,n),OD(t,r),kD(t,i),TD(t,s)}function Pp(t,e){const{extra:r,tags:n,user:i,contexts:s,level:o,sdkProcessingMetadata:c,breadcrumbs:u,fingerprint:l,eventProcessors:f,attachments:d,propagationContext:p,transactionName:h,span:y}=e;Gs(t,"extra",r),Gs(t,"tags",n),Gs(t,"user",i),Gs(t,"contexts",s),t.sdkProcessingMetadata=da(t.sdkProcessingMetadata,c,2),o&&(t.level=o),h&&(t.transactionName=h),y&&(t.span=y),u.length&&(t.breadcrumbs=[...t.breadcrumbs,...u]),l.length&&(t.fingerprint=[...t.fingerprint,...l]),f.length&&(t.eventProcessors=[...t.eventProcessors,...f]),d.length&&(t.attachments=[...t.attachments,...d]),t.propagationContext={...t.propagationContext,...p}}function Gs(t,e,r){t[e]=da(t[e],r,1)}function $D(t,e){const{extra:r,tags:n,user:i,contexts:s,level:o,transactionName:c}=e,u=Ge(r);u&&Object.keys(u).length&&(t.extra={...u,...t.extra});const l=Ge(n);l&&Object.keys(l).length&&(t.tags={...l,...t.tags});const f=Ge(i);f&&Object.keys(f).length&&(t.user={...f,...t.user});const d=Ge(s);d&&Object.keys(d).length&&(t.contexts={...d,...t.contexts}),o&&(t.level=o),c&&t.type!=="transaction"&&(t.transaction=c)}function kD(t,e){const r=[...t.breadcrumbs||[],...e];t.breadcrumbs=r.length?r:void 0}function TD(t,e){t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...e}}function ID(t,e){t.contexts={trace:H0(e),...t.contexts},t.sdkProcessingMetadata={dynamicSamplingContext:tD(e),...t.sdkProcessingMetadata};const r=Lv(e),n=Dl(r).description;n&&!t.transaction&&t.type==="transaction"&&(t.transaction=n)}function OD(t,e){t.fingerprint=t.fingerprint?Array.isArray(t.fingerprint)?t.fingerprint:[t.fingerprint]:[],e&&(t.fingerprint=t.fingerprint.concat(e)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint}function xD(t,e,r,n,i,s){const{normalizeDepth:o=3,normalizeMaxBreadth:c=1e3}=t,u={...e,event_id:e.event_id||r.event_id||We(),timestamp:e.timestamp||ls()},l=r.integrations||t.integrations.map(k=>k.name);PD(u,t),CD(u,l),i&&i.emit("applyFrameMetadata",e),e.type===void 0&&RD(u,t.stackParser);const f=ND(n,r.captureContext);r.mechanism&&Fn(u,r.mechanism);const d=i?i.getEventProcessors():[],p=x0().getScopeData();if(s){const k=s.getScopeData();Pp(p,k)}if(f){const k=f.getScopeData();Pp(p,k)}const h=[...r.attachments||[],...p.attachments];h.length&&(r.attachments=h),wD(u,p);const y=[...d,...p.eventProcessors];return iu(y,u,r).then(k=>(k&&DD(k),typeof o=="number"&&o>0?AD(k,o,c):k))}function PD(t,e){const{environment:r,release:n,dist:i,maxValueLength:s=250}=e;t.environment=t.environment||r||Cl,!t.release&&n&&(t.release=n),!t.dist&&i&&(t.dist=i),t.message&&(t.message=tn(t.message,s));const o=t.exception&&t.exception.values&&t.exception.values[0];o&&o.value&&(o.value=tn(o.value,s));const c=t.request;c&&c.url&&(c.url=tn(c.url,s))}function RD(t,e){const r=ED(e);try{t.exception.values.forEach(n=>{n.stacktrace.frames.forEach(i=>{r&&i.filename&&(i.debug_id=r[i.filename])})})}catch{}}function DD(t){const e={};try{t.exception.values.forEach(n=>{n.stacktrace.frames.forEach(i=>{i.debug_id&&(i.abs_path?e[i.abs_path]=i.debug_id:i.filename&&(e[i.filename]=i.debug_id),delete i.debug_id)})})}catch{}if(Object.keys(e).length===0)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];const r=t.debug_meta.images;Object.entries(e).forEach(([n,i])=>{r.push({type:"sourcemap",code_file:n,debug_id:i})})}function CD(t,e){e.length>0&&(t.sdk=t.sdk||{},t.sdk.integrations=[...t.sdk.integrations||[],...e])}function AD(t,e,r){if(!t)return null;const n={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(i=>({...i,...i.data&&{data:mt(i.data,e,r)}}))},...t.user&&{user:mt(t.user,e,r)},...t.contexts&&{contexts:mt(t.contexts,e,r)},...t.extra&&{extra:mt(t.extra,e,r)}};return t.contexts&&t.contexts.trace&&n.contexts&&(n.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(n.contexts.trace.data=mt(t.contexts.trace.data,e,r))),t.spans&&(n.spans=t.spans.map(i=>({...i,...i.data&&{data:mt(i.data,e,r)}}))),t.contexts&&t.contexts.flags&&n.contexts&&(n.contexts.flags=mt(t.contexts.flags,3,r)),n}function ND(t,e){if(!e)return t;const r=t?t.clone():new Nr;return r.update(e),r}function jD(t,e){return At().captureException(t,void 0)}function Al(t,e){return At().captureEvent(t,e)}function Rp(t){const e=ce(),r=fs(),n=At(),{release:i,environment:s=Cl}=e&&e.getOptions()||{},{userAgent:o}=C.navigator||{},c=S0({release:i,environment:s,user:n.getUser()||r.getUser(),...o&&{userAgent:o},...t}),u=r.getSession();return u&&u.status==="ok"&&Ln(u,{status:"exited"}),Wv(),r.setSession(c),n.setSession(c),c}function Wv(){const t=fs(),e=At(),r=e.getSession()||t.getSession();r&&b0(r),Hv(),t.setSession(),e.setSession()}function Hv(){const t=fs(),e=At(),r=ce(),n=e.getSession()||t.getSession();n&&r&&r.captureSession(n)}function Dp(t=!1){if(t){Wv();return}Hv()}const MD="7";function FD(t){const e=t.protocol?"".concat(t.protocol,":"):"",r=t.port?":".concat(t.port):"";return"".concat(e,"//").concat(t.host).concat(r).concat(t.path?"/".concat(t.path):"","/api/")}function LD(t){return"".concat(FD(t)).concat(t.projectId,"/envelope/")}function UD(t,e){const r={sentry_version:MD};return t.publicKey&&(r.sentry_key=t.publicKey),e&&(r.sentry_client="".concat(e.name,"/").concat(e.version)),new URLSearchParams(r).toString()}function BD(t,e,r){return e||"".concat(LD(t),"?").concat(UD(t,r))}const Cp=[];function zD(t){const e={};return t.forEach(r=>{const{name:n}=r,i=e[n];i&&!i.isDefaultInstance&&r.isDefaultInstance||(e[n]=r)}),Object.values(e)}function GD(t){const e=t.defaultIntegrations||[],r=t.integrations;e.forEach(o=>{o.isDefaultInstance=!0});let n;if(Array.isArray(r))n=[...e,...r];else if(typeof r=="function"){const o=r(e);n=Array.isArray(o)?o:[o]}else n=e;const i=zD(n),s=i.findIndex(o=>o.name==="Debug");if(s>-1){const[o]=i.splice(s,1);i.push(o)}return i}function WD(t,e){const r={};return e.forEach(n=>{n&&Kv(t,n,r)}),r}function Ap(t,e){for(const r of e)r&&r.afterAllSetup&&r.afterAllSetup(t)}function Kv(t,e,r){if(r[e.name]){F&&$.log("Integration skipped because it was already installed: ".concat(e.name));return}if(r[e.name]=e,Cp.indexOf(e.name)===-1&&typeof e.setupOnce=="function"&&(e.setupOnce(),Cp.push(e.name)),e.setup&&typeof e.setup=="function"&&e.setup(t),typeof e.preprocessEvent=="function"){const n=e.preprocessEvent.bind(e);t.on("preprocessEvent",(i,s)=>n(i,s,t))}if(typeof e.processEvent=="function"){const n=e.processEvent.bind(e),i=Object.assign((s,o)=>n(s,o,t),{id:e.name});t.addEventProcessor(i)}F&&$.log("Integration installed: ".concat(e.name))}function HD(t,e,r){const n=[{type:"client_report"},{timestamp:ls(),discarded_events:t}];return ds(e?{dsn:e}:{},[n])}class ut extends Error{constructor(e,r="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=r}}const Np="Not capturing exception because it's already been captured.";class KD{constructor(e){if(this._options=e,this._integrations={},this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=aD(e.dsn):F&&$.warn("No DSN provided, client will not send events."),this._dsn){const i=BD(this._dsn,e.tunnel,e._metadata?e._metadata.sdk:void 0);this._transport=e.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:i})}const n=["enableTracing","tracesSampleRate","tracesSampler"].find(i=>i in e&&e[i]==null);n&&zr(()=>{console.warn("[Sentry] Deprecation warning: `".concat(n,"` is set to undefined, which leads to tracing being enabled. In v9, a value of `undefined` will result in tracing being disabled."))})}captureException(e,r,n){const i=We();if(yp(e))return F&&$.log(Np),i;const s={event_id:i,...r};return this._process(this.eventFromException(e,s).then(o=>this._captureEvent(o,s,n))),s.event_id}captureMessage(e,r,n,i){const s={event_id:We(),...n},o=Tl(e)?e:String(e),c=Il(e)?this.eventFromMessage(o,r,s):this.eventFromException(e,s);return this._process(c.then(u=>this._captureEvent(u,s,i))),s.event_id}captureEvent(e,r,n){const i=We();if(r&&r.originalException&&yp(r.originalException))return F&&$.log(Np),i;const s={event_id:i,...r},c=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,s,c||n)),s.event_id}captureSession(e){typeof e.release!="string"?F&&$.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),Ln(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){const r=this._transport;return r?(this.emit("flush"),this._isClientDoneProcessing(e).then(n=>r.flush(e).then(i=>n&&i))):Ar(!0)}close(e){return this.flush(e).then(r=>(this.getOptions().enabled=!1,this.emit("close"),r))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}init(){(this._isEnabled()||this._options.integrations.some(({name:e})=>e.startsWith("Spotlight")))&&this._setupIntegrations()}getIntegrationByName(e){return this._integrations[e]}addIntegration(e){const r=this._integrations[e.name];Kv(this,e,this._integrations),r||Ap(this,[e])}sendEvent(e,r={}){this.emit("beforeSendEvent",e,r);let n=_D(e,this._dsn,this._options._metadata,this._options.tunnel);for(const s of r.attachments||[])n=pD(n,vD(s));const i=this.sendEnvelope(n);i&&i.then(s=>this.emit("afterSendEvent",e,s),null)}sendSession(e){const r=bD(e,this._dsn,this._options._metadata,this._options.tunnel);this.sendEnvelope(r)}recordDroppedEvent(e,r,n){if(this._options.sendClientReports){const i=typeof n=="number"?n:1,s="".concat(e,":").concat(r);F&&$.log('Recording outcome: "'.concat(s,'"').concat(i>1?" (".concat(i," times)"):"")),this._outcomes[s]=(this._outcomes[s]||0)+i}}on(e,r){const n=this._hooks[e]=this._hooks[e]||[];return n.push(r),()=>{const i=n.indexOf(r);i>-1&&n.splice(i,1)}}emit(e,...r){const n=this._hooks[e];n&&n.forEach(i=>i(...r))}sendEnvelope(e){return this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport?this._transport.send(e).then(null,r=>(F&&$.error("Error while sending envelope:",r),r)):(F&&$.error("Transport disabled"),Ar({}))}_setupIntegrations(){const{integrations:e}=this._options;this._integrations=WD(this,e),Ap(this,e)}_updateSessionFromEvent(e,r){let n=!1,i=!1;const s=r.exception&&r.exception.values;if(s){i=!0;for(const u of s){const l=u.mechanism;if(l&&l.handled===!1){n=!0;break}}}const o=e.status==="ok";(o&&e.errors===0||o&&n)&&(Ln(e,{...n&&{status:"crashed"},errors:e.errors||Number(i||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new ze(r=>{let n=0;const i=1,s=setInterval(()=>{this._numProcessing==0?(clearInterval(s),r(!0)):(n+=i,e&&n>=e&&(clearInterval(s),r(!1)))},i)})}_isEnabled(){return this.getOptions().enabled!==!1&&this._transport!==void 0}_prepareEvent(e,r,n=At(),i=fs()){const s=this.getOptions(),o=Object.keys(this._integrations);return!r.integrations&&o.length>0&&(r.integrations=o),this.emit("preprocessEvent",e,r),e.type||i.setLastEventId(e.event_id||r.event_id),xD(s,e,r,n,this,i).then(c=>{if(c===null)return c;c.contexts={trace:R0(n),...c.contexts};const u=eD(this,n);return c.sdkProcessingMetadata={dynamicSamplingContext:u,...c.sdkProcessingMetadata},c})}_captureEvent(e,r={},n){return this._processEvent(e,r,n).then(i=>i.event_id,i=>{if(F){const s=i;s.logLevel==="log"?$.log(s.message):$.warn(s)}})}_processEvent(e,r,n){const i=this.getOptions(),{sampleRate:s}=i,o=Vv(e),c=Jv(e),u=e.type||"error",l="before send for type `".concat(u,"`"),f=typeof s>"u"?void 0:rD(s);if(c&&typeof f=="number"&&Math.random()>f)return this.recordDroppedEvent("sample_rate","error",e),Oo(new ut("Discarding event because it's not included in the random sample (sampling rate = ".concat(s,")"),"log"));const d=u==="replay_event"?"replay":u,h=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,r,n,h).then(y=>{if(y===null)throw this.recordDroppedEvent("event_processor",d,e),new ut("An event processor returned `null`, will not send event.","log");if(r.data&&r.data.__sentry__===!0)return y;const k=VD(this,i,y,r);return JD(k,l)}).then(y=>{if(y===null){if(this.recordDroppedEvent("before_send",d,e),o){const O=1+(e.spans||[]).length;this.recordDroppedEvent("before_send","span",O)}throw new ut("".concat(l," returned `null`, will not send event."),"log")}const _=n&&n.getSession();if(!o&&_&&this._updateSessionFromEvent(_,y),o){const T=y.sdkProcessingMetadata&&y.sdkProcessingMetadata.spanCountBeforeProcessing||0,O=y.spans?y.spans.length:0,re=T-O;re>0&&this.recordDroppedEvent("before_send","span",re)}const k=y.transaction_info;if(o&&k&&y.transaction!==e.transaction){const T="custom";y.transaction_info={...k,source:T}}return this.sendEvent(y,r),y}).then(null,y=>{throw y instanceof ut?y:(this.captureException(y,{data:{__sentry__:!0},originalException:y}),new ut("Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.\nReason: ".concat(y)))})}_process(e){this._numProcessing++,e.then(r=>(this._numProcessing--,r),r=>(this._numProcessing--,r))}_clearOutcomes(){const e=this._outcomes;return this._outcomes={},Object.entries(e).map(([r,n])=>{const[i,s]=r.split(":");return{reason:i,category:s,quantity:n}})}_flushOutcomes(){F&&$.log("Flushing outcomes...");const e=this._clearOutcomes();if(e.length===0){F&&$.log("No outcomes to send");return}if(!this._dsn){F&&$.log("No dsn provided, will not send outcomes");return}F&&$.log("Sending outcomes:",e);const r=HD(e,this._options.tunnel&&pa(this._dsn));this.sendEnvelope(r)}}function JD(t,e){const r="".concat(e," must return `null` or a valid event.");if(la(t))return t.then(n=>{if(!Mn(n)&&n!==null)throw new ut(r);return n},n=>{throw new ut("".concat(e," rejected with ").concat(n))});if(!Mn(t)&&t!==null)throw new ut(r);return t}function VD(t,e,r,n){const{beforeSend:i,beforeSendTransaction:s,beforeSendSpan:o}=e;if(Jv(r)&&i)return i(r,n);if(Vv(r)){if(r.spans&&o){const c=[];for(const u of r.spans){const l=o(u);l?c.push(l):(X0(),t.recordDroppedEvent("before_send","span"))}r.spans=c}if(s){if(r.spans){const c=r.spans.length;r.sdkProcessingMetadata={...r.sdkProcessingMetadata,spanCountBeforeProcessing:c}}return s(r,n)}}return r}function Jv(t){return t.type===void 0}function Vv(t){return t.type==="transaction"}function YD(t,e){e.debug===!0&&(F?$.enable():zr(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),At().update(e.initialScope);const n=new t(e);return qD(n),n.init(),n}function qD(t){At().setClient(t)}function XD(t){const e=[];function r(){return t===void 0||e.length<t}function n(o){return e.splice(e.indexOf(o),1)[0]||Promise.resolve(void 0)}function i(o){if(!r())return Oo(new ut("Not adding Promise because buffer limit was reached."));const c=o();return e.indexOf(c)===-1&&e.push(c),c.then(()=>n(c)).then(null,()=>n(c).then(null,()=>{})),c}function s(o){return new ze((c,u)=>{let l=e.length;if(!l)return c(!0);const f=setTimeout(()=>{o&&o>0&&c(!1)},o);e.forEach(d=>{Ar(d).then(()=>{--l||(clearTimeout(f),c(!0))},u)})})}return{$:e,add:i,drain:s}}const ZD=60*1e3;function QD(t,e=Date.now()){const r=parseInt("".concat(t),10);if(!isNaN(r))return r*1e3;const n=Date.parse("".concat(t));return isNaN(n)?ZD:n-e}function eC(t,e){return t[e]||t.all||0}function tC(t,e,r=Date.now()){return eC(t,e)>r}function rC(t,{statusCode:e,headers:r},n=Date.now()){const i={...t},s=r&&r["x-sentry-rate-limits"],o=r&&r["retry-after"];if(s)for(const c of s.trim().split(",")){const[u,l,,,f]=c.split(":",5),d=parseInt(u,10),p=(isNaN(d)?60:d)*1e3;if(!l)i.all=n+p;else for(const h of l.split(";"))h==="metric_bucket"?(!f||f.split(";").includes("custom"))&&(i[h]=n+p):i[h]=n+p}else o?i.all=n+QD(o,n):e===429&&(i.all=n+60*1e3);return i}const nC=64;function iC(t,e,r=XD(t.bufferSize||nC)){let n={};const i=o=>r.drain(o);function s(o){const c=[];if(Ip(o,(d,p)=>{const h=Op(p);if(tC(n,h)){const y=jp(d,p);t.recordDroppedEvent("ratelimit_backoff",h,y)}else c.push(d)}),c.length===0)return Ar({});const u=ds(o[0],c),l=d=>{Ip(u,(p,h)=>{const y=jp(p,h);t.recordDroppedEvent(d,Op(h),y)})},f=()=>e({body:hD(u)}).then(d=>(d.statusCode!==void 0&&(d.statusCode<200||d.statusCode>=300)&&F&&$.warn("Sentry responded with status code ".concat(d.statusCode," to sent event.")),n=rC(n,d),d),d=>{throw l("network_error"),d});return r.add(f).then(d=>d,d=>{if(d instanceof ut)return F&&$.error("Skipped sending event because buffer is full."),l("queue_overflow"),Ar({});throw d})}return{send:s,flush:i}}function jp(t,e){if(!(e!=="event"&&e!=="transaction"))return Array.isArray(t)?t[1]:void 0}function sC(t,e,r=[e],n="npm"){const i=t._metadata||{};i.sdk||(i.sdk={name:"sentry.javascript.".concat(e),packages:r.map(s=>({name:"".concat(n,":@sentry/").concat(s),version:Ir})),version:Ir}),t._metadata=i}const oC=100;function jr(t,e){const r=ce(),n=fs();if(!r)return;const{beforeBreadcrumb:i=null,maxBreadcrumbs:s=oC}=r.getOptions();if(s<=0)return;const c={timestamp:ls(),...t},u=i?zr(()=>i(c,e)):c;u!==null&&(r.emit&&r.emit("beforeAddBreadcrumb",u,e),n.addBreadcrumb(u,s))}let Mp;const aC="FunctionToString",Fp=new WeakMap,cC=()=>({name:aC,setupOnce(){Mp=Function.prototype.toString;try{Function.prototype.toString=function(...t){const e=xl(this),r=Fp.has(ce())&&e!==void 0?e:this;return Mp.apply(r,t)}}catch{}},setup(t){Fp.set(t,!0)}}),uC=cC,lC=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/,"undefined is not an object (evaluating 'a.L')",'can\'t redefine non-configurable property "solana"',"vv().getRestrictions is not a function. (In 'vv().getRestrictions(1,a)', 'vv().getRestrictions' is undefined)","Can't find variable: _AutofillCallbackHandler",/^Non-Error promise rejection captured with value: Object Not Found Matching Id:\d+, MethodName:simulateEvent, ParamCount:\d+$/],fC="InboundFilters",dC=(t={})=>({name:fC,processEvent(e,r,n){const i=n.getOptions(),s=hC(t,i);return gC(e,s)?null:e}}),pC=dC;function hC(t={},e={}){return{allowUrls:[...t.allowUrls||[],...e.allowUrls||[]],denyUrls:[...t.denyUrls||[],...e.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...e.ignoreErrors||[],...t.disableErrorDefaults?[]:lC],ignoreTransactions:[...t.ignoreTransactions||[],...e.ignoreTransactions||[]],ignoreInternal:t.ignoreInternal!==void 0?t.ignoreInternal:!0}}function gC(t,e){return e.ignoreInternal&&_C(t)?(F&&$.warn("Event dropped due to being internal Sentry Error.\nEvent: ".concat(Ft(t))),!0):vC(t,e.ignoreErrors)?(F&&$.warn("Event dropped due to being matched by `ignoreErrors` option.\nEvent: ".concat(Ft(t))),!0):wC(t)?(F&&$.warn("Event dropped due to not having an error message, error type or stacktrace.\nEvent: ".concat(Ft(t))),!0):mC(t,e.ignoreTransactions)?(F&&$.warn("Event dropped due to being matched by `ignoreTransactions` option.\nEvent: ".concat(Ft(t))),!0):yC(t,e.denyUrls)?(F&&$.warn("Event dropped due to being matched by `denyUrls` option.\nEvent: ".concat(Ft(t),".\nUrl: ").concat(xo(t))),!0):SC(t,e.allowUrls)?!1:(F&&$.warn("Event dropped due to not being matched by `allowUrls` option.\nEvent: ".concat(Ft(t),".\nUrl: ").concat(xo(t))),!0)}function vC(t,e){return t.type||!e||!e.length?!1:bC(t).some(r=>fa(r,e))}function mC(t,e){if(t.type!=="transaction"||!e||!e.length)return!1;const r=t.transaction;return r?fa(r,e):!1}function yC(t,e){if(!e||!e.length)return!1;const r=xo(t);return r?fa(r,e):!1}function SC(t,e){if(!e||!e.length)return!0;const r=xo(t);return r?fa(r,e):!0}function bC(t){const e=[];t.message&&e.push(t.message);let r;try{r=t.exception.values[t.exception.values.length-1]}catch{}return r&&r.value&&(e.push(r.value),r.type&&e.push("".concat(r.type,": ").concat(r.value))),e}function _C(t){try{return t.exception.values[0].type==="SentryError"}catch{}return!1}function EC(t=[]){for(let e=t.length-1;e>=0;e--){const r=t[e];if(r&&r.filename!=="<anonymous>"&&r.filename!=="[native code]")return r.filename||null}return null}function xo(t){try{let e;try{e=t.exception.values[0].stacktrace.frames}catch{}return e?EC(e):null}catch{return F&&$.error("Cannot extract url for event ".concat(Ft(t))),null}}function wC(t){return t.type||!t.exception||!t.exception.values||t.exception.values.length===0?!1:!t.message&&!t.exception.values.some(e=>e.stacktrace||e.type&&e.type!=="Error"||e.value)}function $C(t,e,r=250,n,i,s,o){if(!s.exception||!s.exception.values||!o||!Dr(o.originalException,Error))return;const c=s.exception.values.length>0?s.exception.values[s.exception.values.length-1]:void 0;c&&(s.exception.values=kC(su(t,e,i,o.originalException,n,s.exception.values,c,0),r))}function su(t,e,r,n,i,s,o,c){if(s.length>=r+1)return s;let u=[...s];if(Dr(n[i],Error)){Lp(o,c);const l=t(e,n[i]),f=u.length;Up(l,i,f,c),u=su(t,e,r,n[i],i,[l,...u],l,f)}return Array.isArray(n.errors)&&n.errors.forEach((l,f)=>{if(Dr(l,Error)){Lp(o,c);const d=t(e,l),p=u.length;Up(d,"errors[".concat(f,"]"),p,c),u=su(t,e,r,l,i,[d,...u],d,p)}}),u}function Lp(t,e){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,...t.type==="AggregateError"&&{is_exception_group:!0},exception_id:e}}function Up(t,e,r,n){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:e,exception_id:r,parent_id:n}}function kC(t,e){return t.map(r=>(r.value&&(r.value=tn(r.value,e)),r))}function pc(t){if(!t)return{};const e=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!e)return{};const r=e[6]||"",n=e[8]||"";return{host:e[4],path:e[5],protocol:e[2],search:r,hash:n,relative:e[5]+r+n}}function TC(t){const e="console";Gr(e,t),Wr(e,IC)}function IC(){"console"in C&&Xc.forEach(function(t){t in C.console&&Ae(C.console,t,function(e){return Io[t]=e,function(...r){rt("console",{args:r,level:t});const i=Io[t];i&&i.apply(C.console,r)}})})}function OC(t){return t==="warn"?"warning":["fatal","error","warning","log","info","debug"].includes(t)?t:"log"}const xC="Dedupe",PC=()=>{let t;return{name:xC,processEvent(e){if(e.type)return e;try{if(DC(e,t))return F&&$.warn("Event dropped due to being a duplicate of previously captured event."),null}catch{}return t=e}}},RC=PC;function DC(t,e){return e?!!(CC(t,e)||AC(t,e)):!1}function CC(t,e){const r=t.message,n=e.message;return!(!r&&!n||r&&!n||!r&&n||r!==n||!qv(t,e)||!Yv(t,e))}function AC(t,e){const r=Bp(e),n=Bp(t);return!(!r||!n||r.type!==n.type||r.value!==n.value||!qv(t,e)||!Yv(t,e))}function Yv(t,e){let r=dp(t),n=dp(e);if(!r&&!n)return!0;if(r&&!n||!r&&n||(r=r,n=n,n.length!==r.length))return!1;for(let i=0;i<n.length;i++){const s=n[i],o=r[i];if(s.filename!==o.filename||s.lineno!==o.lineno||s.colno!==o.colno||s.function!==o.function)return!1}return!0}function qv(t,e){let r=t.fingerprint,n=e.fingerprint;if(!r&&!n)return!0;if(r&&!n||!r&&n)return!1;r=r,n=n;try{return r.join("")===n.join("")}catch{return!1}}function Bp(t){return t.exception&&t.exception.values&&t.exception.values[0]}function Xv(t){if(t!==void 0)return t>=400&&t<500?"warning":t>=500?"error":void 0}const ou=C;function Zv(){if(!("fetch"in ou))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch{return!1}}function au(t){return t&&/^function\s+\w+\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}function NC(){if(typeof EdgeRuntime=="string")return!0;if(!Zv())return!1;if(au(ou.fetch))return!0;let t=!1;const e=ou.document;if(e&&typeof e.createElement=="function")try{const r=e.createElement("iframe");r.hidden=!0,e.head.appendChild(r),r.contentWindow&&r.contentWindow.fetch&&(t=au(r.contentWindow.fetch)),e.head.removeChild(r)}catch(r){Br&&$.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",r)}return t}function jC(t,e){const r="fetch";Gr(r,t),Wr(r,()=>MC(void 0,e))}function MC(t,e=!1){e&&!NC()||Ae(C,"fetch",function(r){return function(...n){const i=new Error,{method:s,url:o}=FC(n),c={args:n,fetchData:{method:s,url:o},startTimestamp:Rt()*1e3,virtualError:i};return rt("fetch",{...c}),r.apply(C,n).then(async u=>(rt("fetch",{...c,endTimestamp:Rt()*1e3,response:u}),u),u=>{throw rt("fetch",{...c,endTimestamp:Rt()*1e3,error:u}),kl(u)&&u.stack===void 0&&(u.stack=i.stack,Cr(u,"framesToPop",1)),u})}})}function cu(t,e){return!!t&&typeof t=="object"&&!!t[e]}function zp(t){return typeof t=="string"?t:t?cu(t,"url")?t.url:t.toString?t.toString():"":""}function FC(t){if(t.length===0)return{method:"GET",url:""};if(t.length===2){const[r,n]=t;return{url:zp(r),method:cu(n,"method")?String(n.method).toUpperCase():"GET"}}const e=t[0];return{url:zp(e),method:cu(e,"method")?String(e.method).toUpperCase():"GET"}}function LC(){return"npm"}const Ws=C;function UC(){const t=Ws.chrome,e=t&&t.app&&t.app.runtime,r="history"in Ws&&!!Ws.history.pushState&&!!Ws.history.replaceState;return!e&&r}const L=C;let uu=0;function Qv(){return uu>0}function BC(){uu++,setTimeout(()=>{uu--})}function Bn(t,e={}){function r(i){return typeof i=="function"}if(!r(t))return t;try{const i=t.__sentry_wrapped__;if(i)return typeof i=="function"?i:t;if(xl(t))return t}catch{return t}const n=function(...i){try{const s=i.map(o=>Bn(o,e));return t.apply(this,s)}catch(s){throw BC(),P0(o=>{o.addEventProcessor(c=>(e.mechanism&&(Qc(c,void 0),Fn(c,e.mechanism)),c.extra={...c.extra,arguments:i},c)),jD(s)}),s}};try{for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}catch{}Nv(n,t),Cr(t,"__sentry_wrapped__",n);try{Object.getOwnPropertyDescriptor(n,"name").configurable&&Object.defineProperty(n,"name",{get(){return t.name}})}catch{}return n}const ps=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__;function Nl(t,e){const r=jl(t,e),n={type:KC(e),value:JC(e)};return r.length&&(n.stacktrace={frames:r}),n.type===void 0&&n.value===""&&(n.value="Unrecoverable error caught"),n}function zC(t,e,r,n){const i=ce(),s=i&&i.getOptions().normalizeDepth,o=ZC(e),c={__serialized__:zv(e,s)};if(o)return{exception:{values:[Nl(t,o)]},extra:c};const u={exception:{values:[{type:ua(e)?e.constructor.name:n?"UnhandledRejection":"Error",value:qC(e,{isUnhandledRejection:n})}]},extra:c};if(r){const l=jl(t,r);l.length&&(u.exception.values[0].stacktrace={frames:l})}return u}function hc(t,e){return{exception:{values:[Nl(t,e)]}}}function jl(t,e){const r=e.stacktrace||e.stack||"",n=WC(e),i=HC(e);try{return t(r,n,i)}catch{}return[]}const GC=/Minified React error #\d+;/i;function WC(t){return t&&GC.test(t.message)?1:0}function HC(t){return typeof t.framesToPop=="number"?t.framesToPop:0}function em(t){return typeof WebAssembly<"u"&&typeof WebAssembly.Exception<"u"?t instanceof WebAssembly.Exception:!1}function KC(t){const e=t&&t.name;return!e&&em(t)?t.message&&Array.isArray(t.message)&&t.message.length==2?t.message[0]:"WebAssembly.Exception":e}function JC(t){const e=t&&t.message;return e?e.error&&typeof e.error.message=="string"?e.error.message:em(t)&&Array.isArray(t.message)&&t.message.length==2?t.message[1]:e:"No error message"}function VC(t,e,r,n){const i=r&&r.syntheticException||void 0,s=Ml(t,e,i,n);return Fn(s),s.level="error",r&&r.event_id&&(s.event_id=r.event_id),Ar(s)}function YC(t,e,r="info",n,i){const s=n&&n.syntheticException||void 0,o=lu(t,e,s,i);return o.level=r,n&&n.event_id&&(o.event_id=n.event_id),Ar(o)}function Ml(t,e,r,n,i){let s;if(Dv(e)&&e.error)return hc(t,e.error);if(hp(e)||o0(e)){const o=e;if("stack"in e)s=hc(t,e);else{const c=o.name||(hp(o)?"DOMError":"DOMException"),u=o.message?"".concat(c,": ").concat(o.message):c;s=lu(t,u,r,n),Qc(s,u)}return"code"in o&&(s.tags={...s.tags,"DOMException.code":"".concat(o.code)}),s}return kl(e)?hc(t,e):Mn(e)||ua(e)?(s=zC(t,e,r,i),Fn(s,{synthetic:!0}),s):(s=lu(t,e,r,n),Qc(s,"".concat(e)),Fn(s,{synthetic:!0}),s)}function lu(t,e,r,n){const i={};if(n&&r){const s=jl(t,r);s.length&&(i.exception={values:[{value:e,stacktrace:{frames:s}}]}),Fn(i,{synthetic:!0})}if(Tl(e)){const{__sentry_template_string__:s,__sentry_template_values__:o}=e;return i.logentry={message:s,params:o},i}return i.message=e,i}function qC(t,{isUnhandledRejection:e}){const r=g0(t),n=e?"promise rejection":"exception";if(Dv(t))return"Event `ErrorEvent` captured as ".concat(n," with message `").concat(t.message,"`");if(ua(t)){const i=XC(t);return"Event `".concat(i,"` (type=").concat(t.type,") captured as ").concat(n)}return"Object captured as ".concat(n," with keys: ").concat(r)}function XC(t){try{const e=Object.getPrototypeOf(t);return e?e.constructor.name:void 0}catch{}}function ZC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];if(r instanceof Error)return r}}function QC(t,{metadata:e,tunnel:r,dsn:n}){const i={event_id:t.event_id,sent_at:new Date().toISOString(),...e&&e.sdk&&{sdk:{name:e.sdk.name,version:e.sdk.version}},...!!r&&!!n&&{dsn:pa(n)}},s=eA(t);return ds(i,[s])}function eA(t){return[{type:"user_report"},t]}class tA extends KD{constructor(e){const r={parentSpanIsAlwaysRootSpan:!0,...e},n=L.SENTRY_SDK_SOURCE||LC();sC(r,"browser",["browser"],n),super(r),r.sendClientReports&&L.document&&L.document.addEventListener("visibilitychange",()=>{L.document.visibilityState==="hidden"&&this._flushOutcomes()})}eventFromException(e,r){return VC(this._options.stackParser,e,r,this._options.attachStacktrace)}eventFromMessage(e,r="info",n){return YC(this._options.stackParser,e,r,n,this._options.attachStacktrace)}captureUserFeedback(e){if(!this._isEnabled()){ps&&$.warn("SDK not enabled, will not capture user feedback.");return}const r=QC(e,{metadata:this.getSdkMetadata(),dsn:this.getDsn(),tunnel:this.getOptions().tunnel});this.sendEnvelope(r)}_prepareEvent(e,r,n){return e.platform=e.platform||"javascript",super._prepareEvent(e,r,n)}}const rA=typeof __SENTRY_DEBUG__>"u"||__SENTRY_DEBUG__,he=C,nA=1e3;let Gp,fu,du;function iA(t){const e="dom";Gr(e,t),Wr(e,sA)}function sA(){if(!he.document)return;const t=rt.bind(null,"dom"),e=Wp(t,!0);he.document.addEventListener("click",e,!1),he.document.addEventListener("keypress",e,!1),["EventTarget","Node"].forEach(r=>{const i=he[r],s=i&&i.prototype;!s||!s.hasOwnProperty||!s.hasOwnProperty("addEventListener")||(Ae(s,"addEventListener",function(o){return function(c,u,l){if(c==="click"||c=="keypress")try{const f=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},d=f[c]=f[c]||{refCount:0};if(!d.handler){const p=Wp(t);d.handler=p,o.call(this,c,p,l)}d.refCount++}catch{}return o.call(this,c,u,l)}}),Ae(s,"removeEventListener",function(o){return function(c,u,l){if(c==="click"||c=="keypress")try{const f=this.__sentry_instrumentation_handlers__||{},d=f[c];d&&(d.refCount--,d.refCount<=0&&(o.call(this,c,d.handler,l),d.handler=void 0,delete f[c]),Object.keys(f).length===0&&delete this.__sentry_instrumentation_handlers__)}catch{}return o.call(this,c,u,l)}}))})}function oA(t){if(t.type!==fu)return!1;try{if(!t.target||t.target._sentryId!==du)return!1}catch{}return!0}function aA(t,e){return t!=="keypress"?!1:!e||!e.tagName?!0:!(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.isContentEditable)}function Wp(t,e=!1){return r=>{if(!r||r._sentryCaptured)return;const n=cA(r);if(aA(r.type,n))return;Cr(r,"_sentryCaptured",!0),n&&!n._sentryId&&Cr(n,"_sentryId",We());const i=r.type==="keypress"?"input":r.type;oA(r)||(t({event:r,name:i,global:e}),fu=r.type,du=n?n._sentryId:void 0),clearTimeout(Gp),Gp=he.setTimeout(()=>{du=void 0,fu=void 0},nA)}}function cA(t){try{return t.target}catch{return null}}let Hs;function tm(t){const e="history";Gr(e,t),Wr(e,uA)}function uA(){if(!UC())return;const t=he.onpopstate;he.onpopstate=function(...r){const n=he.location.href,i=Hs;if(Hs=n,rt("history",{from:i,to:n}),t)try{return t.apply(this,r)}catch{}};function e(r){return function(...n){const i=n.length>2?n[2]:void 0;if(i){const s=Hs,o=String(i);Hs=o,rt("history",{from:s,to:o})}return r.apply(this,n)}}Ae(he.history,"pushState",e),Ae(he.history,"replaceState",e)}const io={};function lA(t){const e=io[t];if(e)return e;let r=he[t];if(au(r))return io[t]=r.bind(he);const n=he.document;if(n&&typeof n.createElement=="function")try{const i=n.createElement("iframe");i.hidden=!0,n.head.appendChild(i);const s=i.contentWindow;s&&s[t]&&(r=s[t]),n.head.removeChild(i)}catch(i){rA&&$.warn("Could not create sandbox iframe for ".concat(t," check, bailing to window.").concat(t,": "),i)}return r&&(io[t]=r.bind(he))}function Hp(t){io[t]=void 0}const si="__sentry_xhr_v3__";function fA(t){const e="xhr";Gr(e,t),Wr(e,dA)}function dA(){if(!he.XMLHttpRequest)return;const t=XMLHttpRequest.prototype;t.open=new Proxy(t.open,{apply(e,r,n){const i=new Error,s=Rt()*1e3,o=Pt(n[0])?n[0].toUpperCase():void 0,c=pA(n[1]);if(!o||!c)return e.apply(r,n);r[si]={method:o,url:c,request_headers:{}},o==="POST"&&c.match(/sentry_key/)&&(r.__sentry_own_request__=!0);const u=()=>{const l=r[si];if(l&&r.readyState===4){try{l.status_code=r.status}catch{}const f={endTimestamp:Rt()*1e3,startTimestamp:s,xhr:r,virtualError:i};rt("xhr",f)}};return"onreadystatechange"in r&&typeof r.onreadystatechange=="function"?r.onreadystatechange=new Proxy(r.onreadystatechange,{apply(l,f,d){return u(),l.apply(f,d)}}):r.addEventListener("readystatechange",u),r.setRequestHeader=new Proxy(r.setRequestHeader,{apply(l,f,d){const[p,h]=d,y=f[si];return y&&Pt(p)&&Pt(h)&&(y.request_headers[p.toLowerCase()]=h),l.apply(f,d)}}),e.apply(r,n)}}),t.send=new Proxy(t.send,{apply(e,r,n){const i=r[si];if(!i)return e.apply(r,n);n[0]!==void 0&&(i.body=n[0]);const s={startTimestamp:Rt()*1e3,xhr:r};return rt("xhr",s),e.apply(r,n)}})}function pA(t){if(Pt(t))return t;try{return t.toString()}catch{}}function hA(t,e=lA("fetch")){let r=0,n=0;function i(s){const o=s.body.length;r+=o,n++;const c={body:s.body,method:"POST",referrerPolicy:"origin",headers:t.headers,keepalive:r<=6e4&&n<15,...t.fetchOptions};if(!e)return Hp("fetch"),Oo("No fetch implementation available");try{return e(t.url,c).then(u=>(r-=o,n--,{statusCode:u.status,headers:{"x-sentry-rate-limits":u.headers.get("X-Sentry-Rate-Limits"),"retry-after":u.headers.get("Retry-After")}}))}catch(u){return Hp("fetch"),r-=o,n--,Oo(u)}}return iC(t,i)}const gA=30,vA=50;function pu(t,e,r,n){const i={filename:t,function:e==="<anonymous>"?Rr:e,in_app:!0};return r!==void 0&&(i.lineno=r),n!==void 0&&(i.colno=n),i}const mA=/^\s*at (\S+?)(?::(\d+))(?::(\d+))\s*$/i,yA=/^\s*at (?:(.+?\)(?: \[.+\])?|.*?) ?\((?:address at )?)?(?:async )?((?:<anonymous>|[-a-z]+:|.*bundle|\/)?.*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,SA=/\((\S*)(?::(\d+))(?::(\d+))\)/,bA=t=>{const e=mA.exec(t);if(e){const[,n,i,s]=e;return pu(n,Rr,+i,+s)}const r=yA.exec(t);if(r){if(r[2]&&r[2].indexOf("eval")===0){const o=SA.exec(r[2]);o&&(r[2]=o[1],r[3]=o[2],r[4]=o[3])}const[i,s]=nm(r[1]||Rr,r[2]);return pu(s,i,r[3]?+r[3]:void 0,r[4]?+r[4]:void 0)}},_A=[gA,bA],EA=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)?((?:[-a-z]+)?:\/.*?|\[native code\]|[^@]*(?:bundle|\d+\.js)|\/[\w\-. /=]+)(?::(\d+))?(?::(\d+))?\s*$/i,wA=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,$A=t=>{const e=EA.exec(t);if(e){if(e[3]&&e[3].indexOf(" > eval")>-1){const s=wA.exec(e[3]);s&&(e[1]=e[1]||"eval",e[3]=s[1],e[4]=s[2],e[5]="")}let n=e[3],i=e[1]||Rr;return[i,n]=nm(i,n),pu(n,i,e[4]?+e[4]:void 0,e[5]?+e[5]:void 0)}},kA=[vA,$A],TA=[_A,kA],rm=Pv(...TA),nm=(t,e)=>{const r=t.indexOf("safari-extension")!==-1,n=t.indexOf("safari-web-extension")!==-1;return r||n?[t.indexOf("@")!==-1?t.split("@")[0]:Rr,r?"safari-extension:".concat(e):"safari-web-extension:".concat(e)]:[t,e]},Ks=1024,IA="Breadcrumbs",OA=(t={})=>{const e={console:!0,dom:!0,fetch:!0,history:!0,sentry:!0,xhr:!0,...t};return{name:IA,setup(r){e.console&&TC(DA(r)),e.dom&&iA(RA(r,e.dom)),e.xhr&&fA(CA(r)),e.fetch&&jC(AA(r)),e.history&&tm(NA(r)),e.sentry&&r.on("beforeSendEvent",PA(r))}}},xA=OA;function PA(t){return function(r){ce()===t&&jr({category:"sentry.".concat(r.type==="transaction"?"transaction":"event"),event_id:r.event_id,level:r.level,message:Ft(r)},{event:r})}}function RA(t,e){return function(n){if(ce()!==t)return;let i,s,o=typeof e=="object"?e.serializeAttribute:void 0,c=typeof e=="object"&&typeof e.maxStringLength=="number"?e.maxStringLength:void 0;c&&c>Ks&&(ps&&$.warn("`dom.maxStringLength` cannot exceed ".concat(Ks,", but a value of ").concat(c," was configured. Sentry will use ").concat(Ks," instead.")),c=Ks),typeof o=="string"&&(o=[o]);try{const l=n.event,f=jA(l)?l.target:l;i=Av(f,{keyAttrs:o,maxStringLength:c}),s=p0(f)}catch{i="<unknown>"}if(i.length===0)return;const u={category:"ui.".concat(n.name),message:i};s&&(u.data={"ui.component_name":s}),jr(u,{event:n.event,name:n.name,global:n.global})}}function DA(t){return function(r){if(ce()!==t)return;const n={category:"console",data:{arguments:r.args,logger:"console"},level:OC(r.level),message:gp(r.args," ")};if(r.level==="assert")if(r.args[0]===!1)n.message="Assertion failed: ".concat(gp(r.args.slice(1)," ")||"console.assert"),n.data.arguments=r.args.slice(1);else return;jr(n,{input:r.args,level:r.level})}}function CA(t){return function(r){if(ce()!==t)return;const{startTimestamp:n,endTimestamp:i}=r,s=r.xhr[si];if(!n||!i||!s)return;const{method:o,url:c,status_code:u,body:l}=s,f={method:o,url:c,status_code:u},d={xhr:r.xhr,input:l,startTimestamp:n,endTimestamp:i},p=Xv(u);jr({category:"xhr",data:f,type:"http",level:p},d)}}function AA(t){return function(r){if(ce()!==t)return;const{startTimestamp:n,endTimestamp:i}=r;if(i&&!(r.fetchData.url.match(/sentry_key/)&&r.fetchData.method==="POST"))if(r.error){const s=r.fetchData,o={data:r.error,input:r.args,startTimestamp:n,endTimestamp:i};jr({category:"fetch",data:s,level:"error",type:"http"},o)}else{const s=r.response,o={...r.fetchData,status_code:s&&s.status},c={input:r.args,response:s,startTimestamp:n,endTimestamp:i},u=Xv(o.status_code);jr({category:"fetch",data:o,type:"http",level:u},c)}}}function NA(t){return function(r){if(ce()!==t)return;let n=r.from,i=r.to;const s=pc(L.location.href);let o=n?pc(n):void 0;const c=pc(i);(!o||!o.path)&&(o=s),s.protocol===c.protocol&&s.host===c.host&&(i=c.relative),s.protocol===o.protocol&&s.host===o.host&&(n=o.relative),jr({category:"navigation",data:{from:n,to:i}})}}function jA(t){return!!t&&!!t.target}const MA=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","BroadcastChannel","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],FA="BrowserApiErrors",LA=(t={})=>{const e={XMLHttpRequest:!0,eventTarget:!0,requestAnimationFrame:!0,setInterval:!0,setTimeout:!0,...t};return{name:FA,setupOnce(){e.setTimeout&&Ae(L,"setTimeout",Kp),e.setInterval&&Ae(L,"setInterval",Kp),e.requestAnimationFrame&&Ae(L,"requestAnimationFrame",BA),e.XMLHttpRequest&&"XMLHttpRequest"in L&&Ae(XMLHttpRequest.prototype,"send",zA);const r=e.eventTarget;r&&(Array.isArray(r)?r:MA).forEach(GA)}}},UA=LA;function Kp(t){return function(...e){const r=e[0];return e[0]=Bn(r,{mechanism:{data:{function:sr(t)},handled:!1,type:"instrument"}}),t.apply(this,e)}}function BA(t){return function(e){return t.apply(this,[Bn(e,{mechanism:{data:{function:"requestAnimationFrame",handler:sr(t)},handled:!1,type:"instrument"}})])}}function zA(t){return function(...e){const r=this;return["onload","onerror","onprogress","onreadystatechange"].forEach(i=>{i in r&&typeof r[i]=="function"&&Ae(r,i,function(s){const o={mechanism:{data:{function:i,handler:sr(s)},handled:!1,type:"instrument"}},c=xl(s);return c&&(o.mechanism.data.handler=sr(c)),Bn(s,o)})}),t.apply(this,e)}}function GA(t){const r=L[t],n=r&&r.prototype;!n||!n.hasOwnProperty||!n.hasOwnProperty("addEventListener")||(Ae(n,"addEventListener",function(i){return function(s,o,c){try{WA(o)&&(o.handleEvent=Bn(o.handleEvent,{mechanism:{data:{function:"handleEvent",handler:sr(o),target:t},handled:!1,type:"instrument"}}))}catch{}return i.apply(this,[s,Bn(o,{mechanism:{data:{function:"addEventListener",handler:sr(o),target:t},handled:!1,type:"instrument"}}),c])}}),Ae(n,"removeEventListener",function(i){return function(s,o,c){try{const u=o.__sentry_wrapped__;u&&i.call(this,s,u,c)}catch{}return i.call(this,s,o,c)}}))}function WA(t){return typeof t.handleEvent=="function"}const HA=()=>({name:"BrowserSession",setupOnce(){if(typeof L.document>"u"){ps&&$.warn("Using the `browserSessionIntegration` in non-browser environments is not supported.");return}Rp({ignoreDuration:!0}),Dp(),tm(({from:t,to:e})=>{t!==void 0&&t!==e&&(Rp({ignoreDuration:!0}),Dp())})}}),KA="GlobalHandlers",JA=(t={})=>{const e={onerror:!0,onunhandledrejection:!0,...t};return{name:KA,setupOnce(){Error.stackTraceLimit=50},setup(r){e.onerror&&(YA(r),Jp("onerror")),e.onunhandledrejection&&(qA(r),Jp("onunhandledrejection"))}}},VA=JA;function YA(t){r0(e=>{const{stackParser:r,attachStacktrace:n}=im();if(ce()!==t||Qv())return;const{msg:i,url:s,line:o,column:c,error:u}=e,l=QA(Ml(r,u||i,void 0,n,!1),s,o,c);l.level="error",Al(l,{originalException:u,mechanism:{handled:!1,type:"onerror"}})})}function qA(t){i0(e=>{const{stackParser:r,attachStacktrace:n}=im();if(ce()!==t||Qv())return;const i=XA(e),s=Il(i)?ZA(i):Ml(r,i,void 0,n,!0);s.level="error",Al(s,{originalException:i,mechanism:{handled:!1,type:"onunhandledrejection"}})})}function XA(t){if(Il(t))return t;try{if("reason"in t)return t.reason;if("detail"in t&&"reason"in t.detail)return t.detail.reason}catch{}return t}function ZA(t){return{exception:{values:[{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: ".concat(String(t))}]}}}function QA(t,e,r,n){const i=t.exception=t.exception||{},s=i.values=i.values||[],o=s[0]=s[0]||{},c=o.stacktrace=o.stacktrace||{},u=c.frames=c.frames||[],l=n,f=r,d=Pt(e)&&e.length>0?e:d0();return u.length===0&&u.push({colno:l,filename:d,function:Rr,in_app:!0,lineno:f}),t}function Jp(t){ps&&$.log("Global Handler attached: ".concat(t))}function im(){const t=ce();return t&&t.getOptions()||{stackParser:()=>[],attachStacktrace:!1}}const e1=()=>({name:"HttpContext",preprocessEvent(t){if(!L.navigator&&!L.location&&!L.document)return;const e=t.request&&t.request.url||L.location&&L.location.href,{referrer:r}=L.document||{},{userAgent:n}=L.navigator||{},i={...t.request&&t.request.headers,...r&&{Referer:r},...n&&{"User-Agent":n}},s={...t.request,...e&&{url:e},headers:i};t.request=s}}),t1="cause",r1=5,n1="LinkedErrors",i1=(t={})=>{const e=t.limit||r1,r=t.key||t1;return{name:n1,preprocessEvent(n,i,s){const o=s.getOptions();$C(Nl,o.stackParser,o.maxValueLength,r,e,n,i)}}},s1=i1;function o1(t){const e=[pC(),uC(),UA(),xA(),VA(),s1(),RC(),e1()];return t.autoSessionTracking!==!1&&e.push(HA()),e}function a1(t={}){const e={defaultIntegrations:o1(t),release:typeof __SENTRY_RELEASE__=="string"?__SENTRY_RELEASE__:L.SENTRY_RELEASE&&L.SENTRY_RELEASE.id?L.SENTRY_RELEASE.id:void 0,autoSessionTracking:!0,sendClientReports:!0};return t.defaultIntegrations==null&&delete t.defaultIntegrations,{...e,...t}}function c1(){const t=typeof L.window<"u"&&L;if(!t)return!1;const e=t.chrome?"chrome":"browser",r=t[e],n=r&&r.runtime&&r.runtime.id,i=L.location&&L.location.href||"",s=["chrome-extension:","moz-extension:","ms-browser-extension:","safari-web-extension:"],o=!!n&&L===L.top&&s.some(u=>i.startsWith("".concat(u,"//"))),c=typeof t.nw<"u";return!!n&&!o&&!c}function u1(t={}){const e=a1(t);if(!e.skipBrowserExtensionCheck&&c1()){zr(()=>{console.error("[Sentry] You cannot run Sentry this way in a browser extension, check: https://docs.sentry.io/platforms/javascript/best-practices/browser-extensions/")});return}ps&&(Zv()||$.warn("No Fetch API detected. The Sentry SDK requires a Fetch API compatible environment to send events. Please add a Fetch API polyfill."));const r={...e,stackParser:e0(e.stackParser||rm),integrations:GD(e),transport:e.transport||hA};return YD(tA,r)}var sm=t=>{throw TypeError(t)},l1=(t,e,r)=>e.has(t)||sm("Cannot "+r),f1=(t,e,r)=>(l1(t,e,"read from private field"),r?r.call(t):e.get(t)),d1=(t,e,r)=>e.has(t)?sm("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),hu;class p1{constructor(e){d1(this,hu,new pR({probability:.01})),u1({dsn:e.dsn,environment:e.servicesEnvironment,release:e.version,integrations:[],defaultIntegrations:[],skipBrowserExtensionCheck:!0,sampleRate:.01,enabled:!Pr,sendClientReports:!1})}write(e){var r;if(e.level!=="error"||e.delivery===!1)return;if(e.args.some(i=>i instanceof wl)||f1(this,hu).shouldSelect()){const i=e.args.at(0);Al({level:"error",exception:{values:om(i)?gu(i):[{type:"Error",value:e.text}]},logger:(r=e.logger)!=null?r:void 0})}}}hu=new WeakMap;function gu(t,e={nextId:1}){const r=e.nextId++,n=new Set(["name","message","stack","cause"]),i=[{type:t.name,value:t.message,stacktrace:typeof t.stack=="string"&&t.stack.length>0?{frames:rm(t.stack)}:void 0,mechanism:{type:"generic",handled:!(t instanceof wl),is_exception_group:t instanceof lt,exception_id:r,parent_id:e.parentId,source:!(t instanceof w)||t instanceof lt?void 0:JSON.stringify(t,(s,o)=>n.has(s)?void 0:o)}}];if(t instanceof lt)for(const s of t.errors)i.push(...gu(s,{...e,parentId:r}));return om(t.cause)&&i.push(...gu(t.cause,{...e,parentId:r})),i}function om(t){return t!==null&&typeof t=="object"&&"message"in t&&typeof t.message=="string"}var h1=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),Vp=t=>{throw TypeError(t)},g1=(t,e,r)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&Vp("Object expected");var n;n===void 0&&(n=e[h1("dispose")]),typeof n!="function"&&Vp("Object not disposable"),t.push([r,n,e])}return e},v1=(t,e,r)=>{var n=typeof SuppressedError=="function"?SuppressedError:function(o,c,u,l){return l=Error(u),l.name="SuppressedError",l.error=o,l.suppressed=c,l},i=o=>e=r?new n(o,e,"An error was suppressed during disposal"):(r=!0,o),s=o=>{for(;o=t.pop();)try{var c=o[1]&&o[1].call(o[2]);if(o[0])return Promise.resolve(c).then(s,u=>(i(u),s()))}catch(u){i(u)}if(r)throw e};return s()};function m1(t,e=Pr){var r=[];try{const s=g1(r,new DisposableStack);return Pr||(s.use(y1(t)),s.use(S1(t))),s.move()}catch(s){var n=s,i=!0}finally{v1(r,n,i)}}function am(t){let e=null;const r=[];return b(t,ae(async n=>(console.error("Failed to get writer",n),P({write:()=>{}}))),x(n=>{e=n;for(const i of r)n.write(i);r.length=0})),{write:n=>{e?e.write(n):r.push(n)}}}function y1(t){return E.addWriter(am(b(t,x(e=>e.client),ae(async e=>(E.error("Failed to get client",e),P("unknown"))),x(e=>new mi({application:"Inkwell",environment:"production",version:oa,client:e,sessionId:ir(),logsPerMinute:50,logsPerSecond:20})))))}function S1(t){return E.addWriter(am(b(t,x(e=>new p1({dsn:"https://25fb716dbdd62694cf86893defe00a1f@o565714.ingest.us.sentry.io/4508976808067072",version:oa,servicesEnvironment:e.servicesEnvironment})))))}var ln;class b1{constructor(e){g(this,ln);v(this,ln,e)}[Symbol.dispose](){a(this,ln)&&a(this,ln)[Symbol.asyncDispose]().then(()=>{},e=>E.error("Unexpected error in DetachedDisposable.dispose",e))}}ln=new WeakMap;function cm(t){if(!t)return;if(Symbol.iterator in t){const r=new DisposableStack;for(const n of t)r.use(Yp(n));return r.dispose()}const e=Yp(t);if(e)return e[Symbol.dispose]()}async function ha(t){if(t){if(Symbol.iterator in t){const e=new AsyncDisposableStack;for(const r of t)e.use(_1(r));return await e.disposeAsync()}if(va(t))return t[Symbol.asyncDispose]();if(ga(t))return t[Symbol.dispose]()}}function Yp(t){if(ga(t))return t;if(va(t))return new b1(t)}function _1(t){if(ga(t)||va(t))return t}function pt(t){const e=new DisposableStack;return e.defer(t),e}function Uj(t){const e=new AsyncDisposableStack;return e.defer(t),e}function ga(t){return Symbol.dispose in t}function va(t){return Symbol.asyncDispose in t}function E1(t){return ga(t)||va(t)}const gc=E.createLogger("FeMetricWriter");var gr,Wt,fn,Mi,dn,or,lm,fm,dm;class um{constructor(e,r){g(this,or);g(this,gr);g(this,Wt,new Map);g(this,fn,[]);g(this,Mi,[]);g(this,dn,null);v(this,gr,Object.entries({...e,inkwell_app_name:r.name,inkwell_app_version:r.version,inkwell_client:r.client}).map(([n,i])=>({key:n,value:i})))}write(e){switch(e.kind){case"counter":{gc.verbose("Metric inkwell_".concat(e.name," incrementing by ").concat(e.value));const r=k1(e);a(this,Wt).has(r)?a(this,Wt).get(r).increment(e.value):a(this,Wt).set(r,new $1(e));break}case"timer":gc.verbose("Metric inkwell_".concat(e.name," completed in ").concat(Number(e.value).toFixed(2),"s")),a(this,fn).push(e);break;case"histogram":gc.verbose("Metric inkwell_".concat(e.name," recorded ").concat(e.value)),a(this,Mi).push(e);break;default:throw new tt(e)}m(this,or,lm).call(this)}}gr=new WeakMap,Wt=new WeakMap,fn=new WeakMap,Mi=new WeakMap,dn=new WeakMap,or=new WeakSet,lm=function(){if(a(this,dn)!==null)return;v(this,dn,setTimeout(()=>{v(this,dn,null),m(this,or,fm).call(this)},7500))},fm=function(){const e=[];for(const r of a(this,Wt).values())e.push(vc(r.toMetric(),a(this,gr)));for(const r of a(this,fn))e.push(vc(r,a(this,gr)));for(const r of a(this,Mi))e.push(vc(r,a(this,gr)));e.length!==0&&(a(this,Wt).clear(),a(this,fn).length=0,m(this,or,dm).call(this,e))},dm=function(e){const r=JSON.stringify(e);T1(async()=>{await fetch("https://inkwell.femetrics.grammarly.io/batch/import",{body:r,method:"POST",mode:"no-cors",cache:"no-store",headers:{"Content-Type":"application/json"},keepalive:!0})}).catch(n=>{})};const w1={timer:"summary",counter:"counter",histogram:"histogram_strikes_back"};function vc(t,e){return{name:"inkwell_"+t.name,type:w1[t.kind],value:t.value,labels:Object.entries(t.labels).map(([r,n])=>({key:r,value:n})).concat(e),report_interval:"1m"}}var Fi,pn;class $1{constructor(e){g(this,Fi);g(this,pn);v(this,Fi,e),v(this,pn,e.value)}increment(e=1){v(this,pn,a(this,pn)+e)}toMetric(){return{...a(this,Fi),value:a(this,pn)}}}Fi=new WeakMap,pn=new WeakMap;function k1(t){return"".concat(t.name,":").concat(JSON.stringify(t.labels,Object.keys(t.labels).sort()))}function T1(t,e=3){return new Promise((r,n)=>{let i=0;const s=()=>{t().then(r).catch(o=>{i++<e?setTimeout(s,2**i*1e3):n(o)})};s()})}var Li,Ui,Bi;class mc{constructor(e,r){g(this,Li,!1);g(this,Ui);g(this,Bi);v(this,Ui,e),v(this,Bi,r)}close(e=null,r){a(this,Li)||(v(this,Li,!0),a(this,Bi).call(this,e!=null?e:null,{...a(this,Ui),...r}))}[Symbol.dispose](){this.close()}}Li=new WeakMap,Ui=new WeakMap,Bi=new WeakMap;var bt,_t,hn;class I1{constructor(e,r){g(this,bt);g(this,_t);g(this,hn,new mc({},()=>{}));v(this,bt,e),v(this,_t,r),a(this,hn).close()}count(e,r={}){var i,s,o;if(((i=r.sampler)==null?void 0:i.shouldSelect())===!1)return a(this,hn);const n={kind:"counter",name:"".concat(a(this,bt),"_").concat(e,"_total"),labels:(s=r.labels)!=null?s:{},value:(o=r.incrementBy)!=null?o:1};return a(this,_t).write(n),new mc(r,(c,u)=>{var l,f,d,p;c!==null?a(this,_t).write({kind:"counter",name:"".concat(a(this,bt),"_").concat(e,"_failure_total"),value:(l=u.incrementBy)!=null?l:1,labels:(f=u.labels)!=null?f:{}}):a(this,_t).write({kind:"counter",name:"".concat(a(this,bt),"_").concat(e,"_success_total"),value:(d=u.incrementBy)!=null?d:1,labels:(p=u.labels)!=null?p:{}})})}duration(e,r={}){var o;if(((o=r.sampler)==null?void 0:o.shouldSelect())===!1)return a(this,hn);const n=this.count(e,r),i=performance.now(),s=new mc(r,(c,u)=>{var l,f;if(c===null){n.close(void 0,u);const d={kind:"timer",name:"".concat(a(this,bt),"_").concat(e,"_duration_seconds"),value:(l=u.durationInSeconds)!=null?l:(performance.now()-i)/1e3,labels:(f=u.labels)!=null?f:{}};a(this,_t).write(d)}else n.close(c,u)});return r.durationInSeconds!==void 0&&s.close(),s}histogram(e,r){var n,i;((n=r==null?void 0:r.sampler)==null?void 0:n.shouldSelect())!==!1&&a(this,_t).write({kind:"histogram",name:"".concat(a(this,bt),"_").concat(e),value:r.value,labels:(i=r.labels)!=null?i:{}})}}bt=new WeakMap,_t=new WeakMap,hn=new WeakMap;function O1(){try{const t=Reflect.get(navigator,"deviceMemory");if(t)return t.toString()}catch{}return"unknown"}function pm(t){return new um({env:"prod",memory_info:O1(),inkwell_execution_realm:t.realm},{name:"Inkwell",client:t.client,version:oa})}function x1(t){const e=new I1("web_client",R1(t)),r=P1(e);return{monitoring:e,[Symbol.dispose]:()=>cm(r)}}function P1(t){return E.addWriter({write:e=>{switch(e.level){case"error":t.count("error_log");break;case"warn":t.count("warn_log");break;case"info":t.count("info_log");break;case"verbose":break;default:throw new tt(e.level)}}})}function R1(t){let e=null;const r=[];return b(t,x(n=>{e=pm(n);for(const i of r)e.write(i)})),{write:n=>{e?e.write(n):r.push(n)}}}function hm(t){return typeof t=="function"?{next:e=>t(e),error:()=>{},complete:()=>{}}:{next:e=>{var r;return(r=t.next)==null?void 0:r.call(t,e)},error:e=>{var r;return(r=t.error)==null?void 0:r.call(t,e)},complete:()=>{var e;return(e=t.complete)==null?void 0:e.call(t)}}}var gn,xe,vn;class D1{constructor(){g(this,gn,[]);g(this,xe,null);g(this,vn,!1)}next(e){a(this,xe)?a(this,xe).next(e):a(this,gn).push(e)}complete(){var e;(e=a(this,xe))==null||e.complete(),v(this,xe,null),v(this,vn,!0)}error(e){var r;(r=a(this,xe))==null||r.error(e),v(this,xe,null),v(this,vn,!0)}subscribe(e){var n=[];try{if(a(this,vn))return E.warn("Cannot subscribe to closed SingleConsumerBufferedEmitter"),pt(()=>{});if(a(this,xe))return E.error("SingleConsumerBufferedEmitter supports only one subscriber."),pt(()=>{});const r=ue(n,new DisposableStack);v(this,xe,hm(e));r.defer(()=>v(this,xe,null));a(this,gn).forEach(c=>{var u;return(u=a(this,xe))==null?void 0:u.next(c)});a(this,gn).length=0;return r.move()}catch(i){var s=i,o=!0}finally{le(n,s,o)}}[Symbol.dispose](){this.complete()}}gn=new WeakMap,xe=new WeakMap,vn=new WeakMap;var vu=function(t,e){return vu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},vu(t,e)};function Vn(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");vu(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function C1(t,e,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function c(f){try{l(n.next(f))}catch(d){o(d)}}function u(f){try{l(n.throw(f))}catch(d){o(d)}}function l(f){f.done?s(f.value):i(f.value).then(c,u)}l((n=n.apply(t,e||[])).next())})}function gm(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(l){return function(f){return u([l,f])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(r=0)),r;)try{if(n=1,i&&(s=l[0]&2?i.return:l[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,l[1])).done)return s;switch(i=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,i=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(f){l=[6,f],i=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function zn(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function mu(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],o;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return s}function yu(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}function rn(t){return this instanceof rn?(this.v=t,this):new rn(t)}function A1(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,s=[];return i={},c("next"),c("throw"),c("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(h){return function(y){return Promise.resolve(y).then(h,d)}}function c(h,y){n[h]&&(i[h]=function(_){return new Promise(function(k,T){s.push([h,_,k,T])>1||u(h,_)})},y&&(i[h]=y(i[h])))}function u(h,y){try{l(n[h](y))}catch(_){p(s[0][3],_)}}function l(h){h.value instanceof rn?Promise.resolve(h.value.v).then(f,d):p(s[0][2],h)}function f(h){u("next",h)}function d(h){u("throw",h)}function p(h,y){h(y),s.shift(),s.length&&u(s[0][0],s[0][1])}}function N1(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof zn=="function"?zn(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(o){return new Promise(function(c,u){o=t[s](o),i(c,u,o.done,o.value)})}}function i(s,o,c,u){Promise.resolve(u).then(function(l){s({value:l,done:c})},o)}}function te(t){return typeof t=="function"}function Fl(t){var e=function(n){Error.call(n),n.stack=new Error().stack},r=t(e);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var yc=Fl(function(t){return function(r){t(this),this.message=r?r.length+" errors occurred during unsubscription:\n"+r.map(function(n,i){return i+1+") "+n.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=r}});function Su(t,e){if(t){var r=t.indexOf(e);0<=r&&t.splice(r,1)}}var ma=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,r,n,i,s;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var c=zn(o),u=c.next();!u.done;u=c.next()){var l=u.value;l.remove(this)}}catch(_){e={error:_}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(e)throw e.error}}else o.remove(this);var f=this.initialTeardown;if(te(f))try{f()}catch(_){s=_ instanceof yc?_.errors:[_]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var p=zn(d),h=p.next();!h.done;h=p.next()){var y=h.value;try{qp(y)}catch(_){s=s!=null?s:[],_ instanceof yc?s=yu(yu([],mu(s)),mu(_.errors)):s.push(_)}}}catch(_){n={error:_}}finally{try{h&&!h.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}}if(s)throw new yc(s)}},t.prototype.add=function(e){var r;if(e&&e!==this)if(this.closed)qp(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(e)}},t.prototype._hasParent=function(e){var r=this._parentage;return r===e||Array.isArray(r)&&r.includes(e)},t.prototype._addParent=function(e){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(e),r):r?[r,e]:e},t.prototype._removeParent=function(e){var r=this._parentage;r===e?this._parentage=null:Array.isArray(r)&&Su(r,e)},t.prototype.remove=function(e){var r=this._finalizers;r&&Su(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),vm=ma.EMPTY;function mm(t){return t instanceof ma||t&&"closed"in t&&te(t.remove)&&te(t.add)&&te(t.unsubscribe)}function qp(t){te(t)?t():t.unsubscribe()}var ym={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Sm={setTimeout:function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,yu([t,e],mu(r)))},clearTimeout:function(t){var e=Sm.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function bm(t){Sm.setTimeout(function(){throw t})}function Xp(){}function so(t){t()}var Ll=function(t){Vn(e,t);function e(r){var n=t.call(this)||this;return n.isStopped=!1,r?(n.destination=r,mm(r)&&r.add(n)):n.destination=L1,n}return e.create=function(r,n,i){return new Po(r,n,i)},e.prototype.next=function(r){this.isStopped||this._next(r)},e.prototype.error=function(r){this.isStopped||(this.isStopped=!0,this._error(r))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(r){this.destination.next(r)},e.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(ma),j1=Function.prototype.bind;function Sc(t,e){return j1.call(t,e)}var M1=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var r=this.partialObserver;if(r.next)try{r.next(e)}catch(n){Js(n)}},t.prototype.error=function(e){var r=this.partialObserver;if(r.error)try{r.error(e)}catch(n){Js(n)}else Js(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(r){Js(r)}},t}(),Po=function(t){Vn(e,t);function e(r,n,i){var s=t.call(this)||this,o;if(te(r)||!r)o={next:r!=null?r:void 0,error:n!=null?n:void 0,complete:i!=null?i:void 0};else{var c;s&&ym.useDeprecatedNextContext?(c=Object.create(r),c.unsubscribe=function(){return s.unsubscribe()},o={next:r.next&&Sc(r.next,c),error:r.error&&Sc(r.error,c),complete:r.complete&&Sc(r.complete,c)}):o=r}return s.destination=new M1(o),s}return e}(Ll);function Js(t){bm(t)}function F1(t){throw t}var L1={closed:!0,next:Xp,error:F1,complete:Xp},Ul=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function U1(t){return t}function Bj(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return _m(t)}function _m(t){return t.length===0?U1:t.length===1?t[0]:function(r){return t.reduce(function(n,i){return i(n)},r)}}var He=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(e,r,n){var i=this,s=z1(e)?e:new Po(e,r,n);return so(function(){var o=i,c=o.operator,u=o.source;s.add(c?c.call(s,u):u?i._subscribe(s):i._trySubscribe(s))}),s},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(r){e.error(r)}},t.prototype.forEach=function(e,r){var n=this;return r=Zp(r),new r(function(i,s){var o=new Po({next:function(c){try{e(c)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});n.subscribe(o)})},t.prototype._subscribe=function(e){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(e)},t.prototype[Ul]=function(){return this},t.prototype.pipe=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return _m(e)(this)},t.prototype.toPromise=function(e){var r=this;return e=Zp(e),new e(function(n,i){var s;r.subscribe(function(o){return s=o},function(o){return i(o)},function(){return n(s)})})},t.create=function(e){return new t(e)},t}();function Zp(t){var e;return(e=t!=null?t:ym.Promise)!==null&&e!==void 0?e:Promise}function B1(t){return t&&te(t.next)&&te(t.error)&&te(t.complete)}function z1(t){return t&&t instanceof Ll||B1(t)&&mm(t)}function G1(t){return te(t==null?void 0:t.lift)}function hs(t){return function(e){if(G1(e))return e.lift(function(r){try{return t(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function Si(t,e,r,n,i){return new W1(t,e,r,n,i)}var W1=function(t){Vn(e,t);function e(r,n,i,s,o,c){var u=t.call(this,r)||this;return u.onFinalize=o,u.shouldUnsubscribe=c,u._next=n?function(l){try{n(l)}catch(f){r.error(f)}}:t.prototype._next,u._error=s?function(l){try{s(l)}catch(f){r.error(f)}finally{this.unsubscribe()}}:t.prototype._error,u._complete=i?function(){try{i()}catch(l){r.error(l)}finally{this.unsubscribe()}}:t.prototype._complete,u}return e.prototype.unsubscribe=function(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;t.prototype.unsubscribe.call(this),!n&&((r=this.onFinalize)===null||r===void 0||r.call(this))}},e}(Ll),H1=Fl(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Bl=function(t){Vn(e,t);function e(){var r=t.call(this)||this;return r.closed=!1,r.currentObservers=null,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return e.prototype.lift=function(r){var n=new Qp(this,this);return n.operator=r,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new H1},e.prototype.next=function(r){var n=this;so(function(){var i,s;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var o=zn(n.currentObservers),c=o.next();!c.done;c=o.next()){var u=c.value;u.next(r)}}catch(l){i={error:l}}finally{try{c&&!c.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}}})},e.prototype.error=function(r){var n=this;so(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=r;for(var i=n.observers;i.length;)i.shift().error(r)}})},e.prototype.complete=function(){var r=this;so(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var n=r.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(r){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,r)},e.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},e.prototype._innerSubscribe=function(r){var n=this,i=this,s=i.hasError,o=i.isStopped,c=i.observers;return s||o?vm:(this.currentObservers=null,c.push(r),new ma(function(){n.currentObservers=null,Su(c,r)}))},e.prototype._checkFinalizedStatuses=function(r){var n=this,i=n.hasError,s=n.thrownError,o=n.isStopped;i?r.error(s):o&&r.complete()},e.prototype.asObservable=function(){var r=new He;return r.source=this,r},e.create=function(r,n){return new Qp(r,n)},e}(He),Qp=function(t){Vn(e,t);function e(r,n){var i=t.call(this)||this;return i.destination=r,i.source=n,i}return e.prototype.next=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,r)},e.prototype.error=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,r)},e.prototype.complete=function(){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||n===void 0||n.call(r)},e.prototype._subscribe=function(r){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(r))!==null&&i!==void 0?i:vm},e}(Bl),Em=function(t){Vn(e,t);function e(r){var n=t.call(this)||this;return n._value=r,n}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(r){var n=t.prototype._subscribe.call(this,r);return!n.closed&&r.next(this._value),n},e.prototype.getValue=function(){var r=this,n=r.hasError,i=r.thrownError,s=r._value;if(n)throw i;return this._throwIfClosed(),s},e.prototype.next=function(r){t.prototype.next.call(this,this._value=r)},e}(Bl),wm=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function $m(t){return te(t==null?void 0:t.then)}function km(t){return te(t[Ul])}function Tm(t){return Symbol.asyncIterator&&te(t==null?void 0:t[Symbol.asyncIterator])}function Im(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function K1(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Om=K1();function xm(t){return te(t==null?void 0:t[Om])}function Pm(t){return A1(this,arguments,function(){var r,n,i,s;return gm(this,function(o){switch(o.label){case 0:r=t.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,rn(r.read())];case 3:return n=o.sent(),i=n.value,s=n.done,s?[4,rn(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,rn(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function Rm(t){return te(t==null?void 0:t.getReader)}function gs(t){if(t instanceof He)return t;if(t!=null){if(km(t))return J1(t);if(wm(t))return V1(t);if($m(t))return Y1(t);if(Tm(t))return Dm(t);if(xm(t))return q1(t);if(Rm(t))return X1(t)}throw Im(t)}function J1(t){return new He(function(e){var r=t[Ul]();if(te(r.subscribe))return r.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function V1(t){return new He(function(e){for(var r=0;r<t.length&&!e.closed;r++)e.next(t[r]);e.complete()})}function Y1(t){return new He(function(e){t.then(function(r){e.closed||(e.next(r),e.complete())},function(r){return e.error(r)}).then(null,bm)})}function q1(t){return new He(function(e){var r,n;try{for(var i=zn(t),s=i.next();!s.done;s=i.next()){var o=s.value;if(e.next(o),e.closed)return}}catch(c){r={error:c}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}e.complete()})}function Dm(t){return new He(function(e){Z1(t,e).catch(function(r){return e.error(r)})})}function X1(t){return Dm(Pm(t))}function Z1(t,e){var r,n,i,s;return C1(this,void 0,void 0,function(){var o,c;return gm(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),r=N1(t),u.label=1;case 1:return[4,r.next()];case 2:if(n=u.sent(),!!n.done)return[3,4];if(o=n.value,e.next(o),e.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return c=u.sent(),i={error:c},[3,11];case 6:return u.trys.push([6,,9,10]),n&&!n.done&&(s=r.return)?[4,s.call(r)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(i)throw i.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function rr(t,e,r,n,i){n===void 0&&(n=0),i===void 0&&(i=!1);var s=e.schedule(function(){r(),i?t.add(this.schedule(null,n)):this.unsubscribe()},n);if(t.add(s),!i)return s}function Cm(t,e){return e===void 0&&(e=0),hs(function(r,n){r.subscribe(Si(n,function(i){return rr(n,t,function(){return n.next(i)},e)},function(){return rr(n,t,function(){return n.complete()},e)},function(i){return rr(n,t,function(){return n.error(i)},e)}))})}function Am(t,e){return e===void 0&&(e=0),hs(function(r,n){n.add(t.schedule(function(){return r.subscribe(n)},e))})}function Q1(t,e){return gs(t).pipe(Am(e),Cm(e))}function eN(t,e){return gs(t).pipe(Am(e),Cm(e))}function tN(t,e){return new He(function(r){var n=0;return e.schedule(function(){n===t.length?r.complete():(r.next(t[n++]),r.closed||this.schedule())})})}function rN(t,e){return new He(function(r){var n;return rr(r,e,function(){n=t[Om](),rr(r,e,function(){var i,s,o;try{i=n.next(),s=i.value,o=i.done}catch(c){r.error(c);return}o?r.complete():r.next(s)},0,!0)}),function(){return te(n==null?void 0:n.return)&&n.return()}})}function Nm(t,e){if(!t)throw new Error("Iterable cannot be null");return new He(function(r){rr(r,e,function(){var n=t[Symbol.asyncIterator]();rr(r,e,function(){n.next().then(function(i){i.done?r.complete():r.next(i.value)})},0,!0)})})}function nN(t,e){return Nm(Pm(t),e)}function iN(t,e){if(t!=null){if(km(t))return Q1(t,e);if(wm(t))return tN(t,e);if($m(t))return eN(t,e);if(Tm(t))return Nm(t,e);if(xm(t))return rN(t,e);if(Rm(t))return nN(t,e)}throw Im(t)}function sN(t,e){return e?iN(t,e):gs(t)}var oN=Fl(function(t){return function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}});function aN(t,e){var r=typeof e=="object";return new Promise(function(n,i){var s=new Po({next:function(o){n(o),s.unsubscribe()},error:i,complete:function(){r?n(e.defaultValue):i(new oN)}});t.subscribe(s)})}function jm(t,e){return hs(function(r,n){var i=0;r.subscribe(Si(n,function(s){n.next(t.call(e,s,i++))}))})}function cN(t,e,r,n,i,s,o,c){var u=[],l=0,f=0,d=!1,p=function(){d&&!u.length&&!l&&e.complete()},h=function(_){return l<n?y(_):u.push(_)},y=function(_){s&&e.next(_),l++;var k=!1;gs(r(_,f++)).subscribe(Si(e,function(T){i==null||i(T),s?h(T):e.next(T)},function(){k=!0},void 0,function(){if(k)try{l--;for(var T=function(){var O=u.shift();o?rr(e,o,function(){return y(O)}):y(O)};u.length&&l<n;)T();p()}catch(O){e.error(O)}}))};return t.subscribe(Si(e,h,function(){d=!0,p()})),function(){c==null||c()}}function Mm(t,e,r){return r===void 0&&(r=1/0),te(e)?Mm(function(n,i){return jm(function(s,o){return e(n,s,i,o)})(gs(t(n,i)))},r):(typeof e=="number"&&(r=e),hs(function(n,i){return cN(n,i,t,r)}))}function uN(t,e){return hs(function(r,n){var i=0;r.subscribe(Si(n,function(s){return t.call(e,s,i++)&&n.next(s)}))})}function zl(t){return e=>{const r=hm(t!=null?t:{}),n=e.subscribe({next:i=>r.next(i),error:i=>r.error(Re(i)),complete:()=>r.complete()});return{[Symbol.dispose]:()=>n.unsubscribe()}}}function zj(t){return new He(e=>{const r=t.subscribe(e);return()=>r[Symbol.dispose]()})}function lN(t){const e=sN(t);return{subscribe:r=>zl(r)(e)}}function fN(t){var n;const e=t.data.data,r=new Gl((n=e.errorMessage)!=null?n:"Unknown error");return Object.assign(r,e),r}class Gl extends w{}class dN extends Gl{constructor(r){super("Unknown action: ".concat(r));S(this,"action");this.action=r}toJSON(){return{...super.toJSON(),action:this.action}}}class pN extends Gl{constructor(r,n,i){super("Timeout waiting for response for ".concat(n,"()"));S(this,"id");S(this,"action");S(this,"data");this.id=r,this.action=n,this.data=i}toJSON(){return{...super.toJSON(),action:this.action,id:this.id,data:this.data}}}function hN(t){return t.data.status==="failure"}function bi(t){return{kind:"transferable",port:t}}function Gj(t){return{kind:"serializable",port:t}}var Et,Lo,W,we,mn,Ht,zi,Gi,vr,Uo,Fm;class _i{constructor(e,r){g(this,Uo);g(this,Et,new DisposableStack);g(this,Lo,new Iv);g(this,W);g(this,we);g(this,mn);g(this,Ht);g(this,zi);g(this,Gi,new Bl);g(this,vr,new Map);var c,u,l,f,d;v(this,we,e),v(this,mn,r.handler);const n=(c=r.logger)==null?void 0:c.name,i=(u=r.logger)==null?void 0:u.location;v(this,W,E.createLogger(["RPC",i,n].filter(Boolean).join("/"),(l=r.logger)==null?void 0:l.context)),v(this,Ht,(f=r.report)!=null?f:null),v(this,zi,(d=r.allowClientsToDispose)!=null?d:!1);const s=new AbortController;a(this,Et).defer(()=>{a(this,W).verbose("RPC disposed."),s.abort(),a(this,vr).forEach(p=>p(R(new kr)))}),a(this,Et).use(b(a(this,Gi),Mm(p=>m(this,Uo,Fm).call(this,p)),zl({next:([p,h])=>{p.data.status==="failure"&&a(this,W).error("Outbound ".concat(p.action," error response:"),Re(p.data.data),{delivery:!1});try{a(this,we).kind==="transferable"?a(this,we).port.postMessage(p,h!=null?h:[]):a(this,we).port.postMessage(p)}catch(y){a(this,W).error("Unexpected error calling postMessage",Re(y),{delivery:!1})}},error:p=>{a(this,W).error("Unexpected error responding to inbound RPC message",p,{delivery:!1})}}))),a(this,we).port.addEventListener("message",p=>{switch(p.data.type){case"request":{a(this,Gi).next(p.data);break}case"response":{p.data.data.status==="failure"&&a(this,W).error("Inbound ".concat(p.data.action," error response:"),Re(p.data.data.data),{delivery:!1});const h=a(this,vr).get(p.data.id);h?h(P(p.data)):(a(this,W).warn('Unexpected response with "'.concat(p.data.action,'" action.'),{delivery:!1}),a(this,W).verbose("Unexpected response:",p.data));break}default:throw new tt(p.data)}},{signal:s.signal});const o=a(this,we).port;o instanceof MessagePort&&(o.addEventListener("messageerror",p=>a(this,W).error("MessagePort error:",Re(p),{delivery:!1}),{signal:s.signal}),o.addEventListener("error",p=>a(this,W).error("MessagePort error:",Re(p),{delivery:!1}),{signal:s.signal}),o.addEventListener("close",()=>a(this,W).verbose("MessagePort closed."),{signal:s.signal})),a(this,we).port.start()}createClient(){const e=new Set(["then","toJSON"]);return new Proxy({},{get:(r,n)=>{if(e.has(n))return;const i=n;if(!e.has(n))return(s,o)=>{var _;if(a(this,Et).disposed)return Q(new kr);const c=a(this,Lo).next(),u=Promise.withResolvers(),l=performance.now();let f=!1;const d=setTimeout(()=>{f=!0,u.resolve(R(new pN(c,String(i),s)))},(_=o==null?void 0:o.timeout)!=null?_:6e4),p=()=>{a(this,vr).delete(c),clearTimeout(d)},h=k=>{var O,re;if(p(),f){a(this,W).warn('RPC response for "'.concat(String(i),'" was received after timeout.'),{delivery:!1}),a(this,W).verbose("RPC response after timeout:",{action:i,request:s,response:k});return}if(De(k)){u.resolve(k);return}const T=k.value;if(hN(T)){const ie=fN(T);(O=a(this,Ht))==null||O.call(this,{kind:"outbound",action:i,durationInMs:performance.now()-l,error:ie}),u.resolve(R(ie))}else(re=a(this,Ht))==null||re.call(this,{kind:"outbound",action:i,durationInMs:performance.now()-l}),u.resolve(P(T.data.data))},y={id:c,type:"request",action:String(i),data:s};return a(this,vr).set(c,h),b(Sl(()=>{var k;a(this,we).kind==="transferable"?a(this,we).port.postMessage(y,(k=o==null?void 0:o.transfer)!=null?k:[]):a(this,we).port.postMessage(y)}),ml(Ie(k=>{a(this,W).error("Failed to send request:",k,{delivery:!1}),h(R(k))}))),u.promise}},has:(r,n)=>typeof n=="string"||n===Symbol.asyncDispose,set:()=>!1})}[Symbol.dispose](){return a(this,Et).dispose()}}Et=new WeakMap,Lo=new WeakMap,W=new WeakMap,we=new WeakMap,mn=new WeakMap,Ht=new WeakMap,zi=new WeakMap,Gi=new WeakMap,vr=new WeakMap,Uo=new WeakSet,Fm=async function(e){var c,u;if(a(this,Et).disposed)return a(this,W).warn("Received request after RPC was disposed.",{delivery:!1}),a(this,W).verbose("Request after dispose:",e),[{id:e.id,type:"response",action:e.action,data:{status:"failure",data:new kr}},null];if(a(this,zi)&&e.action===String(Symbol.asyncDispose)){a(this,W).verbose("Received dispose request. Disposing RPC.");try{return[{id:e.id,type:"response",action:e.action,data:{status:"success",data:null}},null]}finally{setTimeout(()=>a(this,Et).dispose(),0)}}const r=e.action,n=a(this,mn)[r];if(!n)return[{id:e.id,type:"response",action:e.action,data:{status:"failure",data:new dN(e.action)}},null];const i=[],s={transfer:a(this,we).kind==="serializable"?void 0:(l,f)=>(i==null||i.push(...f),l)},o=performance.now();try{const l=await Reflect.apply(n,a(this,mn),[e.data,s]);return De(l)?((c=a(this,Ht))==null||c.call(this,{kind:"inbound",action:e.action,durationInMs:performance.now()-o,error:l.error}),[{id:e.id,type:"response",action:e.action,data:{status:"failure",data:l.error}},i]):((u=a(this,Ht))==null||u.call(this,{kind:"inbound",action:e.action,durationInMs:performance.now()-o}),[{id:e.id,type:"response",action:e.action,data:{status:"success",data:l.value}},i])}catch(l){throw a(this,W).error("Unhandled error in RPC handler. An RPC handler MUST NOT throw.",Re(l),{delivery:!1}),l}};function gN(t){return Lm(t)}function Wj(t){return Lm(t)}function Lm(t){const e=new Set(["then","toJSON"]);return new Proxy({},{get:(r,n)=>{if(!e.has(n))return async(...i)=>b(t,N(s=>Reflect.apply(Reflect.get(s,n),s,i)))},has:(r,n)=>typeof n=="string"&&!e.has(n),set:()=>!1})}function vN(t){const e=new D1,r=new Em(new Set);return E.verbose("Creating connect event source"),globalThis.addEventListener("connect",n=>{const i=n.ports[0];if(!i){E.warn("MessagePort missing on connect event",{delivery:!1});return}E.verbose("Received connect event",{port:i});const s=Promise.withResolvers(),o=new _i(bi(i),{logger:{location:"Background",name:"Window"},handler:{connect:(c,u)=>(t.resolve({windowId:c.windowId,groupId:c.groupId,client:c.client,clientVersion:c.clientVersion,capiSource:c.capiSource,realm:"background",servicesEnvironment:c.servicesEnvironment}),b(s.promise,x(Ie(()=>{const l=new Set(r.value);c.plugins.forEach(f=>l.add(f)),l.size>r.value.size&&r.next(l)})),N(l=>l.connect(c,u)))),disposeConnector:(c,u)=>b(s.promise,N(l=>l.disposeConnector(c,u)))}});e.next(c=>(s.resolve(P(c)),o))}),{connectEventSource:e,pluginRequests:lN(r)}}const Um="@grammarly/plugin-capi-suggestion",Bm="0.0.0",zm={"@grammarly/plugin-capi":"","@grammarly/plugin-document-session":"","@grammarly/plugin-suggestion":""},Gm={};var mN={name:Um,version:Bm,dependencies:zm,optionalDependencies:Gm},yN=Object.freeze({__proto__:null,default:mN,dependencies:zm,name:Um,optionalDependencies:Gm,version:Bm});const Wm="@grammarly/plugin-capi",Hm="0.0.0",Km={},Jm={"@grammarly/plugin-connector":"","@grammarly/plugin-document-group":"","@grammarly/plugin-document-session":""},Vm={};var SN={name:Wm,version:Hm,inkwell:Km,dependencies:Jm,optionalDependencies:Vm},bN=Object.freeze({__proto__:null,default:SN,dependencies:Jm,inkwell:Km,name:Wm,optionalDependencies:Vm,version:Hm});const Ym="@grammarly/plugin-connector",qm="0.0.0",Xm={},Zm={"@grammarly/plugin-monitoring":""},Qm={};var _N={name:Ym,version:qm,inkwell:Xm,dependencies:Zm,optionalDependencies:Qm},EN=Object.freeze({__proto__:null,default:_N,dependencies:Zm,inkwell:Xm,name:Ym,optionalDependencies:Qm,version:qm});const ey="@grammarly/plugin-document-group",ty="0.0.0",ry={},ny={"@grammarly/plugin-connector":"","@grammarly/plugin-monitoring":"","@grammarly/plugin-window-management":""},iy={};var wN={name:ey,version:ty,inkwell:ry,dependencies:ny,optionalDependencies:iy},$N=Object.freeze({__proto__:null,default:wN,dependencies:ny,inkwell:ry,name:ey,optionalDependencies:iy,version:ty});const sy="@grammarly/plugin-document-session",oy="0.0.0",ay={},cy={"@grammarly/plugin-connector":"","@grammarly/plugin-monitoring":"","@grammarly/plugin-document-group":"","@grammarly/plugin-ui":""},uy={};var kN={name:sy,version:oy,inkwell:ay,dependencies:cy,optionalDependencies:uy},TN=Object.freeze({__proto__:null,default:kN,dependencies:cy,inkwell:ay,name:sy,optionalDependencies:uy,version:oy});const ly="@grammarly/plugin-inline-assistant",fy="0.0.0",dy={sduiComponents:["inlineCard"]},py={"@grammarly/plugin-capi-suggestion":"","@grammarly/plugin-connector":"","@grammarly/plugin-document-session":"","@grammarly/plugin-inline-card":"","@grammarly/plugin-inline-decorations":"","@grammarly/plugin-sdui":"","@grammarly/plugin-suggestion":""},hy={};var IN={name:ly,version:fy,inkwell:dy,dependencies:py,optionalDependencies:hy},ON=Object.freeze({__proto__:null,default:IN,dependencies:py,inkwell:dy,name:ly,optionalDependencies:hy,version:fy});const gy="@grammarly/plugin-inline-card",vy="0.0.0",my={"@grammarly/plugin-document-group":"","@grammarly/plugin-document-session":"","@grammarly/plugin-text-decoration":"","@grammarly/plugin-window-management":"","@grammarly/plugin-ui":""},yy={};var xN={name:gy,version:vy,dependencies:my,optionalDependencies:yy},PN=Object.freeze({__proto__:null,default:xN,dependencies:my,name:gy,optionalDependencies:yy,version:vy});const Sy="@grammarly/plugin-inline-decorations",by="0.0.0",_y={},Ey={"@grammarly/plugin-capi":"","@grammarly/plugin-connector":"","@grammarly/plugin-document-group":"","@grammarly/plugin-document-session":"","@grammarly/plugin-capi-suggestion":"","@grammarly/plugin-text-decoration":"","@grammarly/plugin-window-management":"","@grammarly/plugin-ui":""},wy={};var RN={name:Sy,version:by,inkwell:_y,dependencies:Ey,optionalDependencies:wy},DN=Object.freeze({__proto__:null,default:RN,dependencies:Ey,inkwell:_y,name:Sy,optionalDependencies:wy,version:by});const $y="@grammarly/plugin-monitoring",ky="0.0.0",Ty={},Iy={},Oy={};var CN={name:$y,version:ky,inkwell:Ty,dependencies:Iy,optionalDependencies:Oy},AN=Object.freeze({__proto__:null,default:CN,dependencies:Iy,inkwell:Ty,name:$y,optionalDependencies:Oy,version:ky});const xy="@grammarly/plugin-sdui",Py="0.0.0",Ry={"@grammarly/plugin-capi":"","@grammarly/plugin-capi-suggestion":"","@grammarly/plugin-document-group":"","@grammarly/plugin-document-session":"","@grammarly/plugin-suggestion":""},Dy={};var NN={name:xy,version:Py,dependencies:Ry,optionalDependencies:Dy},jN=Object.freeze({__proto__:null,default:NN,dependencies:Ry,name:xy,optionalDependencies:Dy,version:Py});const Cy="@grammarly/plugin-suggestion",Ay="0.0.0",Ny={},jy={"@grammarly/plugin-document-session":""},My={};var MN={name:Cy,version:Ay,inkwell:Ny,dependencies:jy,optionalDependencies:My},FN=Object.freeze({__proto__:null,default:MN,dependencies:jy,inkwell:Ny,name:Cy,optionalDependencies:My,version:Ay});const Fy="@grammarly/plugin-text-decoration",Ly="0.0.0",Uy={"@grammarly/plugin-document-session":"","@grammarly/plugin-monitoring":"","@grammarly/plugin-window-management":""},By={};var LN={name:Fy,version:Ly,dependencies:Uy,optionalDependencies:By},UN=Object.freeze({__proto__:null,default:LN,dependencies:Uy,name:Fy,optionalDependencies:By,version:Ly});const zy="@grammarly/plugin-ui",Gy="0.0.0",Wy={},Hy={},Ky={};var BN={name:zy,version:Gy,inkwell:Wy,dependencies:Hy,optionalDependencies:Ky},zN=Object.freeze({__proto__:null,default:BN,dependencies:Hy,inkwell:Wy,name:zy,optionalDependencies:Ky,version:Gy});const Jy="@grammarly/plugin-window-management",Vy="0.0.0",Yy={},qy={};var GN={name:Jy,version:Vy,dependencies:Yy,optionalDependencies:qy},WN=Object.freeze({__proto__:null,default:GN,dependencies:Yy,name:Jy,optionalDependencies:qy,version:Vy});function Ei(t=Symbol()){return t}function ee(t){return typeof t=="string"?t:typeof t=="symbol"?t.toString():t.name}function eh(t){return typeof t=="function"&&t.prototype!==void 0}class th extends w{constructor(r,n){super('The "'.concat(ee(r),'" token does not exist.')+(n?" Context:\n".concat(String(n)):""));S(this,"token");this.token=r}}class rh extends w{constructor(r,n){super('Unsupported lifetime "'.concat(r,'" for "').concat(ee(n.token),'" provider.'));S(this,"lifetime");S(this,"provider");this.lifetime=r,this.provider=n}}class nh extends w{constructor(r){super('Lifetime is not specified for "'.concat(ee(r.token),'" provider.'));S(this,"provider");this.provider=r}}class Xy extends w{constructor(r,n,i){super('Incorrect number of dependencies provided for "'.concat(ee(r.token),'". Expected ').concat(n,", got ").concat(i,"."));S(this,"provider");this.provider=r}}class HN extends w{constructor(r,n,i){const s=n.findIndex(o=>o===i);super('A circular dependency is detected during registration of "'.concat(ee(r.token),'" (').concat(n.slice(0,s+1).map(o=>ee(o)).join(" -> ")," -> ").concat(ee(i),")."));S(this,"provider");this.provider=r}}class KN extends w{constructor(r,n){super('An error occurred while resolving "'.concat(ee(r),'" token.'),n);S(this,"token");this.token=r}}function JN(t){return t!==null&&typeof t=="object"||typeof t=="function"}const oe={Transient:"Transient",Singleton:"Singleton",ContainerScoped:"ContainerScoped"},Z={Class:"Class",Value:"Value",Token:"Token",Factory:"Factory"};function ti(t){if("useClass"in t)return{type:Z.Class,...t};if("useValue"in t)return{type:Z.Value,...t};if("useToken"in t)return{type:Z.Token,...t};if("useFactory"in t)return{type:Z.Factory,...t};throw new tt(t)}var st,Wn,Zy,Qy;class Vs{constructor(e,r){g(this,Wn);S(this,"provider");S(this,"options");g(this,st,null);this.provider=e,this.options=r}getInstance(){return a(this,st)!==null?a(this,st).value:this.provider.type===Z.Value?this.provider.useValue:null}resolve(e,r){var n,i;return a(this,st)!==null?P(a(this,st).value):((i=(n=this.options).onResolution)==null||i.call(n),b(m(this,Wn,Zy).call(this,e,r),ml(s=>{var o,c;return(c=(o=this.options).onResolutionFailure)==null||c.call(o,s),new KN(this.provider.token,s)}),ne(s=>{var o,c;return(c=(o=this.options).onResolutionSuccess)==null||c.call(o),(this.options.lifetime===oe.ContainerScoped||this.options.lifetime===oe.Singleton)&&v(this,st,{value:s}),s})))}async[Symbol.asyncDispose](){var r,n;(r=Tr())==null||r.recordEvent("dispose",{token:ee(this.provider.token)});const e=(n=a(this,st))==null?void 0:n.value;v(this,st,null),JN(e)&&E1(e)&&await ha(e)}}st=new WeakMap,Wn=new WeakSet,Zy=function(e,r){var n;switch(this.provider.type){case Z.Class:return m(this,Wn,Qy).call(this,this.provider.useClass);case Z.Value:return P(this.provider.useValue);case Z.Factory:return(n=Tr())==null||n.recordEvent("construct",{token:ee(this.provider.token),useFactory:String(this.provider.useFactory)}),this.provider.useFactory({resolve:i=>e.resolve(i,r)},r);case Z.Token:return e.resolve(this.provider.useToken,r);default:return R(new tt(this.provider))}},Qy=function(e){var r;return(r=Tr())==null||r.recordEvent("construct",{token:ee(this.provider.token),useClass:e.name}),e.length===0?Sl(()=>new e):R(new Xy(this.provider,e.length,0))};var se;class VN{constructor(){g(this,se,new Map)}add(e){const r=e.provider.token;let n=a(this,se).get(r);n||(n=[],a(this,se).set(r,n)),n.unshift(e)}remove(e){const r=a(this,se).get(e.provider.token);if(!r)return;const n=r.indexOf(e);n!==-1&&r.splice(n,1)}get(e){const r=a(this,se).get(e);return r==null?void 0:r[0]}has(e){return a(this,se).has(e)&&a(this,se).get(e).length>0}keys(){return a(this,se).keys()}entries(){return a(this,se).entries()}getAll(e){var r;return(r=a(this,se).get(e))!=null?r:[]}setAll(e,r){a(this,se).set(e,r)}removeAll(e){a(this,se).delete(e)}async[Symbol.asyncDispose](){await ha(Array.from(a(this,se).values()).flat())}*[Symbol.iterator](){yield*a(this,se)}}se=new WeakMap;var $e,Kt,wt,Me,Bo,H,tS,oi,rS,nS,oo,iS,sS;class eS{constructor(e="",r){g(this,H);g(this,$e,new VN);g(this,Kt,new Map);g(this,wt,new AsyncDisposableStack);S(this,"label");g(this,Me,[]);g(this,Bo,Pr);this.label=e,Array.isArray(r)?a(this,Me).push(...r):r&&a(this,Me).push(r),a(this,wt).use(a(this,$e)),a(this,wt).defer(()=>{a(this,Me).length=0,a(this,Kt).clear()})}get _isAbstract(){return!1}override(e,r){throw new Error("Overrides are only supported in test environments.")}findAllInstances(e){const r=[];if(eh(e)){for(const[n,i]of a(this,$e).entries())for(const s of i){const o=s.getInstance();o instanceof e&&r.push(o)}a(this,Kt).forEach(n=>{n instanceof e&&r.push(n)})}else{const n=new Set([e,...m(this,H,oo).call(this,e)]);for(const i of n){for(const o of a(this,$e).getAll(i)){const c=o.getInstance();c!==null&&r.push(c)}const s=a(this,Kt).get(i);s!==void 0&&r.push(s)}}for(const n of a(this,Me))r.push(...n.findAllInstances(e));return r}register(e,r){return a(this,wt).disposed?R(new kr):b(m(this,H,sS).call(this,e,r),ne(n=>{if(n.override===!1&&a(this,$e).has(e.token))return pt(It);const i=new Vs(ti(e),n);return a(this,$e).add(i),pt(()=>a(this,$e).remove(i))}))}resolve(e,r){var i;if(a(this,wt).disposed)return R(new kr);const n=m(this,H,nS).call(this,e);return n===null?R(new th(e,void 0)):(this!==n.container&&((i=Tr())==null||i.recordEvent("resolve",{token:ee(e),container:n.container.label})),n.registration.resolve(this,r!=null?r:{}))}toString(){const e=Array.from(a(this,$e).entries()),r=i=>{const s=ti(i.provider);switch(s.type){case Z.Class:return"class ".concat(s.useClass.name);case Z.Factory:return"factory";case Z.Token:return ee(s.useToken);case Z.Value:return"value";default:throw new tt(s)}},n=e.length>0?e.map(([i,s])=>" - ".concat(ee(i))+" = ".concat(s.map(r).join(", "))).join("\n"):" - (empty)";return"".concat(this.label,"(").concat(a(this,Me).length,"):\n").concat(n,"\n")+a(this,Me).map(i=>i.toString()).join("")}[Symbol.asyncDispose](){return a(this,wt).disposeAsync()}}$e=new WeakMap,Kt=new WeakMap,wt=new WeakMap,Me=new WeakMap,Bo=new WeakMap,H=new WeakSet,tS=function(e){var r,n;return(n=(r=m(this,H,oi).call(this,e))==null?void 0:r.registration)!=null?n:null},oi=function(e){var n;const r=a(this,$e).get(e);if(r!==void 0)return{container:this,registration:r};for(const i of a(this,Me)){const s=m(n=i,H,oi).call(n,e);if(s!==null)return i._isAbstract?{container:this,registration:m(this,H,rS).call(this,s.registration)}:s}return null},rS=function(e){const r=new Vs(ti(e.provider),e.options);return a(this,$e).add(r),r},nS=function(e){var s;const r=m(this,H,oi).call(this,e);if(r===null)return eh(e)?(E.warn("Creating a transient registration for a constructor token="+ee(e),{context:"DependencyContainer",delivery:!1}),{container:this,registration:a(this,wt).use(new Vs({type:Z.Class,token:e,useClass:e},{lifetime:oe.Transient}))}):null;const{container:n,registration:i}=r;return n!==this&&i.options.lifetime===oe.ContainerScoped?(a(this,$e).add(new Vs(ti(i.provider),i.options)),{container:this,registration:(s=a(this,$e).get(e))!=null?s:i}):{container:n,registration:i}},oo=function(e){const r=new Set(a(this,Me).flatMap(i=>{var s;return m(s=i,H,oo).call(s,e)})),n=m(this,H,oi).call(this,e);if(r.add(e),n){const{registration:i}=n;if("useToken"in i.provider&&i.provider.useToken&&!r.has(i.provider.useToken))for(const s of m(this,H,oo).call(this,i.provider.useToken))r.add(s)}return Array.from(r)},iS=function(e){var r;if(a(this,Kt).has(e))return P(a(this,Kt).get(e));for(const n of a(this,Me)){const i=m(r=n,H,iS).call(r,e);if(wo(i))return i}return R(new th(e))},sS=function(e,r){var i,s;if(!a(this,Bo))return P(r!=null?r:{lifetime:oe.Transient});const n=ti(e);switch(n.type){case Z.Factory:{if(!r)return R(new nh(n));break}case Z.Class:{if(!r)return R(new nh(n));const o=n.useClass;if(o.length!==0)return R(new Xy(n,o.length,0));break}case Z.Token:{const o=(i=r==null?void 0:r.lifetime)!=null?i:oe.Transient;if(o!==oe.Transient)return R(new rh(o,e));const c=[n.token];let u=n;for(;u!==null;){if(c.includes(u.useToken))return R(new HN(e,c,u.useToken));c.push(u.useToken);const l=m(this,H,tS).call(this,u.useToken);l!==null&&"useToken"in l.provider?u=l.provider:u=null}break}case Z.Value:{const o=(s=r==null?void 0:r.lifetime)!=null?s:oe.Transient;switch(o){case oe.Singleton:case oe.Transient:break;default:return R(new rh(o,e))}}}return P(r!=null?r:{lifetime:oe.Transient})};class YN extends eS{constructor(e="",r=null){super(e,r!=null?r:void 0)}get _isAbstract(){return!0}resolve(e,r){return R(new kr)}}const qN=Ei(Symbol("EnvConfig"));function XN(t){return!0}function ZN(t){var r;const e={staticBundles:bc((r=t.staticBundles)!=null?r:{}),dynamicBundles:bc(t.dynamicBundles),metadata:bc(t.metadata)};return{async load(n){return xt(async()=>{var s,o;const i=(o=(s=e.staticBundles)==null?void 0:s[n])!=null?o:e.dynamicBundles[n];if(!i)throw new ih("@grammarly/plugin-".concat(n));return typeof i=="function"?await i():i})},loadMetadata(n){return Sl(()=>{var o,c,u;const i=e.metadata[n];if(!i)throw new ih("@grammarly/plugin-".concat(n,"/package.json"));const s=i.inkwell;if(!XN(s))throw new QN("Invalid inkwell metadata: ".concat(n));return{packageName:n.startsWith("@grammarly/plugin-")?n:"@grammarly/plugin-".concat(n),dependencies:Object.keys({...i.dependencies}).filter(l=>l.startsWith("@grammarly/plugin-")).map(l=>l.slice(18)),optionalDependencies:Object.keys({...i.optionalDependencies}).filter(l=>l.startsWith("@grammarly/plugin-")).map(l=>l.slice(18)),experiments:Object.fromEntries(Object.entries((o=s==null?void 0:s.experiments)!=null?o:{}).map(([l,{treatments:f}])=>[l,Object.keys(f)])),gates:Object.keys({...s==null?void 0:s.gates}),capiFeatures:[...(c=s==null?void 0:s.capiFeatures)!=null?c:[]],sduiComponents:[...(u=s==null?void 0:s.sduiComponents)!=null?u:[]]}})}}}function bc(t){return Object.fromEntries(Object.entries(t).map(([e,r])=>{let n=e;if(n.endsWith("/package.json")&&(n=n.slice(0,-13)),n.endsWith("/src/index.ts")&&(n=n.slice(0,-13)),n=n.split("/").pop(),n.startsWith("plugin-"))n=n.slice(7);else throw new w("Invalid plugin module: ".concat(e));return[n,r]}))}class ih extends w{constructor(r){super("Module not found: ".concat(r));S(this,"moduleId");this.moduleId=r}}class QN extends w{constructor(r){super("Invalid metadata: ".concat(r));S(this,"moduleId");this.moduleId=r}}function Hj(t){for(const e of t)return e}function ej(t){return function*(e){for(const r of e)t(r)&&(yield r)}}function Kj(t){return function*(e){for(const r of e){if(t<=0)break;yield r,t--}}}function Jj(t){return function*(e){for(const r of e){if(!t(r))return;yield r}}}function Ro(t){return function*(e){for(const r of e)yield t(r)}}function Vj(t){return function*(e){for(const r of e)yield*t(r)}}function*Yj(t){const e=new Set;for(const r of t)e.has(r)||(e.add(r),yield r)}function*qj(...t){for(const e of t)yield*e}function*Xj(t,e){const r=t[Symbol.iterator](),n=e[Symbol.iterator]();for(;;){const i=r.next(),s=n.next();if(i.done||s.done)break;yield[i.value,s.value]}}function Zj(t){return Array.isArray(t)?t:[...t]}function Qj(t){return t instanceof Set?t:new Set(t)}function eM(t,e){const r=new Map;let n=0;for(const i of t){const s=e(i,n++),o=r.get(s);o?o.push(i):r.set(s,[i])}return r}async function tj(t={}){var i,s;var o=[];try{const e=ue(o,new DisposableStack);const r=(i=t.id)!=null?i:ir();const n=(s=t.otherId)!=null?s:ir();return await b(sh(r),jn(ft.use(e)),N(f=>b(sh(n),jn(ft.use(e)),x(d=>[f,d]))),x(([f,d])=>{const p=e.move();return b(d.held,ae(h=>h instanceof bu?D():Q(h)),N(()=>{var y;if(p.disposed)return D();(y=t.onConnection)==null||y.call(t);const h=new AbortController;return p.defer(()=>h.abort()),oS(d.id,h.signal)}),x(()=>{var h;p.disposed||(h=t.onConnectionLost)==null||h.call(t)}),ae(h=>(h instanceof aS||(t.onConnectionError?t.onConnectionError(h):E.error(h)),D()))),b(f.held,ae(h=>(t.onConnectionError?t.onConnectionError(h):E.error(h),D()))),{id:n,otherId:r,[Symbol.dispose]:()=>p.dispose()}}))}catch(c){var u=c,l=!0}finally{le(o,u,l)}}async function rj(t,e={}){var n=[];try{const r=ue(n,new DisposableStack);return await b(nj(t.id),jn(ft.use(r)),x(c=>{const u=r.move(),l=new AbortController;return u.defer(()=>l.abort()),queueMicrotask(()=>{var f;u.disposed||(f=e.onConnection)==null||f.call(e)}),b(oS(t.otherId,l.signal),x(()=>{var f;u.disposed||(f=e.onConnectionLost)==null||f.call(e)}),ae(f=>{var d;return u.disposed||(d=e.onConnectionError)==null||d.call(e,f),D()})),b(c.held,ae(f=>{var d;return u.disposed||(d=e.onConnectionError)==null||d.call(e,f),D()})),u}))}catch(i){var s=i,o=!0}finally{le(n,s,o)}}function sh(t){return Wl(t,{mode:"exclusive"})}function nj(t){return Wl(t,{mode:"exclusive",steal:!0})}function Wl(t,e){var c;const r=new DisposableStack,n=new AbortController,i=Promise.withResolvers(),s=Promise.withResolvers();(c=e.signal)==null||c.addEventListener("abort",()=>r.dispose(),{signal:n.signal});const o=b(xt(()=>navigator.locks.request(t,e,u=>u?(i.resolve(),s.promise):i.reject(new ij))),dt(u=>u.name==="AbortError"?new bu:u.name==="DOMException"&&/(steal|stolen)/i.test(u.message)?new bu:u));return r.defer(()=>{i.reject(new aS),s.resolve(),n.abort()}),b(xt(()=>i.promise),x(()=>({id:t,held:o,[Symbol.dispose]:()=>r.dispose()})))}function oS(t,e){return b(Wl(t,{mode:"exclusive",signal:e}),x(r=>cm(r)))}class bu extends w{constructor(){super("Lock stolen");S(this,"kind","LockStolenError")}}class ij extends w{constructor(){super("Lock failed");S(this,"kind","LockFailedError")}}class aS extends w{constructor(){super("Lock disposed");S(this,"kind","LockDisposedError")}}class ri extends w{constructor(r){super("Invalid state.");S(this,"current");S(this,"expected");this.current=r.current,this.expected=r.expected}toJSON(){return{...super.toJSON(),current:this.current,expected:this.expected}}}let Jr=class extends w{constructor(r,n,i){super("Error ".concat(r?'in "'.concat(r,'" plugin '):"","was caught and suppressed during ").concat(i,"."),n);S(this,"plugin");this.plugin=r}};class sj extends w{constructor(r){super("Entity not found");S(this,"plugin");S(this,"entity");this.plugin=r.plugin,this.entity=r.entity}toJSON(){return{...super.toJSON(),plugin:this.plugin,entity:this.entity}}}class oj extends w{constructor(r){super("Entity already registered");S(this,"plugin");S(this,"entity");this.plugin=r.plugin,this.entity=r.entity}toJSON(){return{...super.toJSON(),plugin:this.plugin,entity:this.entity}}}class aj extends w{constructor(r,n,i){super("Execution scope already exists.");S(this,"scope");S(this,"associatedPlugin");S(this,"currentPlugin");this.scope=r,this.associatedPlugin=n,this.currentPlugin=i}toJSON(){return{...super.toJSON(),scope:this.scope,associatedPlugin:this.associatedPlugin,currentPlugin:this.currentPlugin}}}class _u extends w{constructor(r,n){super("Execution scope not found.");S(this,"scope");S(this,"scopeId");S(this,"kind","ExecutionScopeNotFoundError");this.scope=r,this.scopeId=n}toJSON(){return{...super.toJSON(),scope:this.scope,scopeId:this.scopeId}}}class cj extends w{constructor(r,n,i){super("Failed to resolve dependency.",i);S(this,"token");S(this,"pluginPackage");this.token=r,this.pluginPackage=n}toJSON(){return{...super.toJSON(),token:ee(this.token),pluginPackage:this.pluginPackage}}}class uj extends w{constructor(r,n){super("Failed to activate plugin.",n);S(this,"plugin");this.plugin=r}toJSON(){return{...super.toJSON(),plugin:this.plugin}}}class lj extends w{constructor(r){super("Plugin not found.");S(this,"plugin");this.plugin=r}toJSON(){return{...super.toJSON(),plugin:this.plugin}}}class fj extends w{constructor(r){super("Plugin does not expose a valid API.");S(this,"plugin");this.plugin=r}toJSON(){return{...super.toJSON(),plugin:this.plugin}}}const Gn=[];function Ot(){var t;return(t=Gn[Gn.length-1])!=null?t:null}function cS(t){Gn.push(t)}function Eu(){Gn.pop()}function qe(t,e){try{return cS(t),e()}finally{Eu()}}function dj(){const t=Ot();for(let e=Gn.length-1;e>=0;e--){const r=Gn[e];if(r!==t)return r}return null}var Jt;class pj{constructor(){g(this,Jt,new Map)}add(e,r){const n=new oh(e,r.token);return a(this,Jt).has(n.toString())?R(new oj(n)):(a(this,Jt).set(n.toString(),r),P(pt(()=>a(this,Jt).delete(n.toString()))))}get(e,r,n){const i=new oh(e,r),s=a(this,Jt).get(i.toString());return s?"useFactory"in s?P(s.useFactory):n.resolve(s.useToken):R(new sj(i))}[Symbol.dispose](){a(this,Jt).clear()}}Jt=new WeakMap;class oh{constructor(e,r){S(this,"plugin");S(this,"entity");this.plugin=e,this.entity=r}toString(){var e;return"".concat((e=this.plugin)!=null?e:"",":").concat(this.entity)}}const hj=Ei();var U,Wi,Hi,q,ot,Ze,Vt,mr,$t,yn,X,Yt,qt,Sn,fe,Ki,A,kt,V,uS,wu,lS,ai,$u,fS;class gj{constructor(e,r,n=null){g(this,V);S(this,"id");S(this,"name");S(this,"owningPlugin");S(this,"initializationData");g(this,U);g(this,Wi);g(this,Hi,null);g(this,q);g(this,ot);g(this,Ze);g(this,Vt);g(this,mr);g(this,$t);g(this,yn);g(this,X);g(this,Yt);g(this,qt);g(this,Sn);g(this,fe);g(this,Ki);g(this,A,{kind:"created"});g(this,kt);S(this,"ancestors");S(this,"instanceToken");var s,o;v(this,q,new AsyncDisposableStack),a(this,q).defer(()=>a(this,Vt).clear()),this.id=(o=(s=e.id)!=null?s:n==null?void 0:n.id)!=null?o:ir(),this.initializationData=e.data,this.name=e.name,v(this,U,E.createLogger("ExecutionScopeController|".concat(this.name),this.id)),v(this,Wi,Date.now()),this.owningPlugin=e.plugin,this.instanceToken=e.instanceToken,this.ancestors=r?[{scopeName:r.name,scopeId:r.id,owningPlugin:e.plugin},...r.ancestors]:[],v(this,ot,e.executionScopeService),v(this,Ze,r),v(this,Vt,new Set),v(this,mr,a(this,q).use(new pj)),v(this,kt,n!==null),v(this,Sn,e.realm),v(this,Ki,e.getExecutionScopeProxy),v(this,yn,a(this,q).use(To.startSpan("ExecutionScope",{attributes:{id:this.id,name:e.name}}))),v(this,$t,a(this,q).use(new eS("ExecutionScope(".concat(e.name,")"),r?[e.definitionsContainer,a(r,$t)]:[e.definitionsContainer]))),v(this,Yt,e.activationsInProgress),v(this,qt,e),v(this,fe,{onStart:Array.from(e.callbacks.onStart),onStop:Array.from(e.callbacks.onStop)}),a(this,fe).onStart.forEach(c=>{a(this,U).verbose('onStart "'.concat(c.plugin,'" copied'))});const i=e.realm;v(this,X,{id:this.id,name:e.name,hierarchy:r?[...a(r,X).hierarchy,this.id]:[this.id],realm:i.kind==="background"?{kind:"background",registerEntity:c=>a(this,mr).add(Ot(),c)}:{kind:"foreground",connection:i.connection,resolveEntity:(c,{entity:u,disposable:l})=>{const f=Ot(),d=new AbortController;return a(this,q).use(l),a(this,q).defer(()=>d.abort()),b(i.background.getEntity({plugin:f,entity:c,scopeId:this.id,scopeName:this.name}),x(({id:p,transport:h})=>({entity:new _i(h,{handler:u,logger:{location:"Foreground",name:"RemoteEntity/".concat(f,"/").concat(c),context:p}}).createClient(),connection:d.signal})))}},resolve:(c,u)=>a(this,$t).resolve(c,u),createExecutionScopeController:(c,u)=>this.createExecutionScopeController(c,u),observeExecutionScope:c=>({onStart:u=>a(this,ot).registerOnStartCallback(c,u,{condition:l=>l.hierarchy.includes(this.id)}),onStop:u=>a(this,ot).registerOnStopCallback(c,u,{condition:l=>l.hierarchy.includes(this.id)})}),serialize:()=>this.serialize({childList:!0,ancestors:!0})}),a(this,q).defer(async()=>{await m(this,V,uS).call(this)})}get instantiationOrder(){var e;return(e=a(this,Hi))!=null?e:a(this,Wi)}get realm(){return a(this,X).realm}get isReviving(){return a(this,kt)}get isRunning(){return a(this,A).kind==="started"}resume(){a(this,kt)&&(v(this,kt,!1),a(this,A).kind==="started"&&m(this,V,ai).call(this))}start(){switch(a(this,A).kind){case"created":return m(this,V,lS).call(this);case"starting":return b(a(this,A).task,x(()=>a(this,X)));case"started":return D(a(this,X));case"stopping":case"stopped":case"error":return Q(new ri({current:"stopping",expected:"created"}));default:return Q(new tt(a(this,A)))}}getContainerForTesting(){return R(new w("This method is available only in test mode."))}getParentForTesting(){return R(new w("This method is available only in test mode."))}getChildrenForTesting(){throw new w("This method is available only in test mode.")}register(e,r){return a(this,$t).register(e,{lifetime:oe.Transient,...r})}serialize(e={childList:!1,ancestors:!0}){const r={id:this.id,scope:this.name,owningPlugin:this.owningPlugin,instantiationOrder:this.instantiationOrder,children:e.childList?Array.from(a(this,Vt)).map(n=>n.serialize({childList:!0,ancestors:!1})):[],shouldSynchronizeChildren:e.childList,initializationData:this.initializationData,isForkRoot:e.ancestors===!0};if(e.ancestors){let n=a(this,Ze),i=[r];for(;n;)i=[{...n.serialize({childList:!1,ancestors:!1}),children:i,shouldSynchronizeChildren:!1}],n=a(n,Ze);return i[0]}return r}createExecutionScopeController(e,r){return b(a(this,ot).createExecutionScopeController(e,r),ne(Ie(n=>m(this,V,wu).call(this,n))))}createExecutionScopeFromSerialized(e){return b(a(this,ot).createExecutionScopeControllerFromSerialized(e),ne(Ie(r=>m(this,V,wu).call(this,r))))}getExecutionScope(e){return a(this,ot).getExecutionScopeDefinition(e)}onStart(e,r){const n={...e,condition:i=>r.aborted?!1:e.condition(i)};switch(a(this,A).kind){case"created":a(this,fe).onStart.push(n);break;case"started":a(this,fe).onStart.push(n),b(a(this,Yt).waitUntilUnlocked(),N(()=>m(this,V,ai).call(this)));break;case"starting":a(this,fe).onStart.push(n),b(a(this,A).task,N(()=>a(this,Yt).waitUntilUnlocked()),N(()=>m(this,V,ai).call(this)));break;case"error":case"stopping":case"stopped":a(this,U).warn('Ignoring onStart "'.concat(e.plugin,'" (status:').concat(a(this,A).kind,")"),{delivery:!1});break;default:throw new tt(a(this,A))}}onStop(e,r){const n={...e,condition:i=>r.aborted?!1:e.condition(i)};switch(a(this,A).kind){case"created":case"starting":case"started":a(this,fe).onStop.push(n);break;case"error":case"stopping":case"stopped":a(this,U).warn('Ignoring onStop "'.concat(e.plugin,'" (status:').concat(a(this,A).kind,")"),{delivery:!1});break;default:throw new tt(a(this,A))}}use(e){return a(this,q).use(e)}registerEntity(e,r){return a(this,U).verbose('Registering entity provider "'.concat(r.token,'" in "').concat(this.name,'" scope for plugin "').concat(e,'".')),a(this,mr).add(e,r)}resolveEntity(e,r,n,i){return b(a(this,mr).get(e,r,a(this,X)),ne(s=>{const o=new MessageChannel,c=Promise.withResolvers(),u=gN(xt(()=>c.promise)),l=ir(),f=s({entity:u,connection:n});a(this,q).use(f.disposable);const d=new _i(bi(o.port1),{handler:f.entity,logger:{location:"Background",name:"LocalEntity/".concat(e,"/").concat(r),context:"".concat(i,"|").concat(l)}});return a(this,q).use(d),c.resolve(d.createClient()),{id:l,transport:bi(o.port2)}}))}findExecutionScopeController(e,r){return a(this,ot).findExecutionScopeController(e,r)}entangle(e){if(a(this,Sn).kind==="background"){var r=[];try{const o=ue(r,new DisposableStack);return b(a(this,Sn).entangle(e),ft.use(o),ne(()=>o.move()))}catch(n){var i=n,s=!0}finally{le(r,i,s)}}else return R(new w("Foreground realm does not support entanglement."))}[Symbol.asyncDispose](){return a(this,q).disposeAsync()}}U=new WeakMap,Wi=new WeakMap,Hi=new WeakMap,q=new WeakMap,ot=new WeakMap,Ze=new WeakMap,Vt=new WeakMap,mr=new WeakMap,$t=new WeakMap,yn=new WeakMap,X=new WeakMap,Yt=new WeakMap,qt=new WeakMap,Sn=new WeakMap,fe=new WeakMap,Ki=new WeakMap,A=new WeakMap,kt=new WeakMap,V=new WeakSet,uS=function(){var e;switch(a(this,A).kind){case"created":return Q(new ri({current:"created",expected:"started"}));case"starting":return b(a(this,A).task,N(()=>m(this,V,$u).call(this)));case"started":return m(this,V,$u).call(this);case"stopping":return a(this,A).task;case"stopped":return D();case"error":return Q((e=a(this,A).error)!=null?e:new ri({current:"error",expected:"started"}));default:return Q(new tt(a(this,A)))}},wu=function(e){a(this,Vt).add(e),a(this,q).use(e)},lS=function(){if(a(this,A).kind!=="created")return Q(new ri({current:a(this,A).kind,expected:"created"}));a(this,U).verbose('Starting "'.concat(this.name,'" scope(').concat(this.id,").")),v(this,Hi,Date.now());const e=Promise.withResolvers(),r=a(this,yn).startSpan("start");return v(this,A,{kind:"starting",task:xt(()=>e.promise)}),b(ft.all([a(this,$t).register({token:this.instanceToken,useFactory:()=>P(a(this,Ki).call(this,Ot(),a(this,X)))},{lifetime:oe.Transient}),a(this,$t).register({token:hj,useValue:{id:a(this,X).id,name:a(this,X).name,serialize:()=>a(this,X).serialize()}},{lifetime:oe.Transient})]),bl.use(a(this,q)),N(()=>a(this,qt).onBeforeStart()),ae(n=>(a(this,U).error(new Jr(null,n,'starting of "'.concat(this.name,'" scope')),{delivery:!1}),D())),N(()=>a(this,Yt).waitUntilUnlocked()),N(()=>m(this,V,ai).call(this)),x(()=>(v(this,A,{kind:"started"}),e.resolve(),b(a(this,qt).onAfterStart(),ae(n=>(a(this,U).error(new Jr(null,n,'starting of "'.concat(this.name,'" scope')),{delivery:!1}),D()))),a(this,U).verbose('"'.concat(this.name,'" scope(').concat(this.id,") has been started.")),a(this,Ze)?a(this,U).verbose('Adding "'.concat(this.name,'" scope to parent "').concat(a(this,Ze).name,'".')):a(this,U).verbose('"'.concat(this.name,'" scope is a root scope.')),a(this,X))),ko(r),dt(Ie(n=>{v(this,A,{kind:"error",error:n}),a(this,U).error('"'.concat(this.name,'" scope(').concat(this.id,") has failed to start."),n,{delivery:!1}),e.reject(n)})))},ai=function(){if(a(this,kt)||a(this,fe).onStart.length===0)return D();const e=a(this,fe).onStart.slice();a(this,U).verbose("Executing ".concat(e.length,' onStart callback(s) for "').concat(this.name,"(").concat(this.id,')".')),a(this,fe).onStart.length=0;const r=e.map(({plugin:n,callback:i,condition:s},o)=>s(a(this,X))?(a(this,U).verbose('onStart from "'.concat(n,'" executing (').concat(o,"):\n").concat(i.toString())),b(i(a(this,X)),jn(Ie(()=>a(this,U).verbose('onStart from "'.concat(n,'" finished (').concat(o,").")))),x(c=>{c&&a(this,q).use(c)}),ae(c=>(a(this,U).error(new Jr(n,c,'onStart callback of "'.concat(this.name,'" scope')),{delivery:!1}),D())))):D());return b(yi(r),x(It))},$u=function(){if(a(this,A).kind!=="started")return Q(new ri({current:a(this,A).kind,expected:"started"}));const e=Promise.withResolvers(),r=a(this,yn).startSpan("stop");return v(this,A,{kind:"stopping",task:xt(()=>e.promise)}),a(this,Ze)&&(a(a(this,Ze),Vt).delete(this),a(this,U).verbose('Removing "'.concat(this.name,'" scope from parent "').concat(a(this,Ze).name,'".'))),b(a(this,qt).onBeforeStop(),ae(n=>(a(this,U).error(new Jr(null,n,'stopping of "'.concat(this.name,'" scope')),{delivery:!1}),D())),N(()=>a(this,Yt).waitUntilUnlocked()),N(()=>m(this,V,fS).call(this)),x(()=>{v(this,A,{kind:"stopped"}),b(a(this,qt).onAfterStop(),ae(n=>(a(this,U).error(new Jr(null,n,'stopping of "'.concat(this.name,'" scope')),{delivery:!1}),D()))),a(this,U).verbose('"'.concat(this.name,'" scope(').concat(this.id,") has been stopped.")),e.resolve()}),ko(r),dt(Ie(n=>{v(this,A,{kind:"error",error:n}),e.reject(n)})))},fS=function(){if(a(this,kt)||!a(this,fe).onStop.length)return D();const e=a(this,fe).onStop.slice();a(this,U).verbose("Executing ".concat(e.length," onStop callback(s).")),a(this,fe).onStart.length=0;const r=e.map(({plugin:n,callback:i,condition:s})=>s(a(this,X))?(a(this,U).verbose('onStop from "'.concat(n,'" executing...: ').concat(i.toString())),b(i(a(this,X)),ae(o=>(a(this,U).error(new Jr(n,o,'onStop callback of "'.concat(this.name,'" scope')),{delivery:!1}),D())))):D());return b(yi(r),x(It))};function vj(t){return new Do("global",t)}var de,Fe,yr,at,Xt,Sr,br,_r,ge,ao,Yr,ku;const ql=class ql{constructor(e,r,n=null){g(this,ge);S(this,"name");S(this,"instanceToken");g(this,de);g(this,Fe);g(this,yr,new AsyncDisposableStack);g(this,at);g(this,Xt,new Map);g(this,Sr);g(this,br,new Set);g(this,_r,new Set);this.name=e,this.instanceToken=Ei(Symbol("CurrentExecutionScope|".concat(e))),v(this,at,E.createLogger("ExecutionScopeDefinition|".concat(this.name))),v(this,Fe,r),v(this,de,n!=null?n:{scopeDefinitionMap:new Map([[this.name,{plugin:null,definition:this}]]),controllerMap:new Map,entangledRealms:new Set}),v(this,Sr,new YN("ExecutionScopeDefinition(".concat(this.name,")"))),a(this,yr).use(a(this,Sr)),a(this,yr).defer(()=>{a(this,br).clear(),a(this,_r).clear(),a(this,Xt).clear()})}create(e){return m(this,ge,ao).call(this,null,e)}createWithSerializedExecutionScopeData(e){return m(this,ge,ao).call(this,null,e)}getExecutionScopeDefinition(e){return m(this,ge,Yr).call(this,e).definition}getInstancesForTesting(){return R(new w("This method is only available in test mode"))}register(e,r){return a(this,Sr).register(e,{lifetime:oe.Transient,...r})}onStart(e,{condition:r}={}){const n=Ot();n===null&&a(this,at).warn("onStart callback is being registered outside of a plugin context: "+e.toString(),{delivery:!1});const i={plugin:n,callback:e,condition:r!=null?r:()=>!0};a(this,br).add(i),a(this,at).verbose('onStart "'.concat(n,'" added'));const s=new AbortController;for(const o of a(this,Xt).values())a(this,at).verbose('onStart "'.concat(n,'" forwarded for instance "').concat(o.id,'"')),o.onStart(i,s.signal);return pt(()=>{s.abort(),a(this,br).delete(i)})}onStop(e,{condition:r}={}){const n=Ot();n===null&&a(this,at).warn("onStop callback is being registered outside of a plugin context",{delivery:!1});const i={plugin:n,callback:e,condition:r!=null?r:()=>!0};a(this,_r).add(i);const s=new AbortController;for(const o of a(this,Xt).values())o.onStop(i,s.signal);return pt(()=>{s.abort(),a(this,_r).delete(i)})}[Symbol.asyncDispose](){return a(this,yr).disposeAsync()}};de=new WeakMap,Fe=new WeakMap,yr=new WeakMap,at=new WeakMap,Xt=new WeakMap,Sr=new WeakMap,br=new WeakMap,_r=new WeakMap,ge=new WeakSet,ao=function(e=null,r){const n=Ot(),i={id:r.id,data:"data"in r?r.data:r.initializationData},s="initializationData"in r?r:null,o=new gj({id:i.id,name:this.name,data:i.data,realm:a(this,Fe).background?{kind:"foreground",connection:a(this,Fe).connection,background:a(this,Fe).background}:{kind:"background",entangle:c=>{var l=[];try{const u=ue(l,new DisposableStack);a(this,de).entangledRealms.add(c);u.defer(()=>a(this,de).entangledRealms.delete(c));return P(u.move())}catch(f){var d=f,p=!0}finally{le(l,d,p)}}},plugin:n,instanceToken:this.instanceToken,executionScopeService:{getExecutionScopeDefinition:c=>m(this,ge,Yr).call(this,c).definition,createExecutionScopeController:(c,u)=>m(this,ge,ku).call(this,c,o,u),createExecutionScopeControllerFromSerialized:c=>m(this,ge,ku).call(this,c.scope,o,c),registerOnStartCallback:(c,u,l)=>m(this,ge,Yr).call(this,c).definition.onStart(u,l),registerOnStopCallback:(c,u,l)=>m(this,ge,Yr).call(this,c).definition.onStop(u,l),findExecutionScopeController:(c,u)=>{const l=a(this,de).controllerMap.get(u);return l?P(l):R(new _u(c,u))}},definitionsContainer:a(this,Sr),activationsInProgress:a(this,Fe).activationsInProgress,getExecutionScopeProxy:a(this,Fe).getExecutionScopeProxy,onBeforeStart:()=>(a(this,de).controllerMap.set(o.id,o),a(this,Fe).onBeforeStart(this.name)),onAfterStart:()=>{if(!e)return D();const c={scopeName:o.name,scopeId:o.id,owningPlugin:n,ancestors:o.ancestors,initializationData:o.initializationData};for(const u of a(this,de).entangledRealms)b(u.onExecutionScopeStarted(c),dt(Ie(l=>a(this,at).error("Failed to notify entangled realm about scope start",l,{delivery:!1}))));return D()},onBeforeStop:()=>(a(this,Xt).delete(o.id),a(this,de).controllerMap.delete(o.id),a(this,Fe).onBeforeStop(this.name)),onAfterStop:()=>{const c={scopeName:o.name,scopeId:o.id};for(const u of a(this,de).entangledRealms)b(u.onExecutionScopeStopped(c),dt(Ie(l=>a(this,at).error("Failed to notify entangled realm about scope stop",l,{delivery:!1}))));return D()},callbacks:{onStart:Array.from(a(this,br)),onStop:Array.from(a(this,_r))}},e,s);return a(this,Xt).set(o.id,o),a(this,yr).use(o)},Yr=function(e){const r=a(this,de).scopeDefinitionMap.get(e);if(r)return r;const n=new ql(e,a(this,Fe),a(this,de));return a(this,de).scopeDefinitionMap.set(e,{plugin:null,definition:n}),{plugin:null,definition:n}},ku=function(e,r=null,n){var c;const{plugin:i,definition:s}=m(this,ge,Yr).call(this,e),o=Ot();if(e==="global"&&o!==null)return R(new w("Global scope cannot be associated with a plugin"));if(o!==null){if(i===null)a(this,de).scopeDefinitionMap.set(e,{plugin:o,definition:s});else if(o!==null&&i!==o)return R(new aj(e,i,o))}return P(m(c=s,ge,ao).call(c,r,n))};let Do=ql;var ct;class dS{constructor(){g(this,ct,new Em(0));S(this,"isLocked",{subscribe:e=>b(a(this,ct),jm(r=>r>0),zl(e)),getValue:()=>a(this,ct).getValue()>0})}acquire(){return a(this,ct).next(a(this,ct).value+1),pt(()=>this.release())}release(){a(this,ct).next(a(this,ct).value-1)}waitUntilUnlocked(){return b(xt(()=>b(a(this,ct),uN(e=>e===0),aN)),x(It))}}ct=new WeakMap;function Nt(t,e){return new Proxy(t,{get:(r,n)=>{const i=Reflect.get(e,n);if(i!==void 0)return typeof i=="function"?new Proxy(i,{get:(o,c)=>c==="toString"?Reflect.get(Reflect.get(o,c),"toString"):Reflect.get(o,c)}):i;const s=Reflect.get(r,n,r);return typeof s=="function"?function(...o){return Reflect.apply(s,r,o)}:s}})}function mj(t){return new yj(t)}var ke,Er,Le,Ji,Pe,Zt,bn,_n,Qt,Qe,B,pS,hS,gS,vS,mS,Tu,yS,Iu,Ou,xu;class yj{constructor(e){g(this,B);g(this,ke,E.createLogger("ExecutionScopeReviver"));g(this,Er);g(this,Le);g(this,Ji);g(this,Pe);g(this,Zt,new dS);g(this,bn,new Map);g(this,_n);g(this,Qt);g(this,Qe);v(this,Er,new AsyncDisposableStack),v(this,Le,e);const r=new _i(bi(e.backgroundPort),{logger:{location:"Foreground",name:"RealmEntanglement"},handler:{onExecutionScopeStarted:c=>m(this,B,pS).call(this,c),onExecutionScopeStopped:c=>m(this,B,vS).call(this,c)}});a(this,ke).verbose("Reviving execution scopes from:",a(this,Le).executionScopeData),v(this,_n,r.createClient());const n=a(this,Er).use(new Do("global",{...a(this,Le),background:a(this,_n)}));v(this,Ji,n),v(this,Pe,a(this,Er).use(n.createWithSerializedExecutionScopeData(a(this,Le).executionScopeData))),a(this,Zt).acquire();let i=[{scopeName:"global",scopeId:e.executionScopeData.id}];const s=new Set(e.entangledScopes),o=new Set(["global",...s]);Sj(a(this,Le).executionScopeData,(c,u)=>{if(c.isForkRoot&&(i=Array.from(u).reverse().map(l=>({scopeName:l.scope,scopeId:l.id})),i.push({scopeName:c.scope,scopeId:c.id})),s.has(c.scope))for(const l of u)o.add(l.scope)}),v(this,Qt,i),e.entangledScopes?v(this,Qe,{configured:s,allowed:o}):v(this,Qe,null)}getExecutionScopeDefinition(e){return a(this,Ji).getExecutionScopeDefinition(e)}create(){return Nt(a(this,Pe),{start:()=>b(a(this,Pe).start(),N(e=>b(m(this,B,mS).call(this,e),jn(Ie(()=>a(this,Zt).release())),x(()=>a(this,Pe).resume()),x(()=>e))))})}registerReviver(e,r,n){return a(this,ke).verbose('Registering reviver for "'.concat(e,'" execution scope from "').concat(r,'" plugin.')),a(this,bn).set(n,{scope:e,plugin:r,reviver:n}),pt(()=>a(this,bn).delete(n))}[Symbol.asyncDispose](){return a(this,Er).disposeAsync()}}ke=new WeakMap,Er=new WeakMap,Le=new WeakMap,Ji=new WeakMap,Pe=new WeakMap,Zt=new WeakMap,bn=new WeakMap,_n=new WeakMap,Qt=new WeakMap,Qe=new WeakMap,B=new WeakSet,pS=async function(e){if(a(this,ke).verbose('Received broadcast for "'.concat(e.scopeName,"(").concat(e.scopeId,')" scope.')),!e.ancestors.at(0)||(await a(this,Zt).waitUntilUnlocked(),!m(this,B,xu).call(this,e,e.ancestors))||wo(a(this,Pe).findExecutionScopeController(e.scopeName,e.scopeId)))return P();const n=new Map,i=e.ancestors.filter((o,c)=>{const u=a(this,Pe).findExecutionScopeController(o.scopeName,o.scopeId);return wo(u)?(n.set(o.scopeId,u.value.serialize({childList:!1,ancestors:!1})),!1):(n.set(o.scopeId,{id:o.scopeId,owningPlugin:o.owningPlugin,scope:o.scopeName,instantiationOrder:Date.now()-c-1,children:[],shouldSynchronizeChildren:!1,isForkRoot:!1,initializationData:null}),!0)});if(i.length>0){const o=await b(a(this,_n).getExecutionScopeInitializationData({scopes:i}),x(c=>c.forEach(u=>{const l=n.get(u.scopeId);n.set(u.scopeId,{...l,initializationData:u.initializationData})})));if(De(o))return a(this,ke).verbose('Could not find ancestors for "'.concat(e.scopeName,"(").concat(e.scopeId,')" scope. Failing the revival.')),o}const s=e.ancestors.reduce((o,c)=>({...n.get(c.scopeId),children:[o]}),{owningPlugin:e.owningPlugin,id:e.scopeId,scope:e.scopeName,instantiationOrder:Date.now(),children:[],shouldSynchronizeChildren:!(a(this,Qe)&&a(this,Qe).configured.has(e.scopeName)),initializationData:e.initializationData,isForkRoot:!1});return m(this,B,hS).call(this,s)},hS=async function(e){let r=e,n=e.children.at(0);for(;n;){if(De(a(this,Pe).findExecutionScopeController(n.scope,n.id))){const i=await m(this,B,gS).call(this,r,n);if(De(i))return i}r=n,n=n.children.at(0)}return P()},gS=async function(e,r){return a(this,ke).verbose('Reviving remote execution scope "'.concat(r.scope,"(").concat(r.id,')".')),await b(a(this,Pe).findExecutionScopeController(e.scope,e.id),yl(n=>b(m(this,B,Ou).call(this,n,r),ne(i=>({parentController:n,revivedController:i})))),tr,N(async({parentController:n,revivedController:i})=>{var o=[];try{const s=ue(o,a(this,Zt).acquire());return await b(n.start(),x(f=>m(this,B,Tu).call(this,i,f)),x(()=>i.controller.resume()))}catch(c){var u=c,l=!0}finally{le(o,u,l)}}),ae(n=>n instanceof _u?D():Q(n)),dt(Ie(n=>a(this,ke).error("Unexpected error on remote execution scope start",n,{delivery:!1}))))},vS=async function(e){return await a(this,Zt).waitUntilUnlocked(),b(a(this,Pe).findExecutionScopeController(e.scopeName,e.scopeId),tr,N(r=>xt(()=>ha(r))),ae(r=>r instanceof _u?D():Q(r)),dt(Ie(r=>a(this,ke).error("Unexpected error on remote execution scope stop",r,{delivery:!1}))))},mS=function(e){return b(m(this,B,Iu).call(this,a(this,Pe),a(this,Le).executionScopeData.children),ne(r=>r.sort((n,i)=>n.data.instantiationOrder-i.data.instantiationOrder)),tr,N(async r=>{for(const n of r){const i=await m(this,B,Tu).call(this,n,e);if(De(i))return i}for(const{controller:n}of r)n.resume();return P()}))},Tu=async function({owningPlugin:e,controller:r,data:n},i){return m(this,B,xu).call(this,{scopeName:r.name,scopeId:r.id},r.ancestors)?NR(async s=>{e&&await s(e.activate()),await s(a(this,Le).activationsInProgress.waitUntilUnlocked());const o=m(this,B,yS).call(this,n.scope,n.owningPlugin);return a(this,ke).verbose('Reviving "'.concat(n.scope,'" scope(').concat(n.id,").")),await s(o(r,i,n.initializationData)),P()}):(a(this,ke).verbose('Skipping revival of "'.concat(n.scope,"(").concat(n.id,')" scope as it is not entangled.')),P())},yS=function(e,r){for(const n of a(this,bn).values())if(n.scope===e&&n.plugin===r)return n.reviver;return r&&a(this,ke).verbose('The "'.concat(r,'" plugin did not register a reviver for the "').concat(e,'" scope. Using the default reviver.')),n=>n.start()},Iu=function(e,r){const n=[];for(const i of r){const s=m(this,B,Ou).call(this,e,i);if(De(s))return s;const o=s.value;n.push(o);const c=m(this,B,Iu).call(this,o.controller,o.data.children);if(De(c))return c;n.push(...c.value)}return P(n)},Ou=function(e,r){const n=r.owningPlugin?a(this,Le).findPlugin(r.owningPlugin):P(null),i=e.createExecutionScopeFromSerialized(r);return CR({data:P(r),owningPlugin:n,controller:i})},xu=function(e,r){if(!Array.from(r).reverse().slice(0,a(this,Qt).length).every(({scopeName:s,scopeId:o},c)=>{const u=a(this,Qt).at(c);return u?u.scopeName===s&&u.scopeId===o:!1}))return!1;if(r.length<a(this,Qt).length)return a(this,Qt).some(({scopeName:s,scopeId:o})=>e.scopeName===s&&e.scopeId===o);if(!a(this,Qe))return!0;if(a(this,Qe).configured.has(e.scopeName))for(const s of r)a(this,Qe).allowed.add(s.scopeName);return a(this,Qe).allowed.has(e.scopeName)?!0:(a(this,ke).verbose('Skipping "'.concat(e,'" scope revival due configured.'),a(this,Le).entangledScopes),!1)};function Sj(t,e){const r=(n,i)=>{e(n,i);for(const s of n.children)r(s,[n,...i])};r(t,[])}var wr,j,En,Vi,wn,M,I,SS,bS,Pu,Ru,cr,_S,ES,$n,wS,Du,Cu,Au,kn,$S,Nu,kS,TS;class bj{constructor({context:e,...r}){g(this,I);g(this,wr);g(this,j);g(this,En,new AsyncDisposableStack);g(this,Vi,new Set);g(this,wn,new Set);g(this,M,{kind:"created"});g(this,$n,null);g(this,kn,new Set);v(this,j,r);const n=()=>m(this,I,Ru).call(this,e.realm);v(this,wr,Nt(e,{get realm(){return n()},getPlugin:i=>(a(this,Vi).has(i)||a(this,wn).add(i),e.getPlugin(i)),getPlugins:i=>{if(Array.isArray(i))for(const s of i)a(this,Vi).has(s)||a(this,wn).add(s);return e.getPlugins(i)},getExecutionScopeDefinition:i=>qe(a(this,j).name,()=>m(this,I,SS).call(this,i,e.getExecutionScopeDefinition(i))),registerExecutionScopeReviver:(i,s)=>qe(a(this,j).name,()=>e.registerExecutionScopeReviver(i,(o,c,u)=>s(m(this,I,Pu).call(this,o.name,o),{resolve:m(this,I,Cu).call(this,c)},u)))}))}get debugName(){var e;return(e=a(this,j).metadata.packageName)!=null?e:a(this,j).name}getExecutionScopeProxy(e){return m(this,I,cr).call(this,e)}load(){switch(a(this,M).kind){case"created":return m(this,I,_S).call(this);case"loading":return a(this,M).task;case"loaded":case"activating":case"activated":return D();case"error":return Q(a(this,M).error);default:throw new tt(a(this,M))}}activate(){switch(a(this,M).kind){case"created":return b(this.load(),N(()=>this.activate()));case"loading":return b(a(this,M).task,N(()=>this.activate()));case"loaded":return m(this,I,ES).call(this,a(this,M).module);case"activating":return a(this,M).task;case"activated":return D();case"error":return Q(a(this,M).error)}}get plugin(){return m(this,I,TS).call(this)}async[Symbol.asyncDispose](){return a(this,En).disposeAsync()}}wr=new WeakMap,j=new WeakMap,En=new WeakMap,Vi=new WeakMap,wn=new WeakMap,M=new WeakMap,I=new WeakSet,SS=function(e,r){return Nt(r,{register:m(this,I,Du).call(this,e,r,{warnOnLateRegistration:!1}),onStart:n=>qe(a(this,j).name,()=>r.onStart(Ys(n,i=>n(m(this,I,cr).call(this,i))))),onStop:n=>qe(a(this,j).name,()=>r.onStop(Ys(n,i=>n(m(this,I,cr).call(this,i)))))})},bS=function(e){return Nt(e,{onStart:r=>qe(a(this,j).name,()=>e.onStart(Ys(r,n=>r(m(this,I,cr).call(this,n))))),onStop:r=>qe(a(this,j).name,()=>e.onStop(Ys(r,n=>r(m(this,I,cr).call(this,n)))))})},Pu=function(e,r){return Nt(r,{start:()=>b(r.start(),x(n=>m(this,I,cr).call(this,n))),register:m(this,I,Du).call(this,e,r,{warnOnLateRegistration:!1})})},Ru=function(e){return e.kind==="background"?Nt(e,{registerEntity:r=>qe(a(this,j).name,()=>e.registerEntity(r))}):Nt(e,{resolveEntity:(r,n)=>qe(a(this,j).name,()=>e.resolveEntity(r,n))})},cr=function(e){const r=()=>m(this,I,Ru).call(this,e.realm);return Nt(e,{resolve:m(this,I,Cu).call(this,e),observeExecutionScope:n=>qe(a(this,j).name,()=>m(this,I,bS).call(this,e.observeExecutionScope(n))),createExecutionScopeController:(n,i)=>qe(a(this,j).name,()=>b(e.createExecutionScopeController(n,i),ne(s=>m(this,I,Pu).call(this,n,s)))),get realm(){return r()}})},_S=async function(){var n=[];try{const e=ue(n,To.startSpan("Plugin.load",{attributes:{name:a(this,j).name}}));const r=b(a(this,j).loader.load(a(this,j).name),ko(e),N(c=>typeof c.activate!="function"?(v(this,M,{kind:"error",module:c,error:new fj(this.debugName)}),Q(a(this,M).error)):(v(this,M,{kind:"loaded",module:c}),D())));v(this,M,{kind:"loading",task:r});return await r}catch(i){var s=i,o=!0}finally{le(n,s,o)}},ES=async function(e){var o;var c=[];try{const r=ue(c,a(this,j).activation.acquire());(o=Tr())==null||o.recordEvent("activate",{plugin:this.debugName});const n=To.startSpan("Plugin.activate",{attributes:{name:a(this,j).name}});E.verbose("Activating plugin ".concat(this.debugName));m(this,I,kS).call(this,e);const i=a(this,En).use(new AsyncDisposableStack);const s=b(e.activate(a(this,wr)),d=>vl(d)?tr(d):d,ko(n),x(d=>{i.use(d!=null?d:null),v(this,M,{kind:"activated",module:e,deactivate:i})}),dt(d=>(v(this,M,{kind:"error",module:e,error:d}),new uj(a(this,j).name,d))),N(()=>b(new Set(a(this,wn)),Ro(d=>a(this,wr).getPlugin(d)),ej(d=>!(De(d)&&d.error instanceof lj&&a(this,j).metadata.optionalDependencies.includes(d.error.plugin))),Ro(d=>{var h;if(De(d))return tr(d);const p=d.value;return p.isActivated?D():(E.verbose("Activating dependency ".concat((h=p.metadata.packageName)!=null?h:p.name," for ").concat(this.debugName)),p.activate())}),yi,x(It),ae(d=>(E.error("Failed to activate dependencies for ".concat(this.debugName),d),D())))));v(this,M,{kind:"activating",module:e,task:s});a(this,En).defer(async()=>(await s,i.disposeAsync()));return await s}catch(u){var l=u,f=!0}finally{le(c,l,f)}},$n=new WeakMap,wS=function(){var e,r;if(a(this,$n))return a(this,$n);switch(a(this,M).kind){case"loaded":case"activating":case"activated":return(r=a(this,$n))!=null?r:v(this,$n,new Map(Object.entries((e=a(this,M).module)!=null?e:{}).map(([n,i])=>[i,n.replace(/Token$/,"")])));default:return new Map}},Du=function(e,r,n={warnOnLateRegistration:!0}){return(i,s)=>{var f,d;const o=m(this,I,wS).call(this).get(i.token),c=o?m(this,I,Au).call(this,o):void 0,u=a(this,j).name;(f=Tr())==null||f.recordEvent("register",{name:this.debugName,token:ee(i.token),alias:c?ee(c):void 0,scope:e});const l={lifetime:(d=s==null?void 0:s.lifetime)!=null?d:oe.Transient,onResolution(){var p;cS(u),(p=s==null?void 0:s.onResolution)==null||p.call(s)},onResolutionSuccess(){var p;Eu(),(p=s==null?void 0:s.onResolutionSuccess)==null||p.call(s)},onResolutionFailure(p){var h;Eu(),(h=s==null?void 0:s.onResolutionFailure)==null||h.call(s,p)}};return ft.all(c?[r.register(i,l),r.register({token:c,useToken:i.token})]:[r.register(i,l)])}},Cu=function(e){return(r,n)=>qe(a(this,j).name,()=>b(e.resolve(r,n),ml(i=>new cj(r,this.debugName,i))))},Au=function(e){return Ei(Symbol.for("".concat(this.debugName,":provides/").concat(e)))},kn=new WeakMap,$S=function(e){return a(this,kn).add(e),Ei(Symbol.for("".concat(this.debugName,":consumes/").concat(e)))},Nu=function(e,r="module"in a(this,M)?a(this,M).module:null){const n=m(this,I,$S).call(this,e);if(!r)return n;const i=Reflect.get(r,"".concat(e,"Token"));return i?(a(this,wr).getExecutionScopeDefinition("global").register({token:i,useToken:n},{override:!1}),n):(E.verbose("No token in module"),n)},kS=function(e){for(const r of a(this,kn))m(this,I,Nu).call(this,r,e);a(this,kn).clear()},TS=function(){const e=()=>a(this,M).kind==="activated",r=()=>a(this,M).kind==="loaded"||a(this,M).kind==="activating"||a(this,M).kind==="activated";return{name:a(this,j).name,provides:new Proxy(Object.create(null),{get:(i,s)=>{if(typeof s=="string")return m(this,I,Au).call(this,s)}}),consumes:new Proxy(Object.create(null),{get:(i,s)=>{if(typeof s=="string")return m(this,I,Nu).call(this,s)}}),get isActivated(){return e()},get isLoaded(){return r()},activate:()=>this.activate(),metadata:a(this,j).metadata}};function Ys(t,e){return new Proxy(e,{get:(r,n,i)=>n==="toString"?()=>t.toString():Reflect.get(t,n,i)})}var Tn,Yi,qi,Xi,In;class _j{constructor(e,r,n){g(this,Tn);g(this,Yi);g(this,qi);g(this,Xi,new AsyncDisposableStack);g(this,In,new Map);v(this,Yi,e),v(this,Tn,r),v(this,qi,n)}get(e){const r=a(this,In).get(e);return r?P(r):b(a(this,Tn).loadMetadata(e),ne(n=>{const i=a(this,Xi).use(new bj({name:e,metadata:n,loader:a(this,Tn),context:a(this,Yi),activation:a(this,qi)}));return a(this,In).set(e,i),i}),yl(n=>b($o(n.plugin.metadata.dependencies.map(i=>this.get(i))),ne(Ie(()=>n.plugin.metadata.optionalDependencies.map(i=>this.get(i)))),ne(()=>n))))}activate(e){return b(this.get(e),tr,N(r=>r.activate()))}getPlugin(e){return b(this.get(e),ne(r=>r.plugin))}get all(){return Array.from(a(this,In).values())}[Symbol.asyncDispose](){return a(this,Xi).disposeAsync()}}Tn=new WeakMap,Yi=new WeakMap,qi=new WeakMap,Xi=new WeakMap,In=new WeakMap;function Ej(t){return new wj(t)}var On,xn,Te,pe,$r,Ue,Pn,Be,Tt,Ct,IS,OS,ju;class wj{constructor(e){g(this,Ct);g(this,On,new AbortController);g(this,xn,new AbortController);g(this,Te);g(this,pe);g(this,$r);g(this,Ue);g(this,Pn);g(this,Be);g(this,Tt);S(this,"realm");S(this,"status",a(this,On).signal);var n;v(this,Te,new AsyncDisposableStack),a(this,Te).defer(()=>{a(this,On).abort(),E.verbose("PluginHost disposed.")}),v(this,pe,e),v(this,$r,new dS),v(this,Ue,a(this,Te).use(new _j(this,a(this,pe).loader,a(this,$r))));const r={activationsInProgress:a(this,$r),connection:a(this,xn).signal,onBeforeStart:i=>{var s,o;return b(new Set((o=(s=a(this,pe).plugins[i])==null?void 0:s.onStart)!=null?o:[]),Ro(c=>a(this,Ue).activate(c)),yi,x(It))},onBeforeStop:i=>{var s,o;return b(new Set((o=(s=a(this,pe).plugins[i])==null?void 0:s.onStop)!=null?o:[]),Ro(c=>a(this,Ue).activate(c)),yi,x(It))},getExecutionScopeProxy:(i,s)=>{if(!i)return s;const o=a(this,Ue).get(i);return o.ok?o.value.getExecutionScopeProxy(s):s}};if((n=a(this,pe).background)!=null&&n.executionScopeData)v(this,Tt,a(this,Te).use(mj({...r,entangledScopes:a(this,pe).background.entangledScopes,backgroundPort:a(this,pe).background.executionRealmData.port,findPlugin:i=>a(this,Ue).getPlugin(i),executionScopeData:a(this,pe).background.executionScopeData}))),v(this,Pn,a(this,Tt)),v(this,Be,a(this,Te).use(a(this,Tt).create()));else{const i=a(this,Te).use(vj(r));v(this,Tt,null),v(this,Pn,i),v(this,Be,a(this,Te).use(i.create({data:null})))}this.realm=a(this,Be).realm}getPluginLoader(){return a(this,pe).loader}getPlugin(e){return a(this,Ue).getPlugin(e)}getPlugins(e){return e?$o(e.map(r=>a(this,Ue).getPlugin(r))):P(a(this,Ue).all.map(r=>r.plugin))}getExecutionScopeDefinition(e){return a(this,Pn).getExecutionScopeDefinition(e)}getGlobalExecutionScopeControllerForTesting(){return R(new w("This method is only available in tests."))}register(e,r){return a(this,Be).register(e,r)}registerExecutionScopeReviver(e,r){return e==="global"?R(new w("The global scope is handled internally.")):a(this,Tt)?P(a(this,Tt).registerReviver(e,Ot(),r)):(E.verbose('Cannot register reviver for "'.concat(e,'" scope: no reviver available.')),P(pt(It)))}getResolutionMetadata(){const e=dj();return e?{plugin:e}:null}start(){return b(m(this,Ct,IS).call(this),N(()=>a(this,Be).start()))}async exposeOnPort(e,r=ir()){var u;var l=[];try{const n=ue(l,new DisposableStack);const i="bg-".concat(r);const s="fg-".concat(r);const o=(u=a(this,pe).useWebLocks)!=null?u:!0;if(!o)return E.verbose("Skip Web Locks for ExecutionRealm(".concat(i,").")),b(m(this,Ct,OS).call(this,i,e),ne(()=>n.move()));E.verbose("ExecutionRealm(".concat(i,") created."));const c=new AbortController;return await b(tj({id:i,otherId:s,onConnection:()=>{E.verbose("ExecutionRealm(".concat(i,") connected."))},onConnectionLost:()=>{E.verbose("ExecutionRealm(".concat(i,") disconnected.")),c.abort()},onConnectionError:h=>{E.verbose("SynchronizationLock failed for ExecutionRealm(".concat(i,").")),E.error(h),c.abort()}}),jn(ft.use(n)),N(async h=>b(n.use(m(this,Ct,ju).call(this,r,e,c.signal)),y=>a(this,Be).entangle(y.createClient()),ft.use(n),ne(()=>{const y=n.move();return c.signal.addEventListener("abort",()=>y.dispose(),{once:!0,signal:a(this,On).signal}),E.verbose("ExecutionRealm(".concat(i,") exposed on port.")),{lock:h,[Symbol.dispose]:()=>y.dispose()}}))))}catch(f){var d=f,p=!0}finally{le(l,d,p)}}use(e){if(a(this,Te).disposed)return void ha(e);a(this,Te).use(e)}[Symbol.asyncDispose](){return a(this,Te).disposeAsync()}}On=new WeakMap,xn=new WeakMap,Te=new WeakMap,pe=new WeakMap,$r=new WeakMap,Ue=new WeakMap,Pn=new WeakMap,Be=new WeakMap,Tt=new WeakMap,Ct=new WeakSet,IS=function(){var r;return((r=a(this,pe).background)==null?void 0:r.executionRealmData.lock)?(E.verbose("Using synchronization lock."),b(rj(a(this,pe).background.executionRealmData.lock,{onConnection:()=>{E.verbose("ExecutionRealm connected.")},onConnectionLost:()=>{E.verbose("ExecutionRealm disconnected. Stopping the host."),a(this,xn).abort("connection lost")},onConnectionError:n=>{E.verbose("ExecutionRealm failed to connect. Stopping the host."),E.error(new w("ExecutionRealm connection error",n)),a(this,xn).abort("connection error")}}),Tv(bl.use(a(this,Te))),x(It))):D()},OS=function(e,r){var o=[];try{const n=ue(o,new DisposableStack);const i=new AbortController;n.defer(()=>i.abort());const s=n.use(m(this,Ct,ju).call(this,e,r,i.signal));return b(a(this,Be).entangle(s.createClient()),ft.use(n),ne(()=>n.move()))}catch(c){var u=c,l=!0}finally{le(o,u,l)}},ju=function(e,r,n){const i="bg-".concat(e),s="fg-".concat(e);return new _i(bi(r),{logger:{location:"Background",name:"RealmEntanglement",context:i},handler:{getEntity:async(o,c)=>n.aborted?Q(new kr("Cannot process getEntity() in untangled ExecutionRealm")):b(o.plugin?b(a(this,Ue).getPlugin(o.plugin),tr,N(u=>u.activate())):D(),N(()=>a(this,$r).waitUntilUnlocked()),N(async()=>a(this,Be).findExecutionScopeController(o.scopeName,o.scopeId)),N(async u=>u.resolveEntity(o.plugin,o.entity,n,s)),x(u=>c.transfer(u,[u.transport.port])),dt(u=>(E.error("Failed to get entity:",u),u))),getExecutionScopeInitializationData:async o=>$o(o.scopes.map(({scopeName:c,scopeId:u})=>b(a(this,Be).findExecutionScopeController(c,u),ne(l=>({scopeName:c,scopeId:u,initializationData:l.serialize({childList:!1,ancestors:!1}).initializationData})))))}})};var ah=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),ch=t=>{throw TypeError(t)},uh=(t,e,r)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&ch("Object expected");var n;r&&(n=e[ah("asyncDispose")]),n===void 0&&(n=e[ah("dispose")]),typeof n!="function"&&ch("Object not disposable"),t.push([r,n,e])}else r&&t.push([r]);return e},$j=(t,e,r)=>{var n=typeof SuppressedError=="function"?SuppressedError:function(o,c,u,l){return l=Error(u),l.name="SuppressedError",l.error=o,l.suppressed=c,l},i=o=>e=r?new n(o,e,"An error was suppressed during disposal"):(r=!0,o),s=o=>{for(;o=t.pop();)try{var c=o[1]&&o[1].call(o[2]);if(o[0])return Promise.resolve(c).then(s,u=>(i(u),s()))}catch(u){i(u)}if(r)throw e};return s()};async function kj({metadata:t,monitoring:e,connectEventSource:r,pluginRequests:n}){var i=[];try{E.verbose("Initializing background app",t);const u=uh(i,new AsyncDisposableStack,!0),l=uh(i,e.duration("background_app_launch")),f=u.use(Ej({plugins:{global:{onStart:["window-management","document-group"]}},loader:ZN({metadata:Object.assign({"../plugin-capi-suggestion/package.json":yN,"../plugin-capi/package.json":bN,"../plugin-connector/package.json":EN,"../plugin-document-group/package.json":$N,"../plugin-document-session/package.json":TN,"../plugin-inline-assistant/package.json":ON,"../plugin-inline-card/package.json":PN,"../plugin-inline-decorations/package.json":DN,"../plugin-monitoring/package.json":AN,"../plugin-sdui/package.json":jN,"../plugin-suggestion/package.json":FN,"../plugin-text-decoration/package.json":UN,"../plugin-ui/package.json":zN,"../plugin-window-management/package.json":WN}),dynamicBundles:Object.assign({"../plugin-capi-suggestion/src/index.ts":()=>import("./index-uCjNtyxN.js"),"../plugin-capi/src/index.ts":()=>import("./index-B9uHfCTo.js"),"../plugin-connector/src/index.ts":()=>import("./index-WrA72bii.js"),"../plugin-document-group/src/index.ts":()=>import("./index-DnatBlUk.js"),"../plugin-document-session/src/index.ts":()=>import("./index-DGeXO3oi.js"),"../plugin-inline-assistant/src/index.ts":()=>import("./index-CbxqSIwH.js"),"../plugin-inline-card/src/index.ts":()=>import("./index-Cu8JTHOu.js"),"../plugin-inline-decorations/src/index.ts":()=>import("./index-DnbEk8n_.js"),"../plugin-monitoring/src/index.ts":()=>import("./index-5yZHlJEj.js"),"../plugin-sdui/src/index.ts":()=>import("./index-BRUA9V8r.js"),"../plugin-suggestion/src/index.ts":()=>import("./index-BOWMRPqo.js"),"../plugin-text-decoration/src/index.ts":()=>import("./index-oQtk5Yhs.js"),"../plugin-ui/src/index.ts":()=>import("./index-DYBNIdcl.js"),"../plugin-window-management/src/index.ts":()=>import("./index-BLs3wl_w.js")})})})),d=b($o([f.getPlugin("document-group"),f.getPlugin("window-management")]),yl(([p,h])=>ft.all([f.register({token:qN,useValue:WR(t)}),f.register({token:um,useValue:pm(t)}),f.register({token:p.consumes.ConnectEventSource,useValue:r}),f.register({token:h.consumes.ExecutionRealmProvider,useValue:{getExecutionRealmData:y=>{const _=new MessageChannel;return b(f.exposeOnPort(_.port1,y),x(({lock:k})=>({lock:k,port:_.port2})))}}})])));return De(d)?d:await b(f.start(),x(()=>{u.use(n.subscribe(p=>{for(const h of p)b(f.getPlugin(h),tr,x(y=>y.activate()),dt(Ie(y=>E.error("Failed to activate plugin: "+h,y,{delivery:!0}))))}))}),x(()=>u.move()))}catch(u){var s=u,o=!0}finally{var c=$j(i,s,o);c&&await c}}var Tj=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),Co=t=>{throw TypeError(t)},xS=(t,e,r)=>e.has(t)||Co("Cannot "+r),je=(t,e,r)=>(xS(t,e,"read from private field"),r?r.call(t):e.get(t)),_c=(t,e,r)=>e.has(t)?Co("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Ec=(t,e,r,n)=>(xS(t,e,"write to private field"),e.set(t,r),r),PS=(t,e,r)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&Co("Object expected");var n;n===void 0&&(n=e[Tj("dispose")]),typeof n!="function"&&Co("Object not disposable"),t.push([r,n,e])}return e},RS=(t,e,r)=>{var n=typeof SuppressedError=="function"?SuppressedError:function(o,c,u,l){return l=Error(u),l.name="SuppressedError",l.error=o,l.suppressed=c,l},i=o=>e=r?new n(o,e,"An error was suppressed during disposal"):(r=!0,o),s=o=>{for(;o=t.pop();)try{var c=o[1]&&o[1].call(o[2]);if(o[0])return Promise.resolve(c).then(s,u=>(i(u),s()))}catch(u){i(u)}if(r)throw e};return s()},jt,Mt,ci;function Ij(t){var e=[];try{const i=PS(e,new DisposableStack),s=new AbortController;i.defer(()=>s.abort());const o=(c,u)=>{const l=()=>{const d=-Math.log(Math.random())*c;setTimeout(f,d)},f=()=>{s.signal.aborted||(u(),l())};l()};if(!globalThis.crossOriginIsolated){if("memory"in performance){E.info("Using performance.memory as ".concat(globalThis.origin," is not cross-origin isolated."),{delivery:!1});const c={totalJSHeapSize:new wc,usedJSHeapSize:new wc,jsHeapSizeLimit:new wc};let u=null,l=null;const f=1e3*60;o(f,()=>{const d=performance.memory;if(!d)return;c.totalJSHeapSize.update(d.totalJSHeapSize),c.usedJSHeapSize.update(d.usedJSHeapSize),c.jsHeapSizeLimit.update(d.jsHeapSizeLimit);const p=c.usedJSHeapSize.count,h=c.usedJSHeapSize.mean,y=c.totalJSHeapSize.mean,_=c.usedJSHeapSize.check(h);switch(Ao(u)&&Hl(_)&&(l==null||l.close(),l=null),u=_,Ao(_)&&(l!=null||(l=t.duration("memory_pressure"))),p){case 1:t.histogram("initial_total_js_heap_size",{value:y}),t.histogram("initial_used_js_heap_size",{value:h});break;case 10:t.histogram("10min_total_js_heap_size",{value:y}),t.histogram("10min_used_js_heap_size",{value:h});break;case 60:t.histogram("1hr_total_js_heap_size",{value:y}),t.histogram("1hr_used_js_heap_size",{value:h});break;case 24*60:t.histogram("1day_total_js_heap_size",{value:y}),t.histogram("1day_used_js_heap_size",{value:h});break;case 2*24*60:t.histogram("2day_total_js_heap_size",{value:y}),t.histogram("2day_used_js_heap_size",{value:h});break;case 3*24*60:t.histogram("3day_total_js_heap_size",{value:y}),t.histogram("3day_used_js_heap_size",{value:h});break;case 7*24*60:t.histogram("1week_total_js_heap_size",{value:y}),t.histogram("1week_used_js_heap_size",{value:h});break}})}}return i.move()}catch(i){var r=i,n=!0}finally{RS(e,r,n)}}function Oj(t){var e=[];try{const i=PS(e,new DisposableStack);if(!globalThis.isSecureContext)return E.warn("PressureObserver is not supported in insecure context",{delivery:!1}),i.move();try{const s=new Map,o=new Map,c=new PressureObserver(u=>{var l;for(const f of u){const d=s.get(f.source),p=f.state;if(Ao(d)&&Hl(p)){const h=o.get(f.source);h==null||h.close(),o.delete(f.source)}s.set(f.source,f.state),Ao(p)&&o.set(f.source,(l=o.get(f.source))!=null?l:t.duration("".concat(f.source,"_pressure")))}});i.defer(()=>c.disconnect()),PressureObserver.knownSources.forEach(u=>{E.info("PressureObserver is setup for ".concat(u," pressure."),{delivery:!1}),c.observe(u,{samplePeriod:15*1e3})})}catch(s){s instanceof ReferenceError?E.warn("PressureObserver is not supported",{delivery:!1}):E.error("Failed to create PressureObserver",Re(s))}return i.move()}catch(i){var r=i,n=!0}finally{RS(e,r,n)}}class wc{constructor(){_c(this,jt,0),_c(this,Mt,0),_c(this,ci,0)}update(e){Ec(this,Mt,je(this,Mt)+1);const r=e-je(this,jt);Ec(this,jt,je(this,jt)+r/je(this,Mt)),Ec(this,ci,je(this,ci)+r*(e-je(this,jt)))}get count(){return je(this,Mt)}get mean(){return je(this,jt)}get variance(){return je(this,Mt)<1?NaN:je(this,ci)/je(this,Mt)}getZScore(e){const{mean:r,variance:n}=this;return isNaN(r)||isNaN(n)?NaN:(e-je(this,jt))/Math.sqrt(this.variance)}check(e){const r=this.getZScore(e);return isNaN(r)||r<=1?"normal":r<=2?"fair":r<=3?"serious":"critical"}}jt=new WeakMap;Mt=new WeakMap;ci=new WeakMap;function Hl(t){return t==="normal"||t==="fair"}function Ao(t){return!Hl(t)}var lh=(t,e)=>(e=Symbol[t])?e:Symbol.for("Symbol."+t),fh=t=>{throw TypeError(t)},$c=(t,e,r)=>{if(e!=null){typeof e!="object"&&typeof e!="function"&&fh("Object expected");var n;r&&(n=e[lh("asyncDispose")]),n===void 0&&(n=e[lh("dispose")]),typeof n!="function"&&fh("Object not disposable"),t.push([r,n,e])}else r&&t.push([r]);return e},xj=(t,e,r)=>{var n=typeof SuppressedError=="function"?SuppressedError:function(o,c,u,l){return l=Error(u),l.name="SuppressedError",l.error=o,l.suppressed=c,l},i=o=>e=r?new n(o,e,"An error was suppressed during disposal"):(r=!0,o),s=o=>{for(;o=t.pop();)try{var c=o[1]&&o[1].call(o[2]);if(o[0])return Promise.resolve(c).then(s,u=>(i(u),s()))}catch(u){i(u)}if(r)throw e};return s()};console.log("Worker started");Pj().then(()=>E.info("Background app started")).catch(t=>E.error(t,{delivery:!0}));async function Pj(){var t=[];try{console.log("Starting background app");const i=$c(t,To.startSpan("Background")),s=$c(t,new AsyncDisposableStack,!0);s.use(XR());const o=Promise.withResolvers(),c=xt(()=>o.promise);s.use(m1(c));const{connectEventSource:u,pluginRequests:l}=vN(o),{monitoring:f}=s.use(x1(c)),d=$c(t,f.duration("background_window_setup"));return s.use(Ij(f)),s.use(Oj(f)),await b(c,N(p=>kj({metadata:p,monitoring:f,connectEventSource:u,pluginRequests:l})),Tv(bl.use(s)),x(()=>s.move()))}catch(i){var e=i,r=!0}finally{var n=xj(t,e,r);n&&await n}}export{ma as $,Cm as A,Em as B,w as C,sN as D,qN as E,um as F,D as G,Q as H,Sl as I,_i as J,pR as K,oe as L,I1 as M,Re as N,gv as O,wR as P,gN as Q,ft as R,Bl as S,De as T,tt as U,Gj as V,hj as W,bl as X,jR as Y,He as Z,NR as _,N as a,Fj as a0,Aj as a1,ha as a2,Pr as a3,Nj as a4,yi as a5,ir as a6,pN as a7,kr as a8,Mm as a9,mu as aA,rr as aB,wm as aC,gs as aD,rN as aE,gm as aF,W1 as aG,zn as aH,Su as aI,cN as aJ,Po as aK,kv as aL,Vj as aM,qj as aN,Qj as aO,Wj as aP,Dj as aQ,Iv as aR,$v as aS,To as aT,Yj as aU,Jj as aV,Lj as aW,Xj as aX,oS as aY,pt as aa,Hj as ab,Mj as ac,Cj as ad,Uj as ae,Kj as af,aN as ag,eM as ah,Xp as ai,oN as aj,H1 as ak,Ll as al,yc as am,ym as an,U1 as ao,Ul as ap,Bj as aq,iN as ar,Am as as,hs as at,Si as au,Vn as av,G1 as aw,te as ax,Fl as ay,yu as az,Ro as b,Ei as c,ej as d,ml as e,R as f,Ie as g,yl as h,P as i,$o as j,lN as k,E as l,ne as m,cm as n,dt as o,b as p,x as q,jm as r,zl as s,Zj as t,xt as u,It as v,tr as w,uN as x,D1 as y,zj as z};
//# sourceMappingURL=start-BFd-djfI.js.map
