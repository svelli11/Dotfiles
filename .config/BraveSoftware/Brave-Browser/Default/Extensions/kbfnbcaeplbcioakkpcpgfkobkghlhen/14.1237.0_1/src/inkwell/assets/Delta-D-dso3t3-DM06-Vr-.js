var S=Object.defineProperty;var j=t=>{throw TypeError(t)};var E=(t,e,n)=>e in t?S(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var b=(t,e,n)=>E(t,typeof e!="symbol"?e+"":e,n),N=(t,e,n)=>e.has(t)||j("Cannot "+n);var u=(t,e,n)=>(N(t,e,"read from private field"),n?n.call(t):e.get(t)),L=(t,e,n)=>e.has(t)?j("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),T=(t,e,n,s)=>(N(t,e,"write to private field"),s?s.call(t,n):e.set(t,n),n);function M(t,e=t){let n;return{get(){return n===void 0&&(n=t()),n},update(s){n!==void 0&&(n=e(s,this.get()))},clear(){n=void 0}}}function l(t){return t.delete!==void 0}function d(t){return t.insert!==void 0}function o(t){return t.retain!==void 0}function m(t){return d(t)&&typeof t.insert=="string"}function J(t,e){const n=t.attributes,s=e.attributes;return R(n,s)}function v(t,e){if(t===e)return!0;if(t===void 0||e===void 0)return!1;const n=I(t),s=I(t);return n!==s?!1:R(t[n],e[s])&&J(t,e)}function R(t,e){if(t===e)return!0;if(typeof t!="object"||typeof e!="object"||t===null||e===null)return!1;const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const s of n)if(t[s]!==e[s])return!1;return!0}function y(t){return d(t)?typeof t.insert=="string"?t.insert.length:1:o(t)?t.retain:t.delete}function I(t){return d(t)?"insert":o(t)?"retain":"delete"}function z(t){return a({...t,insert:d(t)?typeof t.insert=="object"?JSON.parse(JSON.stringify(t.insert)):t.insert:void 0,attributes:t.attributes!==void 0?{...t.attributes}:t.attributes})}function a(t){return{insert:t.insert,delete:t.delete,retain:t.retain,attributes:t.attributes}}class k{constructor(e){b(this,"ops");b(this,"index");b(this,"offset");this.ops=e,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(e=1/0){const n=this.ops[this.index];let s;if(n!==void 0){const i=this.offset,r=y(n);e>=r-i?(e=r-i,this.index+=1,this.offset=0):this.offset+=e,l(n)?s=a({delete:e}):o(n)?s={retain:e,attributes:n.attributes}:m(n)?s=a({insert:n.insert.slice(i,i+e),attributes:n.attributes}):s=n}else s=a({retain:1/0});return s}peek(){return this.ops[this.index]}peekLength(){const e=this.ops[this.index];return e!==void 0?y(e)-this.offset:1/0}peekType(){const e=this.ops[this.index];return e!==void 0?I(e):"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const e=this.offset,n=this.index,s=this.next(),i=this.ops.slice(this.index);return this.offset=e,this.index=n,[s].concat(i)}}else return[]}}function g(t,e){return e!==void 0&&Object.keys(e).length>0?{...t,attributes:e}:{...t,attributes:void 0}}function A(t){for(;t.ops.length>0;){const e=t.ops[t.ops.length-1];if(e!==void 0&&o(e)&&e.attributes===void 0)t.ops.pop();else break}return t}var f,p;const w=class w{constructor(e){L(this,f);L(this,p,M(()=>u(this,f).reduce((e,n)=>d(n)?e+y(n):l(n)?e-n.delete:e,0),(e,n)=>d(e)?n+y(e):l(e)?n-e.delete:n));T(this,f,P(e)),u(this,f).length===0&&this.changeLength}get ops(){return u(this,f)}get changeLength(){return u(this,p).get()}insert(e,n){return typeof e=="string"&&e.length===0?this:this.push(g({insert:e},n))}delete(e){return e<=0?this:this.push({delete:e})}retain(e,n){return e<=0?this:this.push(g({retain:e},n))}push(...e){if(e.length===0)return this;const n=e[0];u(this,p).update(n);let s=u(this,f).length,i=u(this,f)[s-1];const r=z(n);if(i!==void 0){if(l(r)&&l(i))return u(this,f)[s-1]=a({delete:i.delete+r.delete}),this;if(l(i)&&d(r)&&(s-=1,i=u(this,f)[s-1],i===void 0))return u(this,f).unshift(r),this;if(J(r,i)){if(m(r)&&m(i))return u(this,f)[s-1]=a(g({insert:i.insert+r.insert},r.attributes)),this;if(o(r)&&o(i))return u(this,f)[s-1]=a(g({retain:i.retain+r.retain},r.attributes)),this}}if(s===u(this,f).length?u(this,f).push(r):u(this,f).splice(s,0,r),e.length>1){const h=e.slice(1);u(this,f).push(...h),h.forEach(c=>{u(this,p).update(c)})}return this}slice(e=0,n=1/0){const s=[],i=new k(u(this,f));let r=0;for(;r<n&&i.hasNext();){let h;r<e?h=i.next(e-r):(h=i.next(n-r),s.push(h)),r+=y(h)}return new w(s)}compose(e){return C(this,new w,e)}transformPosition(e,n=!1){const s=new k(u(this,f));let i=0;for(;s.hasNext()&&i<=e;){const r=s.peekLength(),h=s.peekType();if(s.next(),h==="delete"){e-=Math.min(r,e-i);continue}else h==="insert"&&(!n||i<e)&&(e+=r);i+=r}return e}toJSON(){return{ops:Array.from(u(this,f))}}};f=new WeakMap,p=new WeakMap;let q=w;function D(t={},e={},n=!1){const s=n?{...e}:{};if(!n)for(const i of Object.entries(e))i[1]!==null&&(s[i[0]]=i[1]);for(const i of Object.keys(t))t[i]!==void 0&&e[i]===void 0&&(s[i]=t[i]);return Object.keys(s).length>0?s:void 0}function P(t){return t?B(t)?t.slice():t.ops.slice():[]}function B(t){return Array.isArray(t)}function C(t,e,n){const s=new k(t.ops),i=new k(n.ops),r=i.peek();if(r!==void 0&&o(r)&&r.attributes===void 0){let h=r.retain;for(;s.peekType()==="insert"&&s.peekLength()<=h;)h-=s.peekLength(),e.push(s.next());r.retain-h>0&&i.next(r.retain-h)}for(;s.hasNext()||i.hasNext();)if(i.peekType()==="insert")e.push(i.next());else if(s.peekType()==="delete")e.push(s.next());else{const h=Math.min(s.peekLength(),i.peekLength()),c=s.next(h),O=i.next(h);if(o(O)){let x;if(o(c)?x={retain:h}:x={insert:c.insert},e.push(g(x,D(c.attributes,O.attributes,o(c)))),!i.hasNext()&&v(e.ops[e.ops.length-1],x))return A(e.push(...s.rest()))}else l(O)&&o(c)&&e.push(O)}return A(e)}export{q as D,d as a,o as b,l as c,I as d,y as g,m as i};
//# sourceMappingURL=Delta-D-dso3t3-DM06-Vr-.js.map
